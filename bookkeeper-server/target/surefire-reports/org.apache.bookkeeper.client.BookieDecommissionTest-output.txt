2020-08-10 23:43:16,753 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.client.BookieDecommissionTest
2020-08-10 23:43:17,143 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:17,318 - INFO  - [Time-limited test:MetadataDrivers@105] - BookKeeper metadata driver manager initialized
2020-08-10 23:43:17,325 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:17,339 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:17,467 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:17,508 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:17,509 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:17,513 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:17,571 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:17,763 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie1373690227549947568test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1373690227549947568test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:17,970 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:17,983 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:17,993 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:18,011 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1373690227549947568test/current] [/tmp/bookie1373690227549947568test/current]
2020-08-10 23:43:18,165 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:18,186 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1373690227549947568test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:18,188 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:18,218 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:18,227 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:18,234 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:18,241 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:18,241 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:18,279 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37481 to become writable
2020-08-10 23:43:18,287 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:43:18,292 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:18,297 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:18,300 - INFO  - [BookieJournal-37481:Journal@909] - Starting journal on /tmp/bookie1373690227549947568test/current
2020-08-10 23:43:18,302 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:18,304 - INFO  - [BookieJournal-37481:JournalChannel@157] - Opening journal /tmp/bookie1373690227549947568test/current/173da53e61f.txn
2020-08-10 23:43:18,346 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:18,602 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37481' has been created.
2020-08-10 23:43:18,613 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:18,621 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:18,626 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:18,627 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:18,627 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:18,627 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:18,630 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:18,705 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:18,706 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie10488634682356681357test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie10488634682356681357test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:18,712 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:18,720 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:18,839 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:18,850 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie10488634682356681357test/current] [/tmp/bookie10488634682356681357test/current]
2020-08-10 23:43:18,852 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:18,861 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:43:18,862 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:18,862 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:37481
2020-08-10 23:43:18,866 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie10488634682356681357test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:18,866 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:18,867 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:18,868 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:18,870 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:18,870 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:18,870 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:18,871 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:18,871 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:18,873 - WARN  - [AuditorElector-127.0.0.1:37481:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:43:18,873 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:43:18,874 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:18,874 - INFO  - [AuditorElector-127.0.0.1:37481:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:18,874 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:18,897 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45813 to become writable
2020-08-10 23:43:18,900 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:18,902 - INFO  - [SyncThread-32-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:18,907 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:18,910 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:18,913 - INFO  - [BookieJournal-45813:Journal@909] - Starting journal on /tmp/bookie10488634682356681357test/current
2020-08-10 23:43:18,914 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:43:18,915 - INFO  - [BookieJournal-45813:JournalChannel@157] - Opening journal /tmp/bookie10488634682356681357test/current/173da53e884.txn
2020-08-10 23:43:18,916 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:18,922 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:18,922 - INFO  - [AuditorBookie-127.0.0.1:37481:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:18,922 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:18,937 - INFO  - [AuditorBookie-127.0.0.1:37481-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:18,941 - ERROR - [AuditorBookie-127.0.0.1:37481:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:18,942 - INFO  - [AuditorBookie-127.0.0.1:37481:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:18,942 - INFO  - [AuditorBookie-127.0.0.1:37481:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:18,942 - INFO  - [AuditorBookie-127.0.0.1:37481:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:18,946 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:18,946 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:19,083 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor$11@751] - Completed checkAllLedgers in 168 milliSeconds
2020-08-10 23:43:19,173 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45813' has been created.
2020-08-10 23:43:19,178 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,186 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,192 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:19,192 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:19,193 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:19,193 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:19,198 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:19,198 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:19,225 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:19,226 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie7487327623456686507test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie7487327623456686507test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:19,234 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,241 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,247 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:19,256 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7487327623456686507test/current] [/tmp/bookie7487327623456686507test/current]
2020-08-10 23:43:19,266 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:19,269 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7487327623456686507test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:19,269 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:19,270 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:19,271 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:19,273 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:19,273 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:19,274 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:19,290 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33689 to become writable
2020-08-10 23:43:19,291 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:19,293 - INFO  - [SyncThread-54-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:19,297 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:19,299 - INFO  - [BookieJournal-33689:Journal@909] - Starting journal on /tmp/bookie7487327623456686507test/current
2020-08-10 23:43:19,300 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:19,303 - INFO  - [BookieJournal-33689:JournalChannel@157] - Opening journal /tmp/bookie7487327623456686507test/current/173da53ea08.txn
2020-08-10 23:43:19,312 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:19,312 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:19,312 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:19,568 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33689' has been created.
2020-08-10 23:43:19,572 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,577 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,581 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:19,582 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:19,582 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:19,582 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:19,585 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:19,585 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:19,585 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:19,608 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:19,609 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie4871124831893115628test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie4871124831893115628test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:19,613 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,620 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,625 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:19,635 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie4871124831893115628test/current] [/tmp/bookie4871124831893115628test/current]
2020-08-10 23:43:19,644 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:19,647 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie4871124831893115628test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:19,647 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:19,648 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:19,648 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:19,650 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:19,650 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:19,651 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:19,671 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:32931 to become writable
2020-08-10 23:43:19,672 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:19,677 - INFO  - [SyncThread-70-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:19,681 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:19,684 - INFO  - [BookieJournal-32931:Journal@909] - Starting journal on /tmp/bookie4871124831893115628test/current
2020-08-10 23:43:19,685 - INFO  - [BookieJournal-32931:JournalChannel@157] - Opening journal /tmp/bookie4871124831893115628test/current/173da53eb86.txn
2020-08-10 23:43:19,687 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:19,694 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:19,694 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:19,694 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:19,696 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:19,943 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:32931' has been created.
2020-08-10 23:43:19,947 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,956 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,959 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:19,959 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:19,960 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:19,960 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:19,963 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:19,964 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:19,964 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:19,964 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:19,983 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:19,984 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie1429392457984956895test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1429392457984956895test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:19,989 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:19,994 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:19,999 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:20,007 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1429392457984956895test/current] [/tmp/bookie1429392457984956895test/current]
2020-08-10 23:43:20,017 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:20,019 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1429392457984956895test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:20,019 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:20,020 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:20,021 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:20,023 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:20,023 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:20,023 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:20,040 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:35775 to become writable
2020-08-10 23:43:20,041 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:20,043 - INFO  - [SyncThread-86-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:20,048 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:20,052 - INFO  - [BookieJournal-35775:Journal@909] - Starting journal on /tmp/bookie1429392457984956895test/current
2020-08-10 23:43:20,054 - INFO  - [BookieJournal-35775:JournalChannel@157] - Opening journal /tmp/bookie1429392457984956895test/current/173da53ecf6.txn
2020-08-10 23:43:20,054 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:20,068 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,069 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,068 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,070 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,071 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,332 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:35775' has been created.
2020-08-10 23:43:20,338 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:20,344 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:20,348 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:20,348 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:20,348 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:20,349 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:20,351 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:20,351 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:20,351 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:20,351 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,351 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:20,367 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:20,367 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie9646876573156829000test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie9646876573156829000test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:20,397 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:20,404 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:20,409 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:20,419 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9646876573156829000test/current] [/tmp/bookie9646876573156829000test/current]
2020-08-10 23:43:20,429 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:20,431 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9646876573156829000test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:20,431 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:20,431 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:20,432 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:20,434 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:20,435 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:20,435 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:20,451 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:43135 to become writable
2020-08-10 23:43:20,453 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:20,455 - INFO  - [SyncThread-102-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:20,459 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:20,462 - INFO  - [BookieJournal-43135:Journal@909] - Starting journal on /tmp/bookie9646876573156829000test/current
2020-08-10 23:43:20,462 - INFO  - [BookieJournal-43135:JournalChannel@157] - Opening journal /tmp/bookie9646876573156829000test/current/173da53ee8f.txn
2020-08-10 23:43:20,464 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:20,473 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,474 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,473 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,473 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,474 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,474 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,723 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:43135' has been created.
2020-08-10 23:43:20,727 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:20,732 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:20,737 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:20,737 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:20,737 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:20,737 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:20,740 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:20,741 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:20,741 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:20,741 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,741 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,741 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:20,758 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testDecommissionForLedgersWithMultipleSegmentsAndNotWriteClosed @ metadata service zk://localhost:35965/ledgers in 3973 ms.
2020-08-10 23:43:20,769 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk+null://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:20,777 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:20,780 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:20,780 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:20,781 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:20,781 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:20,785 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:20,785 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:20,785 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:20,785 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:20,786 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:20,786 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:20,798 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:43135, 127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:37481, 127.0.0.1:45813] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:43:20,857 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:43135, 127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:37481, 127.0.0.1:45813] for ledger: 1
2020-08-10 23:43:20,858 - INFO  - [Time-limited test:BookKeeper@1077] - Ensemble: [127.0.0.1:43135, 127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:37481, 127.0.0.1:45813] for ledger: 1
2020-08-10 23:43:20,858 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:32931, 127.0.0.1:43135, 127.0.0.1:45813, 127.0.0.1:33689, 127.0.0.1:35775, 127.0.0.1:37481] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:43:20,862 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:32931, 127.0.0.1:43135, 127.0.0.1:45813, 127.0.0.1:33689, 127.0.0.1:35775, 127.0.0.1:37481] for ledger: 2
2020-08-10 23:43:20,863 - INFO  - [Time-limited test:BookKeeper@1077] - Ensemble: [127.0.0.1:32931, 127.0.0.1:43135, 127.0.0.1:45813, 127.0.0.1:33689, 127.0.0.1:35775, 127.0.0.1:37481] for ledger: 2
2020-08-10 23:43:20,863 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:33689, 127.0.0.1:45813, 127.0.0.1:35775, 127.0.0.1:37481, 127.0.0.1:43135, 127.0.0.1:32931] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:43:20,868 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33689, 127.0.0.1:45813, 127.0.0.1:35775, 127.0.0.1:37481, 127.0.0.1:43135, 127.0.0.1:32931] for ledger: 3
2020-08-10 23:43:20,868 - INFO  - [Time-limited test:BookKeeper@1077] - Ensemble: [127.0.0.1:33689, 127.0.0.1:45813, 127.0.0.1:35775, 127.0.0.1:37481, 127.0.0.1:43135, 127.0.0.1:32931] for ledger: 3
2020-08-10 23:43:20,868 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:43135, 127.0.0.1:37481, 127.0.0.1:45813] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:43:20,872 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:43135, 127.0.0.1:37481, 127.0.0.1:45813] for ledger: 4
2020-08-10 23:43:20,872 - INFO  - [Time-limited test:BookKeeper@1077] - Ensemble: [127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:43135, 127.0.0.1:37481, 127.0.0.1:45813] for ledger: 4
2020-08-10 23:43:20,962 - INFO  - [bookie-io-65-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:20,963 - INFO  - [bookie-io-81-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:20,963 - INFO  - [bookie-io-97-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:20,974 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xd752043c, L:/127.0.0.1:40942 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:20,975 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:20,974 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5d8e65ff, L:/127.0.0.1:47186 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:20,974 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xfd40c35a, L:/127.0.0.1:36228 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:20,975 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:20,974 - INFO  - [bookie-io-81-2:BookieRequestHandler@50] - Channel connected  [id: 0x233f6abf, L:/127.0.0.1:35775 - R:/127.0.0.1:40942]
2020-08-10 23:43:20,975 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:20,974 - INFO  - [bookie-io-97-2:BookieRequestHandler@50] - Channel connected  [id: 0x981d9c53, L:/127.0.0.1:43135 - R:/127.0.0.1:47186]
2020-08-10 23:43:20,975 - INFO  - [bookie-io-65-2:BookieRequestHandler@50] - Channel connected  [id: 0xda4bc08d, L:/127.0.0.1:32931 - R:/127.0.0.1:36228]
2020-08-10 23:43:21,008 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$1@471] - connection [id: 0xfd40c35a, L:/127.0.0.1:36228 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,008 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$1@471] - connection [id: 0xd752043c, L:/127.0.0.1:40942 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,008 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$1@471] - connection [id: 0x5d8e65ff, L:/127.0.0.1:47186 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,088 - INFO  - [bookkeeper-io-3-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x98c70455, L:/127.0.0.1:57604 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:21,089 - INFO  - [bookkeeper-io-3-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:21,089 - INFO  - [bookkeeper-io-3-4:PerChannelBookieClient$1@471] - connection [id: 0x98c70455, L:/127.0.0.1:57604 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,093 - INFO  - [bookie-io-24-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:21,093 - INFO  - [bookie-io-24-2:BookieRequestHandler@50] - Channel connected  [id: 0x23b01400, L:/127.0.0.1:45813 - R:/127.0.0.1:57604]
2020-08-10 23:43:21,113 - INFO  - [bookkeeper-io-3-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x846e5224, L:/127.0.0.1:35262 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:21,118 - INFO  - [bookkeeper-io-3-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:21,119 - INFO  - [bookkeeper-io-3-5:PerChannelBookieClient$1@471] - connection [id: 0x846e5224, L:/127.0.0.1:35262 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,125 - INFO  - [bookie-io-49-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:21,125 - INFO  - [bookie-io-49-2:BookieRequestHandler@50] - Channel connected  [id: 0xdfe1e488, L:/127.0.0.1:33689 - R:/127.0.0.1:35262]
2020-08-10 23:43:21,177 - INFO  - [bookkeeper-io-3-6:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5c29f065, L:/127.0.0.1:37796 - R:127.0.0.1/127.0.0.1:37481]
2020-08-10 23:43:21,177 - INFO  - [bookkeeper-io-3-6:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37481
2020-08-10 23:43:21,178 - INFO  - [bookkeeper-io-3-6:PerChannelBookieClient$1@471] - connection [id: 0x5c29f065, L:/127.0.0.1:37796 - R:127.0.0.1/127.0.0.1:37481] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:21,180 - INFO  - [bookie-io-8-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:21,181 - INFO  - [bookie-io-8-2:BookieRequestHandler@50] - Channel connected  [id: 0x7695d01c, L:/127.0.0.1:37481 - R:/127.0.0.1:37796]
2020-08-10 23:43:21,958 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:43:21,959 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "30000",
  "ledgerDirectories" : "/tmp/bookie6773060511631047113test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:35965/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie6773060511631047113test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:43:21,963 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:21,969 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:21,973 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:43:21,982 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie6773060511631047113test/current] [/tmp/bookie6773060511631047113test/current]
2020-08-10 23:43:21,992 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:43:21,994 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie6773060511631047113test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:43:21,995 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:43:21,995 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:43:21,996 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:43:21,998 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:43:21,998 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:43:21,999 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:43:22,016 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:43253 to become writable
2020-08-10 23:43:22,017 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:43:22,019 - INFO  - [SyncThread-124-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:43:22,023 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:43:22,025 - INFO  - [BookieJournal-43253:Journal@909] - Starting journal on /tmp/bookie6773060511631047113test/current
2020-08-10 23:43:22,026 - INFO  - [BookieJournal-43253:JournalChannel@157] - Opening journal /tmp/bookie6773060511631047113test/current/173da53f4ab.txn
2020-08-10 23:43:22,026 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:43:22,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,038 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,039 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,039 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,287 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:43253' has been created.
2020-08-10 23:43:22,730 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35965/ledgers : zkServers = localhost:35965, ledgersRootPath = /ledgers.
2020-08-10 23:43:22,749 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:43:22,753 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:43:22,754 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:43:22,754 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:43:22,754 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:43:22,763 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43253
2020-08-10 23:43:22,763 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:22,764 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:22,764 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,764 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:22,764 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:22,764 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:22,785 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:22,785 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:22,787 - WARN  - [bookkeeper-io-3-6:PerChannelBookieClient@1270] - Exception caught on:[id: 0x5c29f065, L:/127.0.0.1:37796 - R:127.0.0.1/127.0.0.1:37481] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:22,787 - INFO  - [bookie-io-8-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x7695d01c, L:/127.0.0.1:37481 ! R:/127.0.0.1:37796]
2020-08-10 23:43:22,788 - INFO  - [bookkeeper-io-3-6:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5c29f065, L:/127.0.0.1:37796 ! R:127.0.0.1/127.0.0.1:37481]
2020-08-10 23:43:22,811 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37481 with exitCode 0
2020-08-10 23:43:22,811 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:22,811 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:22,813 - INFO  - [SyncThread-13-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:22,816 - INFO  - [SyncThread-13-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1373690227549947568test/current/0.log for logId 0.
2020-08-10 23:43:22,818 - INFO  - [pool-9-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1373690227549947568test/current/1.log for logId 1.
2020-08-10 23:43:22,843 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095798303 , logFileOffset - 12800]}.
2020-08-10 23:43:22,847 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:22,848 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:22,848 - INFO  - [BookieJournal-37481:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:22,848 - INFO  - [BookieJournal-37481:Journal@1144] - Journal exited loop!
2020-08-10 23:43:22,850 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:22,850 - INFO  - [Bookie-37481:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:22,851 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:22,851 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:22,851 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:22,851 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:22,852 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:22,856 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:22,879 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:22,880 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:22,888 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,890 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,890 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,890 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,891 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,890 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,892 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,891 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,892 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37481
2020-08-10 23:43:22,992 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:22,995 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:22,995 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:22,995 - INFO  - [AuditorElector-127.0.0.1:37481:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:23,009 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:23,017 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:23,027 - INFO  - [AuditorElector-127.0.0.1:45813:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:23,029 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:23,030 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45813
2020-08-10 23:43:23,036 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:23,036 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:23,038 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:23,038 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1114] - Following are the failed bookies: [127.0.0.1:37481], and searching its ledgers for re-replication
2020-08-10 23:43:23,041 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:37481] are identified as underreplicated
2020-08-10 23:43:23,044 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 4 initialDelay: 604796 interval: 604800
2020-08-10 23:43:23,044 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:23,044 - INFO  - [AuditorElector-127.0.0.1:45813:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:23,078 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1114] - Following are the failed bookies: [127.0.0.1:37481], and searching its ledgers for re-replication
2020-08-10 23:43:23,079 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:37481] are identified as underreplicated
2020-08-10 23:43:23,143 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x046b5427, L:/127.0.0.1:47202 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:23,146 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:23,144 - INFO  - [bookie-io-97-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,147 - INFO  - [bookie-io-97-3:BookieRequestHandler@50] - Channel connected  [id: 0xaccefde4, L:/127.0.0.1:43135 - R:/127.0.0.1:47202]
2020-08-10 23:43:23,159 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$1@471] - connection [id: 0x046b5427, L:/127.0.0.1:47202 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,168 - INFO  - [bookkeeper-io-93-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x6b63aa27, L:/127.0.0.1:36242 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:23,168 - INFO  - [bookkeeper-io-93-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:23,173 - INFO  - [bookkeeper-io-93-3:PerChannelBookieClient$1@471] - connection [id: 0x6b63aa27, L:/127.0.0.1:36242 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,174 - INFO  - [bookie-io-81-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,178 - INFO  - [bookie-io-81-3:BookieRequestHandler@50] - Channel connected  [id: 0x2a5e758f, L:/127.0.0.1:35775 - R:/127.0.0.1:40960]
2020-08-10 23:43:23,181 - INFO  - [bookkeeper-io-93-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf0be57af, L:/127.0.0.1:40960 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:23,182 - INFO  - [bookie-io-24-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,184 - INFO  - [bookie-io-24-3:BookieRequestHandler@50] - Channel connected  [id: 0x88dd93c6, L:/127.0.0.1:45813 - R:/127.0.0.1:57622]
2020-08-10 23:43:23,182 - INFO  - [bookkeeper-io-93-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x41fef26f, L:/127.0.0.1:35280 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:23,186 - INFO  - [bookkeeper-io-93-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:23,186 - INFO  - [bookkeeper-io-93-4:PerChannelBookieClient$1@471] - connection [id: 0x41fef26f, L:/127.0.0.1:35280 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,182 - INFO  - [bookkeeper-io-93-6:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7a9abfd4, L:/127.0.0.1:57622 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:23,188 - INFO  - [bookkeeper-io-93-6:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:23,188 - INFO  - [bookkeeper-io-93-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:23,188 - INFO  - [bookkeeper-io-93-6:PerChannelBookieClient$1@471] - connection [id: 0x7a9abfd4, L:/127.0.0.1:57622 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,182 - INFO  - [bookie-io-49-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,197 - INFO  - [bookie-io-49-3:BookieRequestHandler@50] - Channel connected  [id: 0x2be37eca, L:/127.0.0.1:33689 - R:/127.0.0.1:35280]
2020-08-10 23:43:23,199 - ERROR - [bookkeeper-io-93-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5b3ddb30, L:/127.0.0.1:37808]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,182 - INFO  - [bookie-io-65-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,213 - INFO  - [bookie-io-65-3:BookieRequestHandler@50] - Channel connected  [id: 0x1f7f2945, L:/127.0.0.1:32931 - R:/127.0.0.1:36242]
2020-08-10 23:43:23,207 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:23,196 - INFO  - [AuditorBookie-127.0.0.1:37481:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:23,188 - INFO  - [bookkeeper-io-93-2:PerChannelBookieClient$1@471] - connection [id: 0xf0be57af, L:/127.0.0.1:40960 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,216 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:23,216 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:23,221 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2016)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:519)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:602)
	... 4 more
2020-08-10 23:43:23,243 - INFO  - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x9c2ca6aa, L:/127.0.0.1:47216 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:23,250 - INFO  - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:23,243 - INFO  - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xea38be27, L:/127.0.0.1:57626 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:23,250 - INFO  - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:23,250 - INFO  - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x22255336, L:/127.0.0.1:40978 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:23,250 - INFO  - [bookkeeper-io-131-3:PerChannelBookieClient$1@471] - connection [id: 0xea38be27, L:/127.0.0.1:57626 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,251 - INFO  - [bookkeeper-io-131-2:PerChannelBookieClient$1@471] - connection [id: 0x9c2ca6aa, L:/127.0.0.1:47216 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,252 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x95cceda5, L:/127.0.0.1:37826]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,242 - INFO  - [bookie-io-65-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,253 - INFO  - [bookie-io-65-4:BookieRequestHandler@50] - Channel connected  [id: 0xcc5946fe, L:/127.0.0.1:32931 - R:/127.0.0.1:36256]
2020-08-10 23:43:23,241 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1579c71a, L:/127.0.0.1:36256 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:23,254 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:23,241 - INFO  - [bookie-io-97-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,254 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$1@471] - connection [id: 0x1579c71a, L:/127.0.0.1:36256 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,231 - ERROR - [bookkeeper-io-93-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6f0d328e, L:/127.0.0.1:37820]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,254 - INFO  - [bookie-io-97-4:BookieRequestHandler@50] - Channel connected  [id: 0xd4ad2b7c, L:/127.0.0.1:43135 - R:/127.0.0.1:47216]
2020-08-10 23:43:23,252 - INFO  - [bookie-io-24-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,252 - INFO  - [bookie-io-81-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,250 - INFO  - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:23,250 - INFO  - [bookie-io-49-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,249 - INFO  - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x6ae917ba, L:/127.0.0.1:35290 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:23,264 - INFO  - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:23,244 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:23,264 - INFO  - [bookkeeper-io-131-4:PerChannelBookieClient$1@471] - connection [id: 0x6ae917ba, L:/127.0.0.1:35290 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,264 - INFO  - [bookkeeper-io-131-5:PerChannelBookieClient$1@471] - connection [id: 0x22255336, L:/127.0.0.1:40978 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,263 - INFO  - [bookie-io-81-4:BookieRequestHandler@50] - Channel connected  [id: 0x4b8334cd, L:/127.0.0.1:35775 - R:/127.0.0.1:40978]
2020-08-10 23:43:23,263 - INFO  - [bookie-io-24-4:BookieRequestHandler@50] - Channel connected  [id: 0x918ac288, L:/127.0.0.1:45813 - R:/127.0.0.1:57626]
2020-08-10 23:43:23,265 - INFO  - [bookie-io-49-4:BookieRequestHandler@50] - Channel connected  [id: 0x3b6933a6, L:/127.0.0.1:33689 - R:/127.0.0.1:35290]
2020-08-10 23:43:23,274 - INFO  - [bookie-io-24-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,275 - INFO  - [bookie-io-24-5:BookieRequestHandler@50] - Channel connected  [id: 0xb6ca8402, L:/127.0.0.1:45813 - R:/127.0.0.1:57640]
2020-08-10 23:43:23,277 - INFO  - [bookie-io-81-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,278 - INFO  - [bookie-io-49-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,278 - INFO  - [bookie-io-49-5:BookieRequestHandler@50] - Channel connected  [id: 0xeddf622b, L:/127.0.0.1:33689 - R:/127.0.0.1:35300]
2020-08-10 23:43:23,289 - INFO  - [bookkeeper-io-77-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc53442a5, L:/127.0.0.1:35300 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:23,290 - INFO  - [bookkeeper-io-77-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:23,289 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf5baacd4, L:/127.0.0.1:40984 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:23,290 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:23,290 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$1@471] - connection [id: 0xf5baacd4, L:/127.0.0.1:40984 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,289 - INFO  - [bookkeeper-io-77-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x3d95bbb2, L:/127.0.0.1:57640 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:23,292 - INFO  - [bookkeeper-io-77-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:23,292 - INFO  - [bookkeeper-io-77-2:PerChannelBookieClient$1@471] - connection [id: 0x3d95bbb2, L:/127.0.0.1:57640 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,278 - INFO  - [bookie-io-81-5:BookieRequestHandler@50] - Channel connected  [id: 0xb1163d96, L:/127.0.0.1:35775 - R:/127.0.0.1:40984]
2020-08-10 23:43:23,290 - INFO  - [bookkeeper-io-77-1:PerChannelBookieClient$1@471] - connection [id: 0xc53442a5, L:/127.0.0.1:35300 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,297 - ERROR - [bookkeeper-io-77-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xdab651cb, L:/127.0.0.1:37834]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,308 - INFO  - [bookkeeper-io-61-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x4a4464c1, L:/127.0.0.1:36274 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:23,315 - INFO  - [bookkeeper-io-61-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:23,315 - INFO  - [bookkeeper-io-61-2:PerChannelBookieClient$1@471] - connection [id: 0x4a4464c1, L:/127.0.0.1:36274 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,309 - INFO  - [bookie-io-65-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,319 - INFO  - [bookie-io-65-5:BookieRequestHandler@50] - Channel connected  [id: 0x80584972, L:/127.0.0.1:32931 - R:/127.0.0.1:36274]
2020-08-10 23:43:23,321 - INFO  - [bookie-io-97-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,321 - INFO  - [bookie-io-97-5:BookieRequestHandler@50] - Channel connected  [id: 0x21a902ab, L:/127.0.0.1:43135 - R:/127.0.0.1:47240]
2020-08-10 23:43:23,311 - INFO  - [bookie-io-81-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,325 - INFO  - [bookie-io-81-6:BookieRequestHandler@50] - Channel connected  [id: 0xc534e983, L:/127.0.0.1:35775 - R:/127.0.0.1:40992]
2020-08-10 23:43:23,311 - INFO  - [bookie-io-65-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,310 - INFO  - [bookie-io-49-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,326 - INFO  - [bookie-io-65-6:BookieRequestHandler@50] - Channel connected  [id: 0x922ec521, L:/127.0.0.1:32931 - R:/127.0.0.1:36280]
2020-08-10 23:43:23,315 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x374d830d, L:/127.0.0.1:40992 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:23,326 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:23,326 - INFO  - [bookie-io-24-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,326 - INFO  - [bookie-io-49-6:BookieRequestHandler@50] - Channel connected  [id: 0xabd6d2ed, L:/127.0.0.1:33689 - R:/127.0.0.1:35312]
2020-08-10 23:43:23,327 - INFO  - [bookie-io-24-6:BookieRequestHandler@50] - Channel connected  [id: 0xd076dbae, L:/127.0.0.1:45813 - R:/127.0.0.1:57662]
2020-08-10 23:43:23,327 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$1@471] - connection [id: 0x374d830d, L:/127.0.0.1:40992 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,327 - INFO  - [bookie-io-97-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,328 - INFO  - [bookie-io-97-6:BookieRequestHandler@50] - Channel connected  [id: 0x1354e0ec, L:/127.0.0.1:43135 - R:/127.0.0.1:47246]
2020-08-10 23:43:23,332 - INFO  - [bookkeeper-io-77-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf69f16d2, L:/127.0.0.1:47240 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:23,332 - INFO  - [bookkeeper-io-77-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:23,332 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1713a498, L:/127.0.0.1:37852]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,332 - INFO  - [bookkeeper-io-77-5:PerChannelBookieClient$1@471] - connection [id: 0xf69f16d2, L:/127.0.0.1:47240 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,333 - INFO  - [bookkeeper-io-77-6:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x25a628d0, L:/127.0.0.1:36280 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:23,335 - INFO  - [bookkeeper-io-77-6:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:23,335 - INFO  - [bookkeeper-io-77-6:PerChannelBookieClient$1@471] - connection [id: 0x25a628d0, L:/127.0.0.1:36280 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x47d9b3d0, L:/127.0.0.1:35312 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xfc37f365, L:/127.0.0.1:47246 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-6:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x4a6e7549, L:/127.0.0.1:57662 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$1@471] - connection [id: 0x47d9b3d0, L:/127.0.0.1:35312 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,337 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:23,338 - INFO  - [bookkeeper-io-61-6:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:23,338 - INFO  - [bookkeeper-io-61-6:PerChannelBookieClient$1@471] - connection [id: 0x4a6e7549, L:/127.0.0.1:57662 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,338 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$1@471] - connection [id: 0xfc37f365, L:/127.0.0.1:47246 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,348 - ERROR - [bookkeeper-io-61-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xec0eebed, L:/127.0.0.1:37848]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,358 - INFO  - [BookieDeathWatcher-37481:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:43:23,364 - ERROR - [bookkeeper-io-61-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x7aa57cf8, L:/127.0.0.1:37854]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,365 - INFO  - [BookieDeathWatcher-37481:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37481
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:43:23,366 - INFO  - [BookieDeathWatcher-37481:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:23,366 - INFO  - [BookieDeathWatcher-37481:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:23,383 - ERROR - [bookkeeper-io-77-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x8acf1d37, L:/127.0.0.1:37856]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,473 - ERROR - [bookkeeper-io-3-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xa00bf99c, L:/127.0.0.1:37858]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,475 - WARN  - [BookKeeperClientWorker-OrderedExecutor-1-0:PendingAddOp@376] - Failed to write entry (1, 14): Bookie handle is not available
2020-08-10 23:43:23,487 - WARN  - [BookKeeperClientWorker-OrderedExecutor-1-0:BookieWatcherImpl@298] - replaceBookie for bookie: 127.0.0.1:37481 in ensemble: [127.0.0.1:43135, 127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:37481, 127.0.0.1:45813] is not adhering to placement policy and chose 127.0.0.1:43253. excludedBookies [127.0.0.1:37481] and quarantinedBookies []
2020-08-10 23:43:23,494 - INFO  - [BookKeeperClientWorker-OrderedExecutor-1-0:LedgerHandle@1978] - New Ensemble: [127.0.0.1:43135, 127.0.0.1:35775, 127.0.0.1:32931, 127.0.0.1:33689, 127.0.0.1:43253, 127.0.0.1:45813] for ledger: 1
2020-08-10 23:43:23,500 - INFO  - [bookkeeper-io-3-8:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x3f4d4a67, L:/127.0.0.1:44316 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:23,500 - INFO  - [bookkeeper-io-3-8:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:23,500 - INFO  - [bookie-io-119-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:23,501 - INFO  - [bookie-io-119-2:BookieRequestHandler@50] - Channel connected  [id: 0xab19c141, L:/127.0.0.1:43253 - R:/127.0.0.1:44316]
2020-08-10 23:43:23,501 - INFO  - [bookkeeper-io-3-8:PerChannelBookieClient$1@471] - connection [id: 0x3f4d4a67, L:/127.0.0.1:44316 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:23,532 - ERROR - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xd4b7337e, L:/127.0.0.1:37862]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:23,534 - WARN  - [BookKeeperClientWorker-OrderedExecutor-2-0:PendingAddOp@376] - Failed to write entry (2, 15): Bookie handle is not available
2020-08-10 23:43:23,537 - WARN  - [BookKeeperClientWorker-OrderedExecutor-2-0:BookieWatcherImpl@298] - replaceBookie for bookie: 127.0.0.1:37481 in ensemble: [127.0.0.1:32931, 127.0.0.1:43135, 127.0.0.1:45813, 127.0.0.1:33689, 127.0.0.1:35775, 127.0.0.1:37481] is not adhering to placement policy and chose 127.0.0.1:43253. excludedBookies [127.0.0.1:37481] and quarantinedBookies []
2020-08-10 23:43:23,545 - INFO  - [BookKeeperClientWorker-OrderedExecutor-2-0:LedgerHandle@1978] - New Ensemble: [127.0.0.1:32931, 127.0.0.1:43135, 127.0.0.1:45813, 127.0.0.1:33689, 127.0.0.1:35775, 127.0.0.1:43253] for ledger: 2
2020-08-10 23:43:23,687 - INFO  - [Time-limited test:BookKeeperAdmin@1468] - Resetting LostBookieRecoveryDelay value: 0, to kickstart audit task
2020-08-10 23:43:23,701 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor$10@624] - lostBookieRecoveryDelay has been set to 0 or reset to its previous value, so starting AuditTask. Current lostBookieRecoveryDelay: 0, previous lostBookieRecoveryDelay: 0
2020-08-10 23:43:23,702 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:23,707 - INFO  - [AutoRecoveryDeathWatcher-37481:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:23,707 - INFO  - [AutoRecoveryDeathWatcher-37481:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-37481
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:23,707 - INFO  - [AutoRecoveryDeathWatcher-37481:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:23,716 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1114] - Following are the failed bookies: [127.0.0.1:37481], and searching its ledgers for re-replication
2020-08-10 23:43:23,717 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:37481] are identified as underreplicated
2020-08-10 23:43:23,735 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:53,274 - ERROR - [bookkeeper-io-93-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x71e66196, L:/127.0.0.1:37868]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,280 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xda6205ff, L:/127.0.0.1:44326 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:53,282 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:53,281 - INFO  - [bookie-io-119-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,282 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient$1@471] - connection [id: 0xda6205ff, L:/127.0.0.1:44326 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,282 - INFO  - [bookie-io-119-3:BookieRequestHandler@50] - Channel connected  [id: 0x98a59aab, L:/127.0.0.1:43253 - R:/127.0.0.1:44326]
2020-08-10 23:43:53,317 - INFO  - [bookkeeper-io-45-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe411692e, L:/127.0.0.1:47272 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:53,318 - INFO  - [bookkeeper-io-45-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:53,317 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x683c97a3, L:/127.0.0.1:41028 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:53,318 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:53,318 - INFO  - [bookkeeper-io-45-1:PerChannelBookieClient$1@471] - connection [id: 0xe411692e, L:/127.0.0.1:47272 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,319 - INFO  - [bookie-io-97-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,320 - INFO  - [bookie-io-97-7:BookieRequestHandler@50] - Channel connected  [id: 0x971c35c2, L:/127.0.0.1:43135 - R:/127.0.0.1:47272]
2020-08-10 23:43:53,320 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$1@471] - connection [id: 0x683c97a3, L:/127.0.0.1:41028 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,329 - INFO  - [bookkeeper-io-45-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x543f69a3, L:/127.0.0.1:35344 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:53,330 - INFO  - [bookkeeper-io-45-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:53,330 - INFO  - [bookkeeper-io-45-4:PerChannelBookieClient$1@471] - connection [id: 0x543f69a3, L:/127.0.0.1:35344 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,331 - INFO  - [bookie-io-49-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,330 - INFO  - [bookie-io-81-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,331 - INFO  - [bookie-io-81-7:BookieRequestHandler@50] - Channel connected  [id: 0xa2641591, L:/127.0.0.1:35775 - R:/127.0.0.1:41028]
2020-08-10 23:43:53,331 - INFO  - [bookie-io-49-7:BookieRequestHandler@50] - Channel connected  [id: 0xb9b7eb4c, L:/127.0.0.1:33689 - R:/127.0.0.1:35344]
2020-08-10 23:43:53,329 - INFO  - [bookkeeper-io-45-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x474a7792, L:/127.0.0.1:44336 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:53,331 - INFO  - [bookkeeper-io-45-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:53,332 - INFO  - [bookkeeper-io-45-5:PerChannelBookieClient$1@471] - connection [id: 0x474a7792, L:/127.0.0.1:44336 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,329 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x3a104fec, L:/127.0.0.1:36316 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:53,340 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:53,341 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$1@471] - connection [id: 0x3a104fec, L:/127.0.0.1:36316 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,336 - INFO  - [bookie-io-65-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,341 - INFO  - [bookie-io-65-7:BookieRequestHandler@50] - Channel connected  [id: 0x22331cc7, L:/127.0.0.1:32931 - R:/127.0.0.1:36316]
2020-08-10 23:43:53,344 - INFO  - [bookie-io-24-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,345 - INFO  - [bookie-io-24-7:BookieRequestHandler@50] - Channel connected  [id: 0x950e1e47, L:/127.0.0.1:45813 - R:/127.0.0.1:57694]
2020-08-10 23:43:53,336 - INFO  - [bookkeeper-io-45-6:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x71af8250, L:/127.0.0.1:57694 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:53,346 - INFO  - [bookkeeper-io-45-6:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:53,330 - INFO  - [bookie-io-119-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,349 - INFO  - [bookie-io-119-4:BookieRequestHandler@50] - Channel connected  [id: 0x5ce521ef, L:/127.0.0.1:43253 - R:/127.0.0.1:44336]
2020-08-10 23:43:53,350 - INFO  - [bookkeeper-io-45-6:PerChannelBookieClient$1@471] - connection [id: 0x71af8250, L:/127.0.0.1:57694 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,352 - ERROR - [bookkeeper-io-45-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb1068ba3, L:/127.0.0.1:37884]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,361 - INFO  - [bookie-io-119-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,360 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xd8e0f581, L:/127.0.0.1:37888]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,355 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xb1255f6d, L:/127.0.0.1:44342 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:53,362 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:53,362 - INFO  - [bookie-io-119-5:BookieRequestHandler@50] - Channel connected  [id: 0x94256b6a, L:/127.0.0.1:43253 - R:/127.0.0.1:44342]
2020-08-10 23:43:53,362 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient$1@471] - connection [id: 0xb1255f6d, L:/127.0.0.1:44342 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,366 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 1, FirstEntryID: 0[2], LastKnownEntryID: 13[10], Host: [127.0.0.1:37481], Closed: true) in 1 sub fragments.
2020-08-10 23:43:53,378 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger4 for Recovery.
2020-08-10 23:43:53,380 - ERROR - [bookkeeper-io-61-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x24dfbae3, L:/127.0.0.1:37892]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,403 - ERROR - [bookkeeper-io-45-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2da76592, L:/127.0.0.1:37890]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,408 - ERROR - [bookkeeper-io-77-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6d341ab9, L:/127.0.0.1:37894]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,413 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger3 for Recovery.
2020-08-10 23:43:53,419 - INFO  - [BookieHighPriorityThread-35775-OrderedExecutor-4-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 4 from address: /127.0.0.1:40992
2020-08-10 23:43:53,422 - ERROR - [bookkeeper-io-61-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x693f4ee8, L:/127.0.0.1:37896]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,420 - INFO  - [BookieHighPriorityThread-33689-OrderedExecutor-4-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 4 from address: /127.0.0.1:35312
2020-08-10 23:43:53,420 - INFO  - [BookieHighPriorityThread-32931-OrderedExecutor-4-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 4 from address: /127.0.0.1:36274
2020-08-10 23:43:53,420 - INFO  - [BookieHighPriorityThread-43135-OrderedExecutor-4-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 4 from address: /127.0.0.1:47246
2020-08-10 23:43:53,420 - INFO  - [BookieHighPriorityThread-45813-OrderedExecutor-4-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 4 from address: /127.0.0.1:57662
2020-08-10 23:43:53,437 - INFO  - [bookie-io-97-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,441 - INFO  - [bookie-io-97-8:BookieRequestHandler@50] - Channel connected  [id: 0x1de4a463, L:/127.0.0.1:43135 - R:/127.0.0.1:47298]
2020-08-10 23:43:53,442 - INFO  - [bookie-io-24-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,442 - INFO  - [bookie-io-24-8:BookieRequestHandler@50] - Channel connected  [id: 0x2a465811, L:/127.0.0.1:45813 - R:/127.0.0.1:57714]
2020-08-10 23:43:53,447 - ERROR - [bookkeeper-io-77-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbd098aa7, L:/127.0.0.1:37906]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,447 - INFO  - [BookieHighPriorityThread-33689-OrderedExecutor-3-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 3 from address: /127.0.0.1:35300
2020-08-10 23:43:53,448 - INFO  - [BookieHighPriorityThread-45813-OrderedExecutor-3-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 3 from address: /127.0.0.1:57640
2020-08-10 23:43:53,448 - INFO  - [BookieHighPriorityThread-32931-OrderedExecutor-3-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 3 from address: /127.0.0.1:36280
2020-08-10 23:43:53,448 - INFO  - [BookieHighPriorityThread-35775-OrderedExecutor-3-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 3 from address: /127.0.0.1:40984
2020-08-10 23:43:53,448 - INFO  - [BookieHighPriorityThread-43135-OrderedExecutor-3-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 3 from address: /127.0.0.1:47240
2020-08-10 23:43:53,449 - INFO  - [bookie-io-49-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,449 - INFO  - [bookie-io-49-8:BookieRequestHandler@50] - Channel connected  [id: 0xcc0a6fca, L:/127.0.0.1:33689 - R:/127.0.0.1:35372]
2020-08-10 23:43:53,456 - INFO  - [bookie-io-65-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,457 - INFO  - [bookie-io-65-8:BookieRequestHandler@50] - Channel connected  [id: 0x3652d64b, L:/127.0.0.1:32931 - R:/127.0.0.1:36338]
2020-08-10 23:43:53,457 - INFO  - [bookie-io-81-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,458 - INFO  - [bookie-io-81-8:BookieRequestHandler@50] - Channel connected  [id: 0xda55762a, L:/127.0.0.1:35775 - R:/127.0.0.1:41062]
2020-08-10 23:43:53,460 - INFO  - [bookkeeper-io-109-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x53a2783f, L:/127.0.0.1:35372 - R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:53,461 - INFO  - [bookkeeper-io-109-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33689
2020-08-10 23:43:53,461 - INFO  - [bookkeeper-io-109-4:PerChannelBookieClient$1@471] - connection [id: 0x53a2783f, L:/127.0.0.1:35372 - R:127.0.0.1/127.0.0.1:33689] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,462 - INFO  - [bookkeeper-io-109-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x40f27fa9, L:/127.0.0.1:57714 - R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:53,462 - INFO  - [bookkeeper-io-109-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45813
2020-08-10 23:43:53,462 - INFO  - [bookkeeper-io-109-3:PerChannelBookieClient$1@471] - connection [id: 0x40f27fa9, L:/127.0.0.1:57714 - R:127.0.0.1/127.0.0.1:45813] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,463 - INFO  - [bookkeeper-io-109-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x433fce6e, L:/127.0.0.1:47298 - R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:53,463 - INFO  - [bookkeeper-io-109-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43135
2020-08-10 23:43:53,463 - INFO  - [bookkeeper-io-109-2:PerChannelBookieClient$1@471] - connection [id: 0x433fce6e, L:/127.0.0.1:47298 - R:127.0.0.1/127.0.0.1:43135] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,462 - INFO  - [bookkeeper-io-109-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xbd0a5b3f, L:/127.0.0.1:36338 - R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:53,464 - INFO  - [bookkeeper-io-109-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:32931
2020-08-10 23:43:53,465 - INFO  - [bookkeeper-io-109-1:PerChannelBookieClient$1@471] - connection [id: 0xbd0a5b3f, L:/127.0.0.1:36338 - R:127.0.0.1/127.0.0.1:32931] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,467 - INFO  - [bookkeeper-io-109-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xb173e055, L:/127.0.0.1:41062 - R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:53,467 - INFO  - [bookkeeper-io-109-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35775
2020-08-10 23:43:53,469 - INFO  - [bookkeeper-io-109-5:PerChannelBookieClient$1@471] - connection [id: 0xb173e055, L:/127.0.0.1:41062 - R:127.0.0.1/127.0.0.1:35775] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,470 - INFO  - [bookie-io-119-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,472 - INFO  - [bookie-io-119-6:BookieRequestHandler@50] - Channel connected  [id: 0x60ff24aa, L:/127.0.0.1:43253 - R:/127.0.0.1:44368]
2020-08-10 23:43:53,473 - ERROR - [bookkeeper-io-109-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x89a1283c, L:/127.0.0.1:37910]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,473 - INFO  - [BookKeeperClientWorker-OrderedExecutor-1-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L1 E4 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,473 - INFO  - [bookkeeper-io-109-7:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa1052a69, L:/127.0.0.1:44368 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:53,480 - INFO  - [bookkeeper-io-109-7:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:53,480 - INFO  - [bookkeeper-io-109-7:PerChannelBookieClient$1@471] - connection [id: 0xa1052a69, L:/127.0.0.1:44368 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,482 - INFO  - [BookKeeperClientWorker-OrderedExecutor-1-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L1 E10 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,488 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 2, FirstEntryID: 0[3], LastKnownEntryID: 14[11], Host: [127.0.0.1:37481], Closed: true) in 1 sub fragments.
2020-08-10 23:43:53,505 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 4 at entry 11
2020-08-10 23:43:53,516 - INFO  - [BookKeeperClientWorker-OrderedExecutor-3-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 3 at entry 11
2020-08-10 23:43:53,525 - ERROR - [bookkeeper-io-109-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0e0f7c92, L:/127.0.0.1:37914]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,539 - INFO  - [BookKeeperClientWorker-OrderedExecutor-2-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L2 E5 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,547 - INFO  - [BookKeeperClientWorker-OrderedExecutor-2-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L2 E11 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,552 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:37481=127.0.0.1:43253}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:43:53,564 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x41242c7e, L:/127.0.0.1:37916]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,564 - ERROR - [bookkeeper-io-61-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x56132123, L:/127.0.0.1:37918]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,573 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 1
2020-08-10 23:43:53,574 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 3, FirstEntryID: 0[1], LastKnownEntryID: 11[9], Host: [127.0.0.1:37481], Closed: true) in 1 sub fragments.
2020-08-10 23:43:53,576 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 4, FirstEntryID: 0[2], LastKnownEntryID: 11[10], Host: [127.0.0.1:37481], Closed: true) in 1 sub fragments.
2020-08-10 23:43:53,577 - ERROR - [bookkeeper-io-61-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x55909cce, L:/127.0.0.1:37920]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,578 - INFO  - [BookKeeperClientWorker-OrderedExecutor-3-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L3 E3 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,584 - INFO  - [BookKeeperClientWorker-OrderedExecutor-3-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L3 E9 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,584 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x15b2a9f3, L:/127.0.0.1:37922]/127.0.0.1:37481, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:37481
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:53,586 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L4 E4 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,586 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L4 E10 from bookie: 127.0.0.1:37481
2020-08-10 23:43:53,594 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xcee2524b, L:/127.0.0.1:44380 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:53,594 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:53,595 - INFO  - [bookie-io-119-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:53,595 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient$1@471] - connection [id: 0xcee2524b, L:/127.0.0.1:44380 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:53,595 - INFO  - [bookie-io-119-7:BookieRequestHandler@50] - Channel connected  [id: 0xae623ddf, L:/127.0.0.1:43253 - R:/127.0.0.1:44380]
2020-08-10 23:43:53,597 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:37481=127.0.0.1:43253}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:43:53,608 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 2
2020-08-10 23:43:53,616 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:37481=127.0.0.1:43253}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:43:53,618 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:37481=127.0.0.1:43253}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:43:53,631 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 3
2020-08-10 23:43:53,632 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 4
2020-08-10 23:43:53,717 - INFO  - [Time-limited test:BookKeeperAdmin@1468] - Resetting LostBookieRecoveryDelay value: 0, to kickstart audit task
2020-08-10 23:43:53,723 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor$10@624] - lostBookieRecoveryDelay has been set to 0 or reset to its previous value, so starting AuditTask. Current lostBookieRecoveryDelay: 0, previous lostBookieRecoveryDelay: 0
2020-08-10 23:43:53,723 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:53,733 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:54,341 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:43:54,341 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:54,342 - INFO  - [bookkeeper-io-3-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x98c70455, L:/127.0.0.1:57604 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,343 - INFO  - [bookie-io-24-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x23b01400, L:/127.0.0.1:45813 ! R:/127.0.0.1:57604]
2020-08-10 23:43:54,343 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:54,345 - INFO  - [bookkeeper-io-3-8:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x3f4d4a67, L:/127.0.0.1:44316 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:54,345 - INFO  - [bookie-io-119-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xab19c141, L:/127.0.0.1:43253 ! R:/127.0.0.1:44316]
2020-08-10 23:43:54,345 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:54,348 - INFO  - [bookkeeper-io-3-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x846e5224, L:/127.0.0.1:35262 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:54,348 - INFO  - [bookie-io-49-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xdfe1e488, L:/127.0.0.1:33689 ! R:/127.0.0.1:35262]
2020-08-10 23:43:54,348 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:54,349 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:54,350 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:54,350 - INFO  - [bookie-io-81-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x233f6abf, L:/127.0.0.1:35775 ! R:/127.0.0.1:40942]
2020-08-10 23:43:54,350 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xd752043c, L:/127.0.0.1:40942 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:54,352 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:54,352 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5d8e65ff, L:/127.0.0.1:47186 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:54,354 - INFO  - [bookie-io-97-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x981d9c53, L:/127.0.0.1:43135 ! R:/127.0.0.1:47186]
2020-08-10 23:43:54,354 - INFO  - [bookie-io-65-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xda4bc08d, L:/127.0.0.1:32931 ! R:/127.0.0.1:36228]
2020-08-10 23:43:54,354 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xfd40c35a, L:/127.0.0.1:36228 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:54,847 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:54,847 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:54,849 - INFO  - [bookie-io-24-8:BookieRequestHandler@61] - Channels disconnected: [id: 0x2a465811, L:/127.0.0.1:45813 ! R:/127.0.0.1:57714]
2020-08-10 23:43:54,849 - INFO  - [bookie-io-24-7:BookieRequestHandler@61] - Channels disconnected: [id: 0x950e1e47, L:/127.0.0.1:45813 ! R:/127.0.0.1:57694]
2020-08-10 23:43:54,849 - WARN  - [bookkeeper-io-93-6:PerChannelBookieClient@1270] - Exception caught on:[id: 0x7a9abfd4, L:/127.0.0.1:57622 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,850 - WARN  - [bookkeeper-io-131-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0xea38be27, L:/127.0.0.1:57626 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,849 - INFO  - [bookie-io-24-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x88dd93c6, L:/127.0.0.1:45813 ! R:/127.0.0.1:57622]
2020-08-10 23:43:54,850 - WARN  - [bookkeeper-io-61-6:PerChannelBookieClient@1270] - Exception caught on:[id: 0x4a6e7549, L:/127.0.0.1:57662 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,850 - WARN  - [bookkeeper-io-77-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x3d95bbb2, L:/127.0.0.1:57640 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,850 - INFO  - [bookkeeper-io-61-6:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x4a6e7549, L:/127.0.0.1:57662 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,850 - INFO  - [bookkeeper-io-131-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xea38be27, L:/127.0.0.1:57626 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,850 - INFO  - [bookie-io-24-6:BookieRequestHandler@61] - Channels disconnected: [id: 0xd076dbae, L:/127.0.0.1:45813 ! R:/127.0.0.1:57662]
2020-08-10 23:43:54,850 - INFO  - [bookie-io-24-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x918ac288, L:/127.0.0.1:45813 ! R:/127.0.0.1:57626]
2020-08-10 23:43:54,850 - INFO  - [bookkeeper-io-93-6:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7a9abfd4, L:/127.0.0.1:57622 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,849 - WARN  - [bookkeeper-io-45-6:PerChannelBookieClient@1270] - Exception caught on:[id: 0x71af8250, L:/127.0.0.1:57694 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,857 - INFO  - [bookkeeper-io-45-6:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x71af8250, L:/127.0.0.1:57694 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,851 - INFO  - [bookkeeper-io-77-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x3d95bbb2, L:/127.0.0.1:57640 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,850 - WARN  - [bookkeeper-io-109-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x40f27fa9, L:/127.0.0.1:57714 - R:127.0.0.1/127.0.0.1:45813] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:54,850 - INFO  - [bookie-io-24-5:BookieRequestHandler@61] - Channels disconnected: [id: 0xb6ca8402, L:/127.0.0.1:45813 ! R:/127.0.0.1:57640]
2020-08-10 23:43:54,860 - INFO  - [bookkeeper-io-109-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x40f27fa9, L:/127.0.0.1:57714 ! R:127.0.0.1/127.0.0.1:45813]
2020-08-10 23:43:54,877 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45813 with exitCode 0
2020-08-10 23:43:54,877 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:54,877 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:54,877 - INFO  - [SyncThread-32-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:54,878 - INFO  - [SyncThread-32-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10488634682356681357test/current/0.log for logId 0.
2020-08-10 23:43:54,880 - INFO  - [pool-19-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10488634682356681357test/current/1.log for logId 1.
2020-08-10 23:43:54,900 - INFO  - [SyncThread-32-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095798916 , logFileOffset - 20992]}.
2020-08-10 23:43:54,904 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:54,906 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:54,906 - INFO  - [BookieJournal-45813:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:54,906 - INFO  - [BookieJournal-45813:Journal@1144] - Journal exited loop!
2020-08-10 23:43:54,907 - INFO  - [Bookie-45813:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:54,907 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:54,908 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:54,908 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:54,908 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:54,908 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:54,908 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:54,911 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:54,918 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:54,918 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:54,924 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:54,925 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:54,924 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:54,925 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:55,031 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:55,031 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45813
2020-08-10 23:43:55,027 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:55,031 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:55,032 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:55,032 - INFO  - [AuditorElector-127.0.0.1:45813:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:55,042 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,051 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:55,054 - INFO  - [AuditorElector-127.0.0.1:33689:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:55,055 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:55,056 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:33689
2020-08-10 23:43:55,058 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:55,059 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:55,064 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:55,064 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:55,065 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,065 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 36 initialDelay: 604764 interval: 604800
2020-08-10 23:43:55,066 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:55,066 - INFO  - [AuditorElector-127.0.0.1:33689:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:55,099 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:55,101 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:55,114 - ERROR - [bookkeeper-io-93-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x191da848, L:/127.0.0.1:57738]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,123 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:55,123 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,123 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>].
2020-08-10 23:43:55,123 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,124 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:55,124 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,124 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:55,124 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,127 - ERROR - [bookkeeper-io-93-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x74731018, L:/127.0.0.1:57740]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,128 - ERROR - [bookkeeper-io-93-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb2608adc, L:/127.0.0.1:57742]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,131 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 1 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:55,151 - ERROR - [bookkeeper-io-77-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x70531157, L:/127.0.0.1:57744]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,153 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe065f000, L:/127.0.0.1:44390 - R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:55,153 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43253
2020-08-10 23:43:55,153 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient$1@471] - connection [id: 0xe065f000, L:/127.0.0.1:44390 - R:127.0.0.1/127.0.0.1:43253] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:43:55,155 - INFO  - [bookie-io-119-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:43:55,155 - ERROR - [bookkeeper-io-77-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbb26aedd, L:/127.0.0.1:57748]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,158 - INFO  - [bookie-io-119-8:BookieRequestHandler@50] - Channel connected  [id: 0x4a8d6af0, L:/127.0.0.1:43253 - R:/127.0.0.1:44390]
2020-08-10 23:43:55,162 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:32931>].
2020-08-10 23:43:55,164 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,164 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>].
2020-08-10 23:43:55,164 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,165 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:55,165 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,165 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>].
2020-08-10 23:43:55,165 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,167 - ERROR - [bookkeeper-io-77-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb7be2b29, L:/127.0.0.1:57750]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,175 - ERROR - [bookkeeper-io-77-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x22808c6e, L:/127.0.0.1:57752]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,178 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 2 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:55,189 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:55,196 - ERROR - [bookkeeper-io-61-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe69f028e, L:/127.0.0.1:57754]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,207 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:55,207 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,208 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:55,208 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,210 - ERROR - [bookkeeper-io-61-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xcd6bfbbb, L:/127.0.0.1:57756]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,217 - INFO  - [AuditorBookie-127.0.0.1:45813:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:55,217 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 3 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:55,217 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:55,219 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:55,219 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:734)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:620)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:601)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2016)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:725)
	... 6 more
2020-08-10 23:43:55,220 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:55,220 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:55,223 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:55,223 - INFO  - [bookie-io-119-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x5ce521ef, L:/127.0.0.1:43253 ! R:/127.0.0.1:44336]
2020-08-10 23:43:55,223 - INFO  - [bookkeeper-io-45-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x474a7792, L:/127.0.0.1:44336 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:55,225 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:55,227 - INFO  - [bookkeeper-io-45-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x543f69a3, L:/127.0.0.1:35344 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,227 - INFO  - [bookie-io-49-7:BookieRequestHandler@61] - Channels disconnected: [id: 0xb9b7eb4c, L:/127.0.0.1:33689 ! R:/127.0.0.1:35344]
2020-08-10 23:43:55,229 - ERROR - [bookkeeper-io-77-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9eaf9b2b, L:/127.0.0.1:57758]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,229 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:55,231 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:55,235 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x683c97a3, L:/127.0.0.1:41028 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:55,235 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>].
2020-08-10 23:43:55,235 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,236 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:33689>].
2020-08-10 23:43:55,236 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,237 - ERROR - [bookkeeper-io-77-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xafa83990, L:/127.0.0.1:57760]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,235 - INFO  - [bookie-io-81-7:BookieRequestHandler@61] - Channels disconnected: [id: 0xa2641591, L:/127.0.0.1:35775 ! R:/127.0.0.1:41028]
2020-08-10 23:43:55,235 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:55,242 - INFO  - [bookkeeper-io-45-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe411692e, L:/127.0.0.1:47272 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:55,242 - INFO  - [bookie-io-97-7:BookieRequestHandler@61] - Channels disconnected: [id: 0x971c35c2, L:/127.0.0.1:43135 ! R:/127.0.0.1:47272]
2020-08-10 23:43:55,245 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:55,246 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x3a104fec, L:/127.0.0.1:36316 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,247 - INFO  - [bookie-io-65-7:BookieRequestHandler@61] - Channels disconnected: [id: 0x22331cc7, L:/127.0.0.1:32931 ! R:/127.0.0.1:36316]
2020-08-10 23:43:55,250 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 4 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:55,264 - INFO  - [AutoRecoveryDeathWatcher-45813:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:55,264 - INFO  - [AutoRecoveryDeathWatcher-45813:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45813
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:55,265 - INFO  - [AutoRecoveryDeathWatcher-45813:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:55,359 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:55,359 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:55,359 - INFO  - [bookie-io-49-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x3b6933a6, L:/127.0.0.1:33689 ! R:/127.0.0.1:35290]
2020-08-10 23:43:55,360 - WARN  - [bookkeeper-io-61-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x47d9b3d0, L:/127.0.0.1:35312 - R:127.0.0.1/127.0.0.1:33689] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,360 - WARN  - [bookkeeper-io-93-4:PerChannelBookieClient@1270] - Exception caught on:[id: 0x41fef26f, L:/127.0.0.1:35280 - R:127.0.0.1/127.0.0.1:33689] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,360 - INFO  - [bookkeeper-io-93-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x41fef26f, L:/127.0.0.1:35280 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,360 - WARN  - [bookkeeper-io-131-4:PerChannelBookieClient@1270] - Exception caught on:[id: 0x6ae917ba, L:/127.0.0.1:35290 - R:127.0.0.1/127.0.0.1:33689] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,360 - WARN  - [bookkeeper-io-77-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xc53442a5, L:/127.0.0.1:35300 - R:127.0.0.1/127.0.0.1:33689] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,362 - INFO  - [bookkeeper-io-131-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x6ae917ba, L:/127.0.0.1:35290 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,359 - INFO  - [bookie-io-49-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x2be37eca, L:/127.0.0.1:33689 ! R:/127.0.0.1:35280]
2020-08-10 23:43:55,359 - INFO  - [bookie-io-49-5:BookieRequestHandler@61] - Channels disconnected: [id: 0xeddf622b, L:/127.0.0.1:33689 ! R:/127.0.0.1:35300]
2020-08-10 23:43:55,362 - INFO  - [bookkeeper-io-77-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc53442a5, L:/127.0.0.1:35300 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,360 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x47d9b3d0, L:/127.0.0.1:35312 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,360 - WARN  - [bookkeeper-io-109-4:PerChannelBookieClient@1270] - Exception caught on:[id: 0x53a2783f, L:/127.0.0.1:35372 - R:127.0.0.1/127.0.0.1:33689] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,360 - INFO  - [bookie-io-49-8:BookieRequestHandler@61] - Channels disconnected: [id: 0xcc0a6fca, L:/127.0.0.1:33689 ! R:/127.0.0.1:35372]
2020-08-10 23:43:55,372 - INFO  - [bookkeeper-io-109-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x53a2783f, L:/127.0.0.1:35372 ! R:127.0.0.1/127.0.0.1:33689]
2020-08-10 23:43:55,360 - INFO  - [bookie-io-49-6:BookieRequestHandler@61] - Channels disconnected: [id: 0xabd6d2ed, L:/127.0.0.1:33689 ! R:/127.0.0.1:35312]
2020-08-10 23:43:55,378 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33689 with exitCode 0
2020-08-10 23:43:55,379 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:55,379 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:55,380 - INFO  - [SyncThread-54-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:55,382 - INFO  - [SyncThread-54-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7487327623456686507test/current/0.log for logId 0.
2020-08-10 23:43:55,384 - INFO  - [pool-32-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7487327623456686507test/current/1.log for logId 1.
2020-08-10 23:43:55,403 - INFO  - [SyncThread-54-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095799304 , logFileOffset - 20480]}.
2020-08-10 23:43:55,407 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:55,408 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:55,408 - INFO  - [BookieJournal-33689:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:55,409 - INFO  - [BookieJournal-33689:Journal@1144] - Journal exited loop!
2020-08-10 23:43:55,409 - INFO  - [Bookie-33689:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:55,409 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:55,410 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:55,411 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:55,411 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:55,411 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:55,411 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:55,415 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:55,426 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:55,426 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:55,433 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:55,433 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:55,434 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:55,433 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:55,434 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33689
2020-08-10 23:43:55,543 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:55,543 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:55,544 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:55,544 - INFO  - [AuditorElector-127.0.0.1:33689:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:55,553 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,564 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:55,567 - INFO  - [AuditorElector-127.0.0.1:32931:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:55,567 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:55,568 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:32931
2020-08-10 23:43:55,568 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1114] - Following are the failed bookies: [127.0.0.1:33689, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:55,570 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:55,577 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:55,578 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:55,579 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,579 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 36 initialDelay: 604764 interval: 604800
2020-08-10 23:43:55,582 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:55,582 - INFO  - [AuditorElector-127.0.0.1:32931:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:55,606 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:55,613 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1114] - Following are the failed bookies: [127.0.0.1:33689, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:55,614 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:55,632 - INFO  - [AuditorBookie-127.0.0.1:33689:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:55,633 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:55,633 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:55,634 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:43:55,635 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:55,635 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:55,642 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:55,644 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:55,645 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xcee2524b, L:/127.0.0.1:44380 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:55,645 - INFO  - [bookie-io-119-7:BookieRequestHandler@61] - Channels disconnected: [id: 0xae623ddf, L:/127.0.0.1:43253 ! R:/127.0.0.1:44380]
2020-08-10 23:43:55,648 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:55,649 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:55,650 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:55,651 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x374d830d, L:/127.0.0.1:40992 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:55,652 - INFO  - [bookie-io-81-6:BookieRequestHandler@61] - Channels disconnected: [id: 0xc534e983, L:/127.0.0.1:35775 ! R:/127.0.0.1:40992]
2020-08-10 23:43:55,652 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:55,653 - INFO  - [bookkeeper-io-61-4:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xfc37f365, L:/127.0.0.1:47246 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:55,653 - INFO  - [bookie-io-97-6:BookieRequestHandler@61] - Channels disconnected: [id: 0x1354e0ec, L:/127.0.0.1:43135 ! R:/127.0.0.1:47246]
2020-08-10 23:43:55,654 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x82f5d29a, L:/127.0.0.1:35418]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,655 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3c892395, L:/127.0.0.1:57764]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,657 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:55,659 - INFO  - [bookkeeper-io-61-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x4a4464c1, L:/127.0.0.1:36274 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,659 - INFO  - [bookie-io-65-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x80584972, L:/127.0.0.1:32931 ! R:/127.0.0.1:36274]
2020-08-10 23:43:55,661 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:55,662 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:55,667 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:32931>].
2020-08-10 23:43:55,668 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:55,669 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x7c1bc963, L:/127.0.0.1:35422]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,669 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2ab9f130, L:/127.0.0.1:57768]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:55,674 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 3 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:55,677 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:55,779 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:55,780 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:55,780 - INFO  - [bookie-io-65-8:BookieRequestHandler@61] - Channels disconnected: [id: 0x3652d64b, L:/127.0.0.1:32931 ! R:/127.0.0.1:36338]
2020-08-10 23:43:55,781 - WARN  - [bookkeeper-io-109-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xbd0a5b3f, L:/127.0.0.1:36338 - R:127.0.0.1/127.0.0.1:32931] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,781 - INFO  - [bookie-io-65-6:BookieRequestHandler@61] - Channels disconnected: [id: 0x922ec521, L:/127.0.0.1:32931 ! R:/127.0.0.1:36280]
2020-08-10 23:43:55,780 - INFO  - [bookie-io-65-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x1f7f2945, L:/127.0.0.1:32931 ! R:/127.0.0.1:36242]
2020-08-10 23:43:55,780 - WARN  - [bookkeeper-io-93-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x6b63aa27, L:/127.0.0.1:36242 - R:127.0.0.1/127.0.0.1:32931] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,782 - WARN  - [bookkeeper-io-77-6:PerChannelBookieClient@1270] - Exception caught on:[id: 0x25a628d0, L:/127.0.0.1:36280 - R:127.0.0.1/127.0.0.1:32931] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,786 - INFO  - [bookkeeper-io-93-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x6b63aa27, L:/127.0.0.1:36242 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,781 - INFO  - [bookkeeper-io-109-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xbd0a5b3f, L:/127.0.0.1:36338 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,781 - WARN  - [bookkeeper-io-131-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1579c71a, L:/127.0.0.1:36256 - R:127.0.0.1/127.0.0.1:32931] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:55,781 - INFO  - [bookie-io-65-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xcc5946fe, L:/127.0.0.1:32931 ! R:/127.0.0.1:36256]
2020-08-10 23:43:55,788 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1579c71a, L:/127.0.0.1:36256 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,786 - INFO  - [bookkeeper-io-77-6:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x25a628d0, L:/127.0.0.1:36280 ! R:127.0.0.1/127.0.0.1:32931]
2020-08-10 23:43:55,795 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-32931 with exitCode 0
2020-08-10 23:43:55,795 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:55,795 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:55,796 - INFO  - [SyncThread-70-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:55,798 - INFO  - [SyncThread-70-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4871124831893115628test/current/0.log for logId 0.
2020-08-10 23:43:55,799 - INFO  - [pool-42-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4871124831893115628test/current/1.log for logId 1.
2020-08-10 23:43:55,818 - INFO  - [SyncThread-70-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095799686 , logFileOffset - 21504]}.
2020-08-10 23:43:55,824 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:55,827 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:55,827 - INFO  - [BookieJournal-32931:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:55,827 - INFO  - [BookieJournal-32931:Journal@1144] - Journal exited loop!
2020-08-10 23:43:55,828 - INFO  - [Bookie-32931:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:55,828 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:55,830 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:55,831 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:55,831 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:55,831 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:55,831 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:55,834 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:55,841 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:55,842 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:55,854 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:55,854 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:55,854 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:55,854 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:32931
2020-08-10 23:43:55,880 - INFO  - [AutoRecoveryDeathWatcher-33689:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:55,881 - INFO  - [AutoRecoveryDeathWatcher-33689:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-33689
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:55,881 - INFO  - [AutoRecoveryDeathWatcher-33689:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:55,956 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:55,956 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:55,956 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:55,956 - INFO  - [AuditorElector-127.0.0.1:32931:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:55,969 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,977 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:55,980 - INFO  - [AuditorElector-127.0.0.1:35775:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:55,980 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:55,981 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:35775
2020-08-10 23:43:55,985 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1114] - Following are the failed bookies: [127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:55,987 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:55,988 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:55,989 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:55,991 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:55,991 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 37 initialDelay: 604763 interval: 604800
2020-08-10 23:43:55,991 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:55,991 - INFO  - [AuditorElector-127.0.0.1:35775:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:55,998 - INFO  - [BookieDeathWatcher-45813:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:43:55,998 - INFO  - [BookieDeathWatcher-45813:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45813
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:43:55,998 - INFO  - [BookieDeathWatcher-45813:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:55,998 - INFO  - [BookieDeathWatcher-45813:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,008 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:32931] are identified as underreplicated
2020-08-10 23:43:56,021 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1114] - Following are the failed bookies: [127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:56,022 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:56,038 - INFO  - [AutoRecoveryDeathWatcher-32931:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:56,038 - INFO  - [AutoRecoveryDeathWatcher-32931:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-32931
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:56,038 - INFO  - [AutoRecoveryDeathWatcher-32931:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:56,043 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:32931] are identified as underreplicated
2020-08-10 23:43:56,049 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:56,062 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:56,068 - INFO  - [AuditorBookie-127.0.0.1:32931:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:56,068 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:56,072 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:56,072 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:43:56,072 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:56,081 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:56,081 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:56,082 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe065f000, L:/127.0.0.1:44390 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:56,082 - INFO  - [bookie-io-119-8:BookieRequestHandler@61] - Channels disconnected: [id: 0x4a8d6af0, L:/127.0.0.1:43253 ! R:/127.0.0.1:44390]
2020-08-10 23:43:56,082 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:56,083 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:56,083 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:56,086 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:56,086 - INFO  - [bookkeeper-io-77-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf5baacd4, L:/127.0.0.1:40984 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:56,087 - INFO  - [bookkeeper-io-77-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf69f16d2, L:/127.0.0.1:47240 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:56,087 - INFO  - [bookie-io-81-5:BookieRequestHandler@61] - Channels disconnected: [id: 0xb1163d96, L:/127.0.0.1:35775 ! R:/127.0.0.1:40984]
2020-08-10 23:43:56,087 - INFO  - [bookie-io-97-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x21a902ab, L:/127.0.0.1:43135 ! R:/127.0.0.1:47240]
2020-08-10 23:43:56,088 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:56,206 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5c13eb2d, L:/127.0.0.1:36396]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,207 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3091cc6a, L:/127.0.0.1:35430]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,211 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf5ba80b1, L:/127.0.0.1:57772]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,206 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,212 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,213 - INFO  - [bookie-io-81-8:BookieRequestHandler@61] - Channels disconnected: [id: 0xda55762a, L:/127.0.0.1:35775 ! R:/127.0.0.1:41062]
2020-08-10 23:43:56,213 - WARN  - [bookkeeper-io-93-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xf0be57af, L:/127.0.0.1:40960 - R:127.0.0.1/127.0.0.1:35775] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,213 - INFO  - [bookkeeper-io-93-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf0be57af, L:/127.0.0.1:40960 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:56,213 - WARN  - [bookkeeper-io-131-5:PerChannelBookieClient@1270] - Exception caught on:[id: 0x22255336, L:/127.0.0.1:40978 - R:127.0.0.1/127.0.0.1:35775] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,213 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>].
2020-08-10 23:43:56,213 - INFO  - [bookkeeper-io-131-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x22255336, L:/127.0.0.1:40978 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:56,213 - WARN  - [bookkeeper-io-109-5:PerChannelBookieClient@1270] - Exception caught on:[id: 0xb173e055, L:/127.0.0.1:41062 - R:127.0.0.1/127.0.0.1:35775] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,214 - INFO  - [bookkeeper-io-109-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xb173e055, L:/127.0.0.1:41062 ! R:127.0.0.1/127.0.0.1:35775]
2020-08-10 23:43:56,213 - INFO  - [bookie-io-81-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x2a5e758f, L:/127.0.0.1:35775 ! R:/127.0.0.1:40960]
2020-08-10 23:43:56,213 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,215 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,215 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,213 - INFO  - [bookie-io-81-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x4b8334cd, L:/127.0.0.1:35775 ! R:/127.0.0.1:40978]
2020-08-10 23:43:56,218 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1eda082f, L:/127.0.0.1:36402]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,222 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x8348756a, L:/127.0.0.1:35434]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,223 - ERROR - [bookkeeper-io-93-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xeb6821c1, L:/127.0.0.1:36406]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,224 - ERROR - [bookkeeper-io-93-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1bca92ee, L:/127.0.0.1:57782]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,225 - ERROR - [bookkeeper-io-93-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9e0bb182, L:/127.0.0.1:41126]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,226 - ERROR - [bookkeeper-io-93-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x09d4679a, L:/127.0.0.1:35442]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,233 - ERROR - [bookkeeper-io-93-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x274fdfee, L:/127.0.0.1:41136]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,231 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9bd3e622, L:/127.0.0.1:57792]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,230 - ERROR - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc2e639bc, L:/127.0.0.1:36416]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,229 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35775 with exitCode 0
2020-08-10 23:43:56,226 - ERROR - [bookkeeper-io-93-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xcf8b5088, L:/127.0.0.1:57786]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,235 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:56,235 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:56,236 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:56,236 - INFO  - [SyncThread-86-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:56,235 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 4 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:56,238 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,238 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,238 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>].
2020-08-10 23:43:56,238 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,239 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:35775>].
2020-08-10 23:43:56,239 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,239 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>].
2020-08-10 23:43:56,239 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,241 - ERROR - [bookkeeper-io-93-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe5bc9970, L:/127.0.0.1:36422]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,243 - INFO  - [SyncThread-86-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1429392457984956895test/current/0.log for logId 0.
2020-08-10 23:43:56,247 - ERROR - [bookkeeper-io-93-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb589e6c8, L:/127.0.0.1:41142]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,251 - ERROR - [bookkeeper-io-93-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbc4ee1de, L:/127.0.0.1:41144]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,252 - ERROR - [bookkeeper-io-93-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xfa188d73, L:/127.0.0.1:36432]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,253 - ERROR - [bookkeeper-io-93-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe843d6ab, L:/127.0.0.1:41150]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,252 - ERROR - [bookkeeper-io-93-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xaa203c83, L:/127.0.0.1:57798]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,252 - ERROR - [bookkeeper-io-93-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc135da1f, L:/127.0.0.1:35460]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,255 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 2 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:56,260 - INFO  - [pool-52-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1429392457984956895test/current/1.log for logId 1.
2020-08-10 23:43:56,280 - INFO  - [SyncThread-86-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095800054 , logFileOffset - 20480]}.
2020-08-10 23:43:56,285 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:56,285 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:56,286 - INFO  - [BookieJournal-35775:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:56,286 - INFO  - [BookieJournal-35775:Journal@1144] - Journal exited loop!
2020-08-10 23:43:56,286 - INFO  - [Bookie-35775:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:56,286 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:56,287 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:56,287 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:56,287 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:56,287 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:56,287 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:56,291 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:56,295 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:56,295 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:56,300 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:56,300 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:56,301 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35775
2020-08-10 23:43:56,352 - INFO  - [BookieDeathWatcher-33689:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:43:56,353 - INFO  - [BookieDeathWatcher-33689:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33689
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:43:56,353 - INFO  - [BookieDeathWatcher-33689:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,353 - INFO  - [BookieDeathWatcher-33689:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,401 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:56,401 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:56,401 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:56,401 - INFO  - [AuditorElector-127.0.0.1:35775:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:56,408 - INFO  - [AutoRecoveryDeathWatcher-35775:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:56,409 - INFO  - [AutoRecoveryDeathWatcher-35775:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-35775
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:56,409 - INFO  - [AutoRecoveryDeathWatcher-35775:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:56,414 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:56,419 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:56,422 - INFO  - [AuditorElector-127.0.0.1:43135:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:56,422 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:56,424 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:43135
2020-08-10 23:43:56,431 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:56,432 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:56,433 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1114] - Following are the failed bookies: [127.0.0.1:35775, 127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:56,434 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:35775] are identified as underreplicated
2020-08-10 23:43:56,434 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:56,434 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 37 initialDelay: 604763 interval: 604800
2020-08-10 23:43:56,434 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:56,434 - INFO  - [AuditorElector-127.0.0.1:43135:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:56,457 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1114] - Following are the failed bookies: [127.0.0.1:35775, 127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:56,458 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:35775] are identified as underreplicated
2020-08-10 23:43:56,473 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:56,483 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:56,494 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:32931] are identified as underreplicated
2020-08-10 23:43:56,504 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:32931] are identified as underreplicated
2020-08-10 23:43:56,512 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:56,520 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:56,530 - INFO  - [AuditorBookie-127.0.0.1:35775:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:56,532 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:56,532 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:56,533 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:43:56,533 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:56,541 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:56,541 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:56,542 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:56,542 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:56,542 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:56,542 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:56,542 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xda6205ff, L:/127.0.0.1:44326 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:56,542 - INFO  - [bookie-io-119-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x98a59aab, L:/127.0.0.1:43253 ! R:/127.0.0.1:44326]
2020-08-10 23:43:56,543 - INFO  - [bookkeeper-io-93-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x046b5427, L:/127.0.0.1:47202 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:56,543 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:56,543 - INFO  - [bookie-io-97-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xaccefde4, L:/127.0.0.1:43135 ! R:/127.0.0.1:47202]
2020-08-10 23:43:56,547 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:56,553 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x301b409d, L:/127.0.0.1:41152]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,554 - ERROR - [bookkeeper-io-109-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x8798430d, L:/127.0.0.1:36438]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,554 - ERROR - [bookkeeper-io-109-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x62905fbd, L:/127.0.0.1:41158]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,555 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9b2a9a17, L:/127.0.0.1:41160]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,554 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3d3b0b08, L:/127.0.0.1:57814]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,557 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf1d89dc9, L:/127.0.0.1:35482]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,556 - ERROR - [bookkeeper-io-109-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0610437f, L:/127.0.0.1:35480]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,556 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2c62c167, L:/127.0.0.1:36448]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,555 - ERROR - [bookkeeper-io-109-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xecf18d6e, L:/127.0.0.1:57820]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,566 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,566 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,566 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xd73c1ceb, L:/127.0.0.1:57828]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,566 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:43135>].
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,568 - ERROR - [bookkeeper-io-109-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x31c2a708, L:/127.0.0.1:36456]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,571 - ERROR - [bookkeeper-io-109-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x4a66611a, L:/127.0.0.1:57832]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,567 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,572 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,572 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,572 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,573 - ERROR - [bookkeeper-io-109-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbd0b0b9e, L:/127.0.0.1:35490]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,574 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,574 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,574 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,574 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,575 - ERROR - [bookkeeper-io-109-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x52996055, L:/127.0.0.1:35492]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,576 - ERROR - [bookkeeper-io-109-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xdc5d22d5, L:/127.0.0.1:57838]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,576 - ERROR - [bookkeeper-io-109-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x29026a5e, L:/127.0.0.1:41182]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,577 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x32e01922, L:/127.0.0.1:41184]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,577 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x02b061ca, L:/127.0.0.1:36470]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,577 - ERROR - [bookkeeper-io-109-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6c9f82b7, L:/127.0.0.1:41188]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,578 - ERROR - [bookkeeper-io-109-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x8dd51adc, L:/127.0.0.1:36474]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,579 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe5c3e718, L:/127.0.0.1:36476]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,580 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xa8eaf477, L:/127.0.0.1:35508]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,580 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc27b20f3, L:/127.0.0.1:57854]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,581 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1d47a7c8, L:/127.0.0.1:57856]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,581 - ERROR - [bookkeeper-io-109-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x101d593c, L:/127.0.0.1:57858]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,582 - ERROR - [bookkeeper-io-109-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb956d8ff, L:/127.0.0.1:35516]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,582 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xafaa8d73, L:/127.0.0.1:36490]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,582 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x4c9ab228, L:/127.0.0.1:41204]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,583 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x05c63fe6, L:/127.0.0.1:57866]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,584 - ERROR - [bookkeeper-io-109-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe3e1c097, L:/127.0.0.1:35526]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,583 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x56ef16c6, L:/127.0.0.1:35524]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,585 - ERROR - [bookkeeper-io-109-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xabd39756, L:/127.0.0.1:41214]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,586 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbbc25080, L:/127.0.0.1:57874]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,587 - ERROR - [bookkeeper-io-109-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3120e4b9, L:/127.0.0.1:41218]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,588 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 1 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:56,590 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 2 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:43:56,652 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,652 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,653 - INFO  - [bookie-io-97-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xd4ad2b7c, L:/127.0.0.1:43135 ! R:/127.0.0.1:47216]
2020-08-10 23:43:56,653 - WARN  - [bookkeeper-io-131-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x9c2ca6aa, L:/127.0.0.1:47216 - R:127.0.0.1/127.0.0.1:43135] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,653 - WARN  - [bookkeeper-io-109-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x433fce6e, L:/127.0.0.1:47298 - R:127.0.0.1/127.0.0.1:43135] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,654 - INFO  - [bookie-io-97-8:BookieRequestHandler@61] - Channels disconnected: [id: 0x1de4a463, L:/127.0.0.1:43135 ! R:/127.0.0.1:47298]
2020-08-10 23:43:56,654 - INFO  - [bookkeeper-io-109-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x433fce6e, L:/127.0.0.1:47298 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:56,653 - INFO  - [bookkeeper-io-131-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x9c2ca6aa, L:/127.0.0.1:47216 ! R:127.0.0.1/127.0.0.1:43135]
2020-08-10 23:43:56,654 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43135 with exitCode 0
2020-08-10 23:43:56,655 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:56,655 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:56,655 - INFO  - [SyncThread-102-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:56,657 - INFO  - [SyncThread-102-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9646876573156829000test/current/0.log for logId 0.
2020-08-10 23:43:56,659 - INFO  - [pool-62-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9646876573156829000test/current/1.log for logId 1.
2020-08-10 23:43:56,675 - INFO  - [SyncThread-102-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095800463 , logFileOffset - 19968]}.
2020-08-10 23:43:56,678 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:43:56,679 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:43:56,679 - INFO  - [BookieJournal-43135:Journal@1135] - Journal exits when shutting down
2020-08-10 23:43:56,680 - INFO  - [BookieJournal-43135:Journal@1144] - Journal exited loop!
2020-08-10 23:43:56,680 - INFO  - [Bookie-43135:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:43:56,680 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:43:56,681 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:43:56,681 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:43:56,681 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:43:56,681 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:43:56,681 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:43:56,687 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:43:56,691 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:43:56,691 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:43:56,696 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:56,697 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43135
2020-08-10 23:43:56,700 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:56,709 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1114] - Following are the failed bookies: [127.0.0.1:35775, 127.0.0.1:43135, 127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:56,710 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:35775] are identified as underreplicated
2020-08-10 23:43:56,726 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:43135] are identified as underreplicated
2020-08-10 23:43:56,734 - INFO  - [BookieDeathWatcher-32931:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:43:56,734 - INFO  - [BookieDeathWatcher-32931:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-32931
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:43:56,734 - INFO  - [BookieDeathWatcher-32931:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,734 - INFO  - [BookieDeathWatcher-32931:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,776 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:33689] are identified as underreplicated
2020-08-10 23:43:56,795 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:32931] are identified as underreplicated
2020-08-10 23:43:56,797 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:56,797 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:43:56,797 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:43:56,797 - INFO  - [AuditorElector-127.0.0.1:43135:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:43:56,819 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:43:56,823 - INFO  - [AuditorElector-127.0.0.1:43253:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:43:56,824 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:43:56,825 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:43253
2020-08-10 23:43:56,828 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:45813] are identified as underreplicated
2020-08-10 23:43:56,830 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:43:56,831 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:43:56,833 - INFO  - [AuditorBookie-127.0.0.1:43253:Auditor@1067] - Starting auditBookies
2020-08-10 23:43:56,833 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597095798961 durationSinceLastExecutionInSecs: 37 initialDelay: 604763 interval: 604800
2020-08-10 23:43:56,833 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:43:56,833 - INFO  - [AuditorElector-127.0.0.1:43253:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:43:56,852 - INFO  - [AuditorBookie-127.0.0.1:43135:Auditor@1102] - Completed auditBookies
2020-08-10 23:43:56,853 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:43:56,853 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:43:56,855 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:43:56,856 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:43:56,861 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45813
2020-08-10 23:43:56,861 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43253
2020-08-10 23:43:56,861 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33689
2020-08-10 23:43:56,861 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37481
2020-08-10 23:43:56,862 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35775
2020-08-10 23:43:56,861 - INFO  - [bookkeeper-io-109-7:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa1052a69, L:/127.0.0.1:44368 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:56,862 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43135
2020-08-10 23:43:56,862 - INFO  - [bookie-io-119-6:BookieRequestHandler@61] - Channels disconnected: [id: 0x60ff24aa, L:/127.0.0.1:43253 ! R:/127.0.0.1:44368]
2020-08-10 23:43:56,862 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:32931
2020-08-10 23:43:56,881 - INFO  - [AutoRecoveryDeathWatcher-43135:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:43:56,881 - INFO  - [BookieDeathWatcher-43135:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:43:56,881 - INFO  - [AutoRecoveryDeathWatcher-43135:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-43135
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:43:56,881 - INFO  - [AutoRecoveryDeathWatcher-43135:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:43:56,881 - INFO  - [BookieDeathWatcher-43135:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43135
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:43:56,883 - INFO  - [BookieDeathWatcher-43135:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,883 - INFO  - [BookieDeathWatcher-43135:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,974 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:43:56,974 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:43:56,974 - INFO  - [bookie-io-119-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x94256b6a, L:/127.0.0.1:43253 ! R:/127.0.0.1:44342]
2020-08-10 23:43:56,974 - WARN  - [bookkeeper-io-131-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xb1255f6d, L:/127.0.0.1:44342 - R:127.0.0.1/127.0.0.1:43253] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:43:56,975 - INFO  - [bookkeeper-io-131-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xb1255f6d, L:/127.0.0.1:44342 ! R:127.0.0.1/127.0.0.1:43253]
2020-08-10 23:43:56,975 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0bbfd4f6, L:/127.0.0.1:36504]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,976 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43253 with exitCode 0
2020-08-10 23:43:56,976 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:43:56,976 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:43:56,976 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x186f8616, L:/127.0.0.1:57880]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,977 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0123015d, L:/127.0.0.1:47474]/127.0.0.1:43135, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43135
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,977 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5012d756, L:/127.0.0.1:41226]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,977 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9f0bd8da, L:/127.0.0.1:35538]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,980 - INFO  - [AuditorBookie-127.0.0.1:43253:Auditor@1114] - Following are the failed bookies: [127.0.0.1:35775, 127.0.0.1:43135, 127.0.0.1:33689, 127.0.0.1:32931, 127.0.0.1:45813], and searching its ledgers for re-replication
2020-08-10 23:43:56,980 - INFO  - [SyncThread-124-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:43:56,983 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc6e97553, L:/127.0.0.1:35552]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,980 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x22d8eb98, L:/127.0.0.1:57894]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,980 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x14a74e94, L:/127.0.0.1:36518]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,980 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1183bfc8, L:/127.0.0.1:47478]/127.0.0.1:43135, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43135
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,984 - INFO  - [SyncThread-124-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie6773060511631047113test/current/0.log for logId 0.
2020-08-10 23:43:56,983 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xfd554c2d, L:/127.0.0.1:41240]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,982 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x805ba3cb, L:/127.0.0.1:44532]/127.0.0.1:43253, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43253
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,982 - INFO  - [AuditorBookie-127.0.0.1:43253:Auditor@1132] - Following ledgers: [1, 2, 3, 4] of bookie: [127.0.0.1:35775] are identified as underreplicated
2020-08-10 23:43:56,987 - ERROR - [bookkeeper-io-131-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x518d4741, L:/127.0.0.1:44544]/127.0.0.1:43253, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43253
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,987 - INFO  - [pool-75-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie6773060511631047113test/current/1.log for logId 1.
2020-08-10 23:43:56,991 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,991 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,991 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,991 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,992 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,992 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:43:56,992 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:43253>, <Bookie:127.0.0.1:35775>, <Bookie:127.0.0.1:43135>, <Bookie:127.0.0.1:33689>, <Bookie:127.0.0.1:32931>, <Bookie:127.0.0.1:45813>], allBookies [<Bookie:127.0.0.1:43253>].
2020-08-10 23:43:56,992 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:43:56,993 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x64d63478, L:/127.0.0.1:36528]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x472c8c76, L:/127.0.0.1:35562]/127.0.0.1:33689, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:33689
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xa14384e5, L:/127.0.0.1:41254]/127.0.0.1:35775, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:35775
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x4c614a5e, L:/127.0.0.1:44558]/127.0.0.1:43253, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43253
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x7fdbed88, L:/127.0.0.1:57904]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc0147f25, L:/127.0.0.1:36536]/127.0.0.1:32931, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:32931
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,994 - ERROR - [bookkeeper-io-131-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2d045dc1, L:/127.0.0.1:47496]/127.0.0.1:43135, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43135
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:43:56,997 - ERROR - [bookkeeper-io-131-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xed9693e0, L:/127.0.0.1:57916]/127.0.0.1:45813, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45813
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
