2020-08-10 23:48:27,375 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,576 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,576 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,584 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,585 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,586 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,587 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,588 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,588 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,589 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,589 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,590 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,590 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,591 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,591 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,606 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:27,610 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r12/127.0.0.7:3181
2020-08-10 23:48:27,610 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r13/127.0.0.8:3181
2020-08-10 23:48:27,610 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r14/127.0.0.9:3181
2020-08-10 23:48:27,611 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,611 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:27,612 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.0.0.5:3181
2020-08-10 23:48:27,612 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r24/127.0.0.11:3181
2020-08-10 23:48:27,612 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r11/127.0.0.6:3181
2020-08-10 23:48:27,613 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r23/127.0.0.10:3181
2020-08-10 23:48:27,613 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:27,614 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,615 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:27,615 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.0.0.5:3181
2020-08-10 23:48:27,615 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r12/127.0.0.7:3181
2020-08-10 23:48:27,615 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r11/127.0.0.6:3181
2020-08-10 23:48:27,616 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r13/127.0.0.8:3181
2020-08-10 23:48:27,616 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r14/127.0.0.9:3181
2020-08-10 23:48:27,616 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r24/127.0.0.11:3181
2020-08-10 23:48:27,617 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r23/127.0.0.10:3181
2020-08-10 23:48:27,626 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.2:3181]
2020-08-10 23:48:27,633 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.4:3181]
2020-08-10 23:48:27,634 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.6:3181]
2020-08-10 23:48:27,635 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region4 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.8:3181]
2020-08-10 23:48:27,647 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from  : excluded [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.10:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,648 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.10:3181>], allBookies [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.10:3181>].
2020-08-10 23:48:27,649 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 1 bookies in region region5, try allocating 0 bookies
2020-08-10 23:48:27,653 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.2:3181, 127.0.0.3:3181]
2020-08-10 23:48:27,653 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region2 : ensemble [127.0.0.11:3181, 127.0.0.10:3181] exclude [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>]
2020-08-10 23:48:27,654 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region region2 : [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:27,655 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region3 : ensemble [127.0.0.11:3181, 127.0.0.10:3181] exclude [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:27,657 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region region3 : [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>]
2020-08-10 23:48:27,657 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region4 : ensemble [127.0.0.11:3181, 127.0.0.10:3181] exclude [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>]
2020-08-10 23:48:27,658 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from  : excluded [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.10:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,658 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.10:3181>], allBookies [<Bookie:127.0.0.9:3181>, <Bookie:127.0.0.8:3181>].
2020-08-10 23:48:27,662 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,664 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,664 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,665 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,666 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,666 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,666 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,667 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,667 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,667 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,668 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,668 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,668 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,669 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,669 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,671 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r34/127.1.0.15:3181
2020-08-10 23:48:27,672 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r35/127.1.0.16:3181
2020-08-10 23:48:27,672 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:27,672 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r24/127.1.0.11:3181
2020-08-10 23:48:27,673 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r31/127.1.0.12:3181
2020-08-10 23:48:27,673 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r32/127.1.0.13:3181
2020-08-10 23:48:27,674 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r33/127.1.0.14:3181
2020-08-10 23:48:27,674 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:27,674 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:27,675 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:27,675 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:27,676 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:27,676 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:27,677 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:27,677 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:27,677 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:27,678 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:27,678 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:27,678 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:27,679 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:27,679 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:27,680 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:27,680 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:27,680 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:27,681 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r24/127.1.0.11:3181
2020-08-10 23:48:27,681 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r31/127.1.0.12:3181
2020-08-10 23:48:27,681 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r32/127.1.0.13:3181
2020-08-10 23:48:27,682 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r33/127.1.0.14:3181
2020-08-10 23:48:27,682 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r34/127.1.0.15:3181
2020-08-10 23:48:27,682 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region5/r35/127.1.0.16:3181
2020-08-10 23:48:27,684 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.4:3181, 127.1.0.2:3181]
2020-08-10 23:48:27,686 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.7:3181, 127.1.0.6:3181]
2020-08-10 23:48:27,689 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.10:3181, 127.1.0.9:3181]
2020-08-10 23:48:27,691 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region4 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.11:3181, 127.1.0.12:3181]
2020-08-10 23:48:27,693 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region5 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.15:3181, 127.1.0.14:3181]
2020-08-10 23:48:27,694 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.4:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.7:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.11:3181>, <Bookie:127.1.0.12:3181>, <Bookie:127.1.0.15:3181>, <Bookie:127.1.0.14:3181>]
2020-08-10 23:48:27,696 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.4:3181, 127.1.0.3:3181]
2020-08-10 23:48:27,699 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.5:3181, 127.1.0.6:3181]
2020-08-10 23:48:27,701 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.9:3181, 127.1.0.8:3181]
2020-08-10 23:48:27,704 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region4 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.12:3181, 127.1.0.13:3181]
2020-08-10 23:48:27,706 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region5 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.15:3181, 127.1.0.14:3181]
2020-08-10 23:48:27,707 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.4:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.12:3181>, <Bookie:127.1.0.13:3181>, <Bookie:127.1.0.15:3181>, <Bookie:127.1.0.14:3181>]
2020-08-10 23:48:27,710 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,711 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,712 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,713 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,713 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,714 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.2:3181
2020-08-10 23:48:27,714 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,715 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,715 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,715 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.4:3181
2020-08-10 23:48:27,716 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.5:3181
2020-08-10 23:48:27,716 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.2:3181
2020-08-10 23:48:27,716 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,717 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.4:3181
2020-08-10 23:48:27,717 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.5:3181
2020-08-10 23:48:27,721 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,723 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,723 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,724 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,724 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,725 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,725 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,725 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,726 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,726 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:27,726 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,727 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,727 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:27,727 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,728 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,728 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,729 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,729 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:27,729 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:27,730 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region1/r2 : excluded [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,731 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>], allBookies [<Bookie:127.0.0.3:3181>].
2020-08-10 23:48:27,731 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@532] - Failed to choose a bookie from /region1/r2 : excluded [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,734 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,736 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,736 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,737 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,737 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,738 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,738 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,739 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,739 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,740 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,740 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,741 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:27,741 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,741 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,742 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:27,742 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,742 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,748 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,748 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,749 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@369] - reorder set : WriteSet[3,2,0,1]
2020-08-10 23:48:27,752 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,754 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,754 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,755 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,755 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,756 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,756 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.3:3181
2020-08-10 23:48:27,757 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,757 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,757 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.4:3181
2020-08-10 23:48:27,757 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,758 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,758 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r4/127.0.0.5:3181
2020-08-10 23:48:27,758 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,759 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,759 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,759 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.3:3181
2020-08-10 23:48:27,760 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.4:3181
2020-08-10 23:48:27,760 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r4/127.0.0.5:3181
2020-08-10 23:48:27,760 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.2:3181>], allBookies [<Bookie:127.0.0.2:3181>].
2020-08-10 23:48:27,761 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region UnknownRegion, try allocating 1 bookies
2020-08-10 23:48:27,761 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region UnknownRegion allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.2:3181]
2020-08-10 23:48:27,762 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.3:3181>], allBookies [<Bookie:127.0.0.3:3181>].
2020-08-10 23:48:27,762 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region2, try allocating 1 bookies
2020-08-10 23:48:27,762 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.3:3181]
2020-08-10 23:48:27,763 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.4:3181>], allBookies [<Bookie:127.0.0.4:3181>].
2020-08-10 23:48:27,763 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region3, try allocating 1 bookies
2020-08-10 23:48:27,764 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.4:3181]
2020-08-10 23:48:27,764 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.5:3181>], allBookies [<Bookie:127.0.0.5:3181>].
2020-08-10 23:48:27,764 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region4, try allocating 1 bookies
2020-08-10 23:48:27,765 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region4 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.5:3181]
2020-08-10 23:48:27,765 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.2:3181>], allBookies [<Bookie:127.0.0.2:3181>].
2020-08-10 23:48:27,765 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region UnknownRegion, try allocating 1 bookies
2020-08-10 23:48:27,766 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region UnknownRegion : ensemble [] exclude []
2020-08-10 23:48:27,766 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region UnknownRegion : [<Bookie:127.0.0.2:3181>]
2020-08-10 23:48:27,767 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.3:3181>], allBookies [<Bookie:127.0.0.3:3181>].
2020-08-10 23:48:27,767 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region2, try allocating 1 bookies
2020-08-10 23:48:27,767 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region2 : ensemble [] exclude [<Bookie:127.0.0.2:3181>]
2020-08-10 23:48:27,768 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region region2 : [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>]
2020-08-10 23:48:27,768 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.4:3181>], allBookies [<Bookie:127.0.0.4:3181>].
2020-08-10 23:48:27,769 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region3, try allocating 1 bookies
2020-08-10 23:48:27,769 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region3 : ensemble [] exclude [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>]
2020-08-10 23:48:27,769 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region region3 : [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>]
2020-08-10 23:48:27,770 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.5:3181>], allBookies [<Bookie:127.0.0.5:3181>].
2020-08-10 23:48:27,770 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region4, try allocating 1 bookies
2020-08-10 23:48:27,771 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 1 bookies in region region4 : ensemble [] exclude [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>]
2020-08-10 23:48:27,771 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 1 bookies in region region4 : [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:27,771 - ERROR - [main:RegionAwareEnsemblePlacementPolicy@407] - Not enough 5 bookies are available to form an ensemble : [127.0.0.2:3181, 127.0.0.3:3181, 127.0.0.4:3181, 127.0.0.5:3181].
2020-08-10 23:48:27,774 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,775 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,776 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,776 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,777 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,777 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,778 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,778 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,778 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,779 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,779 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,780 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r23/127.1.0.10:3181
2020-08-10 23:48:27,781 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:27,781 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r4/127.1.0.5:3181
2020-08-10 23:48:27,781 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:27,782 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:27,782 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r13/127.1.0.8:3181
2020-08-10 23:48:27,783 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r14/127.1.0.9:3181
2020-08-10 23:48:27,783 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.1.0.6:3181
2020-08-10 23:48:27,783 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.1.0.7:3181
2020-08-10 23:48:27,784 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r23/127.1.0.10:3181
2020-08-10 23:48:27,784 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:27,784 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r4/127.1.0.5:3181
2020-08-10 23:48:27,785 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:27,785 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:27,785 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r13/127.1.0.8:3181
2020-08-10 23:48:27,786 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r14/127.1.0.9:3181
2020-08-10 23:48:27,786 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.1.0.6:3181
2020-08-10 23:48:27,787 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.1.0.7:3181
2020-08-10 23:48:27,787 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.4:3181, 127.1.0.7:3181]
2020-08-10 23:48:27,788 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 2 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:27,788 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region2, try allocating 1 bookies
2020-08-10 23:48:27,789 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:27,789 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 1 bookies in region region2, try allocating 0 bookies
2020-08-10 23:48:27,789 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 2 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:27,790 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region3, try allocating 1 bookies
2020-08-10 23:48:27,790 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:27,790 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 1 bookies in region region3, try allocating 0 bookies
2020-08-10 23:48:27,792 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 6 and write quorum size 6 : [127.1.0.3:3181, 127.1.0.4:3181, 127.1.0.7:3181, 127.1.0.2:3181, 127.1.0.6:3181, 127.1.0.5:3181]
2020-08-10 23:48:27,792 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.3:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.7:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>]
2020-08-10 23:48:27,793 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region1/r12 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,796 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,797 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,798 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,799 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,799 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,800 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:27,801 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,801 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,802 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:27,802 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,802 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,803 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:27,803 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,803 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,804 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:27,804 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,805 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:27,805 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:27,805 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:27,806 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:27,806 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:27,806 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:27,807 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:27,807 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:27,807 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:27,808 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:27,808 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:27,808 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:27,809 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:27,809 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,810 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.3:3181, 127.0.0.4:3181, 127.0.0.2:3181]
2020-08-10 23:48:27,811 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.7:3181, 127.0.0.6:3181, 127.0.0.5:3181]
2020-08-10 23:48:27,811 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,812 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.10:3181, 127.0.0.8:3181, 127.0.0.9:3181]
2020-08-10 23:48:27,813 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:27,814 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1204] - My region is region2, ensemble : [127.0.0.3:3181, 127.0.0.4:3181, 127.0.0.2:3181, 127.0.0.7:3181, 127.0.0.6:3181, 127.0.0.5:3181, 127.0.0.10:3181, 127.0.0.8:3181, 127.0.0.9:3181]
2020-08-10 23:48:27,814 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[0,1,2,3,4,5,6,7,8] => WriteSet[3,4,0,5,1,2,6,7,8].
2020-08-10 23:48:27,815 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[1,2,3,4,5,6,7,8,0] => WriteSet[3,4,1,5,2,6,7,8,0].
2020-08-10 23:48:27,815 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[2,3,4,5,6,7,8,0,1] => WriteSet[3,4,2,5,6,7,8,0,1].
2020-08-10 23:48:27,816 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[3,4,5,6,7,8,0,1,2] => WriteSet[3,4,6,5,7,8,0,1,2].
2020-08-10 23:48:27,817 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[4,5,6,7,8,0,1,2,3] => WriteSet[4,5,6,3,7,8,0,1,2].
2020-08-10 23:48:27,817 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[5,6,7,8,0,1,2,3,4] => WriteSet[5,3,6,4,7,8,0,1,2].
2020-08-10 23:48:27,818 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[6,7,8,0,1,2,3,4,5] => WriteSet[3,4,6,5,7,8,0,1,2].
2020-08-10 23:48:27,818 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[7,8,0,1,2,3,4,5,6] => WriteSet[3,4,7,5,8,0,1,2,6].
2020-08-10 23:48:27,818 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[8,0,1,2,3,4,5,6,7] => WriteSet[3,4,8,5,0,1,2,6,7].
2020-08-10 23:48:27,821 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,823 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,823 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,825 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r2/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,825 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,826 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,827 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r2/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,827 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,827 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack3/127.0.0.7:3181
2020-08-10 23:48:27,828 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r2/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,828 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,828 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack4/127.0.0.8:3181
2020-08-10 23:48:27,829 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack4/127.0.0.9:3181
2020-08-10 23:48:27,829 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack1/127.0.0.3:3181
2020-08-10 23:48:27,829 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack2/127.0.0.4:3181
2020-08-10 23:48:27,830 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,830 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack3/127.0.0.6:3181
2020-08-10 23:48:27,830 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack3/127.0.0.7:3181
2020-08-10 23:48:27,831 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack4/127.0.0.8:3181
2020-08-10 23:48:27,831 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack1/127.0.0.3:3181
2020-08-10 23:48:27,832 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r2/rack2/127.0.0.4:3181
2020-08-10 23:48:27,832 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,832 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack4/127.0.0.9:3181
2020-08-10 23:48:27,833 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,833 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack3/127.0.0.6:3181
2020-08-10 23:48:27,833 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1439] - write set : WriteSet[0,1,2,3,4,5,6,7]
2020-08-10 23:48:27,833 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1442] - reorder set : WriteSet[5,6,4,1,2,7,0,3]
2020-08-10 23:48:27,836 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,838 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,838 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,839 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,839 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,840 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,840 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.3:3181
2020-08-10 23:48:27,840 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,841 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,841 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.4:3181
2020-08-10 23:48:27,842 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,842 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,842 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r4/127.0.0.5:3181
2020-08-10 23:48:27,843 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,843 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,843 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:27,844 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.3:3181
2020-08-10 23:48:27,844 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.4:3181
2020-08-10 23:48:27,844 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region4/r4/127.0.0.5:3181
2020-08-10 23:48:27,845 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r2 : excluded [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,845 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>], allBookies [<Bookie:127.0.0.3:3181>].
2020-08-10 23:48:27,846 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@532] - Failed to choose a bookie from /region2/r2 : excluded [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:27,847 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>], allBookies [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.2:3181>].
2020-08-10 23:48:27,849 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:27,851 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,851 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,852 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:27,853 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,853 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,854 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,854 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,854 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,855 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:27,855 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:27,855 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:27,856 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,856 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,856 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:27,857 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,857 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:27,858 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,984 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,985 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:27,986 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:27,992 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@402] - reorder set : WriteSet[3,1,2,0]
2020-08-10 23:48:27,999 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,002 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,002 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,004 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,005 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,005 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,005 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,006 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,006 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,007 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,007 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,009 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r23/127.1.0.10:3181
2020-08-10 23:48:28,010 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,011 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r4/127.1.0.5:3181
2020-08-10 23:48:28,012 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,012 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,012 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r13/127.1.0.8:3181
2020-08-10 23:48:28,013 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r14/127.1.0.9:3181
2020-08-10 23:48:28,013 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.1.0.6:3181
2020-08-10 23:48:28,014 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.1.0.7:3181
2020-08-10 23:48:28,014 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r23/127.1.0.10:3181
2020-08-10 23:48:28,015 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,016 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r4/127.1.0.5:3181
2020-08-10 23:48:28,016 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,017 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,017 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r13/127.1.0.8:3181
2020-08-10 23:48:28,018 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r14/127.1.0.9:3181
2020-08-10 23:48:28,019 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.1.0.6:3181
2020-08-10 23:48:28,020 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.1.0.7:3181
2020-08-10 23:48:28,023 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.7:3181, 127.1.0.9:3181]
2020-08-10 23:48:28,023 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 2 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:28,024 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region2, try allocating 1 bookies
2020-08-10 23:48:28,024 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:28,025 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 1 bookies in region region2, try allocating 0 bookies
2020-08-10 23:48:28,025 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 2 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:28,025 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 2 bookies in region region3, try allocating 1 bookies
2020-08-10 23:48:28,026 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [], allBookies [].
2020-08-10 23:48:28,026 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 1 bookies in region region3, try allocating 0 bookies
2020-08-10 23:48:28,029 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 6 and write quorum size 6 : [127.1.0.8:3181, 127.1.0.5:3181, 127.1.0.2:3181, 127.1.0.3:3181, 127.1.0.6:3181, 127.1.0.9:3181]
2020-08-10 23:48:28,029 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.8:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.9:3181>]
2020-08-10 23:48:28,031 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region1/r1 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.3:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,032 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,035 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,035 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,037 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,038 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,040 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,041 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,041 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,041 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,042 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,042 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,042 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,042 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,043 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,043 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,043 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,043 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,043 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,044 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,044 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@251] - reorder set : WriteSet[3,1,2,0]
2020-08-10 23:48:28,046 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,049 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,049 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,050 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,050 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,051 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,051 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,051 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,052 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,052 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,053 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,053 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,053 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,054 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,054 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,055 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,055 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,055 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,056 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,056 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,056 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,056 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,057 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,057 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,057 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,057 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,058 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,058 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,058 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,058 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,059 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.3:3181, 127.0.0.2:3181, 127.0.0.4:3181]
2020-08-10 23:48:28,059 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,060 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.7:3181]
2020-08-10 23:48:28,060 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,060 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.8:3181, 127.0.0.10:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,061 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,063 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1261] - My region is region4, ensemble : [127.0.0.3:3181, 127.0.0.2:3181, 127.0.0.4:3181, 127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.7:3181, 127.0.0.8:3181, 127.0.0.10:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,067 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,070 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,070 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,071 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,072 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,072 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,073 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,073 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,073 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,074 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,074 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,074 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,074 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region2 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,075 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,075 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,075 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,076 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,076 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,076 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,077 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,077 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,078 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,078 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,078 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,078 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,079 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,079 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,079 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,079 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,080 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,080 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.2:3181, 127.0.0.4:3181, 127.0.0.3:3181]
2020-08-10 23:48:28,081 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.7:3181]
2020-08-10 23:48:28,081 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,082 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.9:3181, 127.0.0.8:3181, 127.0.0.10:3181]
2020-08-10 23:48:28,083 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.10:3181>]
2020-08-10 23:48:28,084 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1204] - My region is region2, ensemble : [127.0.0.2:3181, 127.0.0.4:3181, 127.0.0.3:3181, 127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.7:3181, 127.0.0.9:3181, 127.0.0.8:3181, 127.0.0.10:3181]
2020-08-10 23:48:28,085 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[0,1,2,3,4,5,6,7,8] => WriteSet[3,4,0,5,1,2,6,7,8].
2020-08-10 23:48:28,085 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[1,2,3,4,5,6,7,8,0] => WriteSet[3,4,1,5,2,6,7,8,0].
2020-08-10 23:48:28,086 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[2,3,4,5,6,7,8,0,1] => WriteSet[3,4,2,5,6,7,8,0,1].
2020-08-10 23:48:28,086 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[3,4,5,6,7,8,0,1,2] => WriteSet[3,4,6,5,7,8,0,1,2].
2020-08-10 23:48:28,087 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[4,5,6,7,8,0,1,2,3] => WriteSet[4,5,6,3,7,8,0,1,2].
2020-08-10 23:48:28,087 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[5,6,7,8,0,1,2,3,4] => WriteSet[5,3,6,4,7,8,0,1,2].
2020-08-10 23:48:28,087 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[6,7,8,0,1,2,3,4,5] => WriteSet[3,4,6,5,7,8,0,1,2].
2020-08-10 23:48:28,088 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[7,8,0,1,2,3,4,5,6] => WriteSet[3,4,7,5,8,0,1,2,6].
2020-08-10 23:48:28,089 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1221] - Reorder WriteSet[8,0,1,2,3,4,5,6,7] => WriteSet[3,4,8,5,0,1,2,6,7].
2020-08-10 23:48:28,091 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,092 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,093 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,093 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,094 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,094 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,095 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,095 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,095 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,096 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,096 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,097 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,097 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,097 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,097 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,098 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,098 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,099 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,099 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,099 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,099 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,100 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,100 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,100 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,100 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,101 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,101 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,101 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,102 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,102 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.2:3181, 127.1.0.4:3181]
2020-08-10 23:48:28,103 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.5:3181, 127.1.0.6:3181]
2020-08-10 23:48:28,103 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.8:3181, 127.1.0.9:3181]
2020-08-10 23:48:28,104 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.2:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.9:3181>]
2020-08-10 23:48:28,106 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,108 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,108 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,109 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r2/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,109 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,109 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@196] - reorder set : WriteSet[0,1,2,3]
2020-08-10 23:48:28,111 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,112 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,113 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,113 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,113 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,114 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.2:3181
2020-08-10 23:48:28,115 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,115 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,115 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,116 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,116 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,116 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,117 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,117 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,117 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,117 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,118 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,118 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,118 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r24/127.0.0.11:3181
2020-08-10 23:48:28,118 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.0.0.6:3181
2020-08-10 23:48:28,119 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r23/127.0.0.10:3181
2020-08-10 23:48:28,119 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,119 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,119 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r24/127.0.0.11:3181
2020-08-10 23:48:28,119 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.0.0.6:3181
2020-08-10 23:48:28,120 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.2:3181
2020-08-10 23:48:28,120 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,120 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,121 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r23/127.0.0.10:3181
2020-08-10 23:48:28,121 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,121 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,122 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.11:3181, 127.0.0.3:3181]
2020-08-10 23:48:28,122 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.8:3181, 127.0.0.4:3181]
2020-08-10 23:48:28,123 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.5:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,124 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,124 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.11:3181, 127.0.0.7:3181, 127.0.0.6:3181]
2020-08-10 23:48:28,125 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.10:3181, 127.0.0.2:3181]
2020-08-10 23:48:28,125 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.9:3181, 127.0.0.5:3181]
2020-08-10 23:48:28,126 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:28,126 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.3:3181, 127.0.0.6:3181, 127.0.0.7:3181]
2020-08-10 23:48:28,127 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.4:3181, 127.0.0.10:3181, 127.0.0.2:3181]
2020-08-10 23:48:28,127 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.9:3181, 127.0.0.5:3181]
2020-08-10 23:48:28,128 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:28,129 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.3:3181, 127.0.0.11:3181, 127.0.0.7:3181]
2020-08-10 23:48:28,130 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.2:3181, 127.0.0.10:3181, 127.0.0.4:3181]
2020-08-10 23:48:28,130 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from ~/region3/r14 : excluded [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,131 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], allBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>].
2020-08-10 23:48:28,131 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 3 bookies in region region3, try allocating 2 bookies
2020-08-10 23:48:28,131 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.9:3181, 127.0.0.5:3181]
2020-08-10 23:48:28,132 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 4 and write quorum size 4 : [127.0.0.3:3181, 127.0.0.6:3181, 127.0.0.11:3181, 127.0.0.7:3181]
2020-08-10 23:48:28,132 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 3 bookies in region region2 : ensemble [] exclude [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>]
2020-08-10 23:48:28,133 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 3 bookies in region region2 : [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>]
2020-08-10 23:48:28,133 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 2 bookies in region region3 : ensemble [] exclude [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>]
2020-08-10 23:48:28,134 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 2 bookies in region region3 : [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:28,134 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.11:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>]
2020-08-10 23:48:28,138 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,143 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,144 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,145 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:28,145 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,145 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,145 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.3:3181
2020-08-10 23:48:28,146 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,146 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,146 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.4:3181
2020-08-10 23:48:28,146 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/r3/127.0.0.5:3181
2020-08-10 23:48:28,147 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,147 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,147 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.2:3181
2020-08-10 23:48:28,147 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.3:3181
2020-08-10 23:48:28,150 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.4:3181
2020-08-10 23:48:28,150 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/r3/127.0.0.5:3181
2020-08-10 23:48:28,151 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region1/r1 : excluded [<Bookie:127.0.0.3:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,151 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,153 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,153 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,153 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack3 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,154 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,154 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,155 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack3 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,155 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,155 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,155 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack3 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,155 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,156 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,156 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,156 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,157 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,157 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,157 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,158 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@177] - write set : WriteSet[0,1,2,3]
2020-08-10 23:48:28,158 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@178] - reorder set : WriteSet[0,3,1,2]
2020-08-10 23:48:28,158 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@179] - expected set : WriteSet[0,3,1,2]
2020-08-10 23:48:28,158 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@180] - reorder equals false
2020-08-10 23:48:28,159 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,161 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,161 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,162 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack1/127.0.0.2:3181
2020-08-10 23:48:28,162 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,163 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,163 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,164 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,164 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,164 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,165 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,165 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,165 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,165 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,165 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,166 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,166 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,166 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,166 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack2/127.0.0.6:3181
2020-08-10 23:48:28,167 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,167 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,167 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,167 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,168 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,168 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,168 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack1/127.0.0.2:3181
2020-08-10 23:48:28,168 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack2/127.0.0.6:3181
2020-08-10 23:48:28,168 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.7:3181]
2020-08-10 23:48:28,169 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.8:3181]
2020-08-10 23:48:28,169 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.9:3181]
2020-08-10 23:48:28,169 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.7:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,170 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.3:3181]
2020-08-10 23:48:28,170 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.4:3181]
2020-08-10 23:48:28,170 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.5:3181]
2020-08-10 23:48:28,170 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region default-region allocating bookies with ensemble size 1 and write quorum size 1 : [127.0.0.2:3181]
2020-08-10 23:48:28,170 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.2:3181>]
2020-08-10 23:48:28,172 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,173 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,173 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,174 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,174 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,175 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,175 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,176 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,176 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,176 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,177 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,177 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,177 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,177 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,178 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,179 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,180 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,180 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,180 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,181 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.3:3181, 127.1.0.2:3181]
2020-08-10 23:48:28,181 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.7:3181, 127.1.0.6:3181]
2020-08-10 23:48:28,181 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.8:3181, 127.1.0.10:3181]
2020-08-10 23:48:28,182 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.3:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.7:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.10:3181>]
2020-08-10 23:48:28,182 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r11 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,183 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r11 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,183 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], allBookies [<Bookie:127.1.0.7:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>].
2020-08-10 23:48:28,184 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@532] - Failed to choose a bookie from /region2/r11 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,185 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,186 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,186 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,187 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,187 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,188 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,188 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,188 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,188 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,188 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,189 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,189 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,190 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,190 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,190 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,190 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,190 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,191 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,191 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,191 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,191 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,191 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,192 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,193 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,193 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.2:3181, 127.1.0.4:3181]
2020-08-10 23:48:28,193 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.5:3181, 127.1.0.6:3181]
2020-08-10 23:48:28,194 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.10:3181, 127.1.0.8:3181]
2020-08-10 23:48:28,194 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.2:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.8:3181>]
2020-08-10 23:48:28,194 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,195 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,195 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.7:3181>], allBookies [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.7:3181>].
2020-08-10 23:48:28,196 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@532] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,197 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.2:3181>, <Bookie:127.1.0.8:3181>, <Bookie:127.1.0.7:3181>], allBookies [<Bookie:127.1.0.2:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.7:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.8:3181>].
2020-08-10 23:48:28,198 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,199 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,199 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,200 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,200 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,201 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.2:3181
2020-08-10 23:48:28,201 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,201 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,201 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,202 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,202 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,202 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,203 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,203 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,203 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,203 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r24/127.0.0.11:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.0.0.6:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r23/127.0.0.10:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r12/127.0.0.7:3181
2020-08-10 23:48:28,204 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r24/127.0.0.11:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r11/127.0.0.6:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.2:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r13/127.0.0.8:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.4:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r23/127.0.0.10:3181
2020-08-10 23:48:28,205 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.0.0.9:3181
2020-08-10 23:48:28,206 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r4/127.0.0.5:3181
2020-08-10 23:48:28,206 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.2:3181, 127.0.0.8:3181, 127.0.0.4:3181]
2020-08-10 23:48:28,206 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from ~/region3/r14 : excluded [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,207 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], allBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>].
2020-08-10 23:48:28,207 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 3 bookies in region region3, try allocating 2 bookies
2020-08-10 23:48:28,207 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.9:3181, 127.0.0.5:3181]
2020-08-10 23:48:28,208 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 4 and write quorum size 4 : [127.0.0.10:3181, 127.0.0.8:3181, 127.0.0.2:3181, 127.0.0.4:3181]
2020-08-10 23:48:28,208 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 2 bookies in region region3 : ensemble [] exclude [<Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>]
2020-08-10 23:48:28,208 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 2 bookies in region region3 : [<Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,209 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,209 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from ~/region3/r14 : excluded [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,209 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>], allBookies [<Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>].
2020-08-10 23:48:28,210 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.10:3181, 127.0.0.4:3181, 127.0.0.2:3181]
2020-08-10 23:48:28,211 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from ~/region3/r4 : excluded [<Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,212 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.9:3181>, <Bookie:127.0.0.5:3181>], allBookies [<Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>].
2020-08-10 23:48:28,212 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@370] - Could not allocate 3 bookies in region region3, try allocating 2 bookies
2020-08-10 23:48:28,212 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.0.0.5:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,213 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 4 and write quorum size 4 : [127.0.0.4:3181, 127.0.0.8:3181, 127.0.0.2:3181, 127.0.0.10:3181]
2020-08-10 23:48:28,213 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@385] - Allocating 2 bookies in region region3 : ensemble [] exclude [<Bookie:127.0.0.4:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.10:3181>]
2020-08-10 23:48:28,214 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@394] - Allocated 2 bookies in region region3 : [<Bookie:127.0.0.4:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,214 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.4:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,215 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,217 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,218 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,219 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,219 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,220 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,220 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,220 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,221 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,221 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,221 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,221 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,221 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,221 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,222 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,223 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,224 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,224 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,224 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,225 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,226 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.2:3181, 127.0.0.4:3181, 127.0.0.3:3181]
2020-08-10 23:48:28,226 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,227 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181]
2020-08-10 23:48:28,227 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,227 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.9:3181, 127.0.0.8:3181, 127.0.0.10:3181]
2020-08-10 23:48:28,228 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.2:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.10:3181>]
2020-08-10 23:48:28,228 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1332] - My region is region4, ensemble : [127.0.0.2:3181, 127.0.0.4:3181, 127.0.0.3:3181, 127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.9:3181, 127.0.0.8:3181, 127.0.0.10:3181]
2020-08-10 23:48:28,233 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,233 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,233 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,234 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,235 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,235 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,235 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1339] - Writable Bookies [127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181], ReadOnly Bookies [127.0.0.8:3181, 127.0.0.9:3181, 127.0.0.10:3181].
2020-08-10 23:48:28,236 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[0,1,2,3,4,5,6,7,8] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,236 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[1,2,3,4,5,6,7,8,0] => WriteSet[3,4,5,6,7,8,1,2,0].
2020-08-10 23:48:28,236 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[2,3,4,5,6,7,8,0,1] => WriteSet[3,4,5,6,7,8,2,0,1].
2020-08-10 23:48:28,237 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[3,4,5,6,7,8,0,1,2] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,238 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[4,5,6,7,8,0,1,2,3] => WriteSet[4,5,3,6,7,8,0,1,2].
2020-08-10 23:48:28,238 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[5,6,7,8,0,1,2,3,4] => WriteSet[5,3,4,6,7,8,0,1,2].
2020-08-10 23:48:28,239 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[6,7,8,0,1,2,3,4,5] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,239 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[7,8,0,1,2,3,4,5,6] => WriteSet[3,4,5,7,8,6,0,1,2].
2020-08-10 23:48:28,240 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[8,0,1,2,3,4,5,6,7] => WriteSet[3,4,5,8,6,7,0,1,2].
2020-08-10 23:48:28,242 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,244 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,244 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,245 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,245 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,246 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,247 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,248 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,252 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,252 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,252 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,253 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,253 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,253 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,253 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,253 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,254 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,254 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,254 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,254 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,254 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,255 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,258 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,258 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,258 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,258 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,258 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,259 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,259 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,259 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,260 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.4:3181, 127.0.0.2:3181, 127.0.0.3:3181]
2020-08-10 23:48:28,260 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,261 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181]
2020-08-10 23:48:28,261 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,262 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.9:3181, 127.0.0.10:3181, 127.0.0.8:3181]
2020-08-10 23:48:28,262 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.4:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.3:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.9:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>]
2020-08-10 23:48:28,263 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1261] - My region is region4, ensemble : [127.0.0.4:3181, 127.0.0.2:3181, 127.0.0.3:3181, 127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181, 127.0.0.9:3181, 127.0.0.10:3181, 127.0.0.8:3181]
2020-08-10 23:48:28,265 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,266 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,267 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,267 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,268 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,268 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,269 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,269 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,269 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,269 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,269 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,270 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,270 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /region4 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,271 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,271 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,271 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,271 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,271 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r3/127.0.0.7:3181
2020-08-10 23:48:28,272 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r1/127.0.0.5:3181
2020-08-10 23:48:28,273 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r2/127.0.0.6:3181
2020-08-10 23:48:28,273 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,273 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,273 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,273 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,273 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.3:3181, 127.0.0.4:3181, 127.0.0.2:3181]
2020-08-10 23:48:28,274 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,274 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.5:3181, 127.0.0.7:3181, 127.0.0.6:3181]
2020-08-10 23:48:28,274 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region4 : excluded [], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,275 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 3 and write quorum size 3 : [127.0.0.10:3181, 127.0.0.8:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,275 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.0.0.3:3181>, <Bookie:127.0.0.4:3181>, <Bookie:127.0.0.2:3181>, <Bookie:127.0.0.5:3181>, <Bookie:127.0.0.7:3181>, <Bookie:127.0.0.6:3181>, <Bookie:127.0.0.10:3181>, <Bookie:127.0.0.8:3181>, <Bookie:127.0.0.9:3181>]
2020-08-10 23:48:28,275 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1332] - My region is region4, ensemble : [127.0.0.3:3181, 127.0.0.4:3181, 127.0.0.2:3181, 127.0.0.5:3181, 127.0.0.7:3181, 127.0.0.6:3181, 127.0.0.10:3181, 127.0.0.8:3181, 127.0.0.9:3181]
2020-08-10 23:48:28,275 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r1/127.0.0.2:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r2/127.0.0.3:3181
2020-08-10 23:48:28,276 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region1/r3/127.0.0.4:3181
2020-08-10 23:48:28,277 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r1/127.0.0.8:3181
2020-08-10 23:48:28,277 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r2/127.0.0.9:3181
2020-08-10 23:48:28,277 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /region3/r3/127.0.0.10:3181
2020-08-10 23:48:28,277 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1339] - Writable Bookies [127.0.0.7:3181, 127.0.0.5:3181, 127.0.0.6:3181], ReadOnly Bookies [127.0.0.8:3181, 127.0.0.9:3181, 127.0.0.10:3181].
2020-08-10 23:48:28,277 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[0,1,2,3,4,5,6,7,8] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,278 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[1,2,3,4,5,6,7,8,0] => WriteSet[3,4,5,6,7,8,1,2,0].
2020-08-10 23:48:28,278 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[2,3,4,5,6,7,8,0,1] => WriteSet[3,4,5,6,7,8,2,0,1].
2020-08-10 23:48:28,278 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[3,4,5,6,7,8,0,1,2] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,278 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[4,5,6,7,8,0,1,2,3] => WriteSet[4,5,3,6,7,8,0,1,2].
2020-08-10 23:48:28,279 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[5,6,7,8,0,1,2,3,4] => WriteSet[5,3,4,6,7,8,0,1,2].
2020-08-10 23:48:28,279 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[6,7,8,0,1,2,3,4,5] => WriteSet[3,4,5,6,7,8,0,1,2].
2020-08-10 23:48:28,279 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[7,8,0,1,2,3,4,5,6] => WriteSet[3,4,5,7,8,6,0,1,2].
2020-08-10 23:48:28,280 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@1355] - Reorder WriteSet[8,0,1,2,3,4,5,6,7] => WriteSet[3,4,5,8,6,7,0,1,2].
2020-08-10 23:48:28,282 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,284 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,284 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,284 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,284 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,285 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,286 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,286 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,286 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,287 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r3/127.1.0.4:3181
2020-08-10 23:48:28,288 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r1/127.1.0.2:3181
2020-08-10 23:48:28,288 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region1/r2/127.1.0.3:3181
2020-08-10 23:48:28,288 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r4/127.1.0.5:3181
2020-08-10 23:48:28,288 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r11/127.1.0.6:3181
2020-08-10 23:48:28,289 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region2/r12/127.1.0.7:3181
2020-08-10 23:48:28,289 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r23/127.1.0.10:3181
2020-08-10 23:48:28,289 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r13/127.1.0.8:3181
2020-08-10 23:48:28,289 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /region3/r14/127.1.0.9:3181
2020-08-10 23:48:28,290 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region1 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.4:3181, 127.1.0.3:3181]
2020-08-10 23:48:28,290 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region2 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.5:3181, 127.1.0.6:3181]
2020-08-10 23:48:28,290 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@365] - Region region3 allocating bookies with ensemble size 2 and write quorum size 2 : [127.1.0.9:3181, 127.1.0.10:3181]
2020-08-10 23:48:28,291 - INFO  - [main:RegionAwareEnsemblePlacementPolicy@417] - Bookies allocated successfully [<Bookie:127.1.0.4:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.10:3181>]
2020-08-10 23:48:28,291 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.3:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,292 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@514] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,292 - WARN  - [main:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], allBookies [<Bookie:127.1.0.7:3181>, <Bookie:127.1.0.6:3181>, <Bookie:127.1.0.5:3181>].
2020-08-10 23:48:28,293 - WARN  - [main:RegionAwareEnsemblePlacementPolicy@532] - Failed to choose a bookie from /region2/r4 : excluded [<Bookie:127.1.0.6:3181>, <Bookie:127.1.0.4:3181>, <Bookie:127.1.0.5:3181>, <Bookie:127.1.0.10:3181>, <Bookie:127.1.0.9:3181>, <Bookie:127.1.0.3:3181>, <Bookie:127.1.0.7:3181>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:48:28,294 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,295 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,296 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,297 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,298 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,298 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,298 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,299 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,299 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,299 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,299 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,299 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,300 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,300 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,300 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,300 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,300 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,301 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,301 - INFO  - [main:NetworkTopologyImpl@498] - Removing a node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,301 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@222] - reorder set : WriteSet[3,1,2,0]
2020-08-10 23:48:28,303 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,305 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,320 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,323 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,324 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,324 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,324 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,325 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,325 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,325 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,325 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,325 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,325 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,325 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,325 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
2020-08-10 23:48:28,326 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,326 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack2/127.0.0.5:3181
2020-08-10 23:48:28,326 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@280] - reorder set : WriteSet[3,1,2,0]
2020-08-10 23:48:28,327 - INFO  - [main:TestRegionAwareEnsemblePlacementPolicy@88] - Set up static DNS Resolver.
2020-08-10 23:48:28,328 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-region/default-rack : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,328 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,329 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.util.StaticDNSResolver.
2020-08-10 23:48:28,329 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,330 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /r1/rack1/127.0.0.2:3181
2020-08-10 23:48:28,330 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,330 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,331 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.3:3181
2020-08-10 23:48:28,331 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /r1/rack1 : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DNSResolverDecorator.
2020-08-10 23:48:28,331 - INFO  - [main:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:48:28,332 - INFO  - [main:NetworkTopologyImpl@426] - Adding a new node: /default-region/default-rack/127.0.0.4:3181
