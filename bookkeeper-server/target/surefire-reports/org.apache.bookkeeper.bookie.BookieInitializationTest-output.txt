2020-08-10 23:29:49,752 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:50,161 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:50,191 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:43179/ledgerstestBookieConnectAfterCookieDelete in 400 ms.
2020-08-10 23:29:50,207 - INFO  - [Time-limited test:MetadataDrivers@105] - BookKeeper metadata driver manager initialized
2020-08-10 23:29:50,241 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43179/ledgers : zkServers = localhost:43179, ledgersRootPath = /ledgers.
2020-08-10 23:29:50,252 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:50,334 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43179/ledgers : zkServers = localhost:43179, ledgersRootPath = /ledgers.
2020-08-10 23:29:50,341 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:50,350 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:50,475 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/BootupTest6828229206289459371test/journal-0/current, /tmp/BootupTest6828229206289459371test/journal-1/current] [/tmp/BootupTest7165997099457531402test/current]
2020-08-10 23:29:51,112 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/BootupTest6828229206289459371test/journal-0/current, /tmp/BootupTest6828229206289459371test/journal-1/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:29:51,125 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:51,147 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/BootupTest7165997099457531402test/current/lastMark.0 (this is okay if it is the first time starting this bookie
2020-08-10 23:29:51,150 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/BootupTest7165997099457531402test/current/lastMark.1 (this is okay if it is the first time starting this bookie
2020-08-10 23:29:51,151 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:51,183 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:51,208 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:51,216 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:51,222 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:51,223 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:51,365 - INFO  - [Time-limited test:ZKRegistrationManager@406] - Removed cookie from /ledgers/cookies for bookie 127.0.0.1:0.
2020-08-10 23:29:51,367 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43179/ledgers : zkServers = localhost:43179, ledgersRootPath = /ledgers.
2020-08-10 23:29:51,375 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:51,381 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:51,398 - ERROR - [Time-limited test:Bookie@476] - Cookie for this bookie is not stored in metadata store. Bookie failing to come up
2020-08-10 23:29:51,398 - INFO  - [Time-limited test:BookieInitializationTest@1576] - As expected Bookie fails to come up without a cookie in metadata store.
2020-08-10 23:29:51,505 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:29:51,625 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 120 ms.
2020-08-10 23:29:51,631 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:51,656 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:51,664 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile in 32 ms.
2020-08-10 23:29:51,696 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "diskCheckInterval" : "1000",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:29:51,714 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:29:51,856 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile : zkServers = localhost:46867, ledgersRootPath = /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile.
2020-08-10 23:29:51,870 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:51,876 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:51,898 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/DiskCheck2223097718222670685test/current] [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:51,920 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:51,923 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck2223097718222670685test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:51,924 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:51,926 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:51,927 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:51,929 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:51,929 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:51,930 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:51,981 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 2 ms.
2020-08-10 23:29:51,986 - INFO  - [SyncThread-14-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:29:51,991 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:51,997 - INFO  - [BookieJournal-35629:Journal@909] - Starting journal on /tmp/DiskCheck2223097718222670685test/current
2020-08-10 23:29:52,004 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:52,012 - INFO  - [BookieJournal-35629:JournalChannel@157] - Opening journal /tmp/DiskCheck2223097718222670685test/current/173da479884.txn
2020-08-10 23:29:52,320 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile : zkServers = localhost:46867, ledgersRootPath = /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile.
2020-08-10 23:29:52,328 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:52,350 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:29:52,355 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:29:52,356 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:29:52,359 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:29:52,386 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35629
2020-08-10 23:29:52,486 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:35629] for ledger: 0
2020-08-10 23:29:52,556 - INFO  - [bookie-io-8-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:29:52,558 - INFO  - [bookkeeper-io-21-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x56fd15f3, L:/127.0.0.1:52878 - R:127.0.0.1/127.0.0.1:35629]
2020-08-10 23:29:52,559 - INFO  - [bookkeeper-io-21-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35629
2020-08-10 23:29:52,558 - INFO  - [bookie-io-8-2:BookieRequestHandler@50] - Channel connected  [id: 0xee2fc7f3, L:/127.0.0.1:35629 - R:/127.0.0.1:52878]
2020-08-10 23:29:52,584 - INFO  - [bookkeeper-io-21-1:PerChannelBookieClient$1@471] - connection [id: 0x56fd15f3, L:/127.0.0.1:52878 - R:127.0.0.1/127.0.0.1:35629] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:29:52,688 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:52,689 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:52,691 - WARN  - [bookkeeper-io-21-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x56fd15f3, L:/127.0.0.1:52878 - R:127.0.0.1/127.0.0.1:35629] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:29:52,692 - INFO  - [bookie-io-8-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xee2fc7f3, L:/127.0.0.1:35629 ! R:/127.0.0.1:52878]
2020-08-10 23:29:52,693 - INFO  - [bookkeeper-io-21-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x56fd15f3, L:/127.0.0.1:52878 ! R:127.0.0.1/127.0.0.1:35629]
2020-08-10 23:29:52,710 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "35629",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile",
  "minUsableSizeForIndexFileCreation" : "9223372036854775807",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:29:52,722 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile : zkServers = localhost:46867, ledgersRootPath = /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile.
2020-08-10 23:29:52,733 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:52,739 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:52,753 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:52,756 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513690624, Used space fraction: 0.847143 > threshold 0.001.
2020-08-10 23:29:52,757 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck2223097718222670685test/current is out of space. Adding it to filled dirs list
2020-08-10 23:29:52,758 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:29:52,758 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:52,762 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:52,770 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:52,774 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:52,777 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:52,777 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:52,778 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35629
2020-08-10 23:29:52,795 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597094992004 from position 0
2020-08-10 23:29:52,798 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck2223097718222670685test/current/173da479884.txn
2020-08-10 23:29:52,800 - ERROR - [Time-limited test:LedgerDirsManager@206] - All ledger directories are non writable and no reserved space (9223372036854775807) left.
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:204)
	at org.apache.bookkeeper.bookie.LedgerDirsManager.pickRandomWritableDirForNewIndexFile(LedgerDirsManager.java:313)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.getNewLedgerIndexFile(IndexPersistenceMgr.java:235)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.createFileInfoBackingFile(IndexPersistenceMgr.java:152)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.loadFileInfo(FileInfoBackingCache.java:76)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.lambda$getFileInfo$2(IndexPersistenceMgr.java:185)
	at com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:5065)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3716)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2424)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2298)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2211)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4154)
	at com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:5060)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.getFileInfo(IndexPersistenceMgr.java:191)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.setMasterKey(IndexPersistenceMgr.java:417)
	at org.apache.bookkeeper.bookie.LedgerCacheImpl.setMasterKey(LedgerCacheImpl.java:174)
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.setMasterKey(InterleavedLedgerStorage.java:321)
	at org.apache.bookkeeper.bookie.SortedLedgerStorage.setMasterKey(SortedLedgerStorage.java:166)
	at org.apache.bookkeeper.bookie.LedgerDescriptor.create(LedgerDescriptor.java:44)
	at org.apache.bookkeeper.bookie.HandleFactoryImpl.getHandle(HandleFactoryImpl.java:48)
	at org.apache.bookkeeper.bookie.Bookie$4.process(Bookie.java:829)
	at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:836)
	at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932)
	at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:898)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:952)
	at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:144)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testWithDiskFullAndAbilityToCreateNewIndexFile(BookieInitializationTest.java:1088)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:29:52,807 - ERROR - [Time-limited test:Bookie@954] - Exception while replaying journals, shutting down
org.apache.bookkeeper.bookie.LedgerDirsManager$NoWritableLedgerDirException: All ledger directories are non writable and no reserved space (9223372036854775807) left.
	at org.apache.bookkeeper.bookie.LedgerDirsManager.getDirsAboveUsableThresholdSize(LedgerDirsManager.java:204)
	at org.apache.bookkeeper.bookie.LedgerDirsManager.pickRandomWritableDirForNewIndexFile(LedgerDirsManager.java:313)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.getNewLedgerIndexFile(IndexPersistenceMgr.java:235)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.createFileInfoBackingFile(IndexPersistenceMgr.java:152)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.loadFileInfo(FileInfoBackingCache.java:76)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.lambda$getFileInfo$2(IndexPersistenceMgr.java:185)
	at com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:5065)
	at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3716)
	at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2424)
	at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2298)
	at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2211)
	at com.google.common.cache.LocalCache.get(LocalCache.java:4154)
	at com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:5060)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.getFileInfo(IndexPersistenceMgr.java:191)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.setMasterKey(IndexPersistenceMgr.java:417)
	at org.apache.bookkeeper.bookie.LedgerCacheImpl.setMasterKey(LedgerCacheImpl.java:174)
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.setMasterKey(InterleavedLedgerStorage.java:321)
	at org.apache.bookkeeper.bookie.SortedLedgerStorage.setMasterKey(SortedLedgerStorage.java:166)
	at org.apache.bookkeeper.bookie.LedgerDescriptor.create(LedgerDescriptor.java:44)
	at org.apache.bookkeeper.bookie.HandleFactoryImpl.getHandle(HandleFactoryImpl.java:48)
	at org.apache.bookkeeper.bookie.Bookie$4.process(Bookie.java:829)
	at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:836)
	at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932)
	at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:898)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:952)
	at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:144)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testWithDiskFullAndAbilityToCreateNewIndexFile(BookieInitializationTest.java:1088)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:29:52,921 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:52,922 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:52,939 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "35629",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck2223097718222670685test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:29:52,944 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:46867/ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile : zkServers = localhost:46867, ledgersRootPath = /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile.
2020-08-10 23:29:52,951 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:52,963 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:52,977 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:52,980 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513674240, Used space fraction: 0.847144 > threshold 0.001.
2020-08-10 23:29:52,981 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck2223097718222670685test/current is out of space. Adding it to filled dirs list
2020-08-10 23:29:52,981 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:29:52,982 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:52,983 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:52,984 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:52,987 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:52,988 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:52,988 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:53,002 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile/available/127.0.0.1:35629 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile/available/127.0.0.1:35629
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:29:53,010 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597094992004 from position 0
2020-08-10 23:29:53,011 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck2223097718222670685test/current/173da479884.txn
2020-08-10 23:29:53,011 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:53,018 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 8 ms.
2020-08-10 23:29:53,020 - INFO  - [SyncThread-40-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:29:53,021 - INFO  - [SyncThread-40-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:53,025 - INFO  - [SyncThread-40-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck2223097718222670685test/current/0.log for logId 0.
2020-08-10 23:29:53,028 - INFO  - [pool-34-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck2223097718222670685test/current/1.log for logId 1.
2020-08-10 23:29:53,029 - INFO  - [SyncThread-40-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:53,030 - INFO  - [SyncThread-40-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:53,039 - INFO  - [SyncThread-40-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094992004 , logFileOffset - 3588]}.
2020-08-10 23:29:53,040 - INFO  - [SyncThread-40-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:53,044 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:53,045 - INFO  - [BookieJournal-35629:Journal@909] - Starting journal on /tmp/DiskCheck2223097718222670685test/current
2020-08-10 23:29:53,046 - INFO  - [BookieJournal-35629:JournalChannel@157] - Opening journal /tmp/DiskCheck2223097718222670685test/current/173da479885.txn
2020-08-10 23:29:53,047 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:53,053 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile/available/127.0.0.1:35629 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestWithDiskFullAndAbilityToCreateNewIndexFile/available/127.0.0.1:35629
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:29:53,797 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:53,798 - INFO  - [LedgerDirsMonitorThread:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: LedgerDirsMonitorThread
2020-08-10 23:29:53,801 - INFO  - [GarbageCollectorThread-31-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:29:53,802 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513620992, Used space fraction: 0.8471472 > threshold 0.001.
2020-08-10 23:29:54,020 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:54,021 - INFO  - [LedgerDirsMonitorThread:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: LedgerDirsMonitorThread
2020-08-10 23:29:54,024 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513620992, Used space fraction: 0.8471472 > threshold 0.001.
2020-08-10 23:29:54,024 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:29:54,430 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:29:54,431 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.800000011920929
2020-08-10 23:29:54,434 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:29:54,434 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@368] - GarbageCollectorThread-41-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:29:54,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:54,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513620992, Used space fraction: 0.8471472 > threshold 0.001.
2020-08-10 23:29:55,010 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:55,010 - INFO  - [LedgerDirsMonitorThread:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: LedgerDirsMonitorThread
2020-08-10 23:29:55,011 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:29:55,012 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513620992, Used space fraction: 0.8471472 > threshold 0.001.
2020-08-10 23:29:55,020 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:29:55,020 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.800000011920929
2020-08-10 23:29:55,021 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:29:55,021 - INFO  - [GarbageCollectorThread-41-1:GarbageCollectorThread@368] - GarbageCollectorThread-41-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:29:55,406 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:55,407 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:55,430 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35629 with exitCode 0
2020-08-10 23:29:55,430 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:29:55,430 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:29:55,431 - INFO  - [SyncThread-40-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094992004 , logFileOffset - 3588]}.
2020-08-10 23:29:55,431 - INFO  - [SyncThread-40-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck2223097718222670685test/current]
2020-08-10 23:29:55,435 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:29:55,437 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:29:55,438 - INFO  - [BookieJournal-35629:Journal@1135] - Journal exits when shutting down
2020-08-10 23:29:55,438 - INFO  - [BookieJournal-35629:Journal@1144] - Journal exited loop!
2020-08-10 23:29:55,439 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:29:55,439 - INFO  - [Bookie-35629:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:29:55,440 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:29:55,440 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:29:55,440 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:29:55,441 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:29:55,441 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:29:55,449 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:29:55,460 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:29:55,460 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:29:55,571 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35629
2020-08-10 23:29:55,693 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:29:55,801 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:55,805 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513620992, Used space fraction: 0.8471472 > threshold 0.001.
2020-08-10 23:29:55,813 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:29:55,816 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:55,835 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:55,842 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:42187/ledgerstestBookieRegistrationWithFQDNHostNameAsBookieID in 25 ms.
2020-08-10 23:29:55,849 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42187/ledgerstestBookieRegistrationWithFQDNHostNameAsBookieID : zkServers = localhost:42187, ledgersRootPath = /ledgerstestBookieRegistrationWithFQDNHostNameAsBookieID.
2020-08-10 23:29:55,856 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:55,908 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:29:55,974 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:29:56,087 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 112 ms.
2020-08-10 23:29:56,091 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:56,108 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:56,119 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:33791/ledgerstestReadLatestBookieStatus in 26 ms.
2020-08-10 23:29:56,156 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "[/tmp/bookie16337827098271768291test0, /tmp/bookie241817209834165148test1, /tmp/bookie14539875629877483203test2]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:33791/ledgerstestReadLatestBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie16337827098271768291test0",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:29:56,165 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33791/ledgerstestReadLatestBookieStatus : zkServers = localhost:33791, ledgersRootPath = /ledgerstestReadLatestBookieStatus.
2020-08-10 23:29:56,177 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:56,183 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:56,195 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie16337827098271768291test0/current] [/tmp/bookie16337827098271768291test0/current, /tmp/bookie241817209834165148test1/current, /tmp/bookie14539875629877483203test2/current]
2020-08-10 23:29:56,210 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie16337827098271768291test0/current, /tmp/bookie241817209834165148test1/current, /tmp/bookie14539875629877483203test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:29:56,216 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:56,219 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie16337827098271768291test0/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:56,221 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie241817209834165148test1/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:56,221 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14539875629877483203test2/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:56,222 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:56,222 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:56,224 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:56,226 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:56,228 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:56,228 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:56,252 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:29:56,253 - INFO  - [SyncThread-50-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:29:56,265 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:56,266 - INFO  - [BookieJournal-43159:Journal@909] - Starting journal on /tmp/bookie16337827098271768291test0/current
2020-08-10 23:29:56,266 - WARN  - [Time-limited test:BookieStatus@165] - Failed to retrieve bookie status from disks. Fall back to current or default bookie status: READ_WRITE
2020-08-10 23:29:56,267 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:56,267 - INFO  - [BookieJournal-43159:JournalChannel@157] - Opening journal /tmp/bookie16337827098271768291test0/current/173da47a92c.txn
2020-08-10 23:29:56,435 - INFO  - [BookieDeathWatcher-35629:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:29:56,436 - INFO  - [BookieDeathWatcher-35629:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35629
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:29:56,438 - INFO  - [BookieDeathWatcher-35629:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:56,439 - INFO  - [BookieDeathWatcher-35629:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:56,527 - INFO  - [Time-limited test:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:29:56,528 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_ONLY
2020-08-10 23:29:56,542 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_WRITE
2020-08-10 23:29:56,542 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:56,543 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:56,553 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43159 with exitCode 0
2020-08-10 23:29:56,553 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:29:56,553 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:29:56,554 - INFO  - [SyncThread-50-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:29:56,566 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:29:56,568 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:29:56,568 - INFO  - [BookieJournal-43159:Journal@1135] - Journal exits when shutting down
2020-08-10 23:29:56,568 - INFO  - [BookieJournal-43159:Journal@1144] - Journal exited loop!
2020-08-10 23:29:56,569 - INFO  - [Bookie-43159:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:29:56,569 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:29:56,570 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:29:56,570 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:29:56,571 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:29:56,571 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:29:56,571 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:29:56,571 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:29:56,572 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:29:56,572 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:29:56,681 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "43159",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "[/tmp/bookie16337827098271768291test0, /tmp/bookie241817209834165148test1, /tmp/bookie14539875629877483203test2]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:33791/ledgerstestReadLatestBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie16337827098271768291test0",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:29:56,687 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33791/ledgerstestReadLatestBookieStatus : zkServers = localhost:33791, ledgersRootPath = /ledgerstestReadLatestBookieStatus.
2020-08-10 23:29:56,695 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:56,703 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:29:56,717 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie16337827098271768291test0/current, /tmp/bookie241817209834165148test1/current, /tmp/bookie14539875629877483203test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:29:56,721 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:29:56,723 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:56,724 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:56,725 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:56,727 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:56,728 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:56,728 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:56,773 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597094996268 from position 0
2020-08-10 23:29:56,774 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie16337827098271768291test0/current/173da47a92c.txn
2020-08-10 23:29:56,775 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:29:56,776 - INFO  - [SyncThread-60-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094996268 , logFileOffset - 516]}.
2020-08-10 23:29:56,789 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:56,790 - INFO  - [BookieJournal-43159:Journal@909] - Starting journal on /tmp/bookie16337827098271768291test0/current
2020-08-10 23:29:56,791 - INFO  - [Time-limited test:BookieStatus@163] - Successfully retrieve bookie status READ_WRITE from disks.
2020-08-10 23:29:56,791 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:56,791 - INFO  - [BookieJournal-43159:JournalChannel@157] - Opening journal /tmp/bookie16337827098271768291test0/current/173da47a92d.txn
2020-08-10 23:29:56,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:56,796 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513567744, Used space fraction: 0.84715044 > threshold 0.001.
2020-08-10 23:29:57,051 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:57,051 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:57,061 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43159 with exitCode 0
2020-08-10 23:29:57,062 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:29:57,062 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:29:57,062 - INFO  - [SyncThread-60-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094996268 , logFileOffset - 516]}.
2020-08-10 23:29:57,073 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:29:57,074 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:29:57,074 - INFO  - [BookieJournal-43159:Journal@1135] - Journal exits when shutting down
2020-08-10 23:29:57,074 - INFO  - [BookieJournal-43159:Journal@1144] - Journal exited loop!
2020-08-10 23:29:57,075 - INFO  - [Bookie-43159:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:29:57,075 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:29:57,076 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:29:57,076 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:29:57,076 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:29:57,077 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:29:57,077 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:29:57,077 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:29:57,078 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:29:57,078 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:29:57,189 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:29:57,279 - INFO  - [BookieDeathWatcher-43159:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:29:57,280 - INFO  - [BookieDeathWatcher-43159:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43159
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:29:57,281 - INFO  - [BookieDeathWatcher-43159:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:57,281 - INFO  - [BookieDeathWatcher-43159:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:57,304 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 114 ms.
2020-08-10 23:29:57,306 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:57,325 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:57,333 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44371/ledgerstestBookieServerStartupOnEphemeralPorts in 25 ms.
2020-08-10 23:29:57,339 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie18402245888194000232test1",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie18402245888194000232test1",
  "allowLoopback" : "true"
}
2020-08-10 23:29:57,345 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie18402245888194000232test1/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:57,346 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:57,346 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:57,346 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:57,348 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:57,350 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:57,350 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:57,374 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:29:57,376 - INFO  - [SyncThread-67-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:29:57,380 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:57,381 - INFO  - [BookieJournal-40559:Journal@909] - Starting journal on /tmp/bookie18402245888194000232test1/current
2020-08-10 23:29:57,382 - INFO  - [BookieJournal-40559:JournalChannel@157] - Opening journal /tmp/bookie18402245888194000232test1/current/173da47ad87.txn
2020-08-10 23:29:57,383 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:57,383 - INFO  - [BookieStateManagerService-0:BookieStateManager@266] - null registration manager while do register
2020-08-10 23:29:57,638 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie1230357155260178406test2",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie1230357155260178406test2",
  "allowLoopback" : "true"
}
2020-08-10 23:29:57,645 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1230357155260178406test2/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:29:57,645 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:29:57,646 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:29:57,646 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:29:57,649 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:29:57,649 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:29:57,649 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:29:57,660 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:29:57,664 - INFO  - [SyncThread-74-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:29:57,668 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:29:57,676 - INFO  - [BookieStateManagerService-0:BookieStateManager@266] - null registration manager while do register
2020-08-10 23:29:57,676 - INFO  - [BookieJournal-44347:Journal@909] - Starting journal on /tmp/bookie1230357155260178406test2/current
2020-08-10 23:29:57,677 - INFO  - [BookieJournal-44347:JournalChannel@157] - Opening journal /tmp/bookie1230357155260178406test2/current/173da47aeae.txn
2020-08-10 23:29:57,678 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:29:57,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:57,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513588224, Used space fraction: 0.8471492 > threshold 0.001.
2020-08-10 23:29:57,799 - INFO  - [BookieDeathWatcher-43159:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:29:57,800 - INFO  - [BookieDeathWatcher-43159:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43159
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:29:57,801 - INFO  - [BookieDeathWatcher-43159:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:29:57,801 - INFO  - [BookieDeathWatcher-43159:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:29:57,929 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:29:58,042 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 113 ms.
2020-08-10 23:29:58,045 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:29:58,069 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:58,079 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44429/ledgerstestBookieRegistration in 33 ms.
2020-08-10 23:29:58,085 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44429/ledgerstestBookieRegistration : zkServers = localhost:44429, ledgersRootPath = /ledgerstestBookieRegistration.
2020-08-10 23:29:58,103 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:58,119 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44429/ledgerstestBookieRegistration : zkServers = localhost:44429, ledgersRootPath = /ledgerstestBookieRegistration.
2020-08-10 23:29:58,125 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:58,135 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:29:58,140 - INFO  - [BookieStateManagerService-0:ZKRegistrationManager@194] - Previous bookie registration znode: /ledgerstestBookieRegistration/available/127.0.1.1:0 exists, so waiting zk sessiontimeout: 10000 ms for znode deletion
2020-08-10 23:29:58,801 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:58,803 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513580032, Used space fraction: 0.8471497 > threshold 0.001.
2020-08-10 23:29:59,797 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:29:59,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513580032, Used space fraction: 0.8471497 > threshold 0.001.
2020-08-10 23:30:00,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:00,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513580032, Used space fraction: 0.8471497 > threshold 0.001.
2020-08-10 23:30:01,798 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:01,800 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513580032, Used space fraction: 0.8471497 > threshold 0.001.
2020-08-10 23:30:01,816 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:01,928 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 112 ms.
2020-08-10 23:30:01,931 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:01,952 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:01,961 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:46803/ledgerstestWithDiskError in 29 ms.
2020-08-10 23:30:01,966 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:02,078 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 111 ms.
2020-08-10 23:30:02,080 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:02,103 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:02,113 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:34157/ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed in 31 ms.
2020-08-10 23:30:02,119 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34157/ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed : zkServers = localhost:34157, ledgersRootPath = /ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed.
2020-08-10 23:30:02,128 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:02,133 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:02,142 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/DiskCheck8054803617689878648test/current] [/tmp/DiskCheck8054803617689878648test/current]
2020-08-10 23:30:02,161 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:02,164 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck8054803617689878648test/current : 2513567744, Used space fraction: 0.84715044 > threshold 0.8463028.
2020-08-10 23:30:02,165 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck8054803617689878648test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:02,165 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck8054803617689878648test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:02,166 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:02,166 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:02,166 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:02,167 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:02,169 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:02,170 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:02,171 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:02,172 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:02,173 - INFO  - [SyncThread-83-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:02,174 - INFO  - [SyncThread-83-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck8054803617689878648test/current]
2020-08-10 23:30:02,178 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:02,180 - INFO  - [BookieJournal-0:Journal@909] - Starting journal on /tmp/DiskCheck8054803617689878648test/current
2020-08-10 23:30:02,181 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed/available/127.0.0.1:0 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed/available/127.0.0.1:0
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:02,181 - INFO  - [BookieJournal-0:JournalChannel@157] - Opening journal /tmp/DiskCheck8054803617689878648test/current/173da47c046.txn
2020-08-10 23:30:02,181 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:02,188 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed/available/127.0.0.1:0 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestWithDiskFullReadOnlyEnabledAndForceGCAllowAllowed/available/127.0.0.1:0
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:02,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:02,799 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513555456, Used space fraction: 0.8471512 > threshold 0.001.
2020-08-10 23:30:03,172 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:03,173 - INFO  - [LedgerDirsMonitorThread:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: LedgerDirsMonitorThread
2020-08-10 23:30:03,174 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:30:03,176 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck8054803617689878648test/current : 2513555456, Used space fraction: 0.8471512 > threshold 0.8463028.
2020-08-10 23:30:03,179 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:30:03,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.800000011920929
2020-08-10 23:30:03,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:30:03,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@368] - GarbageCollectorThread-84-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:30:03,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:03,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513555456, Used space fraction: 0.8471512 > threshold 0.001.
2020-08-10 23:30:04,173 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:04,173 - INFO  - [LedgerDirsMonitorThread:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: LedgerDirsMonitorThread
2020-08-10 23:30:04,174 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:30:04,175 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck8054803617689878648test/current : 2513555456, Used space fraction: 0.8471512 > threshold 0.8463028.
2020-08-10 23:30:04,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:30:04,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.800000011920929
2020-08-10 23:30:04,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:30:04,180 - INFO  - [GarbageCollectorThread-84-1:GarbageCollectorThread@368] - GarbageCollectorThread-84-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:30:04,291 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-0 with exitCode 0
2020-08-10 23:30:04,291 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:04,291 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:04,291 - INFO  - [SyncThread-83-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:04,292 - INFO  - [SyncThread-83-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck8054803617689878648test/current]
2020-08-10 23:30:04,299 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:04,300 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:04,302 - INFO  - [BookieJournal-0:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:04,302 - INFO  - [BookieJournal-0:Journal@1144] - Journal exited loop!
2020-08-10 23:30:04,303 - INFO  - [Bookie-0:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:04,304 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:04,305 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:04,305 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:04,305 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:04,306 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:04,306 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:04,306 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:04,307 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:04,307 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:04,413 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:04,529 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 115 ms.
2020-08-10 23:30:04,531 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:04,547 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:04,556 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:36545/ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled in 24 ms.
2020-08-10 23:30:04,563 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36545/ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled : zkServers = localhost:36545, ledgersRootPath = /ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled.
2020-08-10 23:30:04,569 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:04,573 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:04,585 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/DiskCheck5444381722669012984test/current] [/tmp/DiskCheck5444381722669012984test/current]
2020-08-10 23:30:04,608 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:04,610 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck5444381722669012984test/current : 2513551360, Used space fraction: 0.84715146 > threshold 0.84630376.
2020-08-10 23:30:04,611 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck5444381722669012984test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:04,612 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36545/ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled : zkServers = localhost:36545, ledgersRootPath = /ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled.
2020-08-10 23:30:04,618 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:04,624 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:04,636 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:04,638 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck5444381722669012984test/current : 2513551360, Used space fraction: 0.84715146 > threshold 0.84630376.
2020-08-10 23:30:04,638 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck5444381722669012984test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:04,639 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36545/ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled : zkServers = localhost:36545, ledgersRootPath = /ledgerstestWithDiskFullReadOnlyDisabledOrForceGCAllowDisabled.
2020-08-10 23:30:04,645 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:04,648 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:04,660 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:04,663 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck5444381722669012984test/current : 2513551360, Used space fraction: 0.84715146 > threshold 0.84630376.
2020-08-10 23:30:04,663 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck5444381722669012984test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:04,664 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck5444381722669012984test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:04,664 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:04,664 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:04,665 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:04,666 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:04,668 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:04,669 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:04,670 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:04,775 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:04,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:04,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513551360, Used space fraction: 0.84715146 > threshold 0.001.
2020-08-10 23:30:04,889 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 113 ms.
2020-08-10 23:30:04,892 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:04,913 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:04,924 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:38253/ledgerstestNegativeLengthEntryBookieShutdown in 31 ms.
2020-08-10 23:30:04,932 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie9021553742738583291journal/current/173da47cb04.txn
2020-08-10 23:30:04,969 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7553785948443028549ledger/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:04,969 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:04,970 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:04,971 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:04,975 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:04,976 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:04,976 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:04,977 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095004932 from position 0
2020-08-10 23:30:04,977 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie9021553742738583291journal/current/173da47cb04.txn
2020-08-10 23:30:04,977 - ERROR - [Time-limited test:Journal@820] - Invalid record found with negative length: -1
2020-08-10 23:30:04,978 - ERROR - [Time-limited test:Bookie@954] - Exception while replaying journals, shutting down
java.io.IOException: Invalid record found with negative length -1
	at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:821)
	at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932)
	at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:898)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:952)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testNegativeLengthEntryBookieShutdown(BookieInitializationTest.java:819)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:04,978 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:04,985 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:04,985 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:05,095 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 117 ms.
2020-08-10 23:30:05,097 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:05,117 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:05,124 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44725/ledgerstestExitCodeZK_REG_FAIL in 26 ms.
2020-08-10 23:30:05,189 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie1343494355946086344test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44725/ledgerstestExitCodeZK_REG_FAIL",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie1343494355946086344test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:05,194 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44725/ledgerstestExitCodeZK_REG_FAIL : zkServers = localhost:44725, ledgersRootPath = /ledgerstestExitCodeZK_REG_FAIL.
2020-08-10 23:30:05,201 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:05,206 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:05,214 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1343494355946086344test/current] [/tmp/bookie1343494355946086344test/current]
2020-08-10 23:30:05,231 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:05,233 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1343494355946086344test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:05,233 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:05,234 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:05,234 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:05,236 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:05,237 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:05,237 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:05,266 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:05,267 - INFO  - [SyncThread-105-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:05,272 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:05,276 - INFO  - [BookieJournal-37209:Journal@909] - Starting journal on /tmp/bookie1343494355946086344test/current
2020-08-10 23:30:05,277 - INFO  - [BookieJournal-37209:JournalChannel@157] - Opening journal /tmp/bookie1343494355946086344test/current/173da47cc5e.txn
2020-08-10 23:30:05,287 - ERROR - [Time-limited test:Bookie@1021] - Couldn't register bookie with zookeeper, shutting down : 
java.util.concurrent.ExecutionException: java.io.IOException: org.apache.bookkeeper.bookie.BookieException$MetadataStoreException: mocked exception
	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:1019)
	at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:144)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testExitCodeZK_REG_FAIL(BookieInitializationTest.java:318)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.io.IOException: org.apache.bookkeeper.bookie.BookieException$MetadataStoreException: mocked exception
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:275)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: org.apache.bookkeeper.bookie.BookieException$MetadataStoreException: mocked exception
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	... 7 more
2020-08-10 23:30:05,289 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37209 with exitCode 4
2020-08-10 23:30:05,290 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:05,290 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:05,290 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:05,290 - INFO  - [SyncThread-105-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:05,296 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:05,296 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:05,297 - INFO  - [BookieJournal-37209:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:05,297 - INFO  - [BookieJournal-37209:Journal@1144] - Journal exited loop!
2020-08-10 23:30:05,297 - INFO  - [Bookie-37209:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:05,297 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:05,299 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:05,299 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:05,299 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:05,300 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:05,300 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:05,300 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:05,301 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:05,301 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:05,410 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:05,524 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 112 ms.
2020-08-10 23:30:05,526 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:05,545 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:05,553 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:41373/ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted in 26 ms.
2020-08-10 23:30:05,559 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "[/tmp/bookie11702090169847388423test0, /tmp/bookie14299591791267330847test1, /tmp/bookie13126660467513498031test2]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:41373/ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie11702090169847388423test0",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:05,597 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41373/ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted : zkServers = localhost:41373, ledgersRootPath = /ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted.
2020-08-10 23:30:05,610 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:05,615 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:05,630 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie11702090169847388423test0/current] [/tmp/bookie11702090169847388423test0/current, /tmp/bookie14299591791267330847test1/current, /tmp/bookie13126660467513498031test2/current]
2020-08-10 23:30:05,641 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie11702090169847388423test0/current, /tmp/bookie14299591791267330847test1/current, /tmp/bookie13126660467513498031test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:05,648 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:05,650 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie11702090169847388423test0/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:05,650 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14299591791267330847test1/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:05,651 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie13126660467513498031test2/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:05,651 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:05,652 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:05,653 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:05,654 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:05,655 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:05,655 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:05,664 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:05,665 - INFO  - [SyncThread-115-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:05,677 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:05,679 - INFO  - [BookieJournal-40151:Journal@909] - Starting journal on /tmp/bookie11702090169847388423test0/current
2020-08-10 23:30:05,679 - WARN  - [Time-limited test:BookieStatus@165] - Failed to retrieve bookie status from disks. Fall back to current or default bookie status: READ_WRITE
2020-08-10 23:30:05,681 - INFO  - [BookieJournal-40151:JournalChannel@157] - Opening journal /tmp/bookie11702090169847388423test0/current/173da47cdf2.txn
2020-08-10 23:30:05,684 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:05,798 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:05,799 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513473536, Used space fraction: 0.84715617 > threshold 0.001.
2020-08-10 23:30:05,940 - INFO  - [Time-limited test:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:05,940 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_ONLY
2020-08-10 23:30:05,951 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:05,951 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:05,962 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40151 with exitCode 0
2020-08-10 23:30:05,963 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:05,963 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:05,963 - INFO  - [SyncThread-115-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:05,975 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:05,976 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:05,976 - INFO  - [BookieJournal-40151:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:05,977 - INFO  - [BookieJournal-40151:Journal@1144] - Journal exited loop!
2020-08-10 23:30:05,977 - INFO  - [Bookie-40151:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:05,977 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:05,979 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:05,979 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:05,979 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:05,979 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:05,980 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:05,980 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:05,980 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:05,980 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:06,092 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "40151",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "[/tmp/bookie11702090169847388423test0, /tmp/bookie14299591791267330847test1, /tmp/bookie13126660467513498031test2]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:41373/ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie11702090169847388423test0",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:06,098 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41373/ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted : zkServers = localhost:41373, ledgersRootPath = /ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted.
2020-08-10 23:30:06,104 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:06,109 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:06,126 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie11702090169847388423test0/current, /tmp/bookie14299591791267330847test1/current, /tmp/bookie13126660467513498031test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:06,128 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:06,131 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:06,131 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:06,132 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:06,134 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:06,134 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:06,134 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:06,147 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095005682 from position 0
2020-08-10 23:30:06,147 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie11702090169847388423test0/current/173da47cdf2.txn
2020-08-10 23:30:06,148 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:06,148 - INFO  - [SyncThread-125-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095005682 , logFileOffset - 516]}.
2020-08-10 23:30:06,159 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:06,165 - INFO  - [BookieJournal-40151:Journal@909] - Starting journal on /tmp/bookie11702090169847388423test0/current
2020-08-10 23:30:06,167 - INFO  - [BookieJournal-40151:JournalChannel@157] - Opening journal /tmp/bookie11702090169847388423test0/current/173da47cdf3.txn
2020-08-10 23:30:06,167 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:06,170 - WARN  - [Time-limited test:BookieStatus@158] - IllegalArgumentException while trying to read bookie status from directory /tmp/bookie11702090169847388423test0/current. This is fine if not all directories failed.
2020-08-10 23:30:06,170 - WARN  - [Time-limited test:BookieStatus@158] - IllegalArgumentException while trying to read bookie status from directory /tmp/bookie14299591791267330847test1/current. This is fine if not all directories failed.
2020-08-10 23:30:06,171 - INFO  - [Time-limited test:BookieStatus@163] - Successfully retrieve bookie status READ_ONLY from disks.
2020-08-10 23:30:06,183 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted/available/127.0.0.1:40151 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestRetrieveBookieStatusWhenStatusFileIsCorrupted/available/127.0.0.1:40151
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:06,436 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:06,438 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:06,448 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40151 with exitCode 0
2020-08-10 23:30:06,449 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:06,449 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:06,449 - INFO  - [SyncThread-125-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095005682 , logFileOffset - 516]}.
2020-08-10 23:30:06,460 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:06,461 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:06,462 - INFO  - [BookieJournal-40151:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:06,462 - INFO  - [BookieJournal-40151:Journal@1144] - Journal exited loop!
2020-08-10 23:30:06,462 - INFO  - [Bookie-40151:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:06,462 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:06,463 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:06,464 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:06,465 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:06,576 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:06,690 - INFO  - [BookieDeathWatcher-40151:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:06,691 - INFO  - [BookieDeathWatcher-40151:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40151
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:06,691 - INFO  - [BookieDeathWatcher-40151:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:06,691 - INFO  - [BookieDeathWatcher-40151:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:06,694 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 117 ms.
2020-08-10 23:30:06,697 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:06,722 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:06,729 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled in 30 ms.
2020-08-10 23:30:06,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:06,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513489920, Used space fraction: 0.8471552 > threshold 0.001.
2020-08-10 23:30:06,842 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "indexDirectories" : "/tmp/bookie15194639762939230134test",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15000",
  "allowEphemeralPorts" : "true",
  "zkTimeout" : "5000",
  "ledgerDirectories" : "[/tmp/bookie15194639762939230134test, /tmp/bookie6940901788940774016test]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie15194639762939230134test",
  "allowLoopback" : "true",
  "allowMultipleDirsUnderSameDiskPartition" : "false"
}
2020-08-10 23:30:06,849 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled : zkServers = localhost:37261, ledgersRootPath = /ledgerstestAllowDiskPartitionDuplicationDisabled.
2020-08-10 23:30:06,856 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:06,860 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:06,868 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie15194639762939230134test/current] [/tmp/bookie15194639762939230134test/current, /tmp/bookie6940901788940774016test/current, /tmp/bookie15194639762939230134test/current]
2020-08-10 23:30:06,881 - ERROR - [Time-limited test:Bookie@295] - Dirs: [/tmp/bookie15194639762939230134test/current, /tmp/bookie6940901788940774016test/current, /tmp/bookie15194639762939230134test/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:06,882 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:06,989 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "indexDirectories" : "[/tmp/bookie6557264886428737438test, /tmp/bookie13106374406250175875test]",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15001",
  "allowEphemeralPorts" : "true",
  "zkTimeout" : "5000",
  "ledgerDirectories" : "/tmp/bookie6557264886428737438test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie6557264886428737438test",
  "allowLoopback" : "true",
  "allowMultipleDirsUnderSameDiskPartition" : "false"
}
2020-08-10 23:30:06,994 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled : zkServers = localhost:37261, ledgersRootPath = /ledgerstestAllowDiskPartitionDuplicationDisabled.
2020-08-10 23:30:06,999 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:07,003 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:07,014 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie6557264886428737438test/current] [/tmp/bookie6557264886428737438test/current, /tmp/bookie6557264886428737438test/current, /tmp/bookie13106374406250175875test/current]
2020-08-10 23:30:07,026 - ERROR - [Time-limited test:Bookie@295] - Dirs: [/tmp/bookie6557264886428737438test/current, /tmp/bookie6557264886428737438test/current, /tmp/bookie13106374406250175875test/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:07,026 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:07,141 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "indexDirectories" : "/tmp/bookie17463661854648125099test",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15002",
  "allowEphemeralPorts" : "true",
  "zkTimeout" : "5000",
  "ledgerDirectories" : "/tmp/bookie17463661854648125099test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "[/tmp/bookie17463661854648125099test, /tmp/bookie4334456549216761113test]",
  "allowLoopback" : "true",
  "allowMultipleDirsUnderSameDiskPartition" : "false"
}
2020-08-10 23:30:07,145 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37261/ledgerstestAllowDiskPartitionDuplicationDisabled : zkServers = localhost:37261, ledgersRootPath = /ledgerstestAllowDiskPartitionDuplicationDisabled.
2020-08-10 23:30:07,156 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:07,161 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:07,168 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17463661854648125099test/current, /tmp/bookie4334456549216761113test/current] [/tmp/bookie17463661854648125099test/current, /tmp/bookie17463661854648125099test/current]
2020-08-10 23:30:07,180 - ERROR - [Time-limited test:Bookie@295] - Dirs: [/tmp/bookie17463661854648125099test/current, /tmp/bookie17463661854648125099test/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:07,180 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:07,186 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:07,186 - INFO  - [BookieDeathWatcher-40151:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:07,187 - INFO  - [BookieDeathWatcher-40151:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40151
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:07,192 - INFO  - [BookieDeathWatcher-40151:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:07,192 - INFO  - [BookieDeathWatcher-40151:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:07,305 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:30:07,307 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:07,330 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:07,337 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:35459/ledgerstestUserPermittedToStartWithMissingProperty in 29 ms.
2020-08-10 23:30:07,342 - INFO  - [Time-limited test:BookieInitializationTest@635] - org.apache.bookkeeper.conf.ServerConfiguration@7fce0a97
2020-08-10 23:30:07,401 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:07,401 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:07,401 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:07,443 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15003",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie2467605742585929369test",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie2467605742585929369test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:07,451 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2467605742585929369test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:07,451 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:07,452 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:07,453 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:07,454 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:07,454 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:07,454 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:07,471 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:07,472 - INFO  - [SyncThread-135-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:07,478 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:07,486 - INFO  - [BookieStateManagerService-0:BookieStateManager@266] - null registration manager while do register
2020-08-10 23:30:07,486 - INFO  - [BookieJournal-15003:Journal@909] - Starting journal on /tmp/bookie2467605742585929369test/current
2020-08-10 23:30:07,487 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:07,487 - INFO  - [BookieJournal-15003:JournalChannel@157] - Opening journal /tmp/bookie2467605742585929369test/current/173da47d500.txn
2020-08-10 23:30:07,743 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:07,744 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:07,750 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-15003 with exitCode 0
2020-08-10 23:30:07,751 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:07,751 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:07,751 - INFO  - [SyncThread-135-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:07,756 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:07,756 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:07,757 - INFO  - [BookieJournal-15003:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:07,757 - INFO  - [BookieJournal-15003:Journal@1144] - Journal exited loop!
2020-08-10 23:30:07,757 - INFO  - [Bookie-15003:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:07,757 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:07,758 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:07,758 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:07,759 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:07,762 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:07,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:07,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513444864, Used space fraction: 0.84715796 > threshold 0.001.
2020-08-10 23:30:07,878 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 115 ms.
2020-08-10 23:30:07,881 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:07,907 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:07,916 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:45095/ledgerstestUserPermittedToStart in 34 ms.
2020-08-10 23:30:08,024 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15004",
  "permittedStartupUsers" : "[larry, , , curly, cecbazinga, moe]",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie12217105880155158826test",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie12217105880155158826test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:08,029 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie12217105880155158826test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:08,030 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:08,031 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:08,031 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:08,032 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:08,033 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:08,033 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:08,042 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:08,047 - INFO  - [SyncThread-142-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:08,052 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:08,053 - INFO  - [BookieStateManagerService-0:BookieStateManager@266] - null registration manager while do register
2020-08-10 23:30:08,053 - INFO  - [BookieJournal-15004:Journal@909] - Starting journal on /tmp/bookie12217105880155158826test/current
2020-08-10 23:30:08,054 - INFO  - [BookieJournal-15004:JournalChannel@157] - Opening journal /tmp/bookie12217105880155158826test/current/173da47d737.txn
2020-08-10 23:30:08,055 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:08,309 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:08,309 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:08,319 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-15004 with exitCode 0
2020-08-10 23:30:08,319 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:08,319 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:08,320 - INFO  - [SyncThread-142-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:08,323 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:08,324 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:08,324 - INFO  - [BookieJournal-15004:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:08,324 - INFO  - [BookieJournal-15004:Journal@1144] - Journal exited loop!
2020-08-10 23:30:08,325 - INFO  - [Bookie-15004:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:08,326 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:08,327 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:08,327 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:08,327 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:08,327 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:08,328 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:08,328 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:08,328 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:08,328 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:08,330 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15004",
  "permittedStartupUsers" : "[larry, curly, moe, cecbazinga, ]",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie12217105880155158826test",
  "listeningInterface" : "lo",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie12217105880155158826test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:08,339 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:08,341 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:08,341 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:08,342 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:08,342 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:08,343 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:08,355 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095008055 from position 0
2020-08-10 23:30:08,356 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie12217105880155158826test/current/173da47d737.txn
2020-08-10 23:30:08,356 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:08,357 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095008055 , logFileOffset - 516]}.
2020-08-10 23:30:08,363 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:08,368 - INFO  - [BookieJournal-15004:Journal@909] - Starting journal on /tmp/bookie12217105880155158826test/current
2020-08-10 23:30:08,369 - INFO  - [BookieStateManagerService-0:BookieStateManager@266] - null registration manager while do register
2020-08-10 23:30:08,370 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:08,369 - INFO  - [BookieJournal-15004:JournalChannel@157] - Opening journal /tmp/bookie12217105880155158826test/current/173da47d738.txn
2020-08-10 23:30:08,487 - INFO  - [BookieDeathWatcher-15003:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:08,488 - INFO  - [BookieDeathWatcher-15003:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-15003
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:08,489 - INFO  - [BookieDeathWatcher-15003:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:08,489 - INFO  - [BookieDeathWatcher-15003:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:08,623 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:08,623 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:08,628 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-15004 with exitCode 0
2020-08-10 23:30:08,628 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:08,628 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:08,629 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095008055 , logFileOffset - 516]}.
2020-08-10 23:30:08,632 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:08,634 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:08,635 - INFO  - [BookieJournal-15004:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:08,635 - INFO  - [BookieJournal-15004:Journal@1144] - Journal exited loop!
2020-08-10 23:30:08,635 - INFO  - [Bookie-15004:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:08,635 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:08,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:08,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513436672, Used space fraction: 0.84715843 > threshold 0.001.
2020-08-10 23:30:09,137 - INFO  - [BookieDeathWatcher-15004:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:09,138 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:09,138 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:09,138 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:09,138 - INFO  - [BookieDeathWatcher-15004:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-15004
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:09,139 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:09,140 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:09,140 - INFO  - [BookieDeathWatcher-15004:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:09,143 - INFO  - [BookieDeathWatcher-15004:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:09,143 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:09,144 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:09,144 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:09,146 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:09,265 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:30:09,268 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:09,287 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,296 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:42279/ledgerstestBookieRegistrationWithShortHostNameAsBookieID in 28 ms.
2020-08-10 23:30:09,303 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42279/ledgerstestBookieRegistrationWithShortHostNameAsBookieID : zkServers = localhost:42279, ledgersRootPath = /ledgerstestBookieRegistrationWithShortHostNameAsBookieID.
2020-08-10 23:30:09,312 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,372 - INFO  - [BookieDeathWatcher-15004:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:09,372 - INFO  - [BookieDeathWatcher-15004:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-15004
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:09,374 - INFO  - [BookieDeathWatcher-15004:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:09,374 - INFO  - [BookieDeathWatcher-15004:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:09,429 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:09,549 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:30:09,551 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:09,571 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,578 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:34375/ledgerstestStartBookieWithoutZKInitialized in 25 ms.
2020-08-10 23:30:09,583 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34375/ledgers2 : zkServers = localhost:34375, ledgersRootPath = /ledgers2.
2020-08-10 23:30:09,589 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,598 - ERROR - [Time-limited test:ZKRegistrationManager@415] - BookKeeper metadata doesn't exist in zookeeper. Has the cluster been initialized? Try running bin/bookkeeper shell metaformat
2020-08-10 23:30:09,604 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34375/ledgers2 : zkServers = localhost:34375, ledgersRootPath = /ledgers2.
2020-08-10 23:30:09,609 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,659 - INFO  - [Time-limited test:ZKRegistrationManager@591] - Successfully formatted BookKeeper metadata
2020-08-10 23:30:09,763 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34375/ledgers2 : zkServers = localhost:34375, ledgersRootPath = /ledgers2.
2020-08-10 23:30:09,768 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:09,779 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie3869179470409373242test/current] [/tmp/bookie3869179470409373242test/current]
2020-08-10 23:30:09,791 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:09,793 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie3869179470409373242test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:09,794 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:09,795 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:09,795 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:09,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:09,797 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:09,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513420288, Used space fraction: 0.84715945 > threshold 0.001.
2020-08-10 23:30:09,798 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:09,799 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:09,910 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:10,029 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:30:10,032 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:10,047 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:10,055 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode in 22 ms.
2020-08-10 23:30:10,065 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "diskCheckInterval" : "1000",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck56885845681467770test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck14029528673674038496test/journal-0",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:30:10,069 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:10,079 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:10,082 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:10,089 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/DiskCheck14029528673674038496test/journal-0/current] [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,104 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:10,107 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck56885845681467770test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:10,107 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:10,107 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:10,108 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:10,109 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:10,109 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:10,110 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:10,118 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:10,119 - INFO  - [SyncThread-168-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:10,124 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:10,125 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:10,126 - INFO  - [BookieJournal-40549:Journal@909] - Starting journal on /tmp/DiskCheck14029528673674038496test/journal-0/current
2020-08-10 23:30:10,128 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:10,130 - INFO  - [BookieJournal-40549:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df53.txn
2020-08-10 23:30:10,385 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:10,390 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:10,392 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:10,393 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:10,393 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:10,393 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:10,396 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40549
2020-08-10 23:30:10,433 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:40549] for ledger: 0
2020-08-10 23:30:10,441 - INFO  - [bookkeeper-io-175-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1077fe23, L:/127.0.0.1:52018 - R:127.0.0.1/127.0.0.1:40549]
2020-08-10 23:30:10,443 - INFO  - [bookkeeper-io-175-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40549
2020-08-10 23:30:10,444 - INFO  - [bookkeeper-io-175-1:PerChannelBookieClient$1@471] - connection [id: 0x1077fe23, L:/127.0.0.1:52018 - R:127.0.0.1/127.0.0.1:40549] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:30:10,446 - INFO  - [bookie-io-163-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:30:10,447 - INFO  - [bookie-io-163-2:BookieRequestHandler@50] - Channel connected  [id: 0x1a4d72ae, L:/127.0.0.1:40549 - R:/127.0.0.1:52018]
2020-08-10 23:30:10,529 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:10,529 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:10,530 - INFO  - [bookie-io-163-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1a4d72ae, L:/127.0.0.1:40549 ! R:/127.0.0.1:52018]
2020-08-10 23:30:10,530 - WARN  - [bookkeeper-io-175-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1077fe23, L:/127.0.0.1:52018 - R:127.0.0.1/127.0.0.1:40549] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:30:10,531 - INFO  - [bookkeeper-io-175-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1077fe23, L:/127.0.0.1:52018 ! R:127.0.0.1/127.0.0.1:40549]
2020-08-10 23:30:10,536 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "40549",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck56885845681467770test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck14029528673674038496test/journal-0",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:10,542 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:10,548 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:10,551 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:10,561 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:10,567 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck56885845681467770test/current : 2513367040, Used space fraction: 0.84716266 > threshold 0.001.
2020-08-10 23:30:10,568 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck56885845681467770test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:10,568 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:10,568 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:10,569 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:10,569 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:10,572 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:10,572 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:10,572 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:10,582 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40549
2020-08-10 23:30:10,595 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095010131 from position 0
2020-08-10 23:30:10,596 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df53.txn
2020-08-10 23:30:10,596 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,599 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 4 ms.
2020-08-10 23:30:10,601 - INFO  - [SyncThread-184-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:10,602 - INFO  - [SyncThread-184-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,603 - INFO  - [SyncThread-184-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck56885845681467770test/current/0.log for logId 0.
2020-08-10 23:30:10,605 - INFO  - [SyncThread-184-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,605 - INFO  - [SyncThread-184-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,606 - INFO  - [pool-192-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck56885845681467770test/current/1.log for logId 1.
2020-08-10 23:30:10,613 - INFO  - [SyncThread-184-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010131 , logFileOffset - 4612]}.
2020-08-10 23:30:10,614 - INFO  - [SyncThread-184-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,617 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:10,620 - INFO  - [BookieJournal-40549:Journal@909] - Starting journal on /tmp/DiskCheck14029528673674038496test/journal-0/current
2020-08-10 23:30:10,621 - INFO  - [BookieJournal-40549:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df54.txn
2020-08-10 23:30:10,622 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:10,627 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:10,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:10,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513330176, Used space fraction: 0.8471649 > threshold 0.001.
2020-08-10 23:30:10,884 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:10,884 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:10,891 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40549 with exitCode 0
2020-08-10 23:30:10,891 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:10,891 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:10,891 - INFO  - [SyncThread-184-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010131 , logFileOffset - 4612]}.
2020-08-10 23:30:10,892 - INFO  - [SyncThread-184-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:10,896 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:10,897 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:10,897 - INFO  - [BookieJournal-40549:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:10,898 - INFO  - [BookieJournal-40549:Journal@1144] - Journal exited loop!
2020-08-10 23:30:10,898 - INFO  - [Bookie-40549:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:10,898 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:10,899 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:10,899 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:10,899 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:10,899 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:10,899 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:10,903 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:10,905 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:10,905 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:11,016 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "40549",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck56885845681467770test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck14029528673674038496test/journal-0",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:11,021 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:11,025 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:11,031 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:11,043 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:11,045 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck56885845681467770test/current : 2513330176, Used space fraction: 0.8471649 > threshold 0.001.
2020-08-10 23:30:11,045 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck56885845681467770test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:11,046 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:11,046 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:11,046 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:11,047 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:11,049 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:11,049 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:11,049 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:11,064 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095010131 from position 4612
2020-08-10 23:30:11,065 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df53.txn
2020-08-10 23:30:11,065 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095010132 from position 0
2020-08-10 23:30:11,066 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df54.txn
2020-08-10 23:30:11,066 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 2 ms.
2020-08-10 23:30:11,067 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:11,067 - INFO  - [SyncThread-194-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010132 , logFileOffset - 516]}.
2020-08-10 23:30:11,068 - INFO  - [SyncThread-194-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:11,072 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:11,081 - INFO  - [BookieJournal-40549:Journal@909] - Starting journal on /tmp/DiskCheck14029528673674038496test/journal-0/current
2020-08-10 23:30:11,082 - INFO  - [BookieJournal-40549:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df55.txn
2020-08-10 23:30:11,083 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:11,089 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:11,342 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:11,343 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:11,352 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40549 with exitCode 0
2020-08-10 23:30:11,353 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:11,353 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:11,353 - INFO  - [SyncThread-194-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010132 , logFileOffset - 516]}.
2020-08-10 23:30:11,353 - INFO  - [SyncThread-194-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:11,357 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:11,358 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:11,358 - INFO  - [BookieJournal-40549:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:11,358 - INFO  - [BookieJournal-40549:Journal@1144] - Journal exited loop!
2020-08-10 23:30:11,359 - INFO  - [Bookie-40549:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:11,359 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:11,360 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:11,470 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "40549",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck56885845681467770test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck14029528673674038496test/journal-0",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:11,474 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:11,480 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:11,485 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:11,501 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:11,503 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck56885845681467770test/current : 2513305600, Used space fraction: 0.8471664 > threshold 0.001.
2020-08-10 23:30:11,503 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck56885845681467770test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:11,504 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:11,504 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:11,505 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:11,506 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:11,508 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:11,508 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:11,508 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:11,519 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:11,535 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095010132 from position 516
2020-08-10 23:30:11,535 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df54.txn
2020-08-10 23:30:11,536 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095010133 from position 0
2020-08-10 23:30:11,536 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df55.txn
2020-08-10 23:30:11,536 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:11,537 - INFO  - [SyncThread-204-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010133 , logFileOffset - 516]}.
2020-08-10 23:30:11,537 - INFO  - [SyncThread-204-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:11,541 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:11,542 - INFO  - [BookieJournal-40549:Journal@909] - Starting journal on /tmp/DiskCheck14029528673674038496test/journal-0/current
2020-08-10 23:30:11,543 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:11,544 - INFO  - [BookieJournal-40549:JournalChannel@157] - Opening journal /tmp/DiskCheck14029528673674038496test/journal-0/current/173da47df56.txn
2020-08-10 23:30:11,549 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:11,630 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:11,630 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40549
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:11,632 - INFO  - [BookieDeathWatcher-40549:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:11,632 - INFO  - [BookieDeathWatcher-40549:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:11,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:11,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513276928, Used space fraction: 0.84716815 > threshold 0.001.
2020-08-10 23:30:11,801 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:11,801 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:11,805 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40549 with exitCode 0
2020-08-10 23:30:11,806 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:11,806 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:11,806 - INFO  - [SyncThread-204-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095010133 , logFileOffset - 516]}.
2020-08-10 23:30:11,806 - INFO  - [SyncThread-204-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck56885845681467770test/current]
2020-08-10 23:30:11,810 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:11,810 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:11,811 - INFO  - [BookieJournal-40549:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:11,811 - INFO  - [BookieJournal-40549:Journal@1144] - Journal exited loop!
2020-08-10 23:30:11,811 - INFO  - [Bookie-40549:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:11,811 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:11,812 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:11,812 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:11,813 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:11,926 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "40549",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck56885845681467770test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/DiskCheck14029528673674038496test/journal-0",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:11,931 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45187/ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:45187, ledgersRootPath = /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:11,936 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:11,940 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:11,957 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:11,958 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck56885845681467770test/current : 2513276928, Used space fraction: 0.84716815 > threshold 0.001.
2020-08-10 23:30:11,959 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck56885845681467770test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:11,959 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:11,960 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:11,960 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:11,961 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:11,961 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:11,964 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:11,964 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:11,975 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestOneJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:40549
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:11,979 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40549
2020-08-10 23:30:12,087 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:12,090 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:12,091 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40549
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:12,092 - INFO  - [BookieDeathWatcher-40549:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:12,092 - INFO  - [BookieDeathWatcher-40549:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:12,201 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 113 ms.
2020-08-10 23:30:12,204 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:12,225 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,233 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:45823/ledgerstestBookieRegistrationBookieServiceInfo in 29 ms.
2020-08-10 23:30:12,244 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45823/ledgerstestBookieRegistrationBookieServiceInfo : zkServers = localhost:45823, ledgersRootPath = /ledgerstestBookieRegistrationBookieServiceInfo.
2020-08-10 23:30:12,250 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,298 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:12,298 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:12,372 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:12,481 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 108 ms.
2020-08-10 23:30:12,483 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:12,509 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,516 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:39037/ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider in 32 ms.
2020-08-10 23:30:12,556 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:12,556 - INFO  - [BookieDeathWatcher-40549:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40549
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:12,557 - INFO  - [BookieDeathWatcher-40549:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:12,557 - INFO  - [BookieDeathWatcher-40549:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:12,756 - INFO  - [Time-limited test:Main@310] - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
2020-08-10 23:30:12,757 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "statsProviderClass" : "org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "httpServerPort" : "15006",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15005",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie17380295584916601068test",
  "httpServerClass" : "org.apache.bookkeeper.http.vertx.VertxHttpServer",
  "metadataServiceUri" : "zk://localhost:39037/ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider",
  "httpServerEnabled" : "true",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie17380295584916601068test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:12,763 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39037/ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider : zkServers = localhost:39037, ledgersRootPath = /ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider.
2020-08-10 23:30:12,772 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,780 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:12,788 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17380295584916601068test/current] [/tmp/bookie17380295584916601068test/current]
2020-08-10 23:30:12,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:12,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513412096, Used space fraction: 0.8471599 > threshold 0.001.
2020-08-10 23:30:12,810 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:12,812 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17380295584916601068test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:12,813 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:12,814 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:12,815 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:12,815 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:12,816 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:12,816 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:12,842 - INFO  - [Time-limited test:Main@317] - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
2020-08-10 23:30:12,850 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,855 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39037/ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider : zkServers = localhost:39037, ledgersRootPath = /ledgerstestIOVertexHTTPServerEndpointForBookieWithPrometheusProvider.
2020-08-10 23:30:12,864 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:12,868 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:12,868 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:12,869 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:12,869 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
Aug 10, 2020 11:30:12 PM io.vertx.core.spi.resolver.ResolverProvider
INFO: Using the default address resolver as the dns resolver could not be loaded
2020-08-10 23:30:12,984 - INFO  - [Time-limited test:Main@345] - Load lifecycle component : org.apache.bookkeeper.server.service.HttpService
2020-08-10 23:30:12,988 - INFO  - [Time-limited test:ComponentStarter@84] - Starting component bookie-server.
2020-08-10 23:30:13,014 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:13,017 - INFO  - [SyncThread-224-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:13,022 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:13,028 - INFO  - [BookieJournal-15005:Journal@909] - Starting journal on /tmp/bookie17380295584916601068test/current
2020-08-10 23:30:13,029 - INFO  - [BookieJournal-15005:JournalChannel@157] - Opening journal /tmp/bookie17380295584916601068test/current/173da47eaa6.txn
2020-08-10 23:30:13,031 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:13,045 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.1.1:15005
2020-08-10 23:30:13,321 - INFO  - [vert.x-eventloop-thread-0:VertxHttpServer$2@84] - Starting Vertx HTTP server on port 15006
2020-08-10 23:30:13,616 - INFO  - [Time-limited test:VertxHttpServer@91] - Vertx Http server started successfully
2020-08-10 23:30:13,616 - INFO  - [Time-limited test:ComponentStarter@86] - Started component bookie-server.
2020-08-10 23:30:13,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:13,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513367040, Used space fraction: 0.84716266 > threshold 0.001.
2020-08-10 23:30:13,837 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:13,965 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 128 ms.
2020-08-10 23:30:13,970 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:13,985 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:13,991 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:42947/ledgerstestAutoRecoveryServiceExceptionHandler in 20 ms.
2020-08-10 23:30:14,003 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42947/ledgerstestAutoRecoveryServiceExceptionHandler : zkServers = localhost:42947, ledgersRootPath = /ledgerstestAutoRecoveryServiceExceptionHandler.
2020-08-10 23:30:14,011 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:14,013 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:14,014 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:14,014 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:14,014 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:14,053 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:14,053 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:14,053 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:14,066 - INFO  - [Time-limited test:ComponentStarter@84] - Starting component autorecovery.
2020-08-10 23:30:14,070 - INFO  - [Time-limited test:ComponentStarter@86] - Started component autorecovery.
2020-08-10 23:30:14,070 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:30:14,071 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:30:14,071 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:30:14,072 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:30:14,074 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:734)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:620)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:601)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2016)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:725)
	... 6 more
2020-08-10 23:30:14,076 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:30:14,082 - ERROR - [AuditorElector-127.0.0.1:0:AuditorElector$3@331] - Exception while performing auditor election
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestAutoRecoveryServiceExceptionHandler/underreplication/auditorelection
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2589)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1248)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1242)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2617)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3801(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$28.call(ZooKeeperClient.java:1270)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$28.call(ZooKeeperClient.java:1264)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1264)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:293)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:14,083 - INFO  - [AuditorElector-127.0.0.1:0:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:30:14,083 - ERROR - [AuditorElector-127.0.0.1:0:AuditorElector$2@269] - Exception while deleting myVote:/ledgerstestAutoRecoveryServiceExceptionHandler/underreplication/auditorelection/V_0000000000
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestAutoRecoveryServiceExceptionHandler/underreplication/auditorelection/V_0000000000
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.replication.AuditorElector$2.run(AuditorElector.java:263)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:14,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:14,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513375232, Used space fraction: 0.8471622 > threshold 0.001.
2020-08-10 23:30:15,070 - INFO  - [AutoRecoveryDeathWatcher-0:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:30:15,071 - ERROR - [AutoRecoveryDeathWatcher-0:ComponentStarter@76] - Triggered exceptionHandler of Component: autorecovery because of Exception in Thread: Thread[AutoRecoveryDeathWatcher-0,5,FailOnTimeoutGroup]
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:30:15,074 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@45] - Closing component autorecovery in shutdown hook.
2020-08-10 23:30:15,075 - INFO  - [component-shutdown-thread:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:30:15,076 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@48] - Closed component autorecovery in shutdown hook successfully. Exiting.
2020-08-10 23:30:15,076 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:15,191 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 115 ms.
2020-08-10 23:30:15,193 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:15,216 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:15,224 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:35917/ledgerstestStartBookieWithoutZKServer in 30 ms.
2020-08-10 23:30:15,342 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35917/ledgers : zkServers = localhost:35917, ledgersRootPath = /ledgers.
2020-08-10 23:30:15,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:15,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513383424, Used space fraction: 0.84716165 > threshold 0.001.
2020-08-10 23:30:16,798 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:16,800 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513383424, Used space fraction: 0.84716165 > threshold 0.001.
2020-08-10 23:30:17,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:17,796 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513383424, Used space fraction: 0.84716165 > threshold 0.001.
2020-08-10 23:30:18,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:18,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513383424, Used space fraction: 0.84716165 > threshold 0.001.
2020-08-10 23:30:19,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:19,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513367040, Used space fraction: 0.84716266 > threshold 0.001.
2020-08-10 23:30:20,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:20,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513367040, Used space fraction: 0.84716266 > threshold 0.001.
2020-08-10 23:30:20,964 - ERROR - [Time-limited test:ZKMetadataDriverBase@212] - Failed to create zookeeper client to localhost:35917
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.bookkeeper.zookeeper.ZooKeeperWatcherBase.waitForConnection(ZooKeeperWatcherBase.java:159)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$Builder.build(ZooKeeperClient.java:257)
	at org.apache.bookkeeper.meta.zk.ZKMetadataDriverBase.initialize(ZKMetadataDriverBase.java:197)
	at org.apache.bookkeeper.meta.zk.ZKMetadataBookieDriver.initialize(ZKMetadataBookieDriver.java:60)
	at org.apache.bookkeeper.bookie.Bookie.instantiateMetadataDriver(Bookie.java:1080)
	at org.apache.bookkeeper.bookie.Bookie.<init>(Bookie.java:698)
	at org.apache.bookkeeper.bookie.Bookie.<init>(Bookie.java:617)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testStartBookieWithoutZKServer(BookieInitializationTest.java:894)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:20,965 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:20,966 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 0 ms.
2020-08-10 23:30:20,968 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:20,992 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:20,999 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44219/ledgerstestBookieRegistrationWithSameZooKeeperClient in 30 ms.
2020-08-10 23:30:21,005 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44219/ledgerstestBookieRegistrationWithSameZooKeeperClient : zkServers = localhost:44219, ledgersRootPath = /ledgerstestBookieRegistrationWithSameZooKeeperClient.
2020-08-10 23:30:21,010 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,130 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:21,250 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 119 ms.
2020-08-10 23:30:21,252 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:21,267 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,272 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:41665/ledgerstestAllowDiskPartitionDuplicationAllowed in 19 ms.
2020-08-10 23:30:21,280 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "indexDirectories" : "[/tmp/bookie4108716572851646145test, /tmp/bookie2064471686953252677test]",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "12555",
  "allowEphemeralPorts" : "true",
  "zkTimeout" : "5000",
  "ledgerDirectories" : "[/tmp/bookie12836265737816579235test, /tmp/bookie14993801290943944493test]",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:41665/ledgerstestAllowDiskPartitionDuplicationAllowed",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "[/tmp/bookie12792956187202735867test, /tmp/bookie13763095276881622508test]",
  "allowLoopback" : "true",
  "allowMultipleDirsUnderSameDiskPartition" : "true"
}
2020-08-10 23:30:21,284 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41665/ledgerstestAllowDiskPartitionDuplicationAllowed : zkServers = localhost:41665, ledgersRootPath = /ledgerstestAllowDiskPartitionDuplicationAllowed.
2020-08-10 23:30:21,296 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,300 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:21,308 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie12792956187202735867test/current, /tmp/bookie13763095276881622508test/current] [/tmp/bookie12836265737816579235test/current, /tmp/bookie14993801290943944493test/current, /tmp/bookie4108716572851646145test/current, /tmp/bookie2064471686953252677test/current]
2020-08-10 23:30:21,320 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie12836265737816579235test/current, /tmp/bookie14993801290943944493test/current, /tmp/bookie4108716572851646145test/current, /tmp/bookie2064471686953252677test/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:21,321 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/bookie12792956187202735867test/current, /tmp/bookie13763095276881622508test/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:21,325 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:21,327 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie12836265737816579235test/current/lastMark.0 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:21,327 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14993801290943944493test/current/lastMark.0 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:21,328 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie12836265737816579235test/current/lastMark.1 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:21,328 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14993801290943944493test/current/lastMark.1 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:21,328 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:21,329 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:21,329 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:21,330 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:21,331 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:21,331 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:21,348 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:21,348 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:21,361 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:21,473 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 112 ms.
2020-08-10 23:30:21,476 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:21,501 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,507 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44797/ledgerstestPersistBookieStatus in 30 ms.
2020-08-10 23:30:21,516 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie17210530133642861140test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44797/ledgerstestPersistBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie17210530133642861140test",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:21,523 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44797/ledgerstestPersistBookieStatus : zkServers = localhost:44797, ledgersRootPath = /ledgerstestPersistBookieStatus.
2020-08-10 23:30:21,528 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,532 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:21,539 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17210530133642861140test/current] [/tmp/bookie17210530133642861140test/current]
2020-08-10 23:30:21,555 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:21,557 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17210530133642861140test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:21,557 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:21,557 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:21,558 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:21,559 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:21,559 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:21,559 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:21,568 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:21,568 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:21,570 - INFO  - [SyncThread-258-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:21,574 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:21,575 - INFO  - [BookieJournal-36577:Journal@909] - Starting journal on /tmp/bookie17210530133642861140test/current
2020-08-10 23:30:21,577 - WARN  - [Time-limited test:BookieStatus@165] - Failed to retrieve bookie status from disks. Fall back to current or default bookie status: READ_WRITE
2020-08-10 23:30:21,577 - INFO  - [BookieJournal-36577:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0a.txn
2020-08-10 23:30:21,578 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:21,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:21,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513326080, Used space fraction: 0.84716517 > threshold 0.001.
2020-08-10 23:30:21,833 - INFO  - [Time-limited test:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:21,834 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_ONLY
2020-08-10 23:30:21,843 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:21,844 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:21,847 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-36577 with exitCode 0
2020-08-10 23:30:21,847 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:21,847 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:21,848 - INFO  - [SyncThread-258-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:21,852 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:21,852 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:21,852 - INFO  - [BookieJournal-36577:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:21,852 - INFO  - [BookieJournal-36577:Journal@1144] - Journal exited loop!
2020-08-10 23:30:21,853 - INFO  - [Bookie-36577:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:21,854 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:21,855 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:21,962 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "36577",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie17210530133642861140test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44797/ledgerstestPersistBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie17210530133642861140test",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:21,967 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44797/ledgerstestPersistBookieStatus : zkServers = localhost:44797, ledgersRootPath = /ledgerstestPersistBookieStatus.
2020-08-10 23:30:21,973 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:21,978 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:21,995 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:21,996 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:21,997 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:21,998 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:22,000 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:22,001 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:22,001 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:22,016 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095021578 from position 0
2020-08-10 23:30:22,017 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0a.txn
2020-08-10 23:30:22,017 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:22,020 - INFO  - [SyncThread-268-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095021578 , logFileOffset - 516]}.
2020-08-10 23:30:22,025 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:22,029 - INFO  - [Time-limited test:BookieStatus@163] - Successfully retrieve bookie status READ_ONLY from disks.
2020-08-10 23:30:22,034 - INFO  - [BookieJournal-36577:Journal@909] - Starting journal on /tmp/bookie17210530133642861140test/current
2020-08-10 23:30:22,035 - INFO  - [BookieJournal-36577:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0b.txn
2020-08-10 23:30:22,035 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:22,043 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestPersistBookieStatus/available/127.0.0.1:36577 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestPersistBookieStatus/available/127.0.0.1:36577
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:22,296 - INFO  - [Time-limited test:BookieStateManager@289] - Transitioning Bookie to Writable mode and will serve read/write requests.
2020-08-10 23:30:22,296 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_WRITE
2020-08-10 23:30:22,304 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:22,304 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:22,311 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-36577 with exitCode 0
2020-08-10 23:30:22,311 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:22,311 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:22,312 - INFO  - [SyncThread-268-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095021578 , logFileOffset - 516]}.
2020-08-10 23:30:22,316 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:22,316 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:22,316 - INFO  - [BookieJournal-36577:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:22,317 - INFO  - [BookieJournal-36577:Journal@1144] - Journal exited loop!
2020-08-10 23:30:22,317 - INFO  - [Bookie-36577:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:22,317 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:22,318 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:22,319 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:22,425 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "36577",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie17210530133642861140test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44797/ledgerstestPersistBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie17210530133642861140test",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:22,431 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44797/ledgerstestPersistBookieStatus : zkServers = localhost:44797, ledgersRootPath = /ledgerstestPersistBookieStatus.
2020-08-10 23:30:22,439 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:22,442 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:22,458 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:22,460 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:22,460 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:22,461 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:22,462 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:22,462 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:22,462 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:22,473 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095021578 from position 516
2020-08-10 23:30:22,473 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0a.txn
2020-08-10 23:30:22,473 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095021579 from position 0
2020-08-10 23:30:22,473 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0b.txn
2020-08-10 23:30:22,473 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:22,475 - INFO  - [SyncThread-278-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095021579 , logFileOffset - 516]}.
2020-08-10 23:30:22,479 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:22,487 - INFO  - [BookieJournal-36577:Journal@909] - Starting journal on /tmp/bookie17210530133642861140test/current
2020-08-10 23:30:22,487 - INFO  - [Time-limited test:BookieStatus@163] - Successfully retrieve bookie status READ_WRITE from disks.
2020-08-10 23:30:22,488 - INFO  - [BookieJournal-36577:JournalChannel@157] - Opening journal /tmp/bookie17210530133642861140test/current/173da480c0c.txn
2020-08-10 23:30:22,488 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:22,584 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:22,585 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36577
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:22,586 - INFO  - [BookieDeathWatcher-36577:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:22,586 - INFO  - [BookieDeathWatcher-36577:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:22,751 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:22,751 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:22,756 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-36577 with exitCode 0
2020-08-10 23:30:22,756 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:22,756 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:22,756 - INFO  - [SyncThread-278-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095021579 , logFileOffset - 516]}.
2020-08-10 23:30:22,761 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:22,761 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:22,762 - INFO  - [BookieJournal-36577:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:22,762 - INFO  - [BookieJournal-36577:Journal@1144] - Journal exited loop!
2020-08-10 23:30:22,762 - INFO  - [Bookie-36577:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:22,762 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:22,764 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:22,765 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:22,765 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:22,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:22,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:22,874 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:22,990 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 116 ms.
2020-08-10 23:30:22,994 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:23,017 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:23,024 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:44227/ledgerstestDuplicateBookieServerStartup in 29 ms.
2020-08-10 23:30:23,044 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:23,045 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36577
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:23,046 - INFO  - [BookieDeathWatcher-36577:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:23,046 - INFO  - [BookieDeathWatcher-36577:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:23,131 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15007",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie3278108918216710856test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44227/ledgerstestDuplicateBookieServerStartup",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie3278108918216710856test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:23,135 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44227/ledgerstestDuplicateBookieServerStartup : zkServers = localhost:44227, ledgersRootPath = /ledgerstestDuplicateBookieServerStartup.
2020-08-10 23:30:23,139 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:23,143 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:23,149 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie3278108918216710856test/current] [/tmp/bookie3278108918216710856test/current]
2020-08-10 23:30:23,164 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:23,166 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie3278108918216710856test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:23,166 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:23,167 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:23,168 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:23,170 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:23,170 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:23,170 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:23,178 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:23,179 - INFO  - [SyncThread-288-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:23,182 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:23,185 - INFO  - [BookieJournal-15007:Journal@909] - Starting journal on /tmp/bookie3278108918216710856test/current
2020-08-10 23:30:23,189 - INFO  - [BookieJournal-15007:JournalChannel@157] - Opening journal /tmp/bookie3278108918216710856test/current/173da481256.txn
2020-08-10 23:30:23,189 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:23,446 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15007",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie3278108918216710856test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:44227/ledgerstestDuplicateBookieServerStartup",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie3278108918216710856test",
  "allowLoopback" : "true"
}
2020-08-10 23:30:23,450 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:23,451 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:23,461 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-15007 with exitCode 0
2020-08-10 23:30:23,462 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:23,462 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:23,462 - INFO  - [SyncThread-288-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:23,466 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:23,470 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:23,471 - INFO  - [BookieJournal-15007:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:23,471 - INFO  - [BookieJournal-15007:Journal@1144] - Journal exited loop!
2020-08-10 23:30:23,471 - INFO  - [Bookie-15007:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:23,471 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:23,473 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:23,500 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:23,502 - INFO  - [BookieDeathWatcher-36577:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36577
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:23,502 - INFO  - [BookieDeathWatcher-36577:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:23,503 - INFO  - [BookieDeathWatcher-36577:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:23,581 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:23,692 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 111 ms.
2020-08-10 23:30:23,694 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:23,709 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:23,715 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:33409/ledgerstestRegNodeExistsAfterSessionTimeOut in 21 ms.
2020-08-10 23:30:23,721 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33409/ledgerstestRegNodeExistsAfterSessionTimeOut : zkServers = localhost:33409, ledgersRootPath = /ledgerstestRegNodeExistsAfterSessionTimeOut.
2020-08-10 23:30:23,726 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:23,736 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33409/ledgerstestRegNodeExistsAfterSessionTimeOut : zkServers = localhost:33409, ledgersRootPath = /ledgerstestRegNodeExistsAfterSessionTimeOut.
2020-08-10 23:30:23,741 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:23,746 - INFO  - [BookieStateManagerService-0:ZKRegistrationManager@194] - Previous bookie registration znode: /ledgerstestRegNodeExistsAfterSessionTimeOut/available/127.0.1.1:0 exists, so waiting zk sessiontimeout: 10000 ms for znode deletion
2020-08-10 23:30:23,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:23,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:24,197 - INFO  - [BookieDeathWatcher-15007:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:24,197 - INFO  - [BookieDeathWatcher-15007:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-15007
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:24,198 - INFO  - [BookieDeathWatcher-15007:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:24,198 - INFO  - [BookieDeathWatcher-15007:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:24,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:24,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:25,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:25,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:26,797 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:26,799 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:27,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:27,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:28,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:28,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:29,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:29,796 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:30,799 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:30,800 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:31,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:31,796 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:32,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:32,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:33,748 - ERROR - [BookieStateManagerService-0:ZKRegistrationManager@208] - ZK exception checking and wait ephemeral znode /ledgerstestRegNodeExistsAfterSessionTimeOut/available/127.0.1.1:0 expired : 
org.apache.zookeeper.KeeperException$NodeExistsException: KeeperErrorCode = NodeExists for /ledgerstestRegNodeExistsAfterSessionTimeOut/available/127.0.1.1:0
	at org.apache.bookkeeper.discover.ZKRegistrationManager.checkRegNodeAndWaitExpired(ZKRegistrationManager.java:198)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterBookie(ZKRegistrationManager.java:264)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:224)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:33,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:33,796 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:33,972 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:34,085 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 112 ms.
2020-08-10 23:30:34,087 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:34,104 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:34,110 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:43545/ledgerstestBookieServiceExceptionHandler in 22 ms.
2020-08-10 23:30:34,215 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15008",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie6356838617431975523exception-handler",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43545/ledgerstestBookieServiceExceptionHandler",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie6356838617431975523exception-handler",
  "allowLoopback" : "true"
}
2020-08-10 23:30:34,220 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43545/ledgerstestBookieServiceExceptionHandler : zkServers = localhost:43545, ledgersRootPath = /ledgerstestBookieServiceExceptionHandler.
2020-08-10 23:30:34,225 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:34,231 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:34,241 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie6356838617431975523exception-handler/current] [/tmp/bookie6356838617431975523exception-handler/current]
2020-08-10 23:30:34,254 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:34,256 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie6356838617431975523exception-handler/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:34,257 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:34,258 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:34,258 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:34,260 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:34,261 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:34,261 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:34,275 - INFO  - [Time-limited test:ComponentStarter@84] - Starting component bookie-server.
2020-08-10 23:30:34,276 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:34,278 - INFO  - [SyncThread-299-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:34,282 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:34,284 - INFO  - [BookieJournal-15008:Journal@909] - Starting journal on /tmp/bookie6356838617431975523exception-handler/current
2020-08-10 23:30:34,285 - INFO  - [BookieJournal-15008:JournalChannel@157] - Opening journal /tmp/bookie6356838617431975523exception-handler/current/173da483dae.txn
2020-08-10 23:30:34,286 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:34,548 - INFO  - [Time-limited test:ComponentStarter@86] - Started component bookie-server.
2020-08-10 23:30:34,548 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-15008 with exitCode 0
2020-08-10 23:30:34,549 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:34,549 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:34,549 - INFO  - [SyncThread-299-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:34,553 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:34,555 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:34,555 - INFO  - [BookieJournal-15008:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:34,556 - INFO  - [BookieJournal-15008:Journal@1144] - Journal exited loop!
2020-08-10 23:30:34,556 - INFO  - [Bookie-15008:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:34,556 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:34,557 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:34,558 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:34,559 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:34,799 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:34,801 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513248256, Used space fraction: 0.8471699 > threshold 0.001.
2020-08-10 23:30:35,292 - INFO  - [BookieDeathWatcher-15008:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:35,293 - ERROR - [BookieDeathWatcher-15008:ComponentStarter@76] - Triggered exceptionHandler of Component: bookie-server because of Exception in Thread: Thread[BookieDeathWatcher-15008,5,FailOnTimeoutGroup]
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:35,294 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@45] - Closing component bookie-server in shutdown hook.
2020-08-10 23:30:35,294 - INFO  - [component-shutdown-thread:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:35,294 - INFO  - [component-shutdown-thread:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:35,300 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@48] - Closed component bookie-server in shutdown hook successfully. Exiting.
2020-08-10 23:30:35,300 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:35,414 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 113 ms.
2020-08-10 23:30:35,416 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:35,435 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,442 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:35113/ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider in 24 ms.
2020-08-10 23:30:35,555 - INFO  - [Time-limited test:AutoRecoveryMain@355] - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
2020-08-10 23:30:35,561 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35113/ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider : zkServers = localhost:35113, ledgersRootPath = /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider.
2020-08-10 23:30:35,566 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,569 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:35,570 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:35,570 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:35,570 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:35,602 - INFO  - [Time-limited test:AutoRecoveryMain@361] - Load lifecycle component : org.apache.bookkeeper.server.service.AutoRecoveryService
2020-08-10 23:30:35,606 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,609 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35113/ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider : zkServers = localhost:35113, ledgersRootPath = /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider.
2020-08-10 23:30:35,613 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,616 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:35,616 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:35,617 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:35,617 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
Aug 10, 2020 11:30:35 PM io.vertx.core.spi.resolver.ResolverProvider
INFO: Using the default address resolver as the dns resolver could not be loaded
2020-08-10 23:30:35,624 - INFO  - [Time-limited test:AutoRecoveryMain@372] - Load lifecycle component : org.apache.bookkeeper.server.service.HttpService
2020-08-10 23:30:35,625 - INFO  - [Time-limited test:ComponentStarter@84] - Starting component autorecovery-server.
2020-08-10 23:30:35,631 - INFO  - [vert.x-eventloop-thread-0:VertxHttpServer$2@84] - Starting Vertx HTTP server on port 15009
2020-08-10 23:30:35,635 - INFO  - [Time-limited test:VertxHttpServer@91] - Vertx Http server started successfully
2020-08-10 23:30:35,635 - INFO  - [Time-limited test:ComponentStarter@86] - Started component autorecovery-server.
2020-08-10 23:30:35,673 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:30:35,677 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:30:35,680 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.1.1:0
2020-08-10 23:30:35,680 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:35,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:35,797 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 116 ms.
2020-08-10 23:30:35,798 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513289216, Used space fraction: 0.8471674 > threshold 0.001.
2020-08-10 23:30:35,799 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:35,815 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,821 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:43615/ledgerstestReadOnlyBookieShouldIgnoreBookieStatus in 21 ms.
2020-08-10 23:30:35,829 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "bookiePort" : "0",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie2566494133283672977test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43615/ledgerstestReadOnlyBookieShouldIgnoreBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie2566494133283672977test",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:35,848 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43615/ledgerstestReadOnlyBookieShouldIgnoreBookieStatus : zkServers = localhost:43615, ledgersRootPath = /ledgerstestReadOnlyBookieShouldIgnoreBookieStatus.
2020-08-10 23:30:35,854 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:35,857 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:35,866 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie2566494133283672977test/current] [/tmp/bookie2566494133283672977test/current]
2020-08-10 23:30:35,888 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:35,889 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2566494133283672977test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:35,890 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:35,891 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:35,891 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:35,892 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:35,893 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:35,893 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:35,893 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:35,893 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:35,893 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:35,894 - ERROR - [AuditorElector-127.0.1.1:0:BookieWatcherImpl@71] - Failed to get bookie list : 
org.apache.bookkeeper.client.BKException$ZKException: Error while using ZooKeeper
	at org.apache.bookkeeper.discover.ZKRegistrationClient.lambda$getChildren$3(ZKRegistrationClient.java:293)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$25$1.processResult(ZooKeeperClient.java:1174)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:630)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/available/readonly
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.bookkeeper.discover.ZKRegistrationClient.lambda$getChildren$3(ZKRegistrationClient.java:292)
	... 3 more
2020-08-10 23:30:35,895 - ERROR - [AuditorElector-127.0.1.1:0:Auditor@672] - Couldn't get bookie list, so exiting
org.apache.bookkeeper.client.BKException$ZKException: Error while using ZooKeeper
	at org.apache.bookkeeper.discover.ZKRegistrationClient.lambda$getChildren$3(ZKRegistrationClient.java:293)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$25$1.processResult(ZooKeeperClient.java:1174)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:630)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/available/readonly
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.bookkeeper.discover.ZKRegistrationClient.lambda$getChildren$3(ZKRegistrationClient.java:292)
	... 3 more
2020-08-10 23:30:35,896 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@493] - Executing submitShutdownTask
2020-08-10 23:30:35,909 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:35,910 - INFO  - [SyncThread-325-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:35,915 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:35,921 - WARN  - [Time-limited test:BookieStatus@165] - Failed to retrieve bookie status from disks. Fall back to current or default bookie status: READ_WRITE
2020-08-10 23:30:35,923 - INFO  - [BookieJournal-35781:Journal@909] - Starting journal on /tmp/bookie2566494133283672977test/current
2020-08-10 23:30:35,924 - INFO  - [BookieJournal-35781:JournalChannel@157] - Opening journal /tmp/bookie2566494133283672977test/current/173da484415.txn
2020-08-10 23:30:35,925 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:36,182 - INFO  - [Time-limited test:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:36,182 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_ONLY
2020-08-10 23:30:36,190 - INFO  - [Time-limited test:BookieStateManager@289] - Transitioning Bookie to Writable mode and will serve read/write requests.
2020-08-10 23:30:36,191 - INFO  - [Time-limited test:BookieStatus@112] - Successfully persist bookie status READ_WRITE
2020-08-10 23:30:36,198 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:36,199 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:36,203 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35781 with exitCode 0
2020-08-10 23:30:36,204 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:36,204 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:36,204 - INFO  - [SyncThread-325-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:36,209 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:36,209 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:36,210 - INFO  - [BookieJournal-35781:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:36,210 - INFO  - [BookieJournal-35781:Journal@1144] - Journal exited loop!
2020-08-10 23:30:36,210 - INFO  - [Bookie-35781:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:36,210 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:36,212 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:36,213 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:36,213 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:36,321 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "forceReadOnlyBookie" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "35781",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie2566494133283672977test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43615/ledgerstestReadOnlyBookieShouldIgnoreBookieStatus",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie2566494133283672977test",
  "persistBookieStatusEnabled" : "true",
  "allowLoopback" : "true",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:36,327 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43615/ledgerstestReadOnlyBookieShouldIgnoreBookieStatus : zkServers = localhost:43615, ledgersRootPath = /ledgerstestReadOnlyBookieShouldIgnoreBookieStatus.
2020-08-10 23:30:36,331 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:36,337 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:36,351 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:36,353 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:36,355 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:36,356 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:36,357 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:36,357 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:36,357 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:36,358 - INFO  - [Time-limited test:ReadOnlyBookie@56] - Running bookie in force readonly mode.
2020-08-10 23:30:36,377 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095035925 from position 0
2020-08-10 23:30:36,377 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie2566494133283672977test/current/173da484415.txn
2020-08-10 23:30:36,378 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:36,379 - INFO  - [SyncThread-335-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095035925 , logFileOffset - 516]}.
2020-08-10 23:30:36,383 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:36,388 - INFO  - [BookieJournal-35781:Journal@909] - Starting journal on /tmp/bookie2566494133283672977test/current
2020-08-10 23:30:36,390 - INFO  - [BookieJournal-35781:JournalChannel@157] - Opening journal /tmp/bookie2566494133283672977test/current/173da484416.txn
2020-08-10 23:30:36,390 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:36,396 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestReadOnlyBookieShouldIgnoreBookieStatus/available/127.0.0.1:35781 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestReadOnlyBookieShouldIgnoreBookieStatus/available/127.0.0.1:35781
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:36,650 - INFO  - [Time-limited test:ReadOnlyBookie$1@67] - Skip transition to writable mode for readonly bookie
2020-08-10 23:30:36,651 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:36,651 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:36,655 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35781 with exitCode 0
2020-08-10 23:30:36,655 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:36,656 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:36,656 - INFO  - [SyncThread-335-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095035925 , logFileOffset - 516]}.
2020-08-10 23:30:36,660 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:36,661 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:36,661 - INFO  - [BookieJournal-35781:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:36,661 - INFO  - [BookieJournal-35781:Journal@1144] - Journal exited loop!
2020-08-10 23:30:36,661 - INFO  - [Bookie-35781:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:36,662 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:36,663 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:36,664 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:36,776 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:36,796 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:36,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513215488, Used space fraction: 0.8471719 > threshold 0.001.
2020-08-10 23:30:36,886 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 110 ms.
2020-08-10 23:30:36,889 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:36,905 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:36,910 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:43333/ledgerstestBookieStartException in 19 ms.
2020-08-10 23:30:36,914 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie13129283769998077534journal/current/173da4847f2.txn
2020-08-10 23:30:36,928 - INFO  - [BookieDeathWatcher-35781:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:36,929 - INFO  - [BookieDeathWatcher-35781:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35781
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:36,930 - INFO  - [BookieDeathWatcher-35781:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:36,930 - INFO  - [BookieDeathWatcher-35781:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:37,049 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43333/ledgerstestBookieStartException : zkServers = localhost:43333, ledgersRootPath = /ledgerstestBookieStartException.
2020-08-10 23:30:37,054 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:37,457 - INFO  - [BookieDeathWatcher-35781:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:37,458 - INFO  - [BookieDeathWatcher-35781:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35781
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:37,460 - INFO  - [BookieDeathWatcher-35781:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:37,461 - INFO  - [BookieDeathWatcher-35781:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:37,468 - INFO  - [Time-limited test:Main@310] - Load lifecycle component : org.apache.bookkeeper.server.service.StatsProviderService
2020-08-10 23:30:37,468 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.BookieInitializationTest$MockInterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "15010",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/bookie10824317082205105946ledger",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43333/ledgerstestBookieStartException",
  "journalFlushWhenQueueEmpty" : "true",
  "journalDirectories" : "/tmp/bookie13129283769998077534journal",
  "allowLoopback" : "true"
}
2020-08-10 23:30:37,471 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43333/ledgerstestBookieStartException : zkServers = localhost:43333, ledgersRootPath = /ledgerstestBookieStartException.
2020-08-10 23:30:37,477 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:37,482 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:37,496 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:37,497 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie10824317082205105946ledger/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:37,497 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.BookieInitializationTest$MockInterleavedLedgerStorage
2020-08-10 23:30:37,498 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:37,499 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:37,500 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:37,500 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:37,500 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:37,507 - INFO  - [Time-limited test:Main@317] - Load lifecycle component : org.apache.bookkeeper.server.service.BookieService
2020-08-10 23:30:37,510 - INFO  - [Time-limited test:ComponentStarter@84] - Starting component bookie-server.
2020-08-10 23:30:37,511 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095036914 from position 0
2020-08-10 23:30:37,511 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie13129283769998077534journal/current/173da4847f2.txn
2020-08-10 23:30:37,512 - INFO  - [Time-limited test:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:37,513 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10824317082205105946ledger/current/0.log for logId 0.
2020-08-10 23:30:37,516 - INFO  - [pool-341-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10824317082205105946ledger/current/1.log for logId 1.
2020-08-10 23:30:37,516 - ERROR - [Time-limited test:AbstractLifecycleComponent@85] - Failed to start Component: bookie-server
java.lang.OutOfMemoryError: Some Injected Exception
	at org.apache.bookkeeper.bookie.BookieInitializationTest$MockInterleavedLedgerStorage.addEntry(BookieInitializationTest.java:721)
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:155)
	at org.apache.bookkeeper.bookie.Bookie$4.process(Bookie.java:885)
	at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:836)
	at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932)
	at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:898)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:952)
	at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:144)
	at org.apache.bookkeeper.server.service.BookieService.doStart(BookieService.java:68)
	at org.apache.bookkeeper.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:83)
	at org.apache.bookkeeper.common.component.LifecycleComponentStack.lambda$start$4(LifecycleComponentStack.java:144)
	at com.google.common.collect.ImmutableList.forEach(ImmutableList.java:408)
	at org.apache.bookkeeper.common.component.LifecycleComponentStack.start(LifecycleComponentStack.java:144)
	at org.apache.bookkeeper.common.component.ComponentStarter.startComponent(ComponentStarter.java:85)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testBookieStartException(BookieInitializationTest.java:773)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:37,517 - ERROR - [Time-limited test:AbstractLifecycleComponent@87] - Calling uncaughtExceptionHandler
2020-08-10 23:30:37,517 - ERROR - [Time-limited test:ComponentStarter@76] - Triggered exceptionHandler of Component: bookie-server because of Exception in Thread: Thread[Time-limited test,5,FailOnTimeoutGroup]
java.lang.OutOfMemoryError: Some Injected Exception
	at org.apache.bookkeeper.bookie.BookieInitializationTest$MockInterleavedLedgerStorage.addEntry(BookieInitializationTest.java:721)
	at org.apache.bookkeeper.bookie.LedgerDescriptorImpl.addEntry(LedgerDescriptorImpl.java:155)
	at org.apache.bookkeeper.bookie.Bookie$4.process(Bookie.java:885)
	at org.apache.bookkeeper.bookie.Journal.scanJournal(Journal.java:836)
	at org.apache.bookkeeper.bookie.Bookie.replay(Bookie.java:932)
	at org.apache.bookkeeper.bookie.Bookie.readJournal(Bookie.java:898)
	at org.apache.bookkeeper.bookie.Bookie.start(Bookie.java:952)
	at org.apache.bookkeeper.proto.BookieServer.start(BookieServer.java:144)
	at org.apache.bookkeeper.server.service.BookieService.doStart(BookieService.java:68)
	at org.apache.bookkeeper.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:83)
	at org.apache.bookkeeper.common.component.LifecycleComponentStack.lambda$start$4(LifecycleComponentStack.java:144)
	at com.google.common.collect.ImmutableList.forEach(ImmutableList.java:408)
	at org.apache.bookkeeper.common.component.LifecycleComponentStack.start(LifecycleComponentStack.java:144)
	at org.apache.bookkeeper.common.component.ComponentStarter.startComponent(ComponentStarter.java:85)
	at org.apache.bookkeeper.bookie.BookieInitializationTest.testBookieStartException(BookieInitializationTest.java:773)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.apache.bookkeeper.util.LoggerOutput$1.evaluate(LoggerOutput.java:68)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:55)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:37,517 - INFO  - [Time-limited test:ComponentStarter@86] - Started component bookie-server.
2020-08-10 23:30:37,517 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@45] - Closing component bookie-server in shutdown hook.
2020-08-10 23:30:37,518 - INFO  - [component-shutdown-thread:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:37,519 - INFO  - [component-shutdown-thread:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:37,524 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@48] - Closed component bookie-server in shutdown hook successfully. Exiting.
2020-08-10 23:30:37,633 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:37,659 - ERROR - [AuditorElector-127.0.1.1:0:ZkLedgerUnderreplicationManager@876] - Error while checking the state of lostBookieRecoveryDelay
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/underreplication/lostBookieRecoveryDelay
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.notifyLostBookieRecoveryDelayChanged(ZkLedgerUnderreplicationManager.java:871)
	at org.apache.bookkeeper.replication.Auditor.start(Auditor.java:678)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:315)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:37,659 - ERROR - [AuditorElector-127.0.1.1:0:Auditor@680] - Exception while registering for LostBookieRecoveryDelay change notification, so exiting
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.notifyLostBookieRecoveryDelayChanged(ZkLedgerUnderreplicationManager.java:877)
	at org.apache.bookkeeper.replication.Auditor.start(Auditor.java:678)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:315)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/underreplication/lostBookieRecoveryDelay
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.notifyLostBookieRecoveryDelayChanged(ZkLedgerUnderreplicationManager.java:871)
	... 7 more
2020-08-10 23:30:37,660 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@493] - Executing submitShutdownTask
2020-08-10 23:30:37,659 - ERROR - [ReplicationWorker:ZkLedgerUnderreplicationManager@728] - Error while checking the state of ledger re-replication
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/underreplication/disable
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:725)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:620)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:601)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:37,661 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:730)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:620)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:601)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/underreplication/disable
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2021)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:725)
	... 6 more
2020-08-10 23:30:37,660 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:30:37,661 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:30:37,745 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test null in 111 ms.
2020-08-10 23:30:37,776 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.BookieInitializationTest
2020-08-10 23:30:37,791 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:37,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:37,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2513129472, Used space fraction: 0.84717715 > threshold 0.001.
2020-08-10 23:30:37,797 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase null @ metadata service zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode in 21 ms.
2020-08-10 23:30:37,802 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "diskCheckInterval" : "1000",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck14417946036905712311test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "[/tmp/DiskCheck13135602288081137774test/journal-0, /tmp/DiskCheck13135602288081137774test/journal-1, /tmp/DiskCheck13135602288081137774test/journal-2, /tmp/DiskCheck13135602288081137774test/journal-3]",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore"
}
2020-08-10 23:30:37,807 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:37,812 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:37,816 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:37,825 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:37,836 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:37,841 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:30:37,842 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:37,844 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck14417946036905712311test/current/lastMark.0 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:37,844 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck14417946036905712311test/current/lastMark.1 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:37,845 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck14417946036905712311test/current/lastMark.2 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:37,845 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/DiskCheck14417946036905712311test/current/lastMark.3 (this is okay if it is the first time starting this bookie
2020-08-10 23:30:37,845 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:37,845 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:37,846 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:37,847 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:37,847 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:37,848 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:37,857 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:37,860 - INFO  - [SyncThread-358-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0, LogMark: logFileId - 0 , logFileOffset - 0, LogMark: logFileId - 0 , logFileOffset - 0, LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:37,874 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:37,876 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-0/current
2020-08-10 23:30:37,877 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-1/current
2020-08-10 23:30:37,877 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-2/current
2020-08-10 23:30:37,878 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-3/current
2020-08-10 23:30:37,879 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb7.txn
2020-08-10 23:30:37,879 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb8.txn
2020-08-10 23:30:37,879 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb8.txn
2020-08-10 23:30:37,880 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:37,880 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:37,881 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:37,881 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:37,881 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bba.txn
2020-08-10 23:30:38,143 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:38,147 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:38,149 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:38,150 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:38,150 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:38,150 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:38,152 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:44733
2020-08-10 23:30:38,178 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44733] for ledger: 0
2020-08-10 23:30:38,182 - INFO  - [bookkeeper-io-365-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x9a66c8e1, L:/127.0.0.1:38574 - R:127.0.0.1/127.0.0.1:44733]
2020-08-10 23:30:38,185 - INFO  - [bookkeeper-io-365-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:44733
2020-08-10 23:30:38,186 - INFO  - [bookkeeper-io-365-1:PerChannelBookieClient$1@471] - connection [id: 0x9a66c8e1, L:/127.0.0.1:38574 - R:127.0.0.1/127.0.0.1:44733] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:30:38,186 - INFO  - [bookie-io-350-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:30:38,190 - INFO  - [bookie-io-350-2:BookieRequestHandler@50] - Channel connected  [id: 0x7f272289, L:/127.0.0.1:44733 - R:/127.0.0.1:38574]
2020-08-10 23:30:38,236 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44733] for ledger: 1
2020-08-10 23:30:38,296 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44733] for ledger: 2
2020-08-10 23:30:38,329 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44733] for ledger: 3
2020-08-10 23:30:38,394 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:38,395 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:38,396 - INFO  - [bookie-io-350-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x7f272289, L:/127.0.0.1:44733 ! R:/127.0.0.1:38574]
2020-08-10 23:30:38,396 - WARN  - [bookkeeper-io-365-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x9a66c8e1, L:/127.0.0.1:38574 - R:127.0.0.1/127.0.0.1:44733] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:30:38,397 - INFO  - [bookkeeper-io-365-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x9a66c8e1, L:/127.0.0.1:38574 ! R:127.0.0.1/127.0.0.1:44733]
2020-08-10 23:30:38,400 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "44733",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck14417946036905712311test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "[/tmp/DiskCheck13135602288081137774test/journal-0, /tmp/DiskCheck13135602288081137774test/journal-1, /tmp/DiskCheck13135602288081137774test/journal-2, /tmp/DiskCheck13135602288081137774test/journal-3]",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:38,406 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:38,412 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:38,415 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:38,425 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:38,426 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:38,428 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck14417946036905712311test/current : 2512982016, Used space fraction: 0.8471861 > threshold 0.001.
2020-08-10 23:30:38,429 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck14417946036905712311test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:38,430 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:38,430 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:38,435 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:38,435 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:38,438 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:38,439 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:38,440 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:38,441 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:44733
2020-08-10 23:30:38,454 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 0
2020-08-10 23:30:38,456 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb8.txn
2020-08-10 23:30:38,457 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,460 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 0
2020-08-10 23:30:38,460 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb8.txn
2020-08-10 23:30:38,461 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,462 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037879 from position 0
2020-08-10 23:30:38,463 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb7.txn
2020-08-10 23:30:38,463 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,465 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037882 from position 0
2020-08-10 23:30:38,466 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bba.txn
2020-08-10 23:30:38,466 - INFO  - [Time-limited test:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,468 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 14 ms.
2020-08-10 23:30:38,471 - INFO  - [SyncThread-377-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:38,471 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,472 - INFO  - [SyncThread-377-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck14417946036905712311test/current/0.log for logId 0.
2020-08-10 23:30:38,481 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,481 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,483 - INFO  - [pool-359-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/DiskCheck14417946036905712311test/current/1.log for logId 1.
2020-08-10 23:30:38,485 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,486 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,499 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,499 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,503 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,503 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 5120 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,509 - INFO  - [SyncThread-377-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037880 , logFileOffset - 3076, LogMark: logFileId - 1597095037880 , logFileOffset - 4612, LogMark: logFileId - 1597095037879 , logFileOffset - 2564, LogMark: logFileId - 1597095037882 , logFileOffset - 6660]}.
2020-08-10 23:30:38,511 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,514 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,516 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,520 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,523 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:38,529 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-0/current
2020-08-10 23:30:38,529 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-2/current
2020-08-10 23:30:38,529 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-1/current
2020-08-10 23:30:38,531 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-3/current
2020-08-10 23:30:38,531 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb8.txn
2020-08-10 23:30:38,531 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb9.txn
2020-08-10 23:30:38,531 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:38,533 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbb.txn
2020-08-10 23:30:38,532 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:38,531 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb9.txn
2020-08-10 23:30:38,533 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:38,533 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:38,532 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:38,786 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:38,787 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:38,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:38,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2512871424, Used space fraction: 0.8471928 > threshold 0.001.
2020-08-10 23:30:38,801 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-44733 with exitCode 0
2020-08-10 23:30:38,801 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:38,802 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:38,803 - INFO  - [SyncThread-377-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037880 , logFileOffset - 3076, LogMark: logFileId - 1597095037880 , logFileOffset - 4612, LogMark: logFileId - 1597095037879 , logFileOffset - 2564, LogMark: logFileId - 1597095037882 , logFileOffset - 6660]}.
2020-08-10 23:30:38,803 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,806 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,811 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,815 - INFO  - [SyncThread-377-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:38,819 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:38,820 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:38,820 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:38,821 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:38,821 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:38,821 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:38,821 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:38,822 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:38,822 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:38,822 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:38,823 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:38,823 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:38,824 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:38,824 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:38,824 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:38,824 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:38,825 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:38,825 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:38,825 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:38,825 - INFO  - [Bookie-44733:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:38,825 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:38,830 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:38,830 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:38,831 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:38,831 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:38,831 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:38,836 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:38,843 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:38,843 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:38,952 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "44733",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck14417946036905712311test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "[/tmp/DiskCheck13135602288081137774test/journal-0, /tmp/DiskCheck13135602288081137774test/journal-1, /tmp/DiskCheck13135602288081137774test/journal-2, /tmp/DiskCheck13135602288081137774test/journal-3]",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:38,957 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:38,962 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:38,970 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:38,981 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:38,983 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:38,984 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck14417946036905712311test/current : 2512855040, Used space fraction: 0.8471938 > threshold 0.001.
2020-08-10 23:30:38,985 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck14417946036905712311test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:38,985 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:38,986 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:38,988 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:38,989 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:38,992 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:38,993 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:38,993 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:38,995 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:39,001 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 3076
2020-08-10 23:30:39,002 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb8.txn
2020-08-10 23:30:39,002 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037881 from position 0
2020-08-10 23:30:39,002 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb9.txn
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 4612
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb8.txn
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037881 from position 0
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb9.txn
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037879 from position 2564
2020-08-10 23:30:39,003 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb7.txn
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 0
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb8.txn
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037882 from position 6660
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bba.txn
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037883 from position 0
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbb.txn
2020-08-10 23:30:39,004 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 3 ms.
2020-08-10 23:30:39,007 - INFO  - [SyncThread-390-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037880 , logFileOffset - 516, LogMark: logFileId - 1597095037883 , logFileOffset - 516]}.
2020-08-10 23:30:39,007 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,012 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,016 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,019 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,023 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:39,025 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-0/current
2020-08-10 23:30:39,025 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-1/current
2020-08-10 23:30:39,025 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bba.txn
2020-08-10 23:30:39,026 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bba.txn
2020-08-10 23:30:39,025 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-2/current
2020-08-10 23:30:39,026 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,027 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,026 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,027 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-3/current
2020-08-10 23:30:39,027 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb9.txn
2020-08-10 23:30:39,030 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbc.txn
2020-08-10 23:30:39,031 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,034 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:39,286 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:39,286 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:39,294 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-44733 with exitCode 0
2020-08-10 23:30:39,295 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:39,295 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:39,295 - INFO  - [SyncThread-390-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037880 , logFileOffset - 516, LogMark: logFileId - 1597095037883 , logFileOffset - 516]}.
2020-08-10 23:30:39,295 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,300 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,304 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,308 - INFO  - [SyncThread-390-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,313 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,314 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,314 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,314 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,315 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,315 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,315 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,315 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,316 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,316 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,316 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,316 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,316 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,317 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,317 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,318 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,318 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,319 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,319 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,319 - INFO  - [Bookie-44733:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:39,319 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,322 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:39,322 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:39,322 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:39,332 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:39,332 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:39,333 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:39,333 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:39,333 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:39,381 - ERROR - [AuditorElector-127.0.1.1:0:Auditor@717] - Got UnavailableException while trying to get checkAllLedgersCTime
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getCheckAllLedgersCTime(ZkLedgerUnderreplicationManager.java:948)
	at org.apache.bookkeeper.replication.Auditor.scheduleCheckAllLedgersTask(Auditor.java:715)
	at org.apache.bookkeeper.replication.Auditor.start(Auditor.java:686)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:315)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgerstestIOVertexHTTPServerEndpointForARWithPrometheusProvider/underreplication/checkallledgersctime
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:2131)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$17.call(ZooKeeperClient.java:947)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$17.call(ZooKeeperClient.java:941)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getData(ZooKeeperClient.java:941)
	at org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:2160)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2801(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$18.call(ZooKeeperClient.java:969)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$18.call(ZooKeeperClient.java:963)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getData(ZooKeeperClient.java:963)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getCheckAllLedgersCTime(ZkLedgerUnderreplicationManager.java:940)
	... 8 more
2020-08-10 23:30:39,383 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:30:39,383 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:30:39,384 - INFO  - [AuditorElector-127.0.1.1:0:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:30:39,384 - INFO  - [AuditorBookie-127.0.1.1:0:Auditor$8@502] - Shutting down Auditor's Executor
2020-08-10 23:30:39,385 - INFO  - [AuditorBookie-127.0.1.1:0:Auditor$8@502] - Shutting down Auditor's Executor
2020-08-10 23:30:39,441 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "44733",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck14417946036905712311test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "[/tmp/DiskCheck13135602288081137774test/journal-0, /tmp/DiskCheck13135602288081137774test/journal-1, /tmp/DiskCheck13135602288081137774test/journal-2, /tmp/DiskCheck13135602288081137774test/journal-3]",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:39,452 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:39,456 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:39,461 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:39,472 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:39,473 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:39,475 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck14417946036905712311test/current : 2512805888, Used space fraction: 0.8471968 > threshold 0.001.
2020-08-10 23:30:39,475 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck14417946036905712311test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:39,475 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:39,476 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:39,478 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:39,479 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:39,480 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:39,481 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:39,481 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:30:39,485 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doTransitionToReadOnlyMode(BookieStateManager.java:342)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:253)
	at org.apache.bookkeeper.bookie.BookieStateManager$4.call(BookieStateManager.java:250)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:39,493 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037881 from position 516
2020-08-10 23:30:39,493 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bb9.txn
2020-08-10 23:30:39,494 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037882 from position 0
2020-08-10 23:30:39,494 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bba.txn
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037881 from position 516
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bb9.txn
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037882 from position 0
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bba.txn
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037880 from position 516
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb8.txn
2020-08-10 23:30:39,495 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037881 from position 0
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bb9.txn
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037883 from position 516
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbb.txn
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095037884 from position 0
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbc.txn
2020-08-10 23:30:39,496 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 3 ms.
2020-08-10 23:30:39,501 - INFO  - [SyncThread-403-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037882 , logFileOffset - 516, LogMark: logFileId - 1597095037882 , logFileOffset - 516, LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037884 , logFileOffset - 516]}.
2020-08-10 23:30:39,502 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,506 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,510 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,514 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,518 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:39,522 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-2/current
2020-08-10 23:30:39,522 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-1/current
2020-08-10 23:30:39,523 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-2/current/173da484bba.txn
2020-08-10 23:30:39,522 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-3/current
2020-08-10 23:30:39,523 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-1/current/173da484bbb.txn
2020-08-10 23:30:39,522 - INFO  - [BookieJournal-44733:Journal@909] - Starting journal on /tmp/DiskCheck13135602288081137774test/journal-0/current
2020-08-10 23:30:39,524 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,524 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-3/current/173da484bbd.txn
2020-08-10 23:30:39,525 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,525 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,525 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:39,525 - INFO  - [BookieJournal-44733:JournalChannel@157] - Opening journal /tmp/DiskCheck13135602288081137774test/journal-0/current/173da484bbb.txn
2020-08-10 23:30:39,529 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode/available/127.0.0.1:44733
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:39,536 - INFO  - [BookieDeathWatcher-44733:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:39,536 - INFO  - [BookieDeathWatcher-44733:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44733
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:39,542 - INFO  - [BookieDeathWatcher-44733:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:39,542 - INFO  - [BookieDeathWatcher-44733:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:39,636 - INFO  - [AutoRecoveryDeathWatcher-0:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:30:39,637 - ERROR - [AutoRecoveryDeathWatcher-0:ComponentStarter@76] - Triggered exceptionHandler of Component: autorecovery-server because of Exception in Thread: Thread[AutoRecoveryDeathWatcher-0,5,FailOnTimeoutGroup]
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:30:39,639 - INFO  - [component-shutdown-thread:ComponentStarter$ComponentShutdownHook@45] - Closing component autorecovery-server in shutdown hook.
2020-08-10 23:30:39,782 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:39,782 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:39,788 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-44733 with exitCode 0
2020-08-10 23:30:39,789 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:39,789 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:39,789 - INFO  - [SyncThread-403-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095037882 , logFileOffset - 516, LogMark: logFileId - 1597095037882 , logFileOffset - 516, LogMark: logFileId - 1597095037881 , logFileOffset - 516, LogMark: logFileId - 1597095037884 , logFileOffset - 516]}.
2020-08-10 23:30:39,789 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,793 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,795 - WARN  - [LedgerDirsMonitorThread:LedgerDirsMonitor@110] - LedgerDirsMonitor check process: All ledger directories are non writable
2020-08-10 23:30:39,797 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,797 - ERROR - [LedgerDirsMonitorThread:DiskChecker@156] - Space left on device /tmp/DiskCheck2223097718222670685test/current : 2512756736, Used space fraction: 0.8471998 > threshold 0.001.
2020-08-10 23:30:39,800 - INFO  - [SyncThread-403-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1073741824 are: [/tmp/DiskCheck14417946036905712311test/current]
2020-08-10 23:30:39,805 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,805 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,806 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,806 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,807 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,807 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,807 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,808 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,808 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,808 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,808 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,808 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,809 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,809 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,810 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,811 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:39,812 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:39,815 - INFO  - [BookieJournal-44733:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:39,815 - INFO  - [BookieJournal-44733:Journal@1144] - Journal exited loop!
2020-08-10 23:30:39,815 - INFO  - [Bookie-44733:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:39,815 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:39,816 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:39,817 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:39,818 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:39,928 - INFO  - [Time-limited test:BookieServer@99] - {
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.SortedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.001",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "diskCheckInterval" : "1000",
  "bookiePort" : "44733",
  "allowEphemeralPorts" : "true",
  "ledgerDirectories" : "/tmp/DiskCheck14417946036905712311test",
  "autoRecoveryDaemonEnabled" : "false",
  "zkTimeout" : "5000",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode",
  "minUsableSizeForIndexFileCreation" : "5120",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "[/tmp/DiskCheck13135602288081137774test/journal-0, /tmp/DiskCheck13135602288081137774test/journal-1, /tmp/DiskCheck13135602288081137774test/journal-2, /tmp/DiskCheck13135602288081137774test/journal-3]",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "readOnlyModeEnabled" : "true"
}
2020-08-10 23:30:39,931 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40527/ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode : zkServers = localhost:40527, ledgersRootPath = /ledgerstestMultipleJournalReplayForBookieRestartInReadOnlyMode.
2020-08-10 23:30:40,435 - INFO  - [BookieDeathWatcher-44733:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:40,437 - INFO  - [BookieDeathWatcher-44733:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44733
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:40,438 - INFO  - [BookieDeathWatcher-44733:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:40,438 - INFO  - [BookieDeathWatcher-44733:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:40,444 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:40,455 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:40,464 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/DiskCheck13135602288081137774test/journal-0/current, /tmp/DiskCheck13135602288081137774test/journal-1/current, /tmp/DiskCheck13135602288081137774test/journal-2/current, /tmp/DiskCheck13135602288081137774test/journal-3/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:40,466 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:40,468 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/DiskCheck14417946036905712311test/current : 2512756736, Used space fraction: 0.8471998 > threshold 0.001.
2020-08-10 23:30:40,468 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/DiskCheck14417946036905712311test/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:40,471 - INFO  - [BookieStateManagerService-0:BookieStateManager@331] - Transitioning Bookie to ReadOnly mode, and will serve only read requests from clients!
2020-08-10 23:30:40,473 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:30:40,476 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:40,477 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:40,478 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:40,478 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:30:40,478 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
