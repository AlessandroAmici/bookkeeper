2020-08-10 23:39:00,928 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:01,314 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:01,482 - INFO  - [Time-limited test:MetadataDrivers@105] - BookKeeper metadata driver manager initialized
2020-08-10 23:39:01,489 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38385/ledgers : zkServers = localhost:38385, ledgersRootPath = /ledgers.
2020-08-10 23:39:01,504 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:01,639 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:01,679 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:01,680 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:01,685 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:01,757 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:01,955 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie12136403427615431134test",
  "metadataServiceUri" : "zk://localhost:38385/ledgers",
  "journalDirectories" : "/tmp/bookie12136403427615431134test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:02,158 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38385/ledgers : zkServers = localhost:38385, ledgersRootPath = /ledgers.
2020-08-10 23:39:02,168 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:02,185 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:02,203 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie12136403427615431134test/current] [/tmp/bookie12136403427615431134test/current]
2020-08-10 23:39:02,366 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:02,384 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie12136403427615431134test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:02,386 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:02,413 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:02,422 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:02,427 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:02,434 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:02,435 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:02,466 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37261 to become writable
2020-08-10 23:39:02,473 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 2 ms.
2020-08-10 23:39:02,477 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:02,482 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:02,484 - INFO  - [BookieJournal-37261:Journal@909] - Starting journal on /tmp/bookie12136403427615431134test/current
2020-08-10 23:39:02,487 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:02,490 - INFO  - [BookieJournal-37261:JournalChannel@157] - Opening journal /tmp/bookie12136403427615431134test/current/173da4ffed8.txn
2020-08-10 23:39:02,525 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37261
2020-08-10 23:39:02,774 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37261' has been created.
2020-08-10 23:39:02,776 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testRecoverIndexWhenIndexIsPartiallyFlush @ metadata service zk://localhost:38385/ledgers in 1818 ms.
2020-08-10 23:39:02,861 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37261] for ledger: 0
2020-08-10 23:39:02,872 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37261] for ledger: 1
2020-08-10 23:39:02,881 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37261] for ledger: 2
2020-08-10 23:39:02,949 - INFO  - [bookie-io-8-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:02,962 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xb65f7052, L:/127.0.0.1:33844 - R:127.0.0.1/127.0.0.1:37261]
2020-08-10 23:39:02,962 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37261
2020-08-10 23:39:02,962 - INFO  - [bookie-io-8-2:BookieRequestHandler@50] - Channel connected  [id: 0x9ee1c583, L:/127.0.0.1:37261 - R:/127.0.0.1:33844]
2020-08-10 23:39:02,989 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$1@471] - connection [id: 0xb65f7052, L:/127.0.0.1:33844 - R:127.0.0.1/127.0.0.1:37261] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:03,014 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:03,017 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/0.log for logId 0.
2020-08-10 23:39:03,555 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:03,573 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/1.log for logId 1.
2020-08-10 23:39:03,574 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie12136403427615431134test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:03,598 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:04,026 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:04,028 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/2.log for logId 2.
2020-08-10 23:39:04,028 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie12136403427615431134test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:04,059 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:04,484 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:04,497 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:04,498 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/3.log for logId 3.
2020-08-10 23:39:04,498 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie12136403427615431134test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:04,498 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:04,513 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:04,513 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:04,517 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:04,518 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 2]
2020-08-10 23:39:04,604 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:04,605 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:04,608 - INFO  - [bookie-io-8-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x9ee1c583, L:/127.0.0.1:37261 ! R:/127.0.0.1:33844]
2020-08-10 23:39:04,609 - WARN  - [bookkeeper-io-3-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xb65f7052, L:/127.0.0.1:33844 - R:127.0.0.1/127.0.0.1:37261] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:04,610 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xb65f7052, L:/127.0.0.1:33844 ! R:127.0.0.1/127.0.0.1:37261]
2020-08-10 23:39:04,635 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37261 with exitCode 0
2020-08-10 23:39:04,636 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:04,636 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:04,644 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095542488 , logFileOffset - 461312]}.
2020-08-10 23:39:04,648 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:04,649 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:04,649 - INFO  - [BookieJournal-37261:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:04,649 - INFO  - [BookieJournal-37261:Journal@1144] - Journal exited loop!
2020-08-10 23:39:04,650 - INFO  - [Bookie-37261:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:04,651 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:04,652 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:04,652 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:04,652 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:04,652 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:04,653 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:04,656 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:04,674 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:04,674 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:04,682 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37261
2020-08-10 23:39:05,527 - INFO  - [BookieDeathWatcher-37261:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:05,529 - INFO  - [BookieDeathWatcher-37261:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37261
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:05,532 - INFO  - [BookieDeathWatcher-37261:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:05,532 - INFO  - [BookieDeathWatcher-37261:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:05,800 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie12136403427615431134test",
  "metadataServiceUri" : "zk://localhost:38385/ledgers",
  "journalDirectories" : "/tmp/bookie12136403427615431134test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "600000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "37261",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:39:05,805 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38385/ledgers : zkServers = localhost:38385, ledgersRootPath = /ledgers.
2020-08-10 23:39:05,816 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:05,821 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:05,848 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:05,850 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:05,851 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:05,852 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:05,854 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:05,855 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:39:05,855 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:39:05,878 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37261 to become writable
2020-08-10 23:39:05,879 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095542488 from position 461312
2020-08-10 23:39:05,881 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie12136403427615431134test/current/173da4ffed8.txn
2020-08-10 23:39:05,882 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 3 ms.
2020-08-10 23:39:05,883 - INFO  - [SyncThread-23-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095542488 , logFileOffset - 461316]}.
2020-08-10 23:39:05,888 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:05,889 - INFO  - [BookieJournal-37261:Journal@909] - Starting journal on /tmp/bookie12136403427615431134test/current
2020-08-10 23:39:05,890 - INFO  - [BookieJournal-37261:JournalChannel@157] - Opening journal /tmp/bookie12136403427615431134test/current/173da4ffed9.txn
2020-08-10 23:39:05,891 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:05,898 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37261
2020-08-10 23:39:06,158 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37261' has been created.
2020-08-10 23:39:06,182 - INFO  - [Time-limited test:CompactionTest@1255] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:06,185 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 0.
2020-08-10 23:39:06,186 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/4.log.compacting for logId 4.
2020-08-10 23:39:06,284 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie12136403427615431134test/current/4.log.compacting with logId 4.
2020-08-10 23:39:06,317 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:39:06,318 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 0 end in PartialFlushIndexPhase.
2020-08-10 23:39:06,319 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 1.
2020-08-10 23:39:06,320 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/5.log.compacting for logId 5.
2020-08-10 23:39:06,377 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie12136403427615431134test/current/5.log.compacting with logId 5.
2020-08-10 23:39:06,395 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:39:06,396 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 1 end in PartialFlushIndexPhase.
2020-08-10 23:39:06,396 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 2.
2020-08-10 23:39:06,397 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie12136403427615431134test/current/6.log.compacting for logId 6.
2020-08-10 23:39:06,472 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie12136403427615431134test/current/6.log.compacting with logId 6.
2020-08-10 23:39:06,488 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:39:06,489 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 2 end in PartialFlushIndexPhase.
2020-08-10 23:39:06,509 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x54cb2052, L:/127.0.0.1:33848 - R:127.0.0.1/127.0.0.1:37261]
2020-08-10 23:39:06,510 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37261
2020-08-10 23:39:06,511 - INFO  - [bookie-io-18-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:06,512 - INFO  - [bookie-io-18-2:BookieRequestHandler@50] - Channel connected  [id: 0xb281438d, L:/127.0.0.1:37261 - R:/127.0.0.1:33848]
2020-08-10 23:39:06,514 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$1@471] - connection [id: 0x54cb2052, L:/127.0.0.1:33848 - R:127.0.0.1/127.0.0.1:37261] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:06,548 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie12136403427615431134test/current/6.log.2.compacted has partially flushed index, recovering index.
2020-08-10 23:39:06,553 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 6
2020-08-10 23:39:06,567 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:39:06,568 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie12136403427615431134test/current/5.log.1.compacted has partially flushed index, recovering index.
2020-08-10 23:39:06,571 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 5
2020-08-10 23:39:06,581 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:06,581 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie12136403427615431134test/current/4.log.0.compacted has partially flushed index, recovering index.
2020-08-10 23:39:06,584 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 4
2020-08-10 23:39:06,596 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:39:06,609 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:06,610 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37261
2020-08-10 23:39:06,611 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x54cb2052, L:/127.0.0.1:33848 ! R:127.0.0.1/127.0.0.1:37261]
2020-08-10 23:39:06,611 - INFO  - [bookie-io-18-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xb281438d, L:/127.0.0.1:37261 ! R:/127.0.0.1:33848]
2020-08-10 23:39:08,724 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:08,725 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:08,734 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37261 with exitCode 0
2020-08-10 23:39:08,734 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:08,734 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:08,735 - INFO  - [SyncThread-23-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095542488 , logFileOffset - 461316]}.
2020-08-10 23:39:08,740 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:08,740 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:08,741 - INFO  - [BookieJournal-37261:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:08,741 - INFO  - [BookieJournal-37261:Journal@1144] - Journal exited loop!
2020-08-10 23:39:08,741 - INFO  - [Bookie-37261:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:08,741 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:08,742 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:08,742 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:08,742 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:08,742 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:08,743 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:08,744 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:08,750 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:08,750 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:08,908 - INFO  - [BookieDeathWatcher-37261:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:08,909 - INFO  - [BookieDeathWatcher-37261:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37261
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:08,909 - INFO  - [BookieDeathWatcher-37261:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:08,909 - INFO  - [BookieDeathWatcher-37261:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:08,988 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testRecoverIndexWhenIndexIsPartiallyFlush in 2378 ms.
2020-08-10 23:39:08,991 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:09,008 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:09,020 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36455/ledgers : zkServers = localhost:36455, ledgersRootPath = /ledgers.
2020-08-10 23:39:09,028 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:09,031 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:09,033 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:09,033 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:09,033 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:09,044 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:09,045 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9356291354535148591test",
  "metadataServiceUri" : "zk://localhost:36455/ledgers",
  "journalDirectories" : "/tmp/bookie9356291354535148591test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:09,050 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36455/ledgers : zkServers = localhost:36455, ledgersRootPath = /ledgers.
2020-08-10 23:39:09,058 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:09,062 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:09,071 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9356291354535148591test/current] [/tmp/bookie9356291354535148591test/current]
2020-08-10 23:39:09,085 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:09,088 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9356291354535148591test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:09,088 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:09,088 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:09,089 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:09,090 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:09,091 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:09,091 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:09,116 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38825 to become writable
2020-08-10 23:39:09,118 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:09,120 - INFO  - [SyncThread-39-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:09,123 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:09,124 - INFO  - [BookieJournal-38825:Journal@909] - Starting journal on /tmp/bookie9356291354535148591test/current
2020-08-10 23:39:09,129 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:09,130 - INFO  - [BookieJournal-38825:JournalChannel@157] - Opening journal /tmp/bookie9356291354535148591test/current/173da5018cb.txn
2020-08-10 23:39:09,138 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38825
2020-08-10 23:39:09,388 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38825' has been created.
2020-08-10 23:39:09,389 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompactionWithNoWritableLedgerDirsButIsForceGCAllowWhenNoSpaceIsSet @ metadata service zk://localhost:36455/ledgers in 397 ms.
2020-08-10 23:39:09,390 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:09,390 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:09,403 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38825 with exitCode 0
2020-08-10 23:39:09,403 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:09,403 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:09,403 - INFO  - [SyncThread-39-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:09,411 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:09,413 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:09,413 - INFO  - [BookieJournal-38825:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:09,413 - INFO  - [BookieJournal-38825:Journal@1144] - Journal exited loop!
2020-08-10 23:39:09,413 - INFO  - [Bookie-38825:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:09,414 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:09,415 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:09,415 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:09,415 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:09,415 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:09,415 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:09,416 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:09,416 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:09,416 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:09,422 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38825
2020-08-10 23:39:09,638 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "[/tmp/ledger2133513561053563187test1, /tmp/ledger4785098405463323998test2]",
  "metadataServiceUri" : "zk://localhost:36455/ledgers",
  "journalDirectories" : "/tmp/journal672670765169573407test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "600000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:09,642 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36455/ledgers : zkServers = localhost:36455, ledgersRootPath = /ledgers.
2020-08-10 23:39:09,650 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:09,655 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:09,670 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/journal672670765169573407test/current] [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:09,679 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:39:09,682 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:09,685 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/ledger2133513561053563187test1/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:09,685 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/ledger4785098405463323998test2/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:09,685 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:09,686 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:09,686 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:09,688 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:09,689 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:39:09,689 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:39:09,711 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36455/ledgers : zkServers = localhost:36455, ledgersRootPath = /ledgers.
2020-08-10 23:39:09,720 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:09,723 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:09,724 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:09,724 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:09,724 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:09,733 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34515 to become writable
2020-08-10 23:39:09,734 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:09,737 - INFO  - [SyncThread-49-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:09,744 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:09,746 - INFO  - [BookieJournal-34515:Journal@909] - Starting journal on /tmp/journal672670765169573407test/current
2020-08-10 23:39:09,747 - INFO  - [BookieJournal-34515:JournalChannel@157] - Opening journal /tmp/journal672670765169573407test/current/173da501b34.txn
2020-08-10 23:39:09,748 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:09,755 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34515
2020-08-10 23:39:10,005 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34515' has been created.
2020-08-10 23:39:10,039 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34515] for ledger: 0
2020-08-10 23:39:10,049 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34515] for ledger: 1
2020-08-10 23:39:10,057 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34515] for ledger: 2
2020-08-10 23:39:10,062 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x71b05008, L:/127.0.0.1:41730 - R:127.0.0.1/127.0.0.1:34515]
2020-08-10 23:39:10,062 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34515
2020-08-10 23:39:10,062 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$1@471] - connection [id: 0x71b05008, L:/127.0.0.1:41730 - R:127.0.0.1/127.0.0.1:34515] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:10,063 - INFO  - [bookie-io-44-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:10,063 - INFO  - [bookie-io-44-2:BookieRequestHandler@50] - Channel connected  [id: 0xa33537f3, L:/127.0.0.1:34515 - R:/127.0.0.1:41730]
2020-08-10 23:39:10,064 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:10,065 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4785098405463323998test2/current/0.log for logId 0.
2020-08-10 23:39:10,137 - INFO  - [BookieDeathWatcher-38825:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:10,137 - INFO  - [BookieDeathWatcher-38825:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38825
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:10,138 - INFO  - [BookieDeathWatcher-38825:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:10,138 - INFO  - [BookieDeathWatcher-38825:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:10,509 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:10,521 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4785098405463323998test2/current/1.log for logId 1.
2020-08-10 23:39:10,521 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/ledger4785098405463323998test2/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:10,547 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:10,920 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:10,921 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger2133513561053563187test1/current/2.log for logId 2.
2020-08-10 23:39:10,921 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/ledger4785098405463323998test2/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:10,950 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:11,300 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:11,301 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4785098405463323998test2/current/3.log for logId 3.
2020-08-10 23:39:11,301 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/ledger2133513561053563187test1/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:11,329 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:11,416 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:11,417 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/ledger2133513561053563187test1/current is out of space. Adding it to filled dirs list
2020-08-10 23:39:11,417 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:11,419 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/ledger4785098405463323998test2/current is out of space. Adding it to filled dirs list
2020-08-10 23:39:11,419 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:11,419 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:11,420 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:11,421 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:11,429 - INFO  - [Time-limited test:CompactionTest@468] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:11,435 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:11,435 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:11,436 - INFO  - [GarbageCollectorThread-50-1:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = true, reachEntryLogLimit = false
2020-08-10 23:39:11,438 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,439 - INFO  - [GarbageCollectorThread-50-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger2133513561053563187test1/current/4.log for logId 4.
2020-08-10 23:39:11,440 - INFO  - [GarbageCollectorThread-50-1:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/ledger4785098405463323998test2/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:11,440 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,447 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,448 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:39:11,449 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:39:11,450 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,450 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:39:11,451 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:39:11,450 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,456 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,456 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:39:11,457 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,457 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:39:11,457 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:11,462 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,462 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@368] - GarbageCollectorThread-50-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:11,463 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:11,464 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:11,465 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,466 - INFO  - [SyncThread-49-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:39:11,467 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,468 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:11,472 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:11,472 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:11,473 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:11,481 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:11,482 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:34515
2020-08-10 23:39:11,483 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x71b05008, L:/127.0.0.1:41730 ! R:127.0.0.1/127.0.0.1:34515]
2020-08-10 23:39:11,483 - INFO  - [bookie-io-44-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xa33537f3, L:/127.0.0.1:34515 ! R:/127.0.0.1:41730]
2020-08-10 23:39:13,589 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:13,590 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:13,593 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34515 with exitCode 0
2020-08-10 23:39:13,594 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:13,594 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:13,594 - INFO  - [SyncThread-49-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095549748 , logFileOffset - 461312]}.
2020-08-10 23:39:13,594 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger2133513561053563187test1/current, /tmp/ledger4785098405463323998test2/current]
2020-08-10 23:39:13,602 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:13,602 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:13,603 - INFO  - [BookieJournal-34515:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:13,603 - INFO  - [BookieJournal-34515:Journal@1144] - Journal exited loop!
2020-08-10 23:39:13,603 - INFO  - [Bookie-34515:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:13,604 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:13,606 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:13,606 - ERROR - [Time-limited test:InterleavedLedgerStorage@294] - Error while closing the ledger cache
org.apache.bookkeeper.bookie.FileInfo$FileInfoDeletedException: FileInfo already deleted
	at org.apache.bookkeeper.bookie.FileInfo.checkOpen(FileInfo.java:284)
	at org.apache.bookkeeper.bookie.FileInfo.close(FileInfo.java:461)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.lambda$closeAllWithoutFlushing$0(FileInfoBackingCache.java:117)
	at org.apache.bookkeeper.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:485)
	at org.apache.bookkeeper.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:186)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.closeAllWithoutFlushing(FileInfoBackingCache.java:115)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.close(IndexPersistenceMgr.java:346)
	at org.apache.bookkeeper.bookie.LedgerCacheImpl.close(LedgerCacheImpl.java:184)
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.shutdown(InterleavedLedgerStorage.java:292)
	at org.apache.bookkeeper.bookie.Bookie.shutdown(Bookie.java:1198)
	at org.apache.bookkeeper.bookie.Bookie.shutdown(Bookie.java:1167)
	at org.apache.bookkeeper.proto.BookieServer.shutdown(BookieServer.java:208)
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.stopBKCluster(BookKeeperClusterTestCase.java:271)
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.tearDown(BookKeeperClusterTestCase.java:189)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:39:13,607 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:13,607 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:13,756 - INFO  - [BookieDeathWatcher-34515:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:13,756 - INFO  - [BookieDeathWatcher-34515:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34515
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:13,756 - INFO  - [BookieDeathWatcher-34515:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:13,756 - INFO  - [BookieDeathWatcher-34515:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:13,834 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompactionWithNoWritableLedgerDirsButIsForceGCAllowWhenNoSpaceIsSet in 2352 ms.
2020-08-10 23:39:13,837 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:13,857 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:13,866 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42795/ledgers : zkServers = localhost:42795, ledgersRootPath = /ledgers.
2020-08-10 23:39:13,873 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:13,879 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:13,879 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:13,879 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:13,880 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:13,887 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:13,888 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7822311453781455289test",
  "metadataServiceUri" : "zk://localhost:42795/ledgers",
  "journalDirectories" : "/tmp/bookie7822311453781455289test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:13,893 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42795/ledgers : zkServers = localhost:42795, ledgersRootPath = /ledgers.
2020-08-10 23:39:13,898 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:13,902 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:13,910 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7822311453781455289test/current] [/tmp/bookie7822311453781455289test/current]
2020-08-10 23:39:13,923 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:13,926 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7822311453781455289test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:13,926 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:13,927 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:13,927 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:13,929 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:13,929 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:13,929 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:13,950 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34183 to become writable
2020-08-10 23:39:13,951 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:13,952 - INFO  - [SyncThread-71-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:13,956 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:13,958 - INFO  - [BookieJournal-34183:Journal@909] - Starting journal on /tmp/bookie7822311453781455289test/current
2020-08-10 23:39:13,959 - INFO  - [BookieJournal-34183:JournalChannel@157] - Opening journal /tmp/bookie7822311453781455289test/current/173da502ba8.txn
2020-08-10 23:39:13,959 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:13,966 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34183
2020-08-10 23:39:14,217 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34183' has been created.
2020-08-10 23:39:14,219 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionSafety @ metadata service zk://localhost:42795/ledgers in 381 ms.
2020-08-10 23:39:14,219 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:14,331 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:14,332 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:14,335 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34183 with exitCode 0
2020-08-10 23:39:14,335 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:14,336 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:14,336 - INFO  - [SyncThread-71-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:14,341 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:14,341 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:14,342 - INFO  - [BookieJournal-34183:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:14,342 - INFO  - [BookieJournal-34183:Journal@1144] - Journal exited loop!
2020-08-10 23:39:14,342 - INFO  - [Bookie-34183:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:14,342 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:14,343 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:14,343 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:14,343 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:14,343 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:14,344 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:14,344 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:14,344 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:14,345 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:14,568 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSafety in 348 ms.
2020-08-10 23:39:14,570 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:14,570 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:39:14,571 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:14,572 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:39:14,572 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:39:14,573 - INFO  - [Time-limited test:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:14,574 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest8735882872729381125.dir/current/0.log for logId 0.
2020-08-10 23:39:14,577 - INFO  - [Time-limited test:IndexInMemPageMgr@507] - Could not grab a clean page for ledger 2, entry 0, force flushing dirty ledgers.
2020-08-10 23:39:14,579 - INFO  - [pool-49-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest8735882872729381125.dir/current/1.log for logId 1.
2020-08-10 23:39:14,584 - INFO  - [Time-limited test:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:14,585 - INFO  - [Time-limited test:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bkTest8735882872729381125.dir/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:14,586 - INFO  - [pool-49-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest8735882872729381125.dir/current/2.log for logId 2.
2020-08-10 23:39:14,586 - INFO  - [Time-limited test:IndexInMemPageMgr@507] - Could not grab a clean page for ledger 3, entry 0, force flushing dirty ledgers.
2020-08-10 23:39:14,610 - INFO  - [Time-limited test:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:14,610 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:14,610 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:14,611 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:14,611 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:14,611 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:14,612 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:14,617 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:14,618 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:14,619 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:39:14,621 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:14,621 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:39:14,621 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:39:14,722 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:14,724 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:14,725 - INFO  - [GarbageCollectorThread-77-1:EntryLogger@1043] - Failed to get ledgers map index from: 1.log : No ledgers map index found on entryLogId1
2020-08-10 23:39:14,726 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:14,727 - INFO  - [GarbageCollectorThread-77-1:EntryLogger@1043] - Failed to get ledgers map index from: 2.log : readerIndex(0) + length(4) exceeds writerIndex(0): UnpooledByteBufAllocator$InstrumentedUnpooledUnsafeDirectByteBuf(ridx: 0, widx: 0, cap: 1024)
2020-08-10 23:39:14,729 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@396] - Deleting entryLogId 1 as it has no active ledgers!
2020-08-10 23:39:14,729 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:14,970 - INFO  - [BookieDeathWatcher-34183:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:14,970 - INFO  - [BookieDeathWatcher-34183:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34183
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:14,971 - INFO  - [BookieDeathWatcher-34183:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:14,971 - INFO  - [BookieDeathWatcher-34183:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:15,625 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:15,626 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.699999988079071
2020-08-10 23:39:15,626 - INFO  - [GarbageCollectorThread-77-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:15,627 - INFO  - [GarbageCollectorThread-77-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest8735882872729381125.dir/current/3.log for logId 3.
2020-08-10 23:39:15,629 - INFO  - [pool-50-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest8735882872729381125.dir/current/4.log for logId 4.
2020-08-10 23:39:15,648 - INFO  - [GarbageCollectorThread-77-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:39:15,648 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:39:15,648 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]
2020-08-10 23:39:16,635 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:16,636 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:16,636 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:16,636 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:16,636 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:16,640 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:16,644 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:16,644 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:16,645 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:39:16,646 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:16,647 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:39:16,647 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:39:16,649 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:16,650 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSafety in 1 ms.
2020-08-10 23:39:16,653 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:16,670 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:16,680 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38505/ledgers : zkServers = localhost:38505, ledgersRootPath = /ledgers.
2020-08-10 23:39:16,688 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:16,691 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:16,692 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:16,692 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:16,692 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:16,709 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:16,709 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie14999712315797473812test",
  "metadataServiceUri" : "zk://localhost:38505/ledgers",
  "journalDirectories" : "/tmp/bookie14999712315797473812test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:16,713 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38505/ledgers : zkServers = localhost:38505, ledgersRootPath = /ledgers.
2020-08-10 23:39:16,720 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:16,724 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:16,734 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie14999712315797473812test/current] [/tmp/bookie14999712315797473812test/current]
2020-08-10 23:39:16,748 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:16,751 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14999712315797473812test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:16,751 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:16,752 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:16,752 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:16,754 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:16,754 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:16,754 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:16,773 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34903 to become writable
2020-08-10 23:39:16,775 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:16,778 - INFO  - [SyncThread-90-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:16,782 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:16,783 - INFO  - [BookieJournal-34903:Journal@909] - Starting journal on /tmp/bookie14999712315797473812test/current
2020-08-10 23:39:16,784 - INFO  - [BookieJournal-34903:JournalChannel@157] - Opening journal /tmp/bookie14999712315797473812test/current/173da5036b1.txn
2020-08-10 23:39:16,784 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:16,791 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34903
2020-08-10 23:39:17,044 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34903' has been created.
2020-08-10 23:39:17,046 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionPersistence @ metadata service zk://localhost:38505/ledgers in 392 ms.
2020-08-10 23:39:17,075 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34903] for ledger: 0
2020-08-10 23:39:17,084 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34903] for ledger: 1
2020-08-10 23:39:17,092 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34903] for ledger: 2
2020-08-10 23:39:17,096 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xff8d9dd3, L:/127.0.0.1:37550 - R:127.0.0.1/127.0.0.1:34903]
2020-08-10 23:39:17,096 - INFO  - [bookie-io-85-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:17,097 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34903
2020-08-10 23:39:17,097 - INFO  - [bookie-io-85-2:BookieRequestHandler@50] - Channel connected  [id: 0xab03edc2, L:/127.0.0.1:34903 - R:/127.0.0.1:37550]
2020-08-10 23:39:17,097 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$1@471] - connection [id: 0xff8d9dd3, L:/127.0.0.1:37550 - R:127.0.0.1/127.0.0.1:34903] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:17,099 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:17,099 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie14999712315797473812test/current/0.log for logId 0.
2020-08-10 23:39:17,439 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:17,441 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie14999712315797473812test/current/1.log for logId 1.
2020-08-10 23:39:17,441 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie14999712315797473812test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:17,475 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:17,783 - INFO  - [GarbageCollectorThread-91-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:17,807 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:17,808 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie14999712315797473812test/current/2.log for logId 2.
2020-08-10 23:39:17,808 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie14999712315797473812test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:17,836 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:18,163 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:18,164 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie14999712315797473812test/current/3.log for logId 3.
2020-08-10 23:39:18,165 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie14999712315797473812test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:18,190 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:18,255 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:18,255 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:18,256 - WARN  - [bookkeeper-io-81-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xff8d9dd3, L:/127.0.0.1:37550 - R:127.0.0.1/127.0.0.1:34903] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:18,257 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xff8d9dd3, L:/127.0.0.1:37550 ! R:127.0.0.1/127.0.0.1:34903]
2020-08-10 23:39:18,257 - INFO  - [bookie-io-85-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xab03edc2, L:/127.0.0.1:34903 ! R:/127.0.0.1:37550]
2020-08-10 23:39:18,264 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34903 with exitCode 0
2020-08-10 23:39:18,264 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:18,264 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:18,271 - INFO  - [SyncThread-90-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095556785 , logFileOffset - 461312]}.
2020-08-10 23:39:18,274 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:18,275 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:18,275 - INFO  - [BookieJournal-34903:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:18,275 - INFO  - [BookieJournal-34903:Journal@1144] - Journal exited loop!
2020-08-10 23:39:18,276 - INFO  - [Bookie-34903:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:18,276 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:18,276 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:18,277 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:18,277 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:18,277 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:18,277 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:18,279 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:18,285 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:18,285 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:18,290 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34903
2020-08-10 23:39:18,792 - INFO  - [BookieDeathWatcher-34903:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:18,792 - INFO  - [BookieDeathWatcher-34903:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34903
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:18,792 - INFO  - [BookieDeathWatcher-34903:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:18,792 - INFO  - [BookieDeathWatcher-34903:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:19,396 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie14999712315797473812test",
  "metadataServiceUri" : "zk://localhost:38505/ledgers",
  "journalDirectories" : "/tmp/bookie14999712315797473812test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "34903",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.0",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:39:19,401 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38505/ledgers : zkServers = localhost:38505, ledgersRootPath = /ledgers.
2020-08-10 23:39:19,412 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:19,417 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:19,427 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:19,430 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:19,431 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:19,432 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:19,433 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:19,434 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:39:19,434 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:39:19,451 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34903 to become writable
2020-08-10 23:39:19,452 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095556785 from position 461312
2020-08-10 23:39:19,452 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie14999712315797473812test/current/173da5036b1.txn
2020-08-10 23:39:19,452 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:19,454 - INFO  - [SyncThread-100-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095556785 , logFileOffset - 461316]}.
2020-08-10 23:39:19,457 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:19,458 - INFO  - [BookieJournal-34903:Journal@909] - Starting journal on /tmp/bookie14999712315797473812test/current
2020-08-10 23:39:19,460 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:19,460 - INFO  - [BookieJournal-34903:JournalChannel@157] - Opening journal /tmp/bookie14999712315797473812test/current/173da5036b2.txn
2020-08-10 23:39:19,466 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34903
2020-08-10 23:39:19,717 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34903' has been created.
2020-08-10 23:39:19,726 - INFO  - [Time-limited test:CompactionTest@584] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:19,726 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:19,726 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:19,733 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:19,734 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:19,735 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:19,736 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:19,736 - INFO  - [GarbageCollectorThread-101-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:39:19,745 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:39:19,745 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:39:19,745 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:19,745 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:19,746 - INFO  - [GarbageCollectorThread-101-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:19,746 - INFO  - [GarbageCollectorThread-101-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie14999712315797473812test/current/4.log for logId 4.
2020-08-10 23:39:19,754 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:39:19,755 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:39:19,763 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:39:19,764 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:19,773 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:39:19,774 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:39:19,775 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 3, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:19,775 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@368] - GarbageCollectorThread-101-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:19,775 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:19,781 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:19,781 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:19,781 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:19,789 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xeccb9e39, L:/127.0.0.1:37554 - R:127.0.0.1/127.0.0.1:34903]
2020-08-10 23:39:19,789 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34903
2020-08-10 23:39:19,793 - INFO  - [bookie-io-95-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:19,793 - INFO  - [bookie-io-95-2:BookieRequestHandler@50] - Channel connected  [id: 0x61f7544d, L:/127.0.0.1:34903 - R:/127.0.0.1:37554]
2020-08-10 23:39:19,794 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$1@471] - connection [id: 0xeccb9e39, L:/127.0.0.1:37554 - R:127.0.0.1/127.0.0.1:34903] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:19,823 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:19,823 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:19,824 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:19,825 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:19,825 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:39:19,826 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:39:19,836 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:19,836 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:34903
2020-08-10 23:39:19,837 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xeccb9e39, L:/127.0.0.1:37554 ! R:127.0.0.1/127.0.0.1:34903]
2020-08-10 23:39:19,838 - INFO  - [bookie-io-95-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x61f7544d, L:/127.0.0.1:34903 ! R:/127.0.0.1:37554]
2020-08-10 23:39:21,914 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:21,915 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:21,922 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34903 with exitCode 0
2020-08-10 23:39:21,922 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:21,922 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:21,922 - INFO  - [SyncThread-100-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095556785 , logFileOffset - 461316]}.
2020-08-10 23:39:21,926 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:21,927 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:21,927 - INFO  - [BookieJournal-34903:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:21,927 - INFO  - [BookieJournal-34903:Journal@1144] - Journal exited loop!
2020-08-10 23:39:21,927 - INFO  - [Bookie-34903:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:21,927 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:21,928 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:21,928 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:21,928 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:21,928 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:21,928 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:21,932 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:21,933 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:21,933 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:22,172 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionPersistence in 2336 ms.
2020-08-10 23:39:22,174 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:22,193 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:22,202 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36695/ledgers : zkServers = localhost:36695, ledgersRootPath = /ledgers.
2020-08-10 23:39:22,209 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:22,213 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:22,213 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:22,213 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:22,213 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:22,220 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:22,221 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5790642525352404467test",
  "metadataServiceUri" : "zk://localhost:36695/ledgers",
  "journalDirectories" : "/tmp/bookie5790642525352404467test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:22,224 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36695/ledgers : zkServers = localhost:36695, ledgersRootPath = /ledgers.
2020-08-10 23:39:22,229 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:22,242 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:22,251 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5790642525352404467test/current] [/tmp/bookie5790642525352404467test/current]
2020-08-10 23:39:22,269 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:22,271 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5790642525352404467test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:22,271 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:22,272 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:22,272 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:22,275 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:22,276 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:22,276 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:22,293 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41103 to become writable
2020-08-10 23:39:22,294 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:22,295 - INFO  - [SyncThread-119-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:22,299 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:22,300 - INFO  - [BookieJournal-41103:Journal@909] - Starting journal on /tmp/bookie5790642525352404467test/current
2020-08-10 23:39:22,301 - INFO  - [BookieJournal-41103:JournalChannel@157] - Opening journal /tmp/bookie5790642525352404467test/current/173da504c3e.txn
2020-08-10 23:39:22,302 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:22,310 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41103
2020-08-10 23:39:22,468 - INFO  - [BookieDeathWatcher-34903:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:22,468 - INFO  - [BookieDeathWatcher-34903:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34903
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:22,469 - INFO  - [BookieDeathWatcher-34903:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:22,469 - INFO  - [BookieDeathWatcher-34903:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:22,558 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41103' has been created.
2020-08-10 23:39:22,560 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testForceGarbageCollection @ metadata service zk://localhost:36695/ledgers in 385 ms.
2020-08-10 23:39:22,562 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36695/ledgers : zkServers = localhost:36695, ledgersRootPath = /ledgers.
2020-08-10 23:39:22,569 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:22,573 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:22,574 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:22,575 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:22,575 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:39:22,576 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:39:22,576 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:22,576 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:22,583 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:22,583 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:22,583 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:22,583 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@368] - GarbageCollectorThread-127-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:22,583 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:22,586 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:22,586 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:22,586 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:22,589 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:22,590 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:22,590 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:22,590 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:22,590 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:22,590 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:22,591 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:22,695 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:22,812 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:22,813 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:22,822 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41103 with exitCode 0
2020-08-10 23:39:22,822 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:22,822 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:22,822 - INFO  - [SyncThread-119-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:22,825 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:22,826 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:22,826 - INFO  - [BookieJournal-41103:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:22,826 - INFO  - [BookieJournal-41103:Journal@1144] - Journal exited loop!
2020-08-10 23:39:22,827 - INFO  - [Bookie-41103:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:22,827 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:22,827 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:22,827 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:22,827 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:22,828 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:22,828 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:22,828 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:22,828 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:22,828 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:23,052 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testForceGarbageCollection in 356 ms.
2020-08-10 23:39:23,054 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:23,073 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:23,082 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38423/ledgers : zkServers = localhost:38423, ledgersRootPath = /ledgers.
2020-08-10 23:39:23,088 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:23,091 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:23,091 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:23,091 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:23,092 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:23,099 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:23,100 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie17185329261122684390test",
  "metadataServiceUri" : "zk://localhost:38423/ledgers",
  "journalDirectories" : "/tmp/bookie17185329261122684390test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:23,104 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38423/ledgers : zkServers = localhost:38423, ledgersRootPath = /ledgers.
2020-08-10 23:39:23,110 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:23,114 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:23,128 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17185329261122684390test/current] [/tmp/bookie17185329261122684390test/current]
2020-08-10 23:39:23,140 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:23,146 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17185329261122684390test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:23,146 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:23,146 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:23,147 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:23,148 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:23,149 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:23,149 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:23,163 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41897 to become writable
2020-08-10 23:39:23,163 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:23,164 - INFO  - [SyncThread-139-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:23,168 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:23,169 - INFO  - [BookieJournal-41897:Journal@909] - Starting journal on /tmp/bookie17185329261122684390test/current
2020-08-10 23:39:23,171 - INFO  - [BookieJournal-41897:JournalChannel@157] - Opening journal /tmp/bookie17185329261122684390test/current/173da504fa4.txn
2020-08-10 23:39:23,171 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:23,177 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41897
2020-08-10 23:39:23,310 - INFO  - [BookieDeathWatcher-41103:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:23,311 - INFO  - [BookieDeathWatcher-41103:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41103
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:23,311 - INFO  - [BookieDeathWatcher-41103:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:23,311 - INFO  - [BookieDeathWatcher-41103:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:23,428 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41897' has been created.
2020-08-10 23:39:23,430 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompactionWithNoWritableLedgerDirs @ metadata service zk://localhost:38423/ledgers in 376 ms.
2020-08-10 23:39:23,455 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41897] for ledger: 0
2020-08-10 23:39:23,462 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41897] for ledger: 1
2020-08-10 23:39:23,478 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41897] for ledger: 2
2020-08-10 23:39:23,484 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc6a894ce, L:/127.0.0.1:45358 - R:127.0.0.1/127.0.0.1:41897]
2020-08-10 23:39:23,484 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:41897
2020-08-10 23:39:23,484 - INFO  - [bookie-io-134-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:23,484 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$1@471] - connection [id: 0xc6a894ce, L:/127.0.0.1:45358 - R:127.0.0.1/127.0.0.1:41897] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:23,484 - INFO  - [bookie-io-134-2:BookieRequestHandler@50] - Channel connected  [id: 0x1f178c53, L:/127.0.0.1:41897 - R:/127.0.0.1:45358]
2020-08-10 23:39:23,486 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:23,486 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17185329261122684390test/current/0.log for logId 0.
2020-08-10 23:39:23,828 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:23,838 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17185329261122684390test/current/1.log for logId 1.
2020-08-10 23:39:23,839 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie17185329261122684390test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:23,863 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:24,161 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:24,162 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17185329261122684390test/current/2.log for logId 2.
2020-08-10 23:39:24,162 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie17185329261122684390test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:24,172 - INFO  - [GarbageCollectorThread-140-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:24,190 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:24,495 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:24,496 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17185329261122684390test/current/3.log for logId 3.
2020-08-10 23:39:24,496 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie17185329261122684390test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:24,520 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:24,585 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:24,585 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:24,586 - WARN  - [bookkeeper-io-130-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xc6a894ce, L:/127.0.0.1:45358 - R:127.0.0.1/127.0.0.1:41897] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:24,586 - INFO  - [bookie-io-134-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1f178c53, L:/127.0.0.1:41897 ! R:/127.0.0.1:45358]
2020-08-10 23:39:24,586 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc6a894ce, L:/127.0.0.1:45358 ! R:127.0.0.1/127.0.0.1:41897]
2020-08-10 23:39:24,589 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41897 with exitCode 0
2020-08-10 23:39:24,589 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:24,589 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:24,597 - INFO  - [SyncThread-139-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095563172 , logFileOffset - 461312]}.
2020-08-10 23:39:24,600 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:24,601 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:24,601 - INFO  - [BookieJournal-41897:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:24,601 - INFO  - [BookieJournal-41897:Journal@1144] - Journal exited loop!
2020-08-10 23:39:24,602 - INFO  - [Bookie-41897:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:24,602 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:24,602 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:24,603 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:24,603 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:24,603 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:24,603 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:24,605 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:24,606 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:24,606 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:24,617 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41897
2020-08-10 23:39:25,178 - INFO  - [BookieDeathWatcher-41897:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:25,178 - INFO  - [BookieDeathWatcher-41897:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41897
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:25,178 - INFO  - [BookieDeathWatcher-41897:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:25,178 - INFO  - [BookieDeathWatcher-41897:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:25,721 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie17185329261122684390test",
  "metadataServiceUri" : "zk://localhost:38423/ledgers",
  "journalDirectories" : "/tmp/bookie17185329261122684390test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "41897",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:39:25,725 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:38423/ledgers : zkServers = localhost:38423, ledgersRootPath = /ledgers.
2020-08-10 23:39:25,739 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:25,744 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:25,757 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:25,758 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:25,759 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:25,760 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:25,761 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:25,762 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:39:25,762 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:39:25,786 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41897 to become writable
2020-08-10 23:39:25,787 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095563172 from position 461312
2020-08-10 23:39:25,787 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie17185329261122684390test/current/173da504fa4.txn
2020-08-10 23:39:25,787 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:25,788 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095563172 , logFileOffset - 461316]}.
2020-08-10 23:39:25,792 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:25,793 - INFO  - [BookieJournal-41897:Journal@909] - Starting journal on /tmp/bookie17185329261122684390test/current
2020-08-10 23:39:25,794 - INFO  - [BookieJournal-41897:JournalChannel@157] - Opening journal /tmp/bookie17185329261122684390test/current/173da504fa5.txn
2020-08-10 23:39:25,794 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:25,801 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41897
2020-08-10 23:39:26,050 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41897' has been created.
2020-08-10 23:39:26,051 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/bookie17185329261122684390test/current is out of space. Adding it to filled dirs list
2020-08-10 23:39:26,052 - INFO  - [Time-limited test:GarbageCollectorThread@272] - Suspend Major Compaction triggered by thread: Time-limited test
2020-08-10 23:39:26,052 - INFO  - [Time-limited test:GarbageCollectorThread@285] - Suspend Minor Compaction triggered by thread: Time-limited test
2020-08-10 23:39:26,060 - INFO  - [Time-limited test:CompactionTest@397] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:26,061 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:26,062 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:26,062 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:26,063 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:26,063 - INFO  - [GarbageCollectorThread-150-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:39:26,073 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:39:26,073 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:39:26,073 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:26,073 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:26,073 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:26,074 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41897
2020-08-10 23:39:26,185 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:26,185 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:26,193 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41897 with exitCode 0
2020-08-10 23:39:26,193 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:26,193 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:26,193 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095563172 , logFileOffset - 461316]}.
2020-08-10 23:39:26,193 - INFO  - [SyncThread-149-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/bookie17185329261122684390test/current]
2020-08-10 23:39:26,197 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:26,198 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:26,198 - INFO  - [BookieJournal-41897:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:26,198 - INFO  - [BookieJournal-41897:Journal@1144] - Journal exited loop!
2020-08-10 23:39:26,199 - INFO  - [Bookie-41897:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:26,200 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:26,200 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:26,200 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:26,201 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:26,427 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompactionWithNoWritableLedgerDirs in 353 ms.
2020-08-10 23:39:26,430 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:26,444 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:26,453 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39755/ledgers : zkServers = localhost:39755, ledgersRootPath = /ledgers.
2020-08-10 23:39:26,460 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:26,462 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:26,463 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:26,463 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:26,463 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:26,471 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:26,472 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie13925540601840721682test",
  "metadataServiceUri" : "zk://localhost:39755/ledgers",
  "journalDirectories" : "/tmp/bookie13925540601840721682test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:26,477 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39755/ledgers : zkServers = localhost:39755, ledgersRootPath = /ledgers.
2020-08-10 23:39:26,484 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:26,492 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:26,508 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie13925540601840721682test/current] [/tmp/bookie13925540601840721682test/current]
2020-08-10 23:39:26,519 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:26,521 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie13925540601840721682test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:26,521 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:26,522 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:26,522 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:26,524 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:26,525 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:26,525 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:26,538 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39575 to become writable
2020-08-10 23:39:26,540 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:26,540 - INFO  - [SyncThread-165-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:26,545 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:26,546 - INFO  - [BookieJournal-39575:Journal@909] - Starting journal on /tmp/bookie13925540601840721682test/current
2020-08-10 23:39:26,547 - INFO  - [BookieJournal-39575:JournalChannel@157] - Opening journal /tmp/bookie13925540601840721682test/current/173da505cd4.txn
2020-08-10 23:39:26,547 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:26,554 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39575
2020-08-10 23:39:26,800 - INFO  - [BookieDeathWatcher-41897:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:26,801 - INFO  - [BookieDeathWatcher-41897:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41897
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:26,801 - INFO  - [BookieDeathWatcher-41897:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:26,801 - INFO  - [BookieDeathWatcher-41897:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:26,803 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39575' has been created.
2020-08-10 23:39:26,804 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testDisableCompaction @ metadata service zk://localhost:39755/ledgers in 374 ms.
2020-08-10 23:39:26,835 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39575] for ledger: 0
2020-08-10 23:39:26,843 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39575] for ledger: 1
2020-08-10 23:39:26,851 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39575] for ledger: 2
2020-08-10 23:39:26,854 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1208476f, L:/127.0.0.1:45222 - R:127.0.0.1/127.0.0.1:39575]
2020-08-10 23:39:26,854 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39575
2020-08-10 23:39:26,855 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$1@471] - connection [id: 0x1208476f, L:/127.0.0.1:45222 - R:127.0.0.1/127.0.0.1:39575] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:26,855 - INFO  - [bookie-io-160-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:26,855 - INFO  - [bookie-io-160-2:BookieRequestHandler@50] - Channel connected  [id: 0x923f04b6, L:/127.0.0.1:39575 - R:/127.0.0.1:45222]
2020-08-10 23:39:26,856 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:26,856 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13925540601840721682test/current/0.log for logId 0.
2020-08-10 23:39:27,180 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:27,182 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13925540601840721682test/current/1.log for logId 1.
2020-08-10 23:39:27,183 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie13925540601840721682test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:27,212 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:27,517 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:27,519 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13925540601840721682test/current/2.log for logId 2.
2020-08-10 23:39:27,519 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie13925540601840721682test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:27,544 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:27,546 - INFO  - [GarbageCollectorThread-166-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:27,547 - INFO  - [GarbageCollectorThread-166-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:27,841 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:27,843 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13925540601840721682test/current/3.log for logId 3.
2020-08-10 23:39:27,843 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie13925540601840721682test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:27,871 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:27,920 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:27,920 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:27,921 - WARN  - [bookkeeper-io-156-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1208476f, L:/127.0.0.1:45222 - R:127.0.0.1/127.0.0.1:39575] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:27,921 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1208476f, L:/127.0.0.1:45222 ! R:127.0.0.1/127.0.0.1:39575]
2020-08-10 23:39:27,925 - INFO  - [bookie-io-160-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x923f04b6, L:/127.0.0.1:39575 ! R:/127.0.0.1:45222]
2020-08-10 23:39:28,430 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39575 with exitCode 0
2020-08-10 23:39:28,430 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:28,431 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:28,447 - INFO  - [SyncThread-165-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095566548 , logFileOffset - 461824]}.
2020-08-10 23:39:28,450 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:28,450 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:28,451 - INFO  - [BookieJournal-39575:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:28,451 - INFO  - [BookieJournal-39575:Journal@1144] - Journal exited loop!
2020-08-10 23:39:28,453 - INFO  - [Bookie-39575:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:28,453 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:28,453 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:28,454 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:28,454 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:28,454 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:28,454 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:28,456 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:28,457 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:28,457 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:28,463 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39575
2020-08-10 23:39:29,558 - INFO  - [BookieDeathWatcher-39575:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:29,559 - INFO  - [BookieDeathWatcher-39575:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39575
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:29,559 - INFO  - [BookieDeathWatcher-39575:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:29,559 - INFO  - [BookieDeathWatcher-39575:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:29,576 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie13925540601840721682test",
  "metadataServiceUri" : "zk://localhost:39755/ledgers",
  "journalDirectories" : "/tmp/bookie13925540601840721682test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "39575",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:39:29,580 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39755/ledgers : zkServers = localhost:39755, ledgersRootPath = /ledgers.
2020-08-10 23:39:29,590 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:29,596 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:29,608 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:29,610 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:29,610 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:29,611 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:29,613 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:29,613 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:39:29,614 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:39:29,629 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39575 to become writable
2020-08-10 23:39:29,630 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095566548 from position 461824
2020-08-10 23:39:29,630 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie13925540601840721682test/current/173da505cd4.txn
2020-08-10 23:39:29,630 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:29,631 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095566548 , logFileOffset - 461828]}.
2020-08-10 23:39:29,635 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:29,636 - INFO  - [BookieJournal-39575:Journal@909] - Starting journal on /tmp/bookie13925540601840721682test/current
2020-08-10 23:39:29,637 - INFO  - [BookieJournal-39575:JournalChannel@157] - Opening journal /tmp/bookie13925540601840721682test/current/173da505cd5.txn
2020-08-10 23:39:29,637 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:29,644 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39575
2020-08-10 23:39:29,894 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39575' has been created.
2020-08-10 23:39:29,903 - INFO  - [Time-limited test:CompactionTest@214] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:29,903 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:29,904 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:29,905 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:29,905 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:29,905 - INFO  - [GarbageCollectorThread-176-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:39:29,913 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:39:29,914 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:39:29,914 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:29,914 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39575
2020-08-10 23:39:30,022 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:30,022 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:30,027 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39575 with exitCode 0
2020-08-10 23:39:30,028 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:30,028 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:30,028 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095566548 , logFileOffset - 461828]}.
2020-08-10 23:39:30,032 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:30,032 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:30,033 - INFO  - [BookieJournal-39575:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:30,033 - INFO  - [BookieJournal-39575:Journal@1144] - Journal exited loop!
2020-08-10 23:39:30,033 - INFO  - [Bookie-39575:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:30,033 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:30,033 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:30,034 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:30,035 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:30,257 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testDisableCompaction in 343 ms.
2020-08-10 23:39:30,259 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:30,282 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:30,291 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43165/ledgers : zkServers = localhost:43165, ledgersRootPath = /ledgers.
2020-08-10 23:39:30,302 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:30,305 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:30,306 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:30,306 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:30,306 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:30,313 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:30,313 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie10890906724335925408test",
  "metadataServiceUri" : "zk://localhost:43165/ledgers",
  "journalDirectories" : "/tmp/bookie10890906724335925408test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:30,320 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43165/ledgers : zkServers = localhost:43165, ledgersRootPath = /ledgers.
2020-08-10 23:39:30,327 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:30,331 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:30,339 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie10890906724335925408test/current] [/tmp/bookie10890906724335925408test/current]
2020-08-10 23:39:30,351 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:30,353 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie10890906724335925408test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:30,354 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:30,354 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:30,354 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:30,357 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:30,357 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:30,357 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:30,368 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:42083 to become writable
2020-08-10 23:39:30,369 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:30,370 - INFO  - [SyncThread-191-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:30,373 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:30,375 - INFO  - [BookieJournal-42083:Journal@909] - Starting journal on /tmp/bookie10890906724335925408test/current
2020-08-10 23:39:30,375 - INFO  - [BookieJournal-42083:JournalChannel@157] - Opening journal /tmp/bookie10890906724335925408test/current/173da506bc8.txn
2020-08-10 23:39:30,376 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:30,382 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42083
2020-08-10 23:39:30,634 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:42083' has been created.
2020-08-10 23:39:30,635 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testSuspendGarbageCollection @ metadata service zk://localhost:43165/ledgers in 375 ms.
2020-08-10 23:39:30,638 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43165/ledgers : zkServers = localhost:43165, ledgersRootPath = /ledgers.
2020-08-10 23:39:30,644 - INFO  - [BookieDeathWatcher-39575:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:30,644 - INFO  - [BookieDeathWatcher-39575:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39575
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:30,645 - INFO  - [BookieDeathWatcher-39575:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:30,645 - INFO  - [BookieDeathWatcher-39575:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:30,647 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:30,652 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:30,652 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:30,654 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:30,655 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=1000
2020-08-10 23:39:30,655 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=2000
2020-08-10 23:39:31,659 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:31,659 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:31,659 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:32,378 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:32,378 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:32,378 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:32,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:32,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:32,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:33,156 - INFO  - [Time-limited test:GarbageCollectorThread@272] - Suspend Major Compaction triggered by thread: Time-limited test
2020-08-10 23:39:33,658 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:34,159 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:34,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:34,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:34,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:34,381 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:34,381 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:34,381 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:34,658 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:35,159 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:35,664 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:35,664 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:35,664 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:35,664 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:36,159 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:36,658 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:37,164 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:37,165 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:37,165 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:37,165 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:37,381 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:37,382 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:37,382 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:37,663 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:38,157 - INFO  - [Time-limited test:GarbageCollectorThread@285] - Suspend Minor Compaction triggered by thread: Time-limited test
2020-08-10 23:39:38,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:38,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:38,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:39,161 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:39,161 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:39,382 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:39,382 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:39,382 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:39,661 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:39,661 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:40,159 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:40,159 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:40,661 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:40,661 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:41,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:41,160 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:41,383 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:41,383 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:41,383 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:41,658 - INFO  - [Time-limited test:GarbageCollectorThread@291] - Time-limited test Minor Compaction back to normal since bookie has enough space now.
2020-08-10 23:39:41,658 - INFO  - [Time-limited test:GarbageCollectorThread@278] - Time-limited test Major Compaction back to normal since bookie has enough space now.
2020-08-10 23:39:41,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:39:41,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:39:42,162 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:42,163 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:42,163 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:43,659 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:43,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:43,660 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:44,380 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:44,380 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:44,380 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:44,663 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:44,663 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:44,663 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:45,764 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:45,872 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:45,872 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:45,875 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42083 with exitCode 0
2020-08-10 23:39:45,875 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:45,875 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:45,876 - INFO  - [SyncThread-191-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:45,880 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:45,881 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:45,881 - INFO  - [BookieJournal-42083:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:45,881 - INFO  - [BookieJournal-42083:Journal@1144] - Journal exited loop!
2020-08-10 23:39:45,882 - INFO  - [Bookie-42083:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:45,882 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:45,883 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:45,883 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:46,107 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testSuspendGarbageCollection in 342 ms.
2020-08-10 23:39:46,109 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:46,128 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:46,137 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43431/ledgers : zkServers = localhost:43431, ledgersRootPath = /ledgers.
2020-08-10 23:39:46,143 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:46,148 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:46,148 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:46,148 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:46,149 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:46,158 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:46,159 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9487450833185951850test",
  "metadataServiceUri" : "zk://localhost:43431/ledgers",
  "journalDirectories" : "/tmp/bookie9487450833185951850test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:46,165 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43431/ledgers : zkServers = localhost:43431, ledgersRootPath = /ledgers.
2020-08-10 23:39:46,171 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:46,174 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:46,183 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9487450833185951850test/current] [/tmp/bookie9487450833185951850test/current]
2020-08-10 23:39:46,196 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:46,220 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9487450833185951850test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:46,221 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:46,222 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:46,224 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:46,227 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:46,227 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:46,227 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:46,237 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37929 to become writable
2020-08-10 23:39:46,238 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:46,243 - INFO  - [SyncThread-211-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:46,277 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:46,279 - INFO  - [BookieJournal-37929:Journal@909] - Starting journal on /tmp/bookie9487450833185951850test/current
2020-08-10 23:39:46,280 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:46,280 - INFO  - [BookieJournal-37929:JournalChannel@157] - Opening journal /tmp/bookie9487450833185951850test/current/173da50a9e9.txn
2020-08-10 23:39:46,288 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37929
2020-08-10 23:39:46,407 - INFO  - [BookieDeathWatcher-42083:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:46,407 - INFO  - [BookieDeathWatcher-42083:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42083
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:46,407 - INFO  - [BookieDeathWatcher-42083:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:46,407 - INFO  - [BookieDeathWatcher-42083:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:46,540 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37929' has been created.
2020-08-10 23:39:46,541 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionSmallEntryLogs @ metadata service zk://localhost:43431/ledgers in 432 ms.
2020-08-10 23:39:46,571 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37929] for ledger: 0
2020-08-10 23:39:46,574 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xfd5a425e, L:/127.0.0.1:39386 - R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:46,574 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37929
2020-08-10 23:39:46,574 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$1@471] - connection [id: 0xfd5a425e, L:/127.0.0.1:39386 - R:127.0.0.1/127.0.0.1:37929] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:46,575 - INFO  - [bookie-io-206-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:46,575 - INFO  - [bookie-io-206-2:BookieRequestHandler@50] - Channel connected  [id: 0x0242d27f, L:/127.0.0.1:37929 - R:/127.0.0.1:39386]
2020-08-10 23:39:46,576 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:46,577 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/0.log for logId 0.
2020-08-10 23:39:46,596 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:46,596 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:46,597 - WARN  - [bookkeeper-io-202-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xfd5a425e, L:/127.0.0.1:39386 - R:127.0.0.1/127.0.0.1:37929] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:46,597 - INFO  - [bookie-io-206-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x0242d27f, L:/127.0.0.1:37929 ! R:/127.0.0.1:39386]
2020-08-10 23:39:46,597 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xfd5a425e, L:/127.0.0.1:39386 ! R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:46,599 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37929 with exitCode 0
2020-08-10 23:39:46,600 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:46,600 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:46,608 - INFO  - [SyncThread-211-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095586281 , logFileOffset - 5120]}.
2020-08-10 23:39:46,612 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:46,613 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:46,613 - INFO  - [BookieJournal-37929:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:46,613 - INFO  - [BookieJournal-37929:Journal@1144] - Journal exited loop!
2020-08-10 23:39:46,613 - INFO  - [Bookie-37929:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:46,613 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:46,614 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:46,614 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:46,614 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:46,614 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:46,614 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:46,616 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:46,616 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:46,616 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:46,623 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37929
2020-08-10 23:39:47,289 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:47,290 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37929
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:47,290 - INFO  - [BookieDeathWatcher-37929:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:47,290 - INFO  - [BookieDeathWatcher-37929:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:47,726 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9487450833185951850test",
  "metadataServiceUri" : "zk://localhost:43431/ledgers",
  "journalDirectories" : "/tmp/bookie9487450833185951850test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "37929",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:47,732 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43431/ledgers : zkServers = localhost:43431, ledgersRootPath = /ledgers.
2020-08-10 23:39:47,741 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:47,744 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:47,757 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:47,759 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:47,760 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:47,760 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:47,762 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:47,763 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:47,763 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:47,772 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37929 to become writable
2020-08-10 23:39:47,773 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095586281 from position 5120
2020-08-10 23:39:47,773 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie9487450833185951850test/current/173da50a9e9.txn
2020-08-10 23:39:47,773 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:47,774 - INFO  - [SyncThread-221-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095586281 , logFileOffset - 5124]}.
2020-08-10 23:39:47,777 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:47,778 - INFO  - [BookieJournal-37929:Journal@909] - Starting journal on /tmp/bookie9487450833185951850test/current
2020-08-10 23:39:47,779 - INFO  - [BookieJournal-37929:JournalChannel@157] - Opening journal /tmp/bookie9487450833185951850test/current/173da50a9ea.txn
2020-08-10 23:39:47,781 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:47,787 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37929
2020-08-10 23:39:48,038 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37929' has been created.
2020-08-10 23:39:48,046 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37929] for ledger: 1
2020-08-10 23:39:48,054 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37929] for ledger: 2
2020-08-10 23:39:48,062 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37929] for ledger: 3
2020-08-10 23:39:48,065 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xd244e8d1, L:/127.0.0.1:39390 - R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:48,065 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37929
2020-08-10 23:39:48,065 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$1@471] - connection [id: 0xd244e8d1, L:/127.0.0.1:39390 - R:127.0.0.1/127.0.0.1:37929] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:48,065 - INFO  - [bookie-io-216-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:48,065 - INFO  - [bookie-io-216-2:BookieRequestHandler@50] - Channel connected  [id: 0x0192f235, L:/127.0.0.1:37929 - R:/127.0.0.1:39390]
2020-08-10 23:39:48,066 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:48,067 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/1.log for logId 1.
2020-08-10 23:39:48,397 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:48,398 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/2.log for logId 2.
2020-08-10 23:39:48,398 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie9487450833185951850test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:48,431 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:48,707 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:48,708 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/3.log for logId 3.
2020-08-10 23:39:48,708 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie9487450833185951850test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:48,740 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:48,778 - INFO  - [GarbageCollectorThread-222-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:48,779 - INFO  - [GarbageCollectorThread-222-1:EntryLogger@1043] - Failed to get ledgers map index from: 0.log : No ledgers map index found on entryLogId0
2020-08-10 23:39:48,779 - INFO  - [GarbageCollectorThread-222-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:48,780 - INFO  - [GarbageCollectorThread-222-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:49,042 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:49,044 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/4.log for logId 4.
2020-08-10 23:39:49,045 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/bookie9487450833185951850test/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:49,074 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:39:49,141 - INFO  - [Time-limited test:CompactionTest@781] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:49,141 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:49,141 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:49,142 - WARN  - [bookkeeper-io-202-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xd244e8d1, L:/127.0.0.1:39390 - R:127.0.0.1/127.0.0.1:37929] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:49,142 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xd244e8d1, L:/127.0.0.1:39390 ! R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:49,142 - ERROR - [bookie-io-216-2:DefaultPromise@770] - Failed to submit a listener notification task. Event loop shut down?
java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:867)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:328)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:321)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:778)
	at io.netty.util.concurrent.DefaultPromise.safeExecute(DefaultPromise.java:768)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:432)
	at io.netty.util.concurrent.DefaultPromise.setSuccess(DefaultPromise.java:94)
	at io.netty.channel.group.DefaultChannelGroupFuture.setSuccess0(DefaultChannelGroupFuture.java:205)
	at io.netty.channel.group.DefaultChannelGroupFuture.access$400(DefaultChannelGroupFuture.java:40)
	at io.netty.channel.group.DefaultChannelGroupFuture$1.operationComplete(DefaultChannelGroupFuture.java:74)
	at io.netty.channel.group.DefaultChannelGroupFuture$1.operationComplete(DefaultChannelGroupFuture.java:47)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:485)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:982)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.doClose0(AbstractChannel.java:769)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:744)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:615)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.close(DefaultChannelPipeline.java:1376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.access$1100(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$13.run(AbstractChannelHandlerContext.java:613)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:335)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:39:49,143 - INFO  - [bookie-io-216-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x0192f235, L:/127.0.0.1:37929 ! R:/127.0.0.1:39390]
2020-08-10 23:39:49,145 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37929 with exitCode 0
2020-08-10 23:39:49,145 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:49,145 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:49,152 - INFO  - [SyncThread-221-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095586282 , logFileOffset - 461312]}.
2020-08-10 23:39:49,156 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:49,157 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:49,157 - INFO  - [BookieJournal-37929:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:49,157 - INFO  - [BookieJournal-37929:Journal@1144] - Journal exited loop!
2020-08-10 23:39:49,158 - INFO  - [Bookie-37929:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:49,158 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:49,160 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:49,161 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:49,161 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:49,166 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37929
2020-08-10 23:39:49,790 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:49,790 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37929
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:49,790 - INFO  - [BookieDeathWatcher-37929:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:49,790 - INFO  - [BookieDeathWatcher-37929:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:50,272 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9487450833185951850test",
  "metadataServiceUri" : "zk://localhost:43431/ledgers",
  "journalDirectories" : "/tmp/bookie9487450833185951850test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "37929",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:50,277 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43431/ledgers : zkServers = localhost:43431, ledgersRootPath = /ledgers.
2020-08-10 23:39:50,291 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:50,293 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:50,317 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:50,319 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:50,320 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:50,321 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:50,322 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:50,323 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:50,323 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:50,335 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37929 to become writable
2020-08-10 23:39:50,336 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095586282 from position 461312
2020-08-10 23:39:50,337 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie9487450833185951850test/current/173da50a9ea.txn
2020-08-10 23:39:50,337 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:50,337 - INFO  - [SyncThread-231-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095586282 , logFileOffset - 461316]}.
2020-08-10 23:39:50,340 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:50,341 - INFO  - [BookieJournal-37929:Journal@909] - Starting journal on /tmp/bookie9487450833185951850test/current
2020-08-10 23:39:50,342 - INFO  - [BookieJournal-37929:JournalChannel@157] - Opening journal /tmp/bookie9487450833185951850test/current/173da50a9eb.txn
2020-08-10 23:39:50,343 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:50,352 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37929
2020-08-10 23:39:50,603 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37929' has been created.
2020-08-10 23:39:50,603 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:50,603 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:50,603 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:50,604 - INFO  - [GarbageCollectorThread-232-1:EntryLogger@1043] - Failed to get ledgers map index from: 0.log : No ledgers map index found on entryLogId0
2020-08-10 23:39:50,604 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:50,604 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:50,605 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:50,605 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:39:50,605 - INFO  - [GarbageCollectorThread-232-1:EntryLogger@1043] - Failed to get ledgers map index from: 4.log : No ledgers map index found on entryLogId4
2020-08-10 23:39:50,612 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@396] - Deleting entryLogId 4 as it has no active ledgers!
2020-08-10 23:39:50,613 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 4
2020-08-10 23:39:50,613 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:50,613 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:50,613 - INFO  - [GarbageCollectorThread-232-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:50,618 - INFO  - [GarbageCollectorThread-232-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9487450833185951850test/current/5.log for logId 5.
2020-08-10 23:39:50,626 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:39:50,626 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:50,633 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:39:50,633 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:39:50,640 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 3 after compaction
2020-08-10 23:39:50,640 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:39:50,640 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 1]
2020-08-10 23:39:50,640 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@368] - GarbageCollectorThread-232-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:50,640 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:50,646 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:39:50,646 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:39:50,646 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
2020-08-10 23:39:50,650 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe41ddf3d, L:/127.0.0.1:39394 - R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:50,651 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37929
2020-08-10 23:39:50,651 - INFO  - [bookie-io-226-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:50,652 - INFO  - [bookie-io-226-2:BookieRequestHandler@50] - Channel connected  [id: 0x15bb821f, L:/127.0.0.1:37929 - R:/127.0.0.1:39394]
2020-08-10 23:39:50,652 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$1@471] - connection [id: 0xe41ddf3d, L:/127.0.0.1:39394 - R:127.0.0.1/127.0.0.1:37929] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:50,657 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:50,657 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37929
2020-08-10 23:39:50,657 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe41ddf3d, L:/127.0.0.1:39394 ! R:127.0.0.1/127.0.0.1:37929]
2020-08-10 23:39:50,657 - INFO  - [bookie-io-226-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x15bb821f, L:/127.0.0.1:37929 ! R:/127.0.0.1:39394]
2020-08-10 23:39:52,758 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:52,758 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:52,766 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37929 with exitCode 0
2020-08-10 23:39:52,766 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:52,767 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:52,767 - INFO  - [SyncThread-231-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095586282 , logFileOffset - 461316]}.
2020-08-10 23:39:52,771 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:52,771 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:52,772 - INFO  - [BookieJournal-37929:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:52,772 - INFO  - [BookieJournal-37929:Journal@1144] - Journal exited loop!
2020-08-10 23:39:52,772 - INFO  - [Bookie-37929:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:52,772 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:52,773 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:52,773 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:52,773 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:52,773 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:52,773 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:52,777 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:52,777 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:52,777 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:53,009 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSmallEntryLogs in 2352 ms.
2020-08-10 23:39:53,011 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:53,029 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,040 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43261/ledgers : zkServers = localhost:43261, ledgersRootPath = /ledgers.
2020-08-10 23:39:53,046 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,049 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:53,050 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:53,050 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:53,050 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:53,061 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:53,062 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie722911047626563165test",
  "metadataServiceUri" : "zk://localhost:43261/ledgers",
  "journalDirectories" : "/tmp/bookie722911047626563165test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:53,067 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43261/ledgers : zkServers = localhost:43261, ledgersRootPath = /ledgers.
2020-08-10 23:39:53,080 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,083 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:53,091 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie722911047626563165test/current] [/tmp/bookie722911047626563165test/current]
2020-08-10 23:39:53,102 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:53,104 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie722911047626563165test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:53,104 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:53,105 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:53,105 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:53,106 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:53,106 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:53,106 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:53,115 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:42099 to become writable
2020-08-10 23:39:53,115 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:53,116 - INFO  - [SyncThread-247-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:53,120 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:53,121 - INFO  - [BookieJournal-42099:Journal@909] - Starting journal on /tmp/bookie722911047626563165test/current
2020-08-10 23:39:53,122 - INFO  - [BookieJournal-42099:JournalChannel@157] - Opening journal /tmp/bookie722911047626563165test/current/173da50c4a3.txn
2020-08-10 23:39:53,122 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:53,129 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42099
2020-08-10 23:39:53,352 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:53,352 - INFO  - [BookieDeathWatcher-37929:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37929
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:53,353 - INFO  - [BookieDeathWatcher-37929:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:53,353 - INFO  - [BookieDeathWatcher-37929:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:53,384 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:42099' has been created.
2020-08-10 23:39:53,386 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testWhenNoLogsToCompact @ metadata service zk://localhost:43261/ledgers in 374 ms.
2020-08-10 23:39:53,386 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:53,493 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:53,493 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:53,501 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42099 with exitCode 0
2020-08-10 23:39:53,501 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:53,501 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:53,502 - INFO  - [SyncThread-247-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:53,507 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:53,508 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:53,508 - INFO  - [BookieJournal-42099:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:53,508 - INFO  - [BookieJournal-42099:Journal@1144] - Journal exited loop!
2020-08-10 23:39:53,509 - INFO  - [Bookie-42099:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:53,509 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:53,510 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:53,735 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testWhenNoLogsToCompact in 349 ms.
2020-08-10 23:39:53,738 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:53,738 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:53,741 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:53,741 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:39:53,742 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:39:53,742 - INFO  - [Time-limited test:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.1
2020-08-10 23:39:53,742 - INFO  - [Time-limited test:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:53,742 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:53,742 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testWhenNoLogsToCompact in 0 ms.
2020-08-10 23:39:53,744 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:53,759 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,766 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42973/ledgers : zkServers = localhost:42973, ledgersRootPath = /ledgers.
2020-08-10 23:39:53,775 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,780 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:53,780 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:53,780 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:53,780 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:53,788 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:53,788 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie760179923880459618test",
  "metadataServiceUri" : "zk://localhost:42973/ledgers",
  "journalDirectories" : "/tmp/bookie760179923880459618test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:53,792 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42973/ledgers : zkServers = localhost:42973, ledgersRootPath = /ledgers.
2020-08-10 23:39:53,798 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:53,801 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:53,812 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie760179923880459618test/current] [/tmp/bookie760179923880459618test/current]
2020-08-10 23:39:53,825 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:53,828 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie760179923880459618test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:53,829 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:53,829 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:53,830 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:53,831 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:53,831 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:53,831 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:53,839 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:40025 to become writable
2020-08-10 23:39:53,839 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:39:53,840 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:53,844 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:53,845 - INFO  - [BookieJournal-40025:Journal@909] - Starting journal on /tmp/bookie760179923880459618test/current
2020-08-10 23:39:53,847 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:53,847 - INFO  - [BookieJournal-40025:JournalChannel@157] - Opening journal /tmp/bookie760179923880459618test/current/173da50c778.txn
2020-08-10 23:39:53,855 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40025
2020-08-10 23:39:54,105 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:40025' has been created.
2020-08-10 23:39:54,107 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompaction @ metadata service zk://localhost:42973/ledgers in 362 ms.
2020-08-10 23:39:54,129 - INFO  - [BookieDeathWatcher-42099:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:54,129 - INFO  - [BookieDeathWatcher-42099:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42099
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:54,129 - INFO  - [BookieDeathWatcher-42099:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:54,129 - INFO  - [BookieDeathWatcher-42099:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:54,135 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:40025] for ledger: 0
2020-08-10 23:39:54,142 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:40025] for ledger: 1
2020-08-10 23:39:54,149 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:40025] for ledger: 2
2020-08-10 23:39:54,152 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x145356de, L:/127.0.0.1:33018 - R:127.0.0.1/127.0.0.1:40025]
2020-08-10 23:39:54,152 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40025
2020-08-10 23:39:54,152 - INFO  - [bookie-io-259-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:54,152 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$1@471] - connection [id: 0x145356de, L:/127.0.0.1:33018 - R:127.0.0.1/127.0.0.1:40025] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:54,153 - INFO  - [bookie-io-259-2:BookieRequestHandler@50] - Channel connected  [id: 0xf2b37e3d, L:/127.0.0.1:40025 - R:/127.0.0.1:33018]
2020-08-10 23:39:54,153 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:54,154 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie760179923880459618test/current/0.log for logId 0.
2020-08-10 23:39:54,458 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:54,460 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie760179923880459618test/current/1.log for logId 1.
2020-08-10 23:39:54,460 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie760179923880459618test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:54,492 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:39:54,780 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:54,781 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie760179923880459618test/current/2.log for logId 2.
2020-08-10 23:39:54,781 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie760179923880459618test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:54,810 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:39:54,845 - INFO  - [GarbageCollectorThread-265-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:54,845 - INFO  - [GarbageCollectorThread-265-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:55,092 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:55,093 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie760179923880459618test/current/3.log for logId 3.
2020-08-10 23:39:55,093 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie760179923880459618test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:55,118 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:39:55,178 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:55,178 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:55,179 - WARN  - [bookkeeper-io-255-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x145356de, L:/127.0.0.1:33018 - R:127.0.0.1/127.0.0.1:40025] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:39:55,179 - INFO  - [bookie-io-259-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xf2b37e3d, L:/127.0.0.1:40025 ! R:/127.0.0.1:33018]
2020-08-10 23:39:55,179 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x145356de, L:/127.0.0.1:33018 ! R:127.0.0.1/127.0.0.1:40025]
2020-08-10 23:39:55,184 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40025 with exitCode 0
2020-08-10 23:39:55,184 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:55,184 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:55,191 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095593848 , logFileOffset - 461312]}.
2020-08-10 23:39:55,195 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:55,195 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:55,195 - INFO  - [BookieJournal-40025:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:55,196 - INFO  - [BookieJournal-40025:Journal@1144] - Journal exited loop!
2020-08-10 23:39:55,196 - INFO  - [Bookie-40025:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:55,196 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:55,196 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:55,196 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:55,197 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:55,197 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:55,197 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:55,198 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:55,198 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:55,199 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:55,204 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40025
2020-08-10 23:39:55,853 - INFO  - [BookieDeathWatcher-40025:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:55,853 - INFO  - [BookieDeathWatcher-40025:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40025
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:55,854 - INFO  - [BookieDeathWatcher-40025:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:55,854 - INFO  - [BookieDeathWatcher-40025:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:56,308 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie760179923880459618test",
  "metadataServiceUri" : "zk://localhost:42973/ledgers",
  "journalDirectories" : "/tmp/bookie760179923880459618test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "40025",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:39:56,312 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42973/ledgers : zkServers = localhost:42973, ledgersRootPath = /ledgers.
2020-08-10 23:39:56,323 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:56,327 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:56,342 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:56,344 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:56,344 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:56,345 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:56,348 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:56,348 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:39:56,348 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:39:56,354 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:40025 to become writable
2020-08-10 23:39:56,355 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095593848 from position 461312
2020-08-10 23:39:56,355 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie760179923880459618test/current/173da50c778.txn
2020-08-10 23:39:56,355 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:56,356 - INFO  - [SyncThread-274-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095593848 , logFileOffset - 461316]}.
2020-08-10 23:39:56,359 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:56,360 - INFO  - [BookieJournal-40025:Journal@909] - Starting journal on /tmp/bookie760179923880459618test/current
2020-08-10 23:39:56,361 - INFO  - [BookieJournal-40025:JournalChannel@157] - Opening journal /tmp/bookie760179923880459618test/current/173da50c779.txn
2020-08-10 23:39:56,363 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:56,369 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40025
2020-08-10 23:39:56,622 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:40025' has been created.
2020-08-10 23:39:56,622 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:56,622 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:56,622 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:39:56,623 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:39:56,624 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:39:56,624 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:39:56,624 - INFO  - [GarbageCollectorThread-275-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:39:56,632 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:56,632 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:56,633 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 4]
2020-08-10 23:39:56,633 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@368] - GarbageCollectorThread-275-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:56,633 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:56,638 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:56,638 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:56,638 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 4]
2020-08-10 23:39:56,648 - INFO  - [Time-limited test:CompactionTest@329] - Finished deleting the ledgers contains most entries.
2020-08-10 23:39:56,648 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:39:56,648 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:56,656 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:39:56,656 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:39:56,656 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:56,656 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:56,657 - INFO  - [GarbageCollectorThread-275-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:56,658 - INFO  - [GarbageCollectorThread-275-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie760179923880459618test/current/4.log for logId 4.
2020-08-10 23:39:56,667 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:39:56,667 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:39:56,674 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:39:56,675 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:39:56,682 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:39:56,682 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:39:56,682 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:56,683 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@368] - GarbageCollectorThread-275-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:39:56,683 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:39:56,687 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:39:56,687 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:39:56,687 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:39:56,690 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa9d8ed5a, L:/127.0.0.1:33022 - R:127.0.0.1/127.0.0.1:40025]
2020-08-10 23:39:56,691 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40025
2020-08-10 23:39:56,691 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$1@471] - connection [id: 0xa9d8ed5a, L:/127.0.0.1:33022 - R:127.0.0.1/127.0.0.1:40025] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:56,692 - INFO  - [bookie-io-269-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:56,692 - INFO  - [bookie-io-269-2:BookieRequestHandler@50] - Channel connected  [id: 0xc43d82d8, L:/127.0.0.1:40025 - R:/127.0.0.1:33022]
2020-08-10 23:39:56,700 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:39:56,700 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40025
2020-08-10 23:39:56,701 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa9d8ed5a, L:/127.0.0.1:33022 ! R:127.0.0.1/127.0.0.1:40025]
2020-08-10 23:39:56,701 - INFO  - [bookie-io-269-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc43d82d8, L:/127.0.0.1:40025 ! R:/127.0.0.1:33022]
2020-08-10 23:39:58,804 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:58,805 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:58,809 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40025 with exitCode 0
2020-08-10 23:39:58,809 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:39:58,809 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:39:58,810 - INFO  - [SyncThread-274-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095593848 , logFileOffset - 461316]}.
2020-08-10 23:39:58,814 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:39:58,814 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:39:58,815 - INFO  - [BookieJournal-40025:Journal@1135] - Journal exits when shutting down
2020-08-10 23:39:58,815 - INFO  - [BookieJournal-40025:Journal@1144] - Journal exited loop!
2020-08-10 23:39:58,815 - INFO  - [Bookie-40025:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:39:58,815 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:39:58,816 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:39:58,816 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:39:58,816 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:39:58,816 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:39:58,816 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:39:58,818 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:39:58,818 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:39:58,819 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:39:59,038 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompaction in 2338 ms.
2020-08-10 23:39:59,039 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:39:59,054 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:59,061 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44357/ledgers : zkServers = localhost:44357, ledgersRootPath = /ledgers.
2020-08-10 23:39:59,079 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:59,081 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:39:59,082 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:39:59,082 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:39:59,082 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:39:59,090 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:39:59,090 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7273566122246788246test",
  "metadataServiceUri" : "zk://localhost:44357/ledgers",
  "journalDirectories" : "/tmp/bookie7273566122246788246test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:39:59,094 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44357/ledgers : zkServers = localhost:44357, ledgersRootPath = /ledgers.
2020-08-10 23:39:59,100 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:39:59,103 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:39:59,108 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7273566122246788246test/current] [/tmp/bookie7273566122246788246test/current]
2020-08-10 23:39:59,120 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:39:59,121 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7273566122246788246test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:39:59,122 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:39:59,122 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:39:59,122 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:39:59,123 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:39:59,123 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:39:59,123 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:39:59,130 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38425 to become writable
2020-08-10 23:39:59,131 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:39:59,131 - INFO  - [SyncThread-290-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:39:59,135 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:39:59,139 - INFO  - [BookieJournal-38425:Journal@909] - Starting journal on /tmp/bookie7273566122246788246test/current
2020-08-10 23:39:59,146 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:39:59,146 - INFO  - [BookieJournal-38425:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2b.txn
2020-08-10 23:39:59,152 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38425
2020-08-10 23:39:59,376 - INFO  - [BookieDeathWatcher-40025:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:39:59,376 - INFO  - [BookieDeathWatcher-40025:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40025
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:39:59,376 - INFO  - [BookieDeathWatcher-40025:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:39:59,376 - INFO  - [BookieDeathWatcher-40025:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:39:59,404 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38425' has been created.
2020-08-10 23:39:59,405 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionFailureShouldNotResultInDuplicatedData @ metadata service zk://localhost:44357/ledgers in 365 ms.
2020-08-10 23:39:59,431 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38425] for ledger: 0
2020-08-10 23:39:59,438 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38425] for ledger: 1
2020-08-10 23:39:59,444 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38425] for ledger: 2
2020-08-10 23:39:59,447 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x14a69ab4, L:/127.0.0.1:52622 - R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:39:59,447 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38425
2020-08-10 23:39:59,447 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$1@471] - connection [id: 0x14a69ab4, L:/127.0.0.1:52622 - R:127.0.0.1/127.0.0.1:38425] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:39:59,448 - INFO  - [bookie-io-285-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:39:59,448 - INFO  - [bookie-io-285-2:BookieRequestHandler@50] - Channel connected  [id: 0xc5db0e2c, L:/127.0.0.1:38425 - R:/127.0.0.1:52622]
2020-08-10 23:39:59,449 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:39:59,449 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/0.log for logId 0.
2020-08-10 23:39:59,746 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:39:59,748 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/1.log for logId 1.
2020-08-10 23:39:59,748 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie7273566122246788246test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:39:59,786 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:40:00,074 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:00,076 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/2.log for logId 2.
2020-08-10 23:40:00,076 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie7273566122246788246test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:00,105 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:40:00,136 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:00,137 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:00,396 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:00,397 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/3.log for logId 3.
2020-08-10 23:40:00,397 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie7273566122246788246test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:00,422 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:40:00,706 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:00,708 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/4.log for logId 4.
2020-08-10 23:40:00,709 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/bookie7273566122246788246test/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:00,746 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:40:01,028 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:01,029 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/5.log for logId 5.
2020-08-10 23:40:01,030 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 4 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=4, logFile=/tmp/bookie7273566122246788246test/current/4.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:01,059 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 4 to disk.
2020-08-10 23:40:01,136 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:40:01,137 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:40:01,137 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:40:01,142 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:40:01,142 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:40:01,143 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 5]
2020-08-10 23:40:01,162 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:01,162 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:01,164 - WARN  - [bookkeeper-io-281-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x14a69ab4, L:/127.0.0.1:52622 - R:127.0.0.1/127.0.0.1:38425] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:40:01,164 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x14a69ab4, L:/127.0.0.1:52622 ! R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:40:01,165 - INFO  - [bookie-io-285-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc5db0e2c, L:/127.0.0.1:38425 ! R:/127.0.0.1:52622]
2020-08-10 23:40:01,179 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38425 with exitCode 0
2020-08-10 23:40:01,179 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:01,179 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:01,186 - INFO  - [SyncThread-290-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095599147 , logFileOffset - 768512]}.
2020-08-10 23:40:01,190 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:01,190 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:01,190 - INFO  - [BookieJournal-38425:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:01,190 - INFO  - [BookieJournal-38425:Journal@1144] - Journal exited loop!
2020-08-10 23:40:01,191 - INFO  - [Bookie-38425:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:01,191 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:01,191 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:01,191 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:01,191 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:01,192 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:01,192 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:01,193 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:01,194 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:01,194 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:01,198 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38425
2020-08-10 23:40:02,158 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:02,158 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38425
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:02,159 - INFO  - [BookieDeathWatcher-38425:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:02,159 - INFO  - [BookieDeathWatcher-38425:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:02,308 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7273566122246788246test",
  "metadataServiceUri" : "zk://localhost:44357/ledgers",
  "useTransactionalCompaction" : "true",
  "journalDirectories" : "/tmp/bookie7273566122246788246test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "38425",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:40:02,313 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44357/ledgers : zkServers = localhost:44357, ledgersRootPath = /ledgers.
2020-08-10 23:40:02,322 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:02,327 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:02,339 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:02,340 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:02,341 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:02,341 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:02,343 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:02,343 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:40:02,343 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:40:02,364 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38425 to become writable
2020-08-10 23:40:02,365 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095599147 from position 768512
2020-08-10 23:40:02,365 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2b.txn
2020-08-10 23:40:02,365 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:02,366 - INFO  - [SyncThread-300-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095599147 , logFileOffset - 768516]}.
2020-08-10 23:40:02,370 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:02,371 - INFO  - [BookieJournal-38425:Journal@909] - Starting journal on /tmp/bookie7273566122246788246test/current
2020-08-10 23:40:02,373 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:02,373 - INFO  - [BookieJournal-38425:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2c.txn
2020-08-10 23:40:02,377 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38425
2020-08-10 23:40:02,626 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38425' has been created.
2020-08-10 23:40:02,637 - INFO  - [Time-limited test:CompactionTest@1315] - Finished deleting the ledgers contains most entries.
2020-08-10 23:40:03,371 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:03,372 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:03,372 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:40:03,372 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:40:03,372 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:40:03,372 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 5
2020-08-10 23:40:03,373 - INFO  - [GarbageCollectorThread-301-1:EntryLogger@1043] - Failed to get ledgers map index from: 5.log : No ledgers map index found on entryLogId5
2020-08-10 23:40:03,383 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@396] - Deleting entryLogId 5 as it has no active ledgers!
2020-08-10 23:40:03,383 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@494] - Removing entry log metadata for 5
2020-08-10 23:40:07,640 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 0
2020-08-10 23:40:07,640 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/6.log.compacting for logId 6.
2020-08-10 23:40:07,740 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/6.log.compacting with logId 6.
2020-08-10 23:40:07,742 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:07,743 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 0 end in FlushCompactionLogPhase.
2020-08-10 23:40:07,743 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 1
2020-08-10 23:40:07,743 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/7.log.compacting for logId 7.
2020-08-10 23:40:07,836 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/7.log.compacting with logId 7.
2020-08-10 23:40:07,837 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:07,838 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 1 end in FlushCompactionLogPhase.
2020-08-10 23:40:07,838 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 2
2020-08-10 23:40:07,839 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/8.log.compacting for logId 8.
2020-08-10 23:40:07,926 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/8.log.compacting with logId 8.
2020-08-10 23:40:07,926 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:07,927 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 2 end in FlushCompactionLogPhase.
2020-08-10 23:40:07,928 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 3
2020-08-10 23:40:07,928 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/9.log.compacting for logId 9.
2020-08-10 23:40:08,019 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/9.log.compacting with logId 9.
2020-08-10 23:40:08,020 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:08,021 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 3 end in FlushCompactionLogPhase.
2020-08-10 23:40:08,022 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 4
2020-08-10 23:40:08,022 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/a.log.compacting for logId 10.
2020-08-10 23:40:08,114 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/a.log.compacting with logId 10.
2020-08-10 23:40:08,114 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:08,115 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 4 end in FlushCompactionLogPhase.
2020-08-10 23:40:08,120 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x9565a80b, L:/127.0.0.1:52626 - R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:40:08,121 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38425
2020-08-10 23:40:08,121 - INFO  - [bookie-io-295-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:08,121 - INFO  - [bookie-io-295-2:BookieRequestHandler@50] - Channel connected  [id: 0x1f3e3dee, L:/127.0.0.1:38425 - R:/127.0.0.1:52626]
2020-08-10 23:40:08,121 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$1@471] - connection [id: 0x9565a80b, L:/127.0.0.1:52626 - R:127.0.0.1/127.0.0.1:38425] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:08,129 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:08,129 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:08,130 - WARN  - [bookkeeper-io-281-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x9565a80b, L:/127.0.0.1:52626 - R:127.0.0.1/127.0.0.1:38425] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:40:08,131 - INFO  - [bookie-io-295-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1f3e3dee, L:/127.0.0.1:38425 ! R:/127.0.0.1:52626]
2020-08-10 23:40:08,132 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x9565a80b, L:/127.0.0.1:52626 ! R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:40:08,137 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38425 with exitCode 0
2020-08-10 23:40:08,138 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:08,138 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:08,138 - INFO  - [SyncThread-300-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095599147 , logFileOffset - 768516]}.
2020-08-10 23:40:08,142 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:08,143 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:08,143 - INFO  - [BookieJournal-38425:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:08,143 - INFO  - [BookieJournal-38425:Journal@1144] - Journal exited loop!
2020-08-10 23:40:08,143 - INFO  - [Bookie-38425:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:08,143 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:08,144 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:08,144 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:08,144 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:08,144 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:08,144 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:08,145 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:08,145 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:08,146 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:08,150 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38425
2020-08-10 23:40:08,384 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:08,384 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38425
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:08,385 - INFO  - [BookieDeathWatcher-38425:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:08,385 - INFO  - [BookieDeathWatcher-38425:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:09,261 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7273566122246788246test",
  "metadataServiceUri" : "zk://localhost:44357/ledgers",
  "useTransactionalCompaction" : "true",
  "journalDirectories" : "/tmp/bookie7273566122246788246test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "38425",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:40:09,265 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44357/ledgers : zkServers = localhost:44357, ledgersRootPath = /ledgers.
2020-08-10 23:40:09,274 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:09,276 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:09,285 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:09,287 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:09,288 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:09,289 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:09,290 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:09,290 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:40:09,290 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:40:09,301 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38425 to become writable
2020-08-10 23:40:09,302 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095599147 from position 768516
2020-08-10 23:40:09,302 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2b.txn
2020-08-10 23:40:09,302 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095599148 from position 0
2020-08-10 23:40:09,302 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2c.txn
2020-08-10 23:40:09,302 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:09,303 - INFO  - [SyncThread-310-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095599148 , logFileOffset - 516]}.
2020-08-10 23:40:09,307 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:09,308 - INFO  - [BookieJournal-38425:Journal@909] - Starting journal on /tmp/bookie7273566122246788246test/current
2020-08-10 23:40:09,309 - INFO  - [BookieJournal-38425:JournalChannel@157] - Opening journal /tmp/bookie7273566122246788246test/current/173da50dc2d.txn
2020-08-10 23:40:09,309 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:09,315 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38425
2020-08-10 23:40:09,565 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38425' has been created.
2020-08-10 23:40:10,309 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:10,310 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:10,310 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:40:10,310 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:40:10,310 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:40:13,313 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:40:13,314 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:40:13,314 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 0 with usage 0.02127659574468085.
2020-08-10 23:40:13,315 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/b.log.compacting for logId 11.
2020-08-10 23:40:13,324 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/b.log.compacting with logId 11.
2020-08-10 23:40:13,332 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:40:13,333 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 0.
2020-08-10 23:40:13,333 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 1 with usage 0.02127659574468085.
2020-08-10 23:40:13,333 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/c.log.compacting for logId 12.
2020-08-10 23:40:13,348 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/c.log.compacting with logId 12.
2020-08-10 23:40:13,355 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:40:13,355 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 1.
2020-08-10 23:40:13,355 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 2 with usage 0.02127659574468085.
2020-08-10 23:40:13,357 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/d.log.compacting for logId 13.
2020-08-10 23:40:13,371 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/d.log.compacting with logId 13.
2020-08-10 23:40:13,379 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:40:13,379 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 2.
2020-08-10 23:40:13,379 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 3 with usage 0.02127659574468085.
2020-08-10 23:40:13,380 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/e.log.compacting for logId 14.
2020-08-10 23:40:13,394 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/e.log.compacting with logId 14.
2020-08-10 23:40:13,404 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:40:13,404 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 3.
2020-08-10 23:40:13,404 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 4 with usage 0.02127659574468085.
2020-08-10 23:40:13,405 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7273566122246788246test/current/f.log.compacting for logId 15.
2020-08-10 23:40:13,419 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie7273566122246788246test/current/f.log.compacting with logId 15.
2020-08-10 23:40:13,426 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 4
2020-08-10 23:40:13,426 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 4.
2020-08-10 23:40:13,426 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 5, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:40:14,578 - INFO  - [bookie-io-305-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:14,578 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x0601146d, L:/127.0.0.1:52632 - R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:40:14,579 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38425
2020-08-10 23:40:14,579 - INFO  - [bookie-io-305-2:BookieRequestHandler@50] - Channel connected  [id: 0xd2a3ebdf, L:/127.0.0.1:38425 - R:/127.0.0.1:52632]
2020-08-10 23:40:14,579 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$1@471] - connection [id: 0x0601146d, L:/127.0.0.1:52632 - R:127.0.0.1/127.0.0.1:38425] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:14,591 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:40:14,591 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38425
2020-08-10 23:40:14,592 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x0601146d, L:/127.0.0.1:52632 ! R:127.0.0.1/127.0.0.1:38425]
2020-08-10 23:40:14,592 - INFO  - [bookie-io-305-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xd2a3ebdf, L:/127.0.0.1:38425 ! R:/127.0.0.1:52632]
2020-08-10 23:40:16,686 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:16,686 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:16,694 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38425 with exitCode 0
2020-08-10 23:40:16,694 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:16,694 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:16,694 - INFO  - [SyncThread-310-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095599148 , logFileOffset - 516]}.
2020-08-10 23:40:16,699 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:16,700 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:16,700 - INFO  - [BookieJournal-38425:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:16,700 - INFO  - [BookieJournal-38425:Journal@1144] - Journal exited loop!
2020-08-10 23:40:16,700 - INFO  - [Bookie-38425:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:16,700 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:16,701 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:16,920 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionFailureShouldNotResultInDuplicatedData in 2328 ms.
2020-08-10 23:40:16,922 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:40:16,947 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:16,965 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39967/ledgers : zkServers = localhost:39967, ledgersRootPath = /ledgers.
2020-08-10 23:40:16,972 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:16,974 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:40:16,974 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:40:16,975 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:40:16,975 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:40:16,982 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:40:16,983 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie3443344472553302340test",
  "metadataServiceUri" : "zk://localhost:39967/ledgers",
  "journalDirectories" : "/tmp/bookie3443344472553302340test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:40:16,987 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39967/ledgers : zkServers = localhost:39967, ledgersRootPath = /ledgers.
2020-08-10 23:40:16,995 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:16,998 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:17,002 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie3443344472553302340test/current] [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:17,016 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:17,018 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie3443344472553302340test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:40:17,018 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:17,019 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:17,019 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:17,020 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:17,020 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:40:17,020 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:40:17,032 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45557 to become writable
2020-08-10 23:40:17,032 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:17,033 - INFO  - [SyncThread-326-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:40:17,037 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:17,039 - INFO  - [BookieJournal-45557:Journal@909] - Starting journal on /tmp/bookie3443344472553302340test/current
2020-08-10 23:40:17,040 - INFO  - [BookieJournal-45557:JournalChannel@157] - Opening journal /tmp/bookie3443344472553302340test/current/173da512211.txn
2020-08-10 23:40:17,042 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:17,047 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45557
2020-08-10 23:40:17,299 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45557' has been created.
2020-08-10 23:40:17,301 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionWhenLedgerDirsAreFull @ metadata service zk://localhost:39967/ledgers in 378 ms.
2020-08-10 23:40:17,319 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:17,319 - INFO  - [BookieDeathWatcher-38425:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38425
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:17,320 - INFO  - [BookieDeathWatcher-38425:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:17,320 - INFO  - [BookieDeathWatcher-38425:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:17,326 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45557] for ledger: 0
2020-08-10 23:40:17,331 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45557] for ledger: 1
2020-08-10 23:40:17,337 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45557] for ledger: 2
2020-08-10 23:40:17,352 - INFO  - [bookie-io-321-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:17,352 - INFO  - [bookie-io-321-2:BookieRequestHandler@50] - Channel connected  [id: 0xb88072cf, L:/127.0.0.1:45557 - R:/127.0.0.1:43342]
2020-08-10 23:40:17,352 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf355b64e, L:/127.0.0.1:43342 - R:127.0.0.1/127.0.0.1:45557]
2020-08-10 23:40:17,353 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45557
2020-08-10 23:40:17,353 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$1@471] - connection [id: 0xf355b64e, L:/127.0.0.1:43342 - R:127.0.0.1/127.0.0.1:45557] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:17,354 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:40:17,354 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3443344472553302340test/current/0.log for logId 0.
2020-08-10 23:40:17,647 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:17,647 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3443344472553302340test/current/1.log for logId 1.
2020-08-10 23:40:17,648 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie3443344472553302340test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:17,677 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:40:17,946 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:17,947 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3443344472553302340test/current/2.log for logId 2.
2020-08-10 23:40:17,947 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie3443344472553302340test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:17,973 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:40:18,038 - INFO  - [GarbageCollectorThread-327-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:18,039 - INFO  - [GarbageCollectorThread-327-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:18,238 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:18,239 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3443344472553302340test/current/3.log for logId 3.
2020-08-10 23:40:18,239 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie3443344472553302340test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:18,264 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:40:18,331 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:18,331 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:18,332 - WARN  - [bookkeeper-io-317-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xf355b64e, L:/127.0.0.1:43342 - R:127.0.0.1/127.0.0.1:45557] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:40:18,332 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf355b64e, L:/127.0.0.1:43342 ! R:127.0.0.1/127.0.0.1:45557]
2020-08-10 23:40:18,332 - INFO  - [bookie-io-321-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xb88072cf, L:/127.0.0.1:45557 ! R:/127.0.0.1:43342]
2020-08-10 23:40:18,338 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45557 with exitCode 0
2020-08-10 23:40:18,338 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:18,338 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:18,339 - INFO  - [SyncThread-326-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095617041 , logFileOffset - 461312]}.
2020-08-10 23:40:18,342 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:18,343 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:18,343 - INFO  - [BookieJournal-45557:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:18,343 - INFO  - [BookieJournal-45557:Journal@1144] - Journal exited loop!
2020-08-10 23:40:18,343 - INFO  - [Bookie-45557:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:18,343 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:18,344 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:18,344 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:18,344 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:18,344 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:18,344 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:18,345 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:18,346 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:18,346 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:18,461 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45557
2020-08-10 23:40:19,048 - INFO  - [BookieDeathWatcher-45557:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:19,048 - INFO  - [BookieDeathWatcher-45557:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45557
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:19,049 - INFO  - [BookieDeathWatcher-45557:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:19,049 - INFO  - [BookieDeathWatcher-45557:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:19,458 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.77210385",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie3443344472553302340test",
  "metadataServiceUri" : "zk://localhost:39967/ledgers",
  "minUsableSizeForIndexFileCreation" : "1",
  "journalDirectories" : "/tmp/bookie3443344472553302340test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "forceReadOnlyBookie" : "true",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "45557",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "1",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.0",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "false"
}
2020-08-10 23:40:19,463 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39967/ledgers : zkServers = localhost:39967, ledgersRootPath = /ledgers.
2020-08-10 23:40:19,753 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:19,756 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:19,764 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:19,768 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/bookie3443344472553302340test/current : 2336890880, Used space fraction: 0.8578941 > threshold 0.77210385.
2020-08-10 23:40:19,769 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/bookie3443344472553302340test/current is out of space. Adding it to filled dirs list
2020-08-10 23:40:19,770 - INFO  - [BookieStateManagerService-0:ReadOnlyBookie$1@73] - Skip transition to readonly mode for readonly bookie
2020-08-10 23:40:19,770 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:19,770 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:19,771 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:19,772 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:19,772 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:40:19,772 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:40:19,773 - INFO  - [Time-limited test:ReadOnlyBookie@56] - Running bookie in force readonly mode.
2020-08-10 23:40:19,785 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45557 to become readonly
2020-08-10 23:40:19,788 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095617041 from position 461312
2020-08-10 23:40:19,788 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie3443344472553302340test/current/173da512211.txn
2020-08-10 23:40:19,788 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:19,789 - INFO  - [SyncThread-336-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095617041 , logFileOffset - 461316]}.
2020-08-10 23:40:19,789 - INFO  - [SyncThread-336-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:19,792 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:19,794 - INFO  - [BookieJournal-45557:Journal@909] - Starting journal on /tmp/bookie3443344472553302340test/current
2020-08-10 23:40:19,794 - INFO  - [BookieJournal-45557:JournalChannel@157] - Opening journal /tmp/bookie3443344472553302340test/current/173da512212.txn
2020-08-10 23:40:19,795 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:19,804 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgers/available/127.0.0.1:45557 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgers/available/127.0.0.1:45557
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:40:20,058 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45557' has been created.
2020-08-10 23:40:20,066 - INFO  - [Time-limited test:CompactionTest@699] - Finished deleting the ledgers contains most entries.
2020-08-10 23:40:20,066 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:40:20,066 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:40:20,066 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:20,067 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:20,068 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:40:20,071 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:40:20,071 - INFO  - [GarbageCollectorThread-337-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:40:20,077 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:40:20,081 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:40:20,081 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:40:20,081 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:40:20,082 - INFO  - [GarbageCollectorThread-337-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:40:20,082 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,082 - INFO  - [GarbageCollectorThread-337-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3443344472553302340test/current/4.log for logId 4.
2020-08-10 23:40:20,088 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,088 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,092 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:40:20,092 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:40:20,097 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,098 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,102 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:40:20,102 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:40:20,106 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,106 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:20,109 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:40:20,110 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:40:20,110 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 3, 0, 0, 0, 0, 0, 0]
2020-08-10 23:40:20,110 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@368] - GarbageCollectorThread-337-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:40:20,110 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:40:20,115 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:40:20,115 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:40:20,115 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:40:20,120 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe679c797, L:/127.0.0.1:43346 - R:127.0.0.1/127.0.0.1:45557]
2020-08-10 23:40:20,120 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45557
2020-08-10 23:40:20,120 - INFO  - [bookie-io-331-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:20,120 - INFO  - [bookie-io-331-2:BookieRequestHandler@50] - Channel connected  [id: 0x1816da92, L:/127.0.0.1:45557 - R:/127.0.0.1:43346]
2020-08-10 23:40:20,121 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$1@471] - connection [id: 0xe679c797, L:/127.0.0.1:43346 - R:127.0.0.1/127.0.0.1:45557] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:20,151 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:40:20,151 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45557
2020-08-10 23:40:20,152 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe679c797, L:/127.0.0.1:43346 ! R:127.0.0.1/127.0.0.1:45557]
2020-08-10 23:40:20,152 - INFO  - [bookie-io-331-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1816da92, L:/127.0.0.1:45557 ! R:/127.0.0.1:43346]
2020-08-10 23:40:22,254 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:22,255 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:22,264 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45557 with exitCode 0
2020-08-10 23:40:22,264 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:22,264 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:22,264 - INFO  - [SyncThread-336-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095617041 , logFileOffset - 461316]}.
2020-08-10 23:40:22,264 - INFO  - [SyncThread-336-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie3443344472553302340test/current]
2020-08-10 23:40:22,269 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:22,270 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:22,270 - INFO  - [BookieJournal-45557:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:22,270 - INFO  - [BookieJournal-45557:Journal@1144] - Journal exited loop!
2020-08-10 23:40:22,270 - INFO  - [Bookie-45557:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:22,270 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:22,270 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:22,271 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:22,271 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:22,271 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:22,271 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:22,272 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:22,272 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:22,272 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:22,493 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionWhenLedgerDirsAreFull in 2341 ms.
2020-08-10 23:40:22,494 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:40:22,513 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:22,522 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45821/ledgers : zkServers = localhost:45821, ledgersRootPath = /ledgers.
2020-08-10 23:40:22,530 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:22,533 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:40:22,534 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:40:22,534 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:40:22,534 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:40:22,541 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:40:22,542 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie9303297826040220265test",
  "metadataServiceUri" : "zk://localhost:45821/ledgers",
  "journalDirectories" : "/tmp/bookie9303297826040220265test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:40:22,545 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45821/ledgers : zkServers = localhost:45821, ledgersRootPath = /ledgers.
2020-08-10 23:40:22,551 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:22,557 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:22,564 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9303297826040220265test/current] [/tmp/bookie9303297826040220265test/current]
2020-08-10 23:40:22,574 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:22,576 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9303297826040220265test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:40:22,577 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:22,577 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:22,577 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:22,579 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:22,579 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:40:22,579 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:40:22,588 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41165 to become writable
2020-08-10 23:40:22,589 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:22,589 - INFO  - [SyncThread-352-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:40:22,593 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:22,594 - INFO  - [BookieJournal-41165:Journal@909] - Starting journal on /tmp/bookie9303297826040220265test/current
2020-08-10 23:40:22,596 - INFO  - [BookieJournal-41165:JournalChannel@157] - Opening journal /tmp/bookie9303297826040220265test/current/173da5137c5.txn
2020-08-10 23:40:22,596 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:22,603 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41165
2020-08-10 23:40:22,810 - INFO  - [BookieDeathWatcher-45557:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:22,812 - INFO  - [BookieDeathWatcher-45557:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45557
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:22,813 - INFO  - [BookieDeathWatcher-45557:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:22,813 - INFO  - [BookieDeathWatcher-45557:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:22,853 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41165' has been created.
2020-08-10 23:40:22,854 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMajorCompactionAboveThreshold @ metadata service zk://localhost:45821/ledgers in 359 ms.
2020-08-10 23:40:22,876 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41165] for ledger: 0
2020-08-10 23:40:22,882 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41165] for ledger: 1
2020-08-10 23:40:22,889 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41165] for ledger: 2
2020-08-10 23:40:22,895 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x89cb2c91, L:/127.0.0.1:36220 - R:127.0.0.1/127.0.0.1:41165]
2020-08-10 23:40:22,895 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:41165
2020-08-10 23:40:22,895 - INFO  - [bookie-io-347-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:22,895 - INFO  - [bookie-io-347-2:BookieRequestHandler@50] - Channel connected  [id: 0xf036dc15, L:/127.0.0.1:41165 - R:/127.0.0.1:36220]
2020-08-10 23:40:22,895 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$1@471] - connection [id: 0x89cb2c91, L:/127.0.0.1:36220 - R:127.0.0.1/127.0.0.1:41165] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:22,896 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:40:22,896 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9303297826040220265test/current/0.log for logId 0.
2020-08-10 23:40:23,224 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:23,226 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9303297826040220265test/current/1.log for logId 1.
2020-08-10 23:40:23,226 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie9303297826040220265test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:23,265 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:40:23,579 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:23,581 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9303297826040220265test/current/2.log for logId 2.
2020-08-10 23:40:23,581 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie9303297826040220265test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:23,593 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:23,610 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:40:23,878 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:23,879 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9303297826040220265test/current/3.log for logId 3.
2020-08-10 23:40:23,879 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie9303297826040220265test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:23,905 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:40:23,993 - INFO  - [Time-limited test:CompactionTest@743] - Finished deleting the ledgers contains less entries.
2020-08-10 23:40:23,993 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:40:23,993 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:40:23,994 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:23,994 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:40:24,000 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:40:24,001 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:40:24,001 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 3, 0, 0]
2020-08-10 23:40:24,001 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@368] - GarbageCollectorThread-353-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:40:24,001 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:40:24,005 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:40:24,005 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:40:24,005 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 3, 0, 0]
2020-08-10 23:40:24,005 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:40:24,005 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41165
2020-08-10 23:40:24,006 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x89cb2c91, L:/127.0.0.1:36220 ! R:127.0.0.1/127.0.0.1:41165]
2020-08-10 23:40:24,008 - INFO  - [bookie-io-347-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xf036dc15, L:/127.0.0.1:41165 ! R:/127.0.0.1:36220]
2020-08-10 23:40:24,113 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:24,113 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:24,122 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41165 with exitCode 0
2020-08-10 23:40:24,122 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:24,122 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:24,129 - INFO  - [SyncThread-352-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095622597 , logFileOffset - 461312]}.
2020-08-10 23:40:24,132 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:24,133 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:24,134 - INFO  - [BookieJournal-41165:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:24,134 - INFO  - [BookieJournal-41165:Journal@1144] - Journal exited loop!
2020-08-10 23:40:24,134 - INFO  - [Bookie-41165:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:40:24,134 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:40:24,135 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:40:24,135 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:40:24,135 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:40:24,135 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:40:24,135 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:40:24,136 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:40:24,137 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:40:24,137 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:40:24,354 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMajorCompactionAboveThreshold in 348 ms.
2020-08-10 23:40:24,363 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByEntriesTest
2020-08-10 23:40:24,380 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:24,389 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33757/ledgers : zkServers = localhost:33757, ledgersRootPath = /ledgers.
2020-08-10 23:40:24,395 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:24,398 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:40:24,399 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:40:24,399 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:40:24,399 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:40:24,407 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:40:24,408 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5541101105254815017test",
  "metadataServiceUri" : "zk://localhost:33757/ledgers",
  "journalDirectories" : "/tmp/bookie5541101105254815017test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "false",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:40:24,411 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33757/ledgers : zkServers = localhost:33757, ledgersRootPath = /ledgers.
2020-08-10 23:40:24,416 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:40:24,420 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:40:24,425 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5541101105254815017test/current] [/tmp/bookie5541101105254815017test/current]
2020-08-10 23:40:24,434 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:40:24,436 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5541101105254815017test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:40:24,436 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:40:24,436 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:40:24,437 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:40:24,438 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:40:24,438 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:40:24,438 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:40:24,452 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37523 to become writable
2020-08-10 23:40:24,452 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:40:24,453 - INFO  - [SyncThread-368-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:40:24,456 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:40:24,458 - INFO  - [BookieJournal-37523:Journal@909] - Starting journal on /tmp/bookie5541101105254815017test/current
2020-08-10 23:40:24,458 - INFO  - [BookieJournal-37523:JournalChannel@157] - Opening journal /tmp/bookie5541101105254815017test/current/173da513f0b.txn
2020-08-10 23:40:24,459 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:40:24,465 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37523
2020-08-10 23:40:24,609 - INFO  - [BookieDeathWatcher-41165:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:40:24,609 - INFO  - [BookieDeathWatcher-41165:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41165
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:40:24,609 - INFO  - [BookieDeathWatcher-41165:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:24,609 - INFO  - [BookieDeathWatcher-41165:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:24,714 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37523' has been created.
2020-08-10 23:40:24,717 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMajorCompaction @ metadata service zk://localhost:33757/ledgers in 352 ms.
2020-08-10 23:40:24,744 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37523] for ledger: 0
2020-08-10 23:40:24,750 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37523] for ledger: 1
2020-08-10 23:40:24,756 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37523] for ledger: 2
2020-08-10 23:40:24,760 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa26334d3, L:/127.0.0.1:51520 - R:127.0.0.1/127.0.0.1:37523]
2020-08-10 23:40:24,760 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37523
2020-08-10 23:40:24,760 - INFO  - [bookie-io-363-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:40:24,760 - INFO  - [bookie-io-363-2:BookieRequestHandler@50] - Channel connected  [id: 0x44babb42, L:/127.0.0.1:37523 - R:/127.0.0.1:51520]
2020-08-10 23:40:24,760 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$1@471] - connection [id: 0xa26334d3, L:/127.0.0.1:51520 - R:127.0.0.1/127.0.0.1:37523] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:40:24,761 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:40:24,761 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5541101105254815017test/current/0.log for logId 0.
2020-08-10 23:40:25,068 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:25,069 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5541101105254815017test/current/1.log for logId 1.
2020-08-10 23:40:25,070 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie5541101105254815017test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:25,099 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:40:25,457 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:40:25,542 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:25,543 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5541101105254815017test/current/2.log for logId 2.
2020-08-10 23:40:25,543 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie5541101105254815017test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:25,628 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:40:26,460 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:40:26,468 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:40:26,468 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:40:26,469 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 2]
2020-08-10 23:40:26,629 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:40:26,631 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5541101105254815017test/current/3.log for logId 3.
2020-08-10 23:40:26,631 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie5541101105254815017test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:40:26,703 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:40:26,875 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:40:26,875 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:40:26,876 - WARN  - [bookkeeper-io-359-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xa26334d3, L:/127.0.0.1:51520 - R:127.0.0.1/127.0.0.1:37523] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:40:26,876 - INFO  - [bookie-io-363-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x44babb42, L:/127.0.0.1:37523 ! R:/127.0.0.1:51520]
2020-08-10 23:40:26,876 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa26334d3, L:/127.0.0.1:51520 ! R:127.0.0.1/127.0.0.1:37523]
2020-08-10 23:40:26,883 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37523 with exitCode 0
2020-08-10 23:40:26,884 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:40:26,884 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:40:26,908 - INFO  - [SyncThread-368-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095624459 , logFileOffset - 461312]}.
2020-08-10 23:40:26,919 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:40:26,919 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:40:26,920 - INFO  - [BookieJournal-37523:Journal@1135] - Journal exits when shutting down
2020-08-10 23:40:26,920 - INFO  - [BookieJournal-37523:Journal@1144] - Journal exited loop!
2020-08-10 23:40:26,920 - INFO  - [Bookie-37523:Bookie@1130] - Journal thread(s) quit.
