2020-08-10 23:17:29,739 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:17:30,024 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:30,139 - INFO  - [Time-limited test:MetadataDrivers@105] - BookKeeper metadata driver manager initialized
2020-08-10 23:17:30,144 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:30,154 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:30,229 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:30,254 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:30,255 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:30,258 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:30,320 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:30,452 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie2225134288630740475test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42641/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie2225134288630740475test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:30,578 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:30,589 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:30,596 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:30,608 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie2225134288630740475test/current] [/tmp/bookie2225134288630740475test/current]
2020-08-10 23:17:30,703 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:30,716 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2225134288630740475test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:30,717 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:30,736 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:30,741 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:30,746 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:30,751 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:30,752 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:30,778 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:46301 to become writable
2020-08-10 23:17:30,783 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:17:30,789 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:30,792 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:30,794 - INFO  - [BookieJournal-46301:Journal@909] - Starting journal on /tmp/bookie2225134288630740475test/current
2020-08-10 23:17:30,797 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:30,799 - INFO  - [BookieJournal-46301:JournalChannel@157] - Opening journal /tmp/bookie2225134288630740475test/current/173da3c492e.txn
2020-08-10 23:17:30,818 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:31,071 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:46301' has been created.
2020-08-10 23:17:31,080 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,087 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,090 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:31,091 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:31,091 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:31,091 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:31,094 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:31,147 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:31,148 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie9836042919647561722test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42641/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie9836042919647561722test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:31,154 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,166 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,171 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:31,189 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9836042919647561722test/current] [/tmp/bookie9836042919647561722test/current]
2020-08-10 23:17:31,197 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:31,200 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:17:31,200 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:31,201 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:46301
2020-08-10 23:17:31,207 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9836042919647561722test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:31,208 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:31,208 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:31,209 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:31,210 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:31,211 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:31,212 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:31,212 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:31,215 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:31,217 - WARN  - [AuditorElector-127.0.0.1:46301:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:17:31,217 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:31,221 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:17:31,221 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:31,222 - INFO  - [AuditorElector-127.0.0.1:46301:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:31,234 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:35185 to become writable
2020-08-10 23:17:31,238 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:31,239 - INFO  - [SyncThread-32-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:31,240 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:31,242 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:17:31,243 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:31,250 - INFO  - [BookieJournal-35185:Journal@909] - Starting journal on /tmp/bookie9836042919647561722test/current
2020-08-10 23:17:31,253 - INFO  - [BookieJournal-35185:JournalChannel@157] - Opening journal /tmp/bookie9836042919647561722test/current/173da3c4af6.txn
2020-08-10 23:17:31,253 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:31,265 - INFO  - [AuditorBookie-127.0.0.1:46301:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,267 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:31,268 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:31,272 - INFO  - [AuditorBookie-127.0.0.1:46301-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,276 - ERROR - [AuditorBookie-127.0.0.1:46301:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:31,277 - INFO  - [AuditorBookie-127.0.0.1:46301:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:31,277 - INFO  - [AuditorBookie-127.0.0.1:46301:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:31,277 - INFO  - [AuditorBookie-127.0.0.1:46301:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:31,281 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:31,281 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:31,415 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor$11@751] - Completed checkAllLedgers in 173 milliSeconds
2020-08-10 23:17:31,517 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:35185' has been created.
2020-08-10 23:17:31,520 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,525 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,528 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:31,529 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:31,529 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:31,529 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:31,532 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:31,532 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:31,546 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:31,547 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie1255754497299836437test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42641/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1255754497299836437test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:31,552 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,558 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,562 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:31,570 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1255754497299836437test/current] [/tmp/bookie1255754497299836437test/current]
2020-08-10 23:17:31,577 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:31,579 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1255754497299836437test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:31,579 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:31,579 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:31,580 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:31,581 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:31,581 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:31,581 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:31,601 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39903 to become writable
2020-08-10 23:17:31,604 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:31,605 - INFO  - [SyncThread-54-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:31,609 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:31,611 - INFO  - [BookieJournal-39903:Journal@909] - Starting journal on /tmp/bookie1255754497299836437test/current
2020-08-10 23:17:31,613 - INFO  - [BookieJournal-39903:JournalChannel@157] - Opening journal /tmp/bookie1255754497299836437test/current/173da3c4c5e.txn
2020-08-10 23:17:31,613 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:31,621 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:31,621 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:31,622 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:31,876 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39903' has been created.
2020-08-10 23:17:31,880 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,888 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,891 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:31,891 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:31,891 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:31,892 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:31,894 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:31,894 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:31,894 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:31,907 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testNoSuchLedgerExists @ metadata service zk://localhost:42641/ledgers in 2147 ms.
2020-08-10 23:17:31,909 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:31,916 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:31,934 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:39903, 127.0.0.1:35185, 127.0.0.1:46301] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:17:31,996 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39903, 127.0.0.1:35185, 127.0.0.1:46301] for ledger: 0
2020-08-10 23:17:32,127 - INFO  - [bookie-io-49-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,128 - INFO  - [bookie-io-8-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,128 - INFO  - [bookie-io-24-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,139 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xd6afb8fb, L:/127.0.0.1:52612 - R:127.0.0.1/127.0.0.1:39903]
2020-08-10 23:17:32,139 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x452fa633, L:/127.0.0.1:54316 - R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:32,140 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:46301
2020-08-10 23:17:32,140 - INFO  - [bookie-io-49-2:BookieRequestHandler@50] - Channel connected  [id: 0x678f0611, L:/127.0.0.1:39903 - R:/127.0.0.1:52612]
2020-08-10 23:17:32,141 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x65c2b327, L:/127.0.0.1:49472 - R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:32,139 - INFO  - [bookie-io-24-2:BookieRequestHandler@50] - Channel connected  [id: 0x1eaa8185, L:/127.0.0.1:35185 - R:/127.0.0.1:49472]
2020-08-10 23:17:32,145 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35185
2020-08-10 23:17:32,139 - INFO  - [bookie-io-8-2:BookieRequestHandler@50] - Channel connected  [id: 0x00689f15, L:/127.0.0.1:46301 - R:/127.0.0.1:54316]
2020-08-10 23:17:32,140 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39903
2020-08-10 23:17:32,170 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$1@471] - connection [id: 0x65c2b327, L:/127.0.0.1:49472 - R:127.0.0.1/127.0.0.1:35185] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,170 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$1@471] - connection [id: 0xd6afb8fb, L:/127.0.0.1:52612 - R:127.0.0.1/127.0.0.1:39903] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,170 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient$1@471] - connection [id: 0x452fa633, L:/127.0.0.1:54316 - R:127.0.0.1/127.0.0.1:46301] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,291 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:35185, 127.0.0.1:39903, 127.0.0.1:46301] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:17:32,297 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:35185, 127.0.0.1:39903, 127.0.0.1:46301] for ledger: 1
2020-08-10 23:17:32,342 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:32,342 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:32,345 - WARN  - [bookkeeper-io-3-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xd6afb8fb, L:/127.0.0.1:52612 - R:127.0.0.1/127.0.0.1:39903] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:32,345 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xd6afb8fb, L:/127.0.0.1:52612 ! R:127.0.0.1/127.0.0.1:39903]
2020-08-10 23:17:32,345 - INFO  - [bookie-io-49-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x678f0611, L:/127.0.0.1:39903 ! R:/127.0.0.1:52612]
2020-08-10 23:17:32,374 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39903 with exitCode 0
2020-08-10 23:17:32,375 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:32,375 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:32,375 - INFO  - [SyncThread-54-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:32,378 - INFO  - [SyncThread-54-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1255754497299836437test/current/0.log for logId 0.
2020-08-10 23:17:32,383 - INFO  - [pool-32-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1255754497299836437test/current/1.log for logId 1.
2020-08-10 23:17:32,399 - INFO  - [SyncThread-54-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094251614 , logFileOffset - 5632]}.
2020-08-10 23:17:32,402 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:32,402 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:32,403 - INFO  - [BookieJournal-39903:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:32,404 - INFO  - [BookieJournal-39903:Journal@1144] - Journal exited loop!
2020-08-10 23:17:32,404 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:32,404 - INFO  - [Bookie-39903:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:32,404 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:32,404 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:32,405 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:32,405 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:32,405 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:32,407 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:32,421 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:32,425 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:32,430 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:32,430 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:32,431 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:32,432 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39903
2020-08-10 23:17:32,434 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:32,448 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1114] - Following are the failed bookies: [127.0.0.1:39903], and searching its ledgers for re-replication
2020-08-10 23:17:32,450 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:39903] are identified as underreplicated
2020-08-10 23:17:32,481 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:32,490 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:32,490 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:32,506 - ERROR - [bookkeeper-io-45-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb05e324a, L:/127.0.0.1:52618]/127.0.0.1:39903, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39903
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:32,518 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf2fc1f80, L:/127.0.0.1:49478 - R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:32,521 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35185
2020-08-10 23:17:32,524 - ERROR - [bookkeeper-io-61-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbcc5b37b, L:/127.0.0.1:52622]/127.0.0.1:39903, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39903
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:32,530 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:32,530 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:32,531 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:32,531 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:32,531 - INFO  - [AuditorElector-127.0.0.1:39903:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:32,542 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient$1@471] - connection [id: 0xf2fc1f80, L:/127.0.0.1:49478 - R:127.0.0.1/127.0.0.1:35185] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,546 - INFO  - [bookie-io-8-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,546 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xcb9295bd, L:/127.0.0.1:49482 - R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:32,546 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35185
2020-08-10 23:17:32,546 - INFO  - [bookie-io-8-3:BookieRequestHandler@50] - Channel connected  [id: 0x2f0bfd4c, L:/127.0.0.1:46301 - R:/127.0.0.1:54326]
2020-08-10 23:17:32,547 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient$1@471] - connection [id: 0xcb9295bd, L:/127.0.0.1:49482 - R:127.0.0.1/127.0.0.1:35185] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,548 - INFO  - [bookie-io-24-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,548 - INFO  - [bookie-io-24-3:BookieRequestHandler@50] - Channel connected  [id: 0xb396b424, L:/127.0.0.1:35185 - R:/127.0.0.1:49478]
2020-08-10 23:17:32,547 - INFO  - [ReplicationWorker:ReplicationWorker@240] - InterruptedException while replicating fragments
java.lang.InterruptedException
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:385)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2022)
	at org.apache.bookkeeper.client.SyncCallbackUtils.waitForResult(SyncCallbackUtils.java:55)
	at org.apache.bookkeeper.client.BookKeeperAdmin.openLedgerNoRecovery(BookKeeperAdmin.java:351)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:364)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:17:32,561 - INFO  - [ReplicationWorker:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:32,561 - INFO  - [bookie-io-24-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,558 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x0b71cb2d, L:/127.0.0.1:54328 - R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:32,562 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:46301
2020-08-10 23:17:32,557 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x39231cc1, L:/127.0.0.1:54326 - R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:32,563 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient$1@471] - connection [id: 0x0b71cb2d, L:/127.0.0.1:54328 - R:127.0.0.1/127.0.0.1:46301] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,562 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35185
2020-08-10 23:17:32,563 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:46301
2020-08-10 23:17:32,563 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient$1@471] - connection [id: 0x39231cc1, L:/127.0.0.1:54326 - R:127.0.0.1/127.0.0.1:46301] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,563 - INFO  - [bookie-io-24-4:BookieRequestHandler@50] - Channel connected  [id: 0x0d68f8fb, L:/127.0.0.1:35185 - R:/127.0.0.1:49482]
2020-08-10 23:17:32,567 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:46301
2020-08-10 23:17:32,566 - INFO  - [bookie-io-8-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,577 - INFO  - [bookie-io-24-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x0d68f8fb, L:/127.0.0.1:35185 ! R:/127.0.0.1:49482]
2020-08-10 23:17:32,576 - INFO  - [bookkeeper-io-61-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x0b71cb2d, L:/127.0.0.1:54328 ! R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:32,576 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39903
2020-08-10 23:17:32,576 - ERROR - [BookKeeperClientWorker-OrderedExecutor-1-0:ReadLastConfirmedOp@153] - While readLastConfirmed ledger: 1 did not hear success responses from all quorums, QuorumCoverage(e:3,w:3,a:3) = [-19, -8, -19]
2020-08-10 23:17:32,567 - INFO  - [bookkeeper-io-61-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xcb9295bd, L:/127.0.0.1:49482 ! R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:32,586 - INFO  - [bookie-io-8-4:BookieRequestHandler@50] - Channel connected  [id: 0xd3c06674, L:/127.0.0.1:46301 - R:/127.0.0.1:54328]
2020-08-10 23:17:32,587 - INFO  - [bookie-io-8-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xd3c06674, L:/127.0.0.1:46301 ! R:/127.0.0.1:54328]
2020-08-10 23:17:32,607 - ERROR - [bookkeeper-io-45-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3796664a, L:/127.0.0.1:52636]/127.0.0.1:39903, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39903
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:32,608 - INFO  - [bookkeeper-io-20-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5b9c7a9b, L:/127.0.0.1:49488 - R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:32,608 - INFO  - [bookkeeper-io-20-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:35185
2020-08-10 23:17:32,609 - INFO  - [bookkeeper-io-20-1:PerChannelBookieClient$1@471] - connection [id: 0x5b9c7a9b, L:/127.0.0.1:49488 - R:127.0.0.1/127.0.0.1:35185] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,619 - ERROR - [bookkeeper-io-20-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc547b829, L:/127.0.0.1:52632]/127.0.0.1:39903, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39903
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:32,619 - INFO  - [bookkeeper-io-20-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe75a4f6b, L:/127.0.0.1:54334 - R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:32,619 - INFO  - [bookie-io-24-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,619 - INFO  - [bookie-io-24-5:BookieRequestHandler@50] - Channel connected  [id: 0x88d13e75, L:/127.0.0.1:35185 - R:/127.0.0.1:49488]
2020-08-10 23:17:32,619 - INFO  - [bookkeeper-io-20-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:46301
2020-08-10 23:17:32,620 - INFO  - [bookkeeper-io-20-3:PerChannelBookieClient$1@471] - connection [id: 0xe75a4f6b, L:/127.0.0.1:54334 - R:127.0.0.1/127.0.0.1:46301] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:32,624 - INFO  - [bookie-io-8-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:32,624 - INFO  - [bookie-io-8-5:BookieRequestHandler@50] - Channel connected  [id: 0x0ac86b24, L:/127.0.0.1:46301 - R:/127.0.0.1:54334]
2020-08-10 23:17:32,621 - INFO  - [BookieDeathWatcher-39903:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:32,628 - INFO  - [BookieDeathWatcher-39903:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39903
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:32,628 - INFO  - [BookieDeathWatcher-39903:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:32,628 - INFO  - [BookieDeathWatcher-39903:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:32,639 - ERROR - [bookkeeper-io-20-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x00735cd0, L:/127.0.0.1:52638]/127.0.0.1:39903, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39903
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:32,736 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:32,737 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie5017816978767510697test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42641/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie5017816978767510697test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:32,741 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:32,746 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:32,749 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:32,756 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5017816978767510697test/current] [/tmp/bookie5017816978767510697test/current]
2020-08-10 23:17:32,768 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:32,770 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5017816978767510697test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:32,770 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:32,771 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:32,771 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:32,773 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:32,773 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:32,773 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:32,789 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:35629 to become writable
2020-08-10 23:17:32,790 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:17:32,791 - INFO  - [SyncThread-74-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:32,796 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:32,804 - INFO  - [BookieJournal-35629:Journal@909] - Starting journal on /tmp/bookie5017816978767510697test/current
2020-08-10 23:17:32,805 - INFO  - [BookieJournal-35629:JournalChannel@157] - Opening journal /tmp/bookie5017816978767510697test/current/173da3c5106.txn
2020-08-10 23:17:32,805 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:32,812 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35629
2020-08-10 23:17:32,812 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35629
2020-08-10 23:17:32,812 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35629
2020-08-10 23:17:32,906 - INFO  - [AutoRecoveryDeathWatcher-39903:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:32,906 - INFO  - [AutoRecoveryDeathWatcher-39903:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-39903
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:32,906 - INFO  - [AutoRecoveryDeathWatcher-39903:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:33,062 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:35629' has been created.
2020-08-10 23:17:33,068 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42641/ledgers : zkServers = localhost:42641, ledgersRootPath = /ledgers.
2020-08-10 23:17:33,073 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:33,075 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:33,076 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:33,076 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:33,076 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:33,079 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:33,079 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:33,079 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:35629
2020-08-10 23:17:35,637 - INFO  - [ReplicationWorker:ReplicationWorker@415] - BKNoSuchLedgerExistsOnMetadataServerException while opening ledger 0 for replication. Other clients might have deleted the ledger. So, no harm to continue
2020-08-10 23:17:35,640 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:17:35,876 - INFO  - [ReplicationWorker:ReplicationWorker@415] - BKNoSuchLedgerExistsOnMetadataServerException while opening ledger 1 for replication. Other clients might have deleted the ledger. So, no harm to continue
2020-08-10 23:17:35,881 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:17:35,885 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:17:35,885 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35185
2020-08-10 23:17:35,886 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x65c2b327, L:/127.0.0.1:49472 ! R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:35,886 - INFO  - [bookie-io-24-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1eaa8185, L:/127.0.0.1:35185 ! R:/127.0.0.1:49472]
2020-08-10 23:17:35,886 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:46301
2020-08-10 23:17:35,888 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39903
2020-08-10 23:17:35,888 - INFO  - [bookie-io-8-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x00689f15, L:/127.0.0.1:46301 ! R:/127.0.0.1:54316]
2020-08-10 23:17:35,888 - INFO  - [bookkeeper-io-3-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x452fa633, L:/127.0.0.1:54316 ! R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:36,005 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:36,006 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:36,007 - INFO  - [bookie-io-8-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x2f0bfd4c, L:/127.0.0.1:46301 ! R:/127.0.0.1:54326]
2020-08-10 23:17:36,007 - WARN  - [bookkeeper-io-20-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0xe75a4f6b, L:/127.0.0.1:54334 - R:127.0.0.1/127.0.0.1:46301] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:36,008 - INFO  - [bookie-io-8-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x0ac86b24, L:/127.0.0.1:46301 ! R:/127.0.0.1:54334]
2020-08-10 23:17:36,007 - WARN  - [bookkeeper-io-45-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x39231cc1, L:/127.0.0.1:54326 - R:127.0.0.1/127.0.0.1:46301] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:36,008 - INFO  - [bookkeeper-io-45-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x39231cc1, L:/127.0.0.1:54326 ! R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:36,008 - INFO  - [bookkeeper-io-20-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe75a4f6b, L:/127.0.0.1:54334 ! R:127.0.0.1/127.0.0.1:46301]
2020-08-10 23:17:36,017 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-46301 with exitCode 0
2020-08-10 23:17:36,017 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:36,017 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:36,018 - INFO  - [SyncThread-13-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:36,019 - INFO  - [SyncThread-13-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie2225134288630740475test/current/0.log for logId 0.
2020-08-10 23:17:36,020 - INFO  - [pool-9-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie2225134288630740475test/current/1.log for logId 1.
2020-08-10 23:17:36,024 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094250798 , logFileOffset - 5632]}.
2020-08-10 23:17:36,027 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:36,027 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:36,027 - INFO  - [BookieJournal-46301:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:36,028 - INFO  - [BookieJournal-46301:Journal@1144] - Journal exited loop!
2020-08-10 23:17:36,028 - INFO  - [Bookie-46301:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:36,028 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:36,029 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:36,029 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:36,029 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:36,029 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:36,029 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:36,032 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:36,032 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:36,032 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:36,037 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:36,143 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:36,146 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:36,146 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:36,146 - INFO  - [AuditorElector-127.0.0.1:46301:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:36,146 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:36,147 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:46301
2020-08-10 23:17:36,147 - INFO  - [AutoRecoveryDeathWatcher-46301:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:36,147 - INFO  - [AutoRecoveryDeathWatcher-46301:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-46301
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:36,148 - INFO  - [AutoRecoveryDeathWatcher-46301:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:36,155 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:36,160 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:36,163 - INFO  - [AuditorElector-127.0.0.1:35185:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:36,164 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:36,163 - INFO  - [AuditorBookie-127.0.0.1:46301:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:36,164 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:36,165 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:36,165 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:36,166 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:36,166 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35185
2020-08-10 23:17:36,167 - INFO  - [bookkeeper-io-20-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5b9c7a9b, L:/127.0.0.1:49488 ! R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:36,167 - INFO  - [bookie-io-24-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x88d13e75, L:/127.0.0.1:35185 ! R:/127.0.0.1:49488]
2020-08-10 23:17:36,167 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:46301
2020-08-10 23:17:36,168 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39903
2020-08-10 23:17:36,170 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:35185
2020-08-10 23:17:36,173 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:36,181 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:36,183 - INFO  - [AuditorBookie-127.0.0.1:35185:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:36,183 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094251292 durationSinceLastExecutionInSecs: 4 initialDelay: 604796 interval: 604800
2020-08-10 23:17:36,184 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:36,184 - INFO  - [AuditorElector-127.0.0.1:35185:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:36,196 - INFO  - [AuditorBookie-127.0.0.1:35185:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:36,287 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:36,287 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:36,287 - WARN  - [bookkeeper-io-45-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xf2fc1f80, L:/127.0.0.1:49478 - R:127.0.0.1/127.0.0.1:35185] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:36,288 - INFO  - [bookie-io-24-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xb396b424, L:/127.0.0.1:35185 ! R:/127.0.0.1:49478]
2020-08-10 23:17:36,288 - INFO  - [bookkeeper-io-45-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf2fc1f80, L:/127.0.0.1:49478 ! R:127.0.0.1/127.0.0.1:35185]
2020-08-10 23:17:36,289 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35185 with exitCode 0
2020-08-10 23:17:36,290 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:36,290 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:36,290 - INFO  - [SyncThread-32-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:36,291 - INFO  - [SyncThread-32-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9836042919647561722test/current/0.log for logId 0.
2020-08-10 23:17:36,292 - INFO  - [pool-19-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie9836042919647561722test/current/1.log for logId 1.
2020-08-10 23:17:36,296 - INFO  - [SyncThread-32-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094251254 , logFileOffset - 6144]}.
2020-08-10 23:17:36,299 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:36,299 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:36,300 - INFO  - [BookieJournal-35185:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:36,300 - INFO  - [BookieJournal-35185:Journal@1144] - Journal exited loop!
2020-08-10 23:17:36,300 - INFO  - [Bookie-35185:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:36,300 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:36,301 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:36,301 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:36,301 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:36,301 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:36,301 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:36,304 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:36,304 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:36,304 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:36,308 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:36,309 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35185
2020-08-10 23:17:36,410 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:36,410 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:36,412 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:36,412 - INFO  - [AuditorElector-127.0.0.1:35185:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:36,420 - INFO  - [AuditorBookie-127.0.0.1:35185:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:36,424 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:36,426 - INFO  - [AuditorBookie-127.0.0.1:35185:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:36,426 - INFO  - [AuditorElector-127.0.0.1:35629:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:36,427 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:36,427 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:36,427 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:36,427 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:36,428 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:36,428 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:35185
2020-08-10 23:17:36,429 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:35629
2020-08-10 23:17:36,430 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:46301
2020-08-10 23:17:36,430 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39903
2020-08-10 23:17:36,433 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:36,438 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:36,440 - INFO  - [AuditorBookie-127.0.0.1:35629:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:36,440 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094251292 durationSinceLastExecutionInSecs: 5 initialDelay: 604795 interval: 604800
2020-08-10 23:17:36,440 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:36,440 - INFO  - [AuditorElector-127.0.0.1:35629:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:36,545 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:36,545 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:36,553 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-35629 with exitCode 0
2020-08-10 23:17:36,553 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:36,553 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:36,553 - INFO  - [SyncThread-74-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:36,555 - INFO  - [AutoRecoveryDeathWatcher-35185:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:36,555 - INFO  - [AutoRecoveryDeathWatcher-35185:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-35185
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:36,555 - INFO  - [AutoRecoveryDeathWatcher-35185:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:36,557 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:36,558 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:36,558 - INFO  - [BookieJournal-35629:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:36,558 - INFO  - [BookieJournal-35629:Journal@1144] - Journal exited loop!
2020-08-10 23:17:36,558 - INFO  - [Bookie-35629:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:36,559 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:36,559 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:36,559 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:36,559 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:36,560 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:36,560 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:36,560 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:36,560 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:36,560 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:36,562 - INFO  - [AuditorBookie-127.0.0.1:35629:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:36,564 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:35629
2020-08-10 23:17:36,566 - INFO  - [AuditorBookie-127.0.0.1:35629:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:36,571 - INFO  - [AuditorBookie-127.0.0.1:35629:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:36,665 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:36,668 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:36,668 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:36,669 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:36,669 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:36,669 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:36,670 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:36,821 - INFO  - [BookieDeathWatcher-35629:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:36,821 - INFO  - [BookieDeathWatcher-35629:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35629
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:36,821 - INFO  - [BookieDeathWatcher-35629:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:36,821 - INFO  - [BookieDeathWatcher-35629:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:36,826 - INFO  - [BookieDeathWatcher-46301:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:36,826 - INFO  - [BookieDeathWatcher-46301:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46301
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:36,826 - INFO  - [BookieDeathWatcher-46301:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:36,827 - INFO  - [BookieDeathWatcher-46301:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:36,668 - INFO  - [AuditorElector-127.0.0.1:35629:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:37,100 - INFO  - [AutoRecoveryDeathWatcher-35629:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:37,101 - INFO  - [AutoRecoveryDeathWatcher-35629:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-35629
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:37,102 - INFO  - [AutoRecoveryDeathWatcher-35629:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:37,111 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testNoSuchLedgerExists in 1226 ms.
2020-08-10 23:17:37,202 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:17:37,270 - INFO  - [BookieDeathWatcher-35185:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:37,270 - INFO  - [BookieDeathWatcher-35185:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-35185
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:37,270 - INFO  - [BookieDeathWatcher-35185:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:37,271 - INFO  - [BookieDeathWatcher-35185:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:37,307 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:17:37,329 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,337 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:37,343 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,346 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:37,346 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:37,346 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:37,346 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:37,355 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:37,355 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie9002637677240332593test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45441/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie9002637677240332593test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:37,361 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:37,366 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,368 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:37,375 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie9002637677240332593test/current] [/tmp/bookie9002637677240332593test/current]
2020-08-10 23:17:37,386 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:37,387 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie9002637677240332593test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:37,388 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:37,388 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:37,389 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:37,390 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:37,390 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:37,390 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:37,400 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41965 to become writable
2020-08-10 23:17:37,401 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:37,402 - INFO  - [SyncThread-102-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:37,405 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:37,409 - INFO  - [BookieJournal-41965:Journal@909] - Starting journal on /tmp/bookie9002637677240332593test/current
2020-08-10 23:17:37,410 - INFO  - [BookieJournal-41965:JournalChannel@157] - Opening journal /tmp/bookie9002637677240332593test/current/173da3c6303.txn
2020-08-10 23:17:37,410 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:37,416 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:37,665 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41965' has been created.
2020-08-10 23:17:37,668 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:37,672 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,674 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:37,675 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:37,675 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:37,675 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:37,676 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:37,698 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:37,698 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie14582300888288094540test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45441/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie14582300888288094540test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:37,706 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:37,711 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,717 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:37,722 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie14582300888288094540test/current] [/tmp/bookie14582300888288094540test/current]
2020-08-10 23:17:37,724 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:37,727 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:17:37,730 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:41965
2020-08-10 23:17:37,733 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:37,733 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:37,734 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie14582300888288094540test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:37,734 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:37,735 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:37,735 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:37,736 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:37,736 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:37,736 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:37,740 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:37,742 - WARN  - [AuditorElector-127.0.0.1:41965:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:17:37,742 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:17:37,742 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:37,742 - INFO  - [AuditorElector-127.0.0.1:41965:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:37,742 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:37,748 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:37,749 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:17:37,763 - INFO  - [AuditorBookie-127.0.0.1:41965:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:37,768 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33059 to become writable
2020-08-10 23:17:37,769 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:37,770 - INFO  - [SyncThread-121-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:37,771 - INFO  - [AuditorBookie-127.0.0.1:41965-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:37,773 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:37,773 - ERROR - [AuditorBookie-127.0.0.1:41965:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:37,774 - INFO  - [AuditorBookie-127.0.0.1:41965:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:37,775 - INFO  - [AuditorBookie-127.0.0.1:41965:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:37,775 - INFO  - [BookieJournal-33059:Journal@909] - Starting journal on /tmp/bookie14582300888288094540test/current
2020-08-10 23:17:37,775 - INFO  - [AuditorBookie-127.0.0.1:41965:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:37,778 - INFO  - [BookieJournal-33059:JournalChannel@157] - Opening journal /tmp/bookie14582300888288094540test/current/173da3c6473.txn
2020-08-10 23:17:37,779 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:37,779 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:37,782 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:37,783 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:37,783 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:37,905 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor$11@751] - Completed checkAllLedgers in 155 milliSeconds
2020-08-10 23:17:38,032 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33059' has been created.
2020-08-10 23:17:38,034 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:38,038 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:38,041 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:38,041 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:38,041 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:38,041 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:38,043 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,043 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:38,060 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:38,060 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie18061109748950926459test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:45441/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie18061109748950926459test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:38,069 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:38,074 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:38,077 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:38,081 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie18061109748950926459test/current] [/tmp/bookie18061109748950926459test/current]
2020-08-10 23:17:38,086 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:38,087 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie18061109748950926459test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:38,087 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:38,088 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:38,089 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:38,090 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:38,090 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:38,090 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:38,144 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:46379 to become writable
2020-08-10 23:17:38,145 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:17:38,145 - INFO  - [SyncThread-143-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:38,149 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:38,152 - INFO  - [BookieJournal-46379:Journal@909] - Starting journal on /tmp/bookie18061109748950926459test/current
2020-08-10 23:17:38,152 - INFO  - [BookieJournal-46379:JournalChannel@157] - Opening journal /tmp/bookie18061109748950926459test/current/173da3c65e9.txn
2020-08-10 23:17:38,153 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:38,160 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46379
2020-08-10 23:17:38,160 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46379
2020-08-10 23:17:38,160 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46379
2020-08-10 23:17:38,408 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:46379' has been created.
2020-08-10 23:17:38,412 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:38,418 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:38,423 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:38,424 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:38,424 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:38,424 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:38,428 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:46379
2020-08-10 23:17:38,429 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,429 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:38,444 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testEmptyLedgerLosesQuorumEventually @ metadata service zk://localhost:45441/ledgers in 1137 ms.
2020-08-10 23:17:38,445 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45441/ledgers : zkServers = localhost:45441, ledgersRootPath = /ledgers.
2020-08-10 23:17:38,454 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:38,460 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:46379, 127.0.0.1:33059, 127.0.0.1:41965] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:17:38,485 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:46379, 127.0.0.1:33059, 127.0.0.1:41965] for ledger: 0
2020-08-10 23:17:38,485 - INFO  - [Time-limited test:BookieAutoRecoveryTest@383] - Killing last bookie, 127.0.0.1:41965, in ensemble [127.0.0.1:46379, 127.0.0.1:33059, 127.0.0.1:41965]
2020-08-10 23:17:38,487 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:38,487 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:38,493 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41965 with exitCode 0
2020-08-10 23:17:38,493 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:38,493 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:38,493 - INFO  - [SyncThread-102-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:38,497 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:38,497 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:38,497 - INFO  - [BookieJournal-41965:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:38,498 - INFO  - [BookieJournal-41965:Journal@1144] - Journal exited loop!
2020-08-10 23:17:38,498 - INFO  - [Bookie-41965:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:38,498 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:38,499 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:38,499 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:38,499 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:38,505 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,505 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,505 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,507 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41965
2020-08-10 23:17:38,510 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:38,518 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41965], and searching its ledgers for re-replication
2020-08-10 23:17:38,518 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41965] are identified as underreplicated
2020-08-10 23:17:38,542 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:38,543 - INFO  - [AuditorBookie-127.0.0.1:41965:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:38,558 - INFO  - [bookkeeper-io-134-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x4a65ee14, L:/127.0.0.1:40232 - R:127.0.0.1/127.0.0.1:46379]
2020-08-10 23:17:38,558 - INFO  - [bookkeeper-io-134-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:46379
2020-08-10 23:17:38,559 - INFO  - [bookkeeper-io-134-1:PerChannelBookieClient$1@471] - connection [id: 0x4a65ee14, L:/127.0.0.1:40232 - R:127.0.0.1/127.0.0.1:46379] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:38,562 - INFO  - [bookie-io-138-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:38,566 - INFO  - [bookie-io-138-2:BookieRequestHandler@50] - Channel connected  [id: 0xc4972ef0, L:/127.0.0.1:46379 - R:/127.0.0.1:40232]
2020-08-10 23:17:38,564 - ERROR - [bookkeeper-io-134-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x732eb155, L:/127.0.0.1:44366]/127.0.0.1:41965, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41965
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:38,564 - INFO  - [bookkeeper-io-134-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xd514ab68, L:/127.0.0.1:48500 - R:127.0.0.1/127.0.0.1:33059]
2020-08-10 23:17:38,567 - INFO  - [bookkeeper-io-134-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33059
2020-08-10 23:17:38,567 - INFO  - [bookkeeper-io-134-2:PerChannelBookieClient$1@471] - connection [id: 0xd514ab68, L:/127.0.0.1:48500 - R:127.0.0.1/127.0.0.1:33059] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:38,568 - INFO  - [bookie-io-113-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:38,568 - INFO  - [bookie-io-113-2:BookieRequestHandler@50] - Channel connected  [id: 0xbaf68b2e, L:/127.0.0.1:33059 - R:/127.0.0.1:48500]
2020-08-10 23:17:38,571 - INFO  - [BookieReadThreadPool-OrderedExecutor-0-0:ReadEntryProcessorV3@225] - No ledger found while reading entry: 0 from ledger: 0
2020-08-10 23:17:38,572 - INFO  - [BookieReadThreadPool-OrderedExecutor-0-0:ReadEntryProcessorV3@225] - No ledger found while reading entry: 0 from ledger: 0
2020-08-10 23:17:38,608 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:38,608 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:38,611 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:38,611 - INFO  - [AuditorElector-127.0.0.1:41965:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:38,612 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:38,612 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:38,613 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:38,613 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:38,699 - INFO  - [AutoRecoveryDeathWatcher-41965:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:38,699 - INFO  - [AutoRecoveryDeathWatcher-41965:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-41965
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:38,699 - INFO  - [AutoRecoveryDeathWatcher-41965:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:38,898 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:38,901 - INFO  - [AuditorElector-127.0.0.1:33059:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:38,901 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:38,902 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:33059
2020-08-10 23:17:38,905 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:38,905 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:38,906 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094257789 durationSinceLastExecutionInSecs: 1 initialDelay: 604799 interval: 604800
2020-08-10 23:17:38,906 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:38,906 - INFO  - [AuditorElector-127.0.0.1:33059:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:38,906 - INFO  - [AuditorBookie-127.0.0.1:33059:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:38,915 - INFO  - [AuditorBookie-127.0.0.1:33059:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41965], and searching its ledgers for re-replication
2020-08-10 23:17:38,915 - INFO  - [AuditorBookie-127.0.0.1:33059:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41965] are identified as underreplicated
2020-08-10 23:17:38,920 - INFO  - [AuditorBookie-127.0.0.1:33059:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:39,416 - INFO  - [BookieDeathWatcher-41965:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:39,416 - INFO  - [BookieDeathWatcher-41965:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41965
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:39,416 - INFO  - [BookieDeathWatcher-41965:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:39,416 - INFO  - [BookieDeathWatcher-41965:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:41,581 - ERROR - [bookkeeper-io-134-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe591ade4, L:/127.0.0.1:44368]/127.0.0.1:41965, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41965
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:41,582 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger0 for Recovery.
2020-08-10 23:17:41,604 - INFO  - [BookieHighPriorityThread-33059-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:48500
2020-08-10 23:17:41,604 - INFO  - [BookieHighPriorityThread-46379-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:40232
2020-08-10 23:17:41,613 - ERROR - [bookkeeper-io-134-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x024db406, L:/127.0.0.1:44370]/127.0.0.1:41965, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41965
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:41,616 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 0 at entry -1
2020-08-10 23:17:41,630 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:17:41,632 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:17:41,633 - INFO  - [Time-limited test:BookieAutoRecoveryTest@397] - Killing second bookie, 127.0.0.1:33059, in ensemble [127.0.0.1:46379, 127.0.0.1:33059, 127.0.0.1:41965]
2020-08-10 23:17:41,634 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:41,634 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:41,634 - WARN  - [bookkeeper-io-134-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xd514ab68, L:/127.0.0.1:48500 - R:127.0.0.1/127.0.0.1:33059] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:41,634 - INFO  - [bookkeeper-io-134-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xd514ab68, L:/127.0.0.1:48500 ! R:127.0.0.1/127.0.0.1:33059]
2020-08-10 23:17:41,635 - INFO  - [bookie-io-113-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xbaf68b2e, L:/127.0.0.1:33059 ! R:/127.0.0.1:48500]
2020-08-10 23:17:41,638 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33059 with exitCode 0
2020-08-10 23:17:41,638 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:41,638 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:41,639 - INFO  - [SyncThread-121-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094257779 , logFileOffset - 1024]}.
2020-08-10 23:17:41,643 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:41,644 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:41,644 - INFO  - [BookieJournal-33059:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:41,644 - INFO  - [BookieJournal-33059:Journal@1144] - Journal exited loop!
2020-08-10 23:17:41,644 - INFO  - [Bookie-33059:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:41,644 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:41,646 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:41,648 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:41,648 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:41,652 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:41,754 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:41,756 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:41,757 - INFO  - [AuditorElector-127.0.0.1:33059:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:41,757 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:41,759 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:41,759 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33059
2020-08-10 23:17:41,759 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:41,760 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:41,760 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2587)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1248)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager$1.getChildren(ZkLedgerUnderreplicationManager.java:144)
	at org.apache.bookkeeper.util.SubTreeCache.getChildren(SubTreeCache.java:118)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:544)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:602)
	... 4 more
2020-08-10 23:17:41,763 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:41,763 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:46379
2020-08-10 23:17:41,764 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41965
2020-08-10 23:17:41,764 - INFO  - [bookie-io-138-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc4972ef0, L:/127.0.0.1:46379 ! R:/127.0.0.1:40232]
2020-08-10 23:17:41,764 - INFO  - [bookkeeper-io-134-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x4a65ee14, L:/127.0.0.1:40232 ! R:127.0.0.1/127.0.0.1:46379]
2020-08-10 23:17:41,765 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33059
2020-08-10 23:17:41,877 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:41,879 - INFO  - [AuditorElector-127.0.0.1:46379:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:41,880 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:41,880 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:46379
2020-08-10 23:17:41,883 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:41,883 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:41,884 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094257789 durationSinceLastExecutionInSecs: 4 initialDelay: 604796 interval: 604800
2020-08-10 23:17:41,884 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:41,884 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:41,884 - INFO  - [AuditorElector-127.0.0.1:46379:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:41,887 - INFO  - [BookieDeathWatcher-33059:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:41,887 - INFO  - [BookieDeathWatcher-33059:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33059
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:41,887 - INFO  - [BookieDeathWatcher-33059:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:41,887 - INFO  - [BookieDeathWatcher-33059:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:41,897 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41965, 127.0.0.1:33059], and searching its ledgers for re-replication
2020-08-10 23:17:41,897 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41965] are identified as underreplicated
2020-08-10 23:17:41,973 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:33059] are identified as underreplicated
2020-08-10 23:17:41,979 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:17:41,983 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:42,010 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:17:42,035 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:17:42,076 - INFO  - [AutoRecoveryDeathWatcher-33059:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:42,077 - INFO  - [AutoRecoveryDeathWatcher-33059:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-33059
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:42,077 - INFO  - [AutoRecoveryDeathWatcher-33059:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:42,150 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:42,150 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:42,159 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-46379 with exitCode 0
2020-08-10 23:17:42,159 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:42,159 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:42,159 - INFO  - [SyncThread-143-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094258153 , logFileOffset - 1024]}.
2020-08-10 23:17:42,173 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:42,173 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:42,173 - INFO  - [BookieJournal-46379:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:42,173 - INFO  - [BookieJournal-46379:Journal@1144] - Journal exited loop!
2020-08-10 23:17:42,174 - INFO  - [Bookie-46379:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:42,174 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:42,174 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:42,174 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:42,174 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:42,174 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:42,175 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:42,175 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:42,176 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:42,176 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:42,184 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:46379
2020-08-10 23:17:42,187 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:42,193 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41965, 127.0.0.1:46379, 127.0.0.1:33059], and searching its ledgers for re-replication
2020-08-10 23:17:42,193 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41965] are identified as underreplicated
2020-08-10 23:17:42,244 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:42,244 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:46379] are identified as underreplicated
2020-08-10 23:17:42,262 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:33059] are identified as underreplicated
2020-08-10 23:17:42,263 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:17:42,282 - INFO  - [AuditorBookie-127.0.0.1:46379:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:42,285 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:42,285 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:42,286 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:42,286 - INFO  - [AuditorElector-127.0.0.1:46379:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:42,286 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:42,287 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:42,288 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:1536)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$1901(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:711)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.create(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:530)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:602)
	... 4 more
2020-08-10 23:17:42,288 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:42,452 - INFO  - [AutoRecoveryDeathWatcher-46379:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:42,453 - INFO  - [AutoRecoveryDeathWatcher-46379:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-46379
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:42,453 - INFO  - [AutoRecoveryDeathWatcher-46379:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:42,524 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testEmptyLedgerLosesQuorumEventually in 489 ms.
2020-08-10 23:17:42,619 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:17:42,722 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:17:42,744 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:42,757 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:42,770 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:42,773 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:42,773 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:42,773 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:42,773 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:42,794 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:42,795 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie4610405980802566439test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42275/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie4610405980802566439test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:42,797 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:42,808 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:42,810 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:42,814 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie4610405980802566439test/current] [/tmp/bookie4610405980802566439test/current]
2020-08-10 23:17:42,837 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:42,838 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie4610405980802566439test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:42,838 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:42,839 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:42,839 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:42,841 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:42,841 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:42,841 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:42,862 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45387 to become writable
2020-08-10 23:17:42,863 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:42,864 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:42,881 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:42,883 - INFO  - [BookieJournal-45387:Journal@909] - Starting journal on /tmp/bookie4610405980802566439test/current
2020-08-10 23:17:42,883 - INFO  - [BookieJournal-45387:JournalChannel@157] - Opening journal /tmp/bookie4610405980802566439test/current/173da3c7864.txn
2020-08-10 23:17:42,884 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:42,910 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:43,159 - INFO  - [BookieDeathWatcher-46379:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:43,160 - INFO  - [BookieDeathWatcher-46379:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-46379
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:43,160 - INFO  - [BookieDeathWatcher-46379:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:43,160 - INFO  - [BookieDeathWatcher-46379:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:43,161 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45387' has been created.
2020-08-10 23:17:43,165 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,172 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,174 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:43,174 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:43,174 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:43,174 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:43,176 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:43,224 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:43,224 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie3844330652885498085test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42275/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie3844330652885498085test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:43,232 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,240 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,244 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:43,245 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:43,252 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:17:43,253 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45387
2020-08-10 23:17:43,254 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie3844330652885498085test/current] [/tmp/bookie3844330652885498085test/current]
2020-08-10 23:17:43,257 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:43,257 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:43,262 - WARN  - [AuditorElector-127.0.0.1:45387:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:17:43,262 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:17:43,263 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:43,263 - INFO  - [AuditorElector-127.0.0.1:45387:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:43,262 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:43,264 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:43,269 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie3844330652885498085test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:43,269 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:43,270 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:43,270 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:43,274 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:43,274 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:43,274 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:43,277 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:43,278 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:17:43,288 - INFO  - [AuditorBookie-127.0.0.1:45387:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,292 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45231 to become writable
2020-08-10 23:17:43,295 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:43,296 - INFO  - [AuditorBookie-127.0.0.1:45387-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,297 - INFO  - [SyncThread-194-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:43,299 - ERROR - [AuditorBookie-127.0.0.1:45387:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:43,299 - INFO  - [AuditorBookie-127.0.0.1:45387:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:43,299 - INFO  - [AuditorBookie-127.0.0.1:45387:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:43,299 - INFO  - [AuditorBookie-127.0.0.1:45387:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:43,301 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:43,308 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:43,312 - INFO  - [BookieJournal-45231:Journal@909] - Starting journal on /tmp/bookie3844330652885498085test/current
2020-08-10 23:17:43,313 - INFO  - [BookieJournal-45231:JournalChannel@157] - Opening journal /tmp/bookie3844330652885498085test/current/173da3c7a12.txn
2020-08-10 23:17:43,316 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:43,334 - WARN  - [AuditorBookie-127.0.0.1:45387-EventThread:ZKRegistrationClient$WatchTask@115] - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@76f71164[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@7980d8e7[Wrapped task = com.google.common.util.concurrent.TrustedListenableFutureTask@7dbf430f (delegate = java.util.concurrent.Executors$RunnableAdapter@38bdd2dc[Wrapped task = org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask@557e5306])]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@94fa8bd[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 5]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2055)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:825)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:340)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:562)
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:512)
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63)
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317)
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273)
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:113)
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:161)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:535)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510)
2020-08-10 23:17:43,339 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:43,339 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:43,439 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor$11@751] - Completed checkAllLedgers in 161 milliSeconds
2020-08-10 23:17:43,584 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45231' has been created.
2020-08-10 23:17:43,586 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,595 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,600 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:43,600 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:43,600 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:43,600 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:43,602 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:43,602 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:43,613 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:43,614 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie1304939439248939159test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42275/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1304939439248939159test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:43,617 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,630 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,634 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:43,639 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1304939439248939159test/current] [/tmp/bookie1304939439248939159test/current]
2020-08-10 23:17:43,651 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:43,652 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1304939439248939159test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:43,652 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:43,653 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:43,653 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:43,654 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:43,654 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:43,654 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:43,663 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45289 to become writable
2020-08-10 23:17:43,663 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:43,664 - INFO  - [SyncThread-216-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:43,681 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:43,682 - INFO  - [BookieJournal-45289:Journal@909] - Starting journal on /tmp/bookie1304939439248939159test/current
2020-08-10 23:17:43,682 - INFO  - [BookieJournal-45289:JournalChannel@157] - Opening journal /tmp/bookie1304939439248939159test/current/173da3c7b83.txn
2020-08-10 23:17:43,682 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:43,698 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:43,699 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:43,699 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:43,951 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45289' has been created.
2020-08-10 23:17:43,953 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,964 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,966 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:43,966 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:43,966 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:43,967 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:43,969 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:43,969 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:43,970 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:43,981 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testClosedLedgers @ metadata service zk://localhost:42275/ledgers in 1259 ms.
2020-08-10 23:17:43,982 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:43,994 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:43,999 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:45289, 127.0.0.1:45387, 127.0.0.1:45231] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:17:44,060 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45289, 127.0.0.1:45387, 127.0.0.1:45231] for ledger: 0
2020-08-10 23:17:44,074 - INFO  - [bookie-io-170-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:44,074 - INFO  - [bookie-io-170-2:BookieRequestHandler@50] - Channel connected  [id: 0xf7f3e8d1, L:/127.0.0.1:45387 - R:/127.0.0.1:48736]
2020-08-10 23:17:44,075 - INFO  - [bookkeeper-io-166-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7bdcdf43, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45289]
2020-08-10 23:17:44,075 - INFO  - [bookkeeper-io-166-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45289
2020-08-10 23:17:44,075 - INFO  - [bookkeeper-io-166-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x6b266c8c, L:/127.0.0.1:48736 - R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:44,076 - INFO  - [bookie-io-211-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:44,077 - INFO  - [bookie-io-211-2:BookieRequestHandler@50] - Channel connected  [id: 0xf07b4c89, L:/127.0.0.1:45289 - R:/127.0.0.1:48754]
2020-08-10 23:17:44,076 - INFO  - [bookkeeper-io-166-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x81ef7157, L:/127.0.0.1:58192 - R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:44,078 - INFO  - [bookkeeper-io-166-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45231
2020-08-10 23:17:44,077 - INFO  - [bookie-io-186-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:44,078 - INFO  - [bookkeeper-io-166-3:PerChannelBookieClient$1@471] - connection [id: 0x81ef7157, L:/127.0.0.1:58192 - R:127.0.0.1/127.0.0.1:45231] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:44,077 - INFO  - [bookkeeper-io-166-1:PerChannelBookieClient$1@471] - connection [id: 0x7bdcdf43, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45289] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:44,076 - INFO  - [bookkeeper-io-166-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45387
2020-08-10 23:17:44,078 - INFO  - [bookkeeper-io-166-2:PerChannelBookieClient$1@471] - connection [id: 0x6b266c8c, L:/127.0.0.1:48736 - R:127.0.0.1/127.0.0.1:45387] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:44,078 - INFO  - [bookie-io-186-2:BookieRequestHandler@50] - Channel connected  [id: 0xe55ce267, L:/127.0.0.1:45231 - R:/127.0.0.1:58192]
2020-08-10 23:17:44,186 - INFO  - [Time-limited test:BookieAutoRecoveryTest@210] - Killing Bookie :127.0.0.1:45289
2020-08-10 23:17:44,187 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:44,187 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:44,188 - WARN  - [bookkeeper-io-166-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x7bdcdf43, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45289] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:44,188 - INFO  - [bookie-io-211-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xf07b4c89, L:/127.0.0.1:45289 ! R:/127.0.0.1:48754]
2020-08-10 23:17:44,188 - INFO  - [bookkeeper-io-166-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7bdcdf43, L:/127.0.0.1:48754 ! R:127.0.0.1/127.0.0.1:45289]
2020-08-10 23:17:44,193 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45289 with exitCode 0
2020-08-10 23:17:44,193 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:44,193 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:44,194 - INFO  - [SyncThread-216-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:44,194 - INFO  - [SyncThread-216-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1304939439248939159test/current/0.log for logId 0.
2020-08-10 23:17:44,196 - INFO  - [pool-122-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1304939439248939159test/current/1.log for logId 1.
2020-08-10 23:17:44,346 - INFO  - [SyncThread-216-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094263683 , logFileOffset - 3072]}.
2020-08-10 23:17:44,359 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:44,360 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:44,360 - INFO  - [BookieJournal-45289:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:44,360 - INFO  - [BookieJournal-45289:Journal@1144] - Journal exited loop!
2020-08-10 23:17:44,360 - INFO  - [Bookie-45289:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:44,361 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:44,361 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:44,361 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:44,361 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:44,362 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:44,362 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:44,370 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:44,371 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:44,371 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:44,380 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:44,380 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:44,481 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:44,482 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:44,484 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:44,484 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:44,484 - INFO  - [AuditorElector-127.0.0.1:45289:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:44,484 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:44,486 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:44,486 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:44,487 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45289
2020-08-10 23:17:44,501 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:44,513 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45289], and searching its ledgers for re-replication
2020-08-10 23:17:44,513 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45289] are identified as underreplicated
2020-08-10 23:17:44,570 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:44,570 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:44,588 - ERROR - [bookkeeper-io-207-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x25bdf37f, L:/127.0.0.1:48760]/127.0.0.1:45289, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45289
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:44,590 - INFO  - [bookie-io-170-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:44,591 - INFO  - [bookie-io-170-3:BookieRequestHandler@50] - Channel connected  [id: 0xbde4c849, L:/127.0.0.1:45387 - R:/127.0.0.1:48742]
2020-08-10 23:17:44,590 - INFO  - [bookkeeper-io-207-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x9808345c, L:/127.0.0.1:58198 - R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:44,591 - INFO  - [bookkeeper-io-207-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45231
2020-08-10 23:17:44,590 - INFO  - [bookkeeper-io-207-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x9114c950, L:/127.0.0.1:48742 - R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:44,592 - INFO  - [bookkeeper-io-207-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45387
2020-08-10 23:17:44,591 - INFO  - [bookie-io-186-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:44,592 - INFO  - [bookkeeper-io-207-2:PerChannelBookieClient$1@471] - connection [id: 0x9114c950, L:/127.0.0.1:48742 - R:127.0.0.1/127.0.0.1:45387] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:44,592 - INFO  - [bookkeeper-io-207-3:PerChannelBookieClient$1@471] - connection [id: 0x9808345c, L:/127.0.0.1:58198 - R:127.0.0.1/127.0.0.1:45231] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:44,592 - INFO  - [bookie-io-186-3:BookieRequestHandler@50] - Channel connected  [id: 0xb2964d83, L:/127.0.0.1:45231 - R:/127.0.0.1:58198]
2020-08-10 23:17:44,597 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45289>, <Bookie:127.0.0.1:45387>], allBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>].
2020-08-10 23:17:44,597 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45289>, <Bookie:127.0.0.1:45387>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:17:44,597 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45289>, <Bookie:127.0.0.1:45387>], allBookies [<Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45231>].
2020-08-10 23:17:44,597 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:17:44,604 - INFO  - [Time-limited test:BookieAutoRecoveryTest@220] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0000/urL0000000000 to know the status of rereplication process
2020-08-10 23:17:44,605 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:44,605 - ERROR - [bookkeeper-io-207-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6f769323, L:/127.0.0.1:48766]/127.0.0.1:45289, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45289
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:44,605 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie13341293853969540506test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:42275/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie13341293853969540506test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:44,608 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:17:44,611 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:44,620 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:44,623 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:44,628 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie13341293853969540506test/current] [/tmp/bookie13341293853969540506test/current]
2020-08-10 23:17:44,636 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:44,637 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie13341293853969540506test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:44,637 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:44,638 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:44,638 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:44,639 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:44,639 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:44,639 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:44,652 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45357 to become writable
2020-08-10 23:17:44,652 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:44,656 - INFO  - [SyncThread-236-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:44,669 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:44,673 - INFO  - [BookieJournal-45357:Journal@909] - Starting journal on /tmp/bookie13341293853969540506test/current
2020-08-10 23:17:44,674 - INFO  - [BookieJournal-45357:JournalChannel@157] - Opening journal /tmp/bookie13341293853969540506test/current/173da3c7f63.txn
2020-08-10 23:17:44,674 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:44,681 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45357
2020-08-10 23:17:44,681 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45357
2020-08-10 23:17:44,681 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45357
2020-08-10 23:17:44,699 - INFO  - [BookieDeathWatcher-45289:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:44,699 - INFO  - [BookieDeathWatcher-45289:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45289
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:44,699 - INFO  - [BookieDeathWatcher-45289:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:44,699 - INFO  - [BookieDeathWatcher-45289:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:44,931 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45357' has been created.
2020-08-10 23:17:44,934 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42275/ledgers : zkServers = localhost:42275, ledgersRootPath = /ledgers.
2020-08-10 23:17:44,944 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:44,947 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:44,947 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:44,949 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:44,950 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:44,953 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:44,953 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45357
2020-08-10 23:17:44,953 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:44,980 - INFO  - [AutoRecoveryDeathWatcher-45289:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:44,980 - INFO  - [AutoRecoveryDeathWatcher-45289:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45289
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:44,980 - INFO  - [AutoRecoveryDeathWatcher-45289:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:54,023 - INFO  - [bookkeeper-io-243-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7c3ad48e, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:54,024 - INFO  - [bookkeeper-io-243-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45387
2020-08-10 23:17:54,024 - INFO  - [bookkeeper-io-243-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xd59eea8f, L:/127.0.0.1:58212 - R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:54,024 - INFO  - [bookkeeper-io-243-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45231
2020-08-10 23:17:54,024 - INFO  - [bookie-io-186-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:54,024 - INFO  - [bookie-io-170-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:54,025 - INFO  - [bookie-io-170-4:BookieRequestHandler@50] - Channel connected  [id: 0xd110084d, L:/127.0.0.1:45387 - R:/127.0.0.1:48754]
2020-08-10 23:17:54,025 - INFO  - [bookie-io-186-4:BookieRequestHandler@50] - Channel connected  [id: 0xb071146e, L:/127.0.0.1:45231 - R:/127.0.0.1:58212]
2020-08-10 23:17:54,023 - ERROR - [bookkeeper-io-243-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x22393158, L:/127.0.0.1:48776]/127.0.0.1:45289, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45289
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,025 - INFO  - [bookkeeper-io-243-3:PerChannelBookieClient$1@471] - connection [id: 0xd59eea8f, L:/127.0.0.1:58212 - R:127.0.0.1/127.0.0.1:45231] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:54,024 - INFO  - [bookkeeper-io-243-2:PerChannelBookieClient$1@471] - connection [id: 0x7c3ad48e, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45387] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:54,029 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 4[4], Host: [127.0.0.1:45289], Closed: true) in 1 sub fragments.
2020-08-10 23:17:54,032 - ERROR - [bookkeeper-io-243-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xdc606057, L:/127.0.0.1:48780]/127.0.0.1:45289, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45289
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,053 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E0 from bookie: 127.0.0.1:45289
2020-08-10 23:17:54,055 - INFO  - [bookkeeper-io-243-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x6d948592, L:/127.0.0.1:48954 - R:127.0.0.1/127.0.0.1:45357]
2020-08-10 23:17:54,057 - INFO  - [bookkeeper-io-243-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45357
2020-08-10 23:17:54,058 - INFO  - [bookkeeper-io-243-5:PerChannelBookieClient$1@471] - connection [id: 0x6d948592, L:/127.0.0.1:48954 - R:127.0.0.1/127.0.0.1:45357] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:54,055 - INFO  - [bookie-io-231-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:54,058 - INFO  - [bookie-io-231-2:BookieRequestHandler@50] - Channel connected  [id: 0xdc9e17bf, L:/127.0.0.1:45357 - R:/127.0.0.1:48954]
2020-08-10 23:17:54,055 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E3 from bookie: 127.0.0.1:45289
2020-08-10 23:17:54,091 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:45289=127.0.0.1:45357}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:17:54,095 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:17:54,097 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:17:54,098 - INFO  - [Time-limited test:BookieAutoRecoveryTest@239] - Waiting to update the urledger metadata in zookeeper
2020-08-10 23:17:54,101 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:17:54,102 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45387
2020-08-10 23:17:54,103 - INFO  - [bookkeeper-io-166-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x6b266c8c, L:/127.0.0.1:48736 ! R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:54,103 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45231
2020-08-10 23:17:54,103 - INFO  - [bookie-io-170-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xf7f3e8d1, L:/127.0.0.1:45387 ! R:/127.0.0.1:48736]
2020-08-10 23:17:54,104 - INFO  - [bookkeeper-io-166-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x81ef7157, L:/127.0.0.1:58192 ! R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:54,104 - INFO  - [bookie-io-186-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xe55ce267, L:/127.0.0.1:45231 ! R:/127.0.0.1:58192]
2020-08-10 23:17:54,105 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45289
2020-08-10 23:17:54,219 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:54,219 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:54,219 - INFO  - [bookie-io-170-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xd110084d, L:/127.0.0.1:45387 ! R:/127.0.0.1:48754]
2020-08-10 23:17:54,219 - WARN  - [bookkeeper-io-243-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x7c3ad48e, L:/127.0.0.1:48754 - R:127.0.0.1/127.0.0.1:45387] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:54,220 - INFO  - [bookkeeper-io-243-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7c3ad48e, L:/127.0.0.1:48754 ! R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:54,220 - INFO  - [bookie-io-170-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xbde4c849, L:/127.0.0.1:45387 ! R:/127.0.0.1:48742]
2020-08-10 23:17:54,222 - WARN  - [bookkeeper-io-207-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x9114c950, L:/127.0.0.1:48742 - R:127.0.0.1/127.0.0.1:45387] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:54,222 - INFO  - [bookkeeper-io-207-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x9114c950, L:/127.0.0.1:48742 ! R:127.0.0.1/127.0.0.1:45387]
2020-08-10 23:17:54,232 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45387 with exitCode 0
2020-08-10 23:17:54,232 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:54,232 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:54,232 - INFO  - [SyncThread-175-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:54,234 - INFO  - [SyncThread-175-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4610405980802566439test/current/0.log for logId 0.
2020-08-10 23:17:54,235 - INFO  - [pool-99-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4610405980802566439test/current/1.log for logId 1.
2020-08-10 23:17:54,241 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094262884 , logFileOffset - 3072]}.
2020-08-10 23:17:54,244 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:54,245 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:54,245 - INFO  - [BookieJournal-45387:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:54,245 - INFO  - [BookieJournal-45387:Journal@1144] - Journal exited loop!
2020-08-10 23:17:54,245 - INFO  - [Bookie-45387:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:54,245 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:54,246 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:54,246 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:54,246 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:54,246 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:54,246 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:54,253 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:54,255 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:54,256 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:54,262 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:54,262 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:54,364 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:54,365 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:54,365 - INFO  - [AuditorElector-127.0.0.1:45387:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:54,366 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45387
2020-08-10 23:17:54,366 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:54,371 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:54,375 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:54,378 - INFO  - [AuditorElector-127.0.0.1:45231:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:54,378 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:54,379 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45231
2020-08-10 23:17:54,383 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:54,383 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:54,383 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094263305 durationSinceLastExecutionInSecs: 11 initialDelay: 604789 interval: 604800
2020-08-10 23:17:54,384 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:54,384 - INFO  - [AuditorElector-127.0.0.1:45231:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:54,384 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45387], and searching its ledgers for re-replication
2020-08-10 23:17:54,384 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45387] are identified as underreplicated
2020-08-10 23:17:54,385 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:54,403 - INFO  - [AuditorBookie-127.0.0.1:45387:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:54,404 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:54,404 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:54,404 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2587)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1248)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager$1.getChildren(ZkLedgerUnderreplicationManager.java:144)
	at org.apache.bookkeeper.util.SubTreeCache.getChildren(SubTreeCache.java:118)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:501)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:602)
	... 4 more
2020-08-10 23:17:54,405 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:54,407 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45387], and searching its ledgers for re-replication
2020-08-10 23:17:54,410 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45387] are identified as underreplicated
2020-08-10 23:17:54,417 - ERROR - [bookkeeper-io-207-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xff50307d, L:/127.0.0.1:48764]/127.0.0.1:45387, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45387
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,420 - INFO  - [bookie-io-231-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:54,420 - INFO  - [bookie-io-231-3:BookieRequestHandler@50] - Channel connected  [id: 0xb1f76f2f, L:/127.0.0.1:45357 - R:/127.0.0.1:48958]
2020-08-10 23:17:54,421 - INFO  - [bookkeeper-io-207-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xbf5e17df, L:/127.0.0.1:48958 - R:127.0.0.1/127.0.0.1:45357]
2020-08-10 23:17:54,421 - INFO  - [bookkeeper-io-207-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45357
2020-08-10 23:17:54,422 - INFO  - [bookkeeper-io-207-5:PerChannelBookieClient$1@471] - connection [id: 0xbf5e17df, L:/127.0.0.1:48958 - R:127.0.0.1/127.0.0.1:45357] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:54,424 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], allBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45357>].
2020-08-10 23:17:54,424 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:17:54,424 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], allBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45357>].
2020-08-10 23:17:54,424 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:17:54,425 - ERROR - [bookkeeper-io-207-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x54129c4a, L:/127.0.0.1:48768]/127.0.0.1:45387, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45387
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,426 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 1 number of times, so deferring the ledger lock release by 18750 msecs
2020-08-10 23:17:54,521 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:54,521 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:54,522 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:54,522 - INFO  - [bookie-io-186-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xb2964d83, L:/127.0.0.1:45231 ! R:/127.0.0.1:58198]
2020-08-10 23:17:54,522 - WARN  - [bookkeeper-io-207-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x9808345c, L:/127.0.0.1:58198 - R:127.0.0.1/127.0.0.1:45231] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:54,522 - WARN  - [bookkeeper-io-243-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0xd59eea8f, L:/127.0.0.1:58212 - R:127.0.0.1/127.0.0.1:45231] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:54,522 - INFO  - [bookkeeper-io-207-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x9808345c, L:/127.0.0.1:58198 ! R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:54,523 - INFO  - [bookie-io-186-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xb071146e, L:/127.0.0.1:45231 ! R:/127.0.0.1:58212]
2020-08-10 23:17:54,522 - INFO  - [bookkeeper-io-243-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xd59eea8f, L:/127.0.0.1:58212 ! R:127.0.0.1/127.0.0.1:45231]
2020-08-10 23:17:54,524 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45231 with exitCode 0
2020-08-10 23:17:54,525 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:54,525 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:54,525 - INFO  - [SyncThread-194-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:54,526 - INFO  - [SyncThread-194-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3844330652885498085test/current/0.log for logId 0.
2020-08-10 23:17:54,533 - INFO  - [pool-109-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie3844330652885498085test/current/1.log for logId 1.
2020-08-10 23:17:54,547 - INFO  - [SyncThread-194-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094263314 , logFileOffset - 3072]}.
2020-08-10 23:17:54,551 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:54,552 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:54,552 - INFO  - [BookieJournal-45231:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:54,552 - INFO  - [BookieJournal-45231:Journal@1144] - Journal exited loop!
2020-08-10 23:17:54,552 - INFO  - [Bookie-45231:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:54,552 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:54,553 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:54,553 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:54,553 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:54,553 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:54,553 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:54,578 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:54,579 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:54,579 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:54,583 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:54,583 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45231
2020-08-10 23:17:54,586 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:54,592 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45231, 127.0.0.1:45387], and searching its ledgers for re-replication
2020-08-10 23:17:54,592 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45231] are identified as underreplicated
2020-08-10 23:17:54,598 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45387] are identified as underreplicated
2020-08-10 23:17:54,602 - INFO  - [AuditorBookie-127.0.0.1:45231:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:54,686 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:54,686 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:54,687 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:54,687 - INFO  - [AuditorElector-127.0.0.1:45231:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:54,687 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:54,687 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:54,687 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:54,691 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:54,695 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45387
2020-08-10 23:17:54,696 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45357
2020-08-10 23:17:54,698 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45231
2020-08-10 23:17:54,698 - INFO  - [bookie-io-231-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xb1f76f2f, L:/127.0.0.1:45357 ! R:/127.0.0.1:48958]
2020-08-10 23:17:54,698 - INFO  - [bookkeeper-io-207-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xbf5e17df, L:/127.0.0.1:48958 ! R:127.0.0.1/127.0.0.1:45357]
2020-08-10 23:17:54,700 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45289
2020-08-10 23:17:54,707 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:54,714 - INFO  - [AuditorElector-127.0.0.1:45357:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:54,714 - ERROR - [bookkeeper-io-243-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3728faf8, L:/127.0.0.1:48770]/127.0.0.1:45387, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45387
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,714 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:54,715 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45357
2020-08-10 23:17:54,719 - ERROR - [bookkeeper-io-243-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5e7a4809, L:/127.0.0.1:58226]/127.0.0.1:45231, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45231
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,720 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:54,720 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:54,720 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], allBookies [<Bookie:127.0.0.1:45357>].
2020-08-10 23:17:54,721 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:17:54,721 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:45231>, <Bookie:127.0.0.1:45387>, <Bookie:127.0.0.1:45357>], allBookies [<Bookie:127.0.0.1:45357>].
2020-08-10 23:17:54,721 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:17:54,721 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:54,721 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094263305 durationSinceLastExecutionInSecs: 11 initialDelay: 604789 interval: 604800
2020-08-10 23:17:54,721 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:54,721 - INFO  - [AuditorElector-127.0.0.1:45357:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:54,724 - ERROR - [bookkeeper-io-243-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xbe164ff5, L:/127.0.0.1:58228]/127.0.0.1:45231, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45231
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,724 - ERROR - [bookkeeper-io-243-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb0c810ab, L:/127.0.0.1:48776]/127.0.0.1:45387, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45387
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:54,725 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:17:54,744 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45231, 127.0.0.1:45387], and searching its ledgers for re-replication
2020-08-10 23:17:54,744 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45231] are identified as underreplicated
2020-08-10 23:17:54,747 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45387] are identified as underreplicated
2020-08-10 23:17:54,751 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:54,806 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:54,806 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:54,806 - WARN  - [bookkeeper-io-243-5:PerChannelBookieClient@1270] - Exception caught on:[id: 0x6d948592, L:/127.0.0.1:48954 - R:127.0.0.1/127.0.0.1:45357] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:54,806 - INFO  - [bookie-io-231-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xdc9e17bf, L:/127.0.0.1:45357 ! R:/127.0.0.1:48954]
2020-08-10 23:17:54,806 - INFO  - [bookkeeper-io-243-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x6d948592, L:/127.0.0.1:48954 ! R:127.0.0.1/127.0.0.1:45357]
2020-08-10 23:17:54,808 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45357 with exitCode 0
2020-08-10 23:17:54,809 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:54,809 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:54,809 - INFO  - [SyncThread-236-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:54,810 - INFO  - [SyncThread-236-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13341293853969540506test/current/0.log for logId 0.
2020-08-10 23:17:54,813 - INFO  - [pool-134-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13341293853969540506test/current/1.log for logId 1.
2020-08-10 23:17:54,820 - INFO  - [SyncThread-236-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094264675 , logFileOffset - 2560]}.
2020-08-10 23:17:54,823 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:54,823 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:54,823 - INFO  - [BookieJournal-45357:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:54,823 - INFO  - [BookieJournal-45357:Journal@1144] - Journal exited loop!
2020-08-10 23:17:54,824 - INFO  - [Bookie-45357:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:54,824 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:54,824 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:54,824 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:54,824 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:54,824 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:54,825 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:54,827 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:54,828 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:54,828 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:54,831 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45357
2020-08-10 23:17:54,834 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:54,840 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45231, 127.0.0.1:45387, 127.0.0.1:45357], and searching its ledgers for re-replication
2020-08-10 23:17:54,840 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45231] are identified as underreplicated
2020-08-10 23:17:54,843 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45387] are identified as underreplicated
2020-08-10 23:17:54,847 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:45357] are identified as underreplicated
2020-08-10 23:17:54,855 - INFO  - [AuditorBookie-127.0.0.1:45357:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:54,920 - INFO  - [BookieDeathWatcher-45387:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:54,920 - INFO  - [BookieDeathWatcher-45387:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45387
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:54,920 - INFO  - [BookieDeathWatcher-45387:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:54,920 - INFO  - [BookieDeathWatcher-45387:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:54,931 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:54,932 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:54,932 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:54,932 - INFO  - [AuditorElector-127.0.0.1:45357:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:54,932 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:54,932 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:54,932 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:54,934 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:54,937 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45387
2020-08-10 23:17:54,938 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45357
2020-08-10 23:17:54,938 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45231
2020-08-10 23:17:54,938 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45289
2020-08-10 23:17:54,988 - INFO  - [AutoRecoveryDeathWatcher-45357:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:54,988 - INFO  - [AutoRecoveryDeathWatcher-45357:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45357
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:54,988 - INFO  - [AutoRecoveryDeathWatcher-45357:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:55,156 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testClosedLedgers in 1054 ms.
2020-08-10 23:17:55,248 - INFO  - [AutoRecoveryDeathWatcher-45387:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:55,248 - INFO  - [AutoRecoveryDeathWatcher-45387:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45387
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:55,248 - INFO  - [AutoRecoveryDeathWatcher-45387:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:55,250 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:17:55,355 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:17:55,357 - INFO  - [BookieDeathWatcher-45231:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:55,357 - INFO  - [BookieDeathWatcher-45231:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45231
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:55,358 - INFO  - [BookieDeathWatcher-45231:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:55,358 - INFO  - [BookieDeathWatcher-45231:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:55,372 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,380 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:55,383 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,385 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:55,385 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:55,386 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:55,386 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:55,391 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:55,391 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie2134972353428261844test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie2134972353428261844test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:55,393 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:55,400 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,403 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:55,406 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie2134972353428261844test/current] [/tmp/bookie2134972353428261844test/current]
2020-08-10 23:17:55,414 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:55,416 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2134972353428261844test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:55,416 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:55,416 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:55,416 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:55,417 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:55,417 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:55,417 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:55,429 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38841 to become writable
2020-08-10 23:17:55,430 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:55,430 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:55,435 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:55,436 - INFO  - [BookieJournal-38841:Journal@909] - Starting journal on /tmp/bookie2134972353428261844test/current
2020-08-10 23:17:55,436 - INFO  - [BookieJournal-38841:JournalChannel@157] - Opening journal /tmp/bookie2134972353428261844test/current/173da3ca96d.txn
2020-08-10 23:17:55,436 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:55,441 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:55,624 - INFO  - [AutoRecoveryDeathWatcher-45231:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:55,624 - INFO  - [AutoRecoveryDeathWatcher-45231:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45231
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:55,624 - INFO  - [AutoRecoveryDeathWatcher-45231:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:55,689 - INFO  - [BookieDeathWatcher-45357:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:55,689 - INFO  - [BookieDeathWatcher-45357:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45357
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:55,689 - INFO  - [BookieDeathWatcher-45357:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:55,689 - INFO  - [BookieDeathWatcher-45357:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:55,692 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38841' has been created.
2020-08-10 23:17:55,695 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:55,699 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,701 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:55,701 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:55,701 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:55,701 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:55,705 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:55,725 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:55,725 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie1815961897007536635test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1815961897007536635test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:55,728 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:55,733 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,737 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:55,740 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:55,742 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:17:55,743 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:38841
2020-08-10 23:17:55,745 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1815961897007536635test/current] [/tmp/bookie1815961897007536635test/current]
2020-08-10 23:17:55,751 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:55,751 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:55,753 - WARN  - [AuditorElector-127.0.0.1:38841:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:17:55,753 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:17:55,753 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:55,753 - INFO  - [AuditorElector-127.0.0.1:38841:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:55,753 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:55,754 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:55,755 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1815961897007536635test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:55,755 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:55,755 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:55,755 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:55,756 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:55,756 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:55,756 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:55,763 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:55,764 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:17:55,767 - INFO  - [AuditorBookie-127.0.0.1:38841:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:55,767 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34227 to become writable
2020-08-10 23:17:55,768 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:55,769 - INFO  - [SyncThread-283-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:55,771 - INFO  - [AuditorBookie-127.0.0.1:38841-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:55,775 - ERROR - [AuditorBookie-127.0.0.1:38841:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:55,776 - INFO  - [AuditorBookie-127.0.0.1:38841:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:55,776 - INFO  - [AuditorBookie-127.0.0.1:38841:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:55,776 - INFO  - [AuditorBookie-127.0.0.1:38841:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:55,776 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:55,779 - INFO  - [BookieJournal-34227:Journal@909] - Starting journal on /tmp/bookie1815961897007536635test/current
2020-08-10 23:17:55,779 - INFO  - [BookieJournal-34227:JournalChannel@157] - Opening journal /tmp/bookie1815961897007536635test/current/173da3caac4.txn
2020-08-10 23:17:55,780 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:55,782 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:55,786 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:55,786 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:55,787 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:55,898 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor$11@751] - Completed checkAllLedgers in 134 milliSeconds
2020-08-10 23:17:56,037 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34227' has been created.
2020-08-10 23:17:56,039 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:56,042 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:56,044 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:56,044 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:56,044 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:56,044 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:56,047 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:56,047 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:56,059 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:17:56,059 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie5701803960077993996test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie5701803960077993996test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:56,062 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:56,066 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:56,074 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:56,080 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5701803960077993996test/current] [/tmp/bookie5701803960077993996test/current]
2020-08-10 23:17:56,085 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:56,086 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5701803960077993996test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:56,086 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:56,086 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:56,087 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:56,087 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:56,087 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:56,088 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:56,098 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:42403 to become writable
2020-08-10 23:17:56,098 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:56,099 - INFO  - [SyncThread-305-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:56,103 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:56,104 - INFO  - [BookieJournal-42403:Journal@909] - Starting journal on /tmp/bookie5701803960077993996test/current
2020-08-10 23:17:56,105 - INFO  - [BookieJournal-42403:JournalChannel@157] - Opening journal /tmp/bookie5701803960077993996test/current/173da3cac0a.txn
2020-08-10 23:17:56,105 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:56,112 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42403
2020-08-10 23:17:56,112 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42403
2020-08-10 23:17:56,112 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42403
2020-08-10 23:17:56,365 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:42403' has been created.
2020-08-10 23:17:56,367 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:56,371 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:56,372 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:56,372 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:56,372 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:56,373 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:56,374 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42403
2020-08-10 23:17:56,375 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:56,375 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:56,382 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testLedgerMetadataContainsIpAddressAsBookieID @ metadata service zk://localhost:43329/ledgers in 1027 ms.
2020-08-10 23:17:56,383 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:56,390 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:56,499 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:56,500 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:56,505 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38841 with exitCode 0
2020-08-10 23:17:56,505 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:56,505 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:56,505 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:56,509 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:56,509 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:56,510 - INFO  - [BookieJournal-38841:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:56,510 - INFO  - [BookieJournal-38841:Journal@1144] - Journal exited loop!
2020-08-10 23:17:56,510 - INFO  - [Bookie-38841:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:56,510 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:56,511 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:56,514 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:56,514 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:56,514 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38841
2020-08-10 23:17:56,517 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:56,521 - INFO  - [AuditorBookie-127.0.0.1:38841:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:56,616 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:56,616 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:56,617 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:56,620 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:56,620 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:56,620 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:56,621 - INFO  - [AuditorElector-127.0.0.1:38841:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:56,621 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:56,638 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:56,640 - INFO  - [AuditorElector-127.0.0.1:34227:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:56,640 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:56,640 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:34227
2020-08-10 23:17:56,643 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:56,643 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:56,644 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094275789 durationSinceLastExecutionInSecs: 0 initialDelay: 604800 interval: 604800
2020-08-10 23:17:56,644 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:56,644 - INFO  - [AuditorElector-127.0.0.1:34227:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:56,644 - INFO  - [AuditorBookie-127.0.0.1:34227:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:56,648 - INFO  - [AuditorBookie-127.0.0.1:34227:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:56,724 - INFO  - [AutoRecoveryDeathWatcher-38841:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:56,724 - INFO  - [AutoRecoveryDeathWatcher-38841:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-38841
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:56,724 - INFO  - [AutoRecoveryDeathWatcher-38841:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:56,736 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:56,736 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:56,745 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34227 with exitCode 0
2020-08-10 23:17:56,745 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:56,745 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:56,745 - INFO  - [SyncThread-283-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:56,748 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:56,749 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:56,750 - INFO  - [BookieJournal-34227:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:56,750 - INFO  - [BookieJournal-34227:Journal@1144] - Journal exited loop!
2020-08-10 23:17:56,750 - INFO  - [Bookie-34227:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:56,750 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:56,751 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:56,755 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:56,756 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34227
2020-08-10 23:17:56,858 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:56,858 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:56,859 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:56,859 - INFO  - [AuditorElector-127.0.0.1:34227:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:56,864 - INFO  - [AuditorBookie-127.0.0.1:34227:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:56,869 - INFO  - [AuditorBookie-127.0.0.1:34227:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:56,870 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:56,870 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:56,870 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:56,871 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:56,871 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:56,874 - INFO  - [AuditorElector-127.0.0.1:42403:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:56,874 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:56,875 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:42403
2020-08-10 23:17:56,978 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:56,978 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:56,982 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42403 with exitCode 0
2020-08-10 23:17:56,982 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:56,982 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:56,982 - INFO  - [SyncThread-305-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:56,983 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:56,983 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:56,985 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094275789 durationSinceLastExecutionInSecs: 1 initialDelay: 604799 interval: 604800
2020-08-10 23:17:56,985 - INFO  - [AuditorBookie-127.0.0.1:42403:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:56,985 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:56,985 - INFO  - [AuditorElector-127.0.0.1:42403:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:56,987 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:56,987 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:56,988 - INFO  - [BookieJournal-42403:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:56,988 - INFO  - [BookieJournal-42403:Journal@1144] - Journal exited loop!
2020-08-10 23:17:56,988 - INFO  - [Bookie-42403:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:56,988 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:56,989 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:56,993 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:42403
2020-08-10 23:17:56,995 - INFO  - [AuditorBookie-127.0.0.1:42403:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:57,000 - INFO  - [AuditorBookie-127.0.0.1:42403:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:57,004 - INFO  - [AuditorBookie-127.0.0.1:42403:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:57,060 - INFO  - [AutoRecoveryDeathWatcher-34227:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:57,061 - INFO  - [AutoRecoveryDeathWatcher-34227:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-34227
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:57,061 - INFO  - [AutoRecoveryDeathWatcher-34227:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:57,092 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:57,093 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:57,093 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:17:57,093 - INFO  - [AuditorElector-127.0.0.1:42403:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:57,095 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:57,095 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:57,095 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:57,095 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:57,111 - INFO  - [BookieDeathWatcher-42403:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:57,111 - INFO  - [BookieDeathWatcher-42403:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42403
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:57,111 - INFO  - [BookieDeathWatcher-42403:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:57,111 - INFO  - [BookieDeathWatcher-42403:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:57,215 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:57,223 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:57,225 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:57,225 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:57,225 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:57,226 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:57,229 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie8255751466935994529test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie8255751466935994529test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:57,231 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:57,235 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:57,237 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:57,242 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8255751466935994529test/current] [/tmp/bookie8255751466935994529test/current]
2020-08-10 23:17:57,250 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:57,251 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8255751466935994529test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:57,251 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:57,252 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:57,252 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:57,253 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:57,253 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:57,253 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:57,258 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38861 to become writable
2020-08-10 23:17:57,259 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:57,260 - INFO  - [SyncThread-337-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:57,263 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:57,265 - INFO  - [BookieJournal-38861:Journal@909] - Starting journal on /tmp/bookie8255751466935994529test/current
2020-08-10 23:17:57,265 - INFO  - [BookieJournal-38861:JournalChannel@157] - Opening journal /tmp/bookie8255751466935994529test/current/173da3cb092.txn
2020-08-10 23:17:57,267 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:57,272 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38861
2020-08-10 23:17:57,383 - INFO  - [AutoRecoveryDeathWatcher-42403:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:57,383 - INFO  - [AutoRecoveryDeathWatcher-42403:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-42403
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:57,383 - INFO  - [AutoRecoveryDeathWatcher-42403:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:57,442 - INFO  - [BookieDeathWatcher-38841:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:57,442 - INFO  - [BookieDeathWatcher-38841:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38841
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:57,442 - INFO  - [BookieDeathWatcher-38841:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:57,442 - INFO  - [BookieDeathWatcher-38841:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:57,521 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38861' has been created.
2020-08-10 23:17:57,524 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:57,527 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:57,529 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:57,529 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:57,529 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:57,529 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:57,530 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38861
2020-08-10 23:17:57,537 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie7419352735221037005test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie7419352735221037005test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "true",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:57,543 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:57,553 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:57,556 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:57,556 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:17:57,559 - INFO  - [AuditorElector-127.0.0.1:38861:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:17:57,559 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:17:57,560 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:38861
2020-08-10 23:17:57,562 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7419352735221037005test/current] [/tmp/bookie7419352735221037005test/current]
2020-08-10 23:17:57,563 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:17:57,564 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:17:57,565 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094275789 durationSinceLastExecutionInSecs: 1 initialDelay: 604799 interval: 604800
2020-08-10 23:17:57,565 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:17:57,565 - INFO  - [AuditorElector-127.0.0.1:38861:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:17:57,567 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:57,569 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:57,570 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7419352735221037005test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:57,570 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:57,571 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:57,571 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:57,572 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:57,572 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:57,572 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:57,572 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:57,581 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for localhost:37485 to become writable
2020-08-10 23:17:57,581 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:57,582 - INFO  - [SyncThread-356-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:57,586 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:57,587 - INFO  - [BookieJournal-37485:Journal@909] - Starting journal on /tmp/bookie7419352735221037005test/current
2020-08-10 23:17:57,587 - INFO  - [BookieJournal-37485:JournalChannel@157] - Opening journal /tmp/bookie7419352735221037005test/current/173da3cb1d4.txn
2020-08-10 23:17:57,592 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:57,792 - INFO  - [BookieDeathWatcher-34227:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:57,792 - INFO  - [BookieDeathWatcher-34227:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34227
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:57,792 - INFO  - [BookieDeathWatcher-34227:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:57,792 - INFO  - [BookieDeathWatcher-34227:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:58,086 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:37485
2020-08-10 23:17:58,086 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:37485
2020-08-10 23:17:58,335 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie 'localhost:37485' has been created.
2020-08-10 23:17:58,338 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:58,341 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:58,343 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:58,343 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:58,343 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:58,343 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:58,344 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:37485
2020-08-10 23:17:58,345 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38861
2020-08-10 23:17:58,352 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie15953718834620822709test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie15953718834620822709test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "true",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:58,354 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:58,359 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:58,362 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:58,365 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie15953718834620822709test/current] [/tmp/bookie15953718834620822709test/current]
2020-08-10 23:17:58,369 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:58,370 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie15953718834620822709test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:58,370 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:58,371 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:58,371 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:58,371 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:58,372 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:58,372 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:58,378 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for localhost:43397 to become writable
2020-08-10 23:17:58,378 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:58,379 - INFO  - [SyncThread-372-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:58,383 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:58,388 - INFO  - [BookieJournal-43397:Journal@909] - Starting journal on /tmp/bookie15953718834620822709test/current
2020-08-10 23:17:58,388 - INFO  - [BookieJournal-43397:JournalChannel@157] - Opening journal /tmp/bookie15953718834620822709test/current/173da3cb4f5.txn
2020-08-10 23:17:58,389 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:58,393 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:43397
2020-08-10 23:17:58,393 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:43397
2020-08-10 23:17:58,393 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:43397
2020-08-10 23:17:58,644 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie 'localhost:43397' has been created.
2020-08-10 23:17:58,646 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:58,651 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:58,652 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:58,652 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:58,652 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:58,652 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:58,654 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:37485
2020-08-10 23:17:58,654 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38861
2020-08-10 23:17:58,654 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:43397
2020-08-10 23:17:58,661 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:38861, localhost:37485, localhost:43397] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:17:58,679 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38861, localhost:37485, localhost:43397] for ledger: 0
2020-08-10 23:17:58,681 - INFO  - [bookkeeper-io-328-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x754a2ca8, L:/127.0.0.1:43254 - R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:17:58,681 - INFO  - [bookkeeper-io-328-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38861
2020-08-10 23:17:58,681 - INFO  - [bookie-io-348-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:58,681 - INFO  - [bookie-io-348-2:BookieRequestHandler@50] - Channel connected  [id: 0x878fc03b, L:/127.0.0.1:37485 - R:/127.0.0.1:49426]
2020-08-10 23:17:58,681 - INFO  - [bookkeeper-io-328-1:PerChannelBookieClient$1@471] - connection [id: 0x754a2ca8, L:/127.0.0.1:43254 - R:127.0.0.1/127.0.0.1:38861] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:58,682 - INFO  - [bookie-io-332-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:58,682 - INFO  - [bookie-io-332-2:BookieRequestHandler@50] - Channel connected  [id: 0x53e1279b, L:/127.0.0.1:38861 - R:/127.0.0.1:43254]
2020-08-10 23:17:58,682 - INFO  - [bookkeeper-io-328-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x18f7ba66, L:/127.0.0.1:49426 - R:localhost/127.0.0.1:37485]
2020-08-10 23:17:58,682 - INFO  - [bookkeeper-io-328-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:37485
2020-08-10 23:17:58,683 - INFO  - [bookkeeper-io-328-2:PerChannelBookieClient$1@471] - connection [id: 0x18f7ba66, L:/127.0.0.1:49426 - R:localhost/127.0.0.1:37485] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:58,691 - INFO  - [bookkeeper-io-328-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x111af784, L:/127.0.0.1:52160 - R:localhost/127.0.0.1:43397]
2020-08-10 23:17:58,691 - INFO  - [bookkeeper-io-328-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:43397
2020-08-10 23:17:58,691 - INFO  - [bookkeeper-io-328-3:PerChannelBookieClient$1@471] - connection [id: 0x111af784, L:/127.0.0.1:52160 - R:localhost/127.0.0.1:43397] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:58,693 - INFO  - [bookie-io-367-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:58,693 - INFO  - [bookie-io-367-2:BookieRequestHandler@50] - Channel connected  [id: 0x9257241d, L:/127.0.0.1:43397 - R:/127.0.0.1:52160]
2020-08-10 23:17:58,733 - INFO  - [Time-limited test:BookieAutoRecoveryTest@446] - Kill bookie which has registered using hostname
2020-08-10 23:17:58,734 - INFO  - [Time-limited test:BookieAutoRecoveryTest@458] - Killing Bookie :localhost:37485
2020-08-10 23:17:58,735 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:58,735 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:58,736 - WARN  - [bookkeeper-io-328-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x18f7ba66, L:/127.0.0.1:49426 - R:localhost/127.0.0.1:37485] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:17:58,736 - INFO  - [bookkeeper-io-328-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x18f7ba66, L:/127.0.0.1:49426 ! R:localhost/127.0.0.1:37485]
2020-08-10 23:17:58,736 - INFO  - [bookie-io-348-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x878fc03b, L:/127.0.0.1:37485 ! R:/127.0.0.1:49426]
2020-08-10 23:17:58,738 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37485 with exitCode 0
2020-08-10 23:17:58,738 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:17:58,738 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:17:58,738 - INFO  - [SyncThread-356-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:17:58,739 - INFO  - [SyncThread-356-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7419352735221037005test/current/0.log for logId 0.
2020-08-10 23:17:58,740 - INFO  - [pool-197-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie7419352735221037005test/current/1.log for logId 1.
2020-08-10 23:17:58,747 - INFO  - [SyncThread-356-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094277588 , logFileOffset - 3072]}.
2020-08-10 23:17:58,750 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:17:58,751 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:17:58,751 - INFO  - [BookieJournal-37485:Journal@1135] - Journal exits when shutting down
2020-08-10 23:17:58,752 - INFO  - [BookieJournal-37485:Journal@1144] - Journal exited loop!
2020-08-10 23:17:58,752 - INFO  - [Bookie-37485:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:17:58,752 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:17:58,753 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:17:58,753 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:17:58,753 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:17:58,753 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:17:58,753 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:17:58,762 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:17:58,763 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:17:58,763 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:17:58,766 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:37485
2020-08-10 23:17:58,766 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:37485
2020-08-10 23:17:58,766 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:37485
2020-08-10 23:17:58,767 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:37485
2020-08-10 23:17:58,770 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1067] - Starting auditBookies
2020-08-10 23:17:58,777 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1114] - Following are the failed bookies: [localhost:37485], and searching its ledgers for re-replication
2020-08-10 23:17:58,777 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:37485] are identified as underreplicated
2020-08-10 23:17:58,794 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:17:58,794 - INFO  - [AuditorBookie-127.0.0.1:38861:Auditor@1102] - Completed auditBookies
2020-08-10 23:17:58,802 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x61506191, L:/127.0.0.1:43258 - R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:17:58,802 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38861
2020-08-10 23:17:58,802 - ERROR - [bookkeeper-io-344-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x59bc7036, L:/127.0.0.1:49434]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:58,803 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$1@471] - connection [id: 0x61506191, L:/127.0.0.1:43258 - R:127.0.0.1/127.0.0.1:38861] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:58,804 - INFO  - [bookie-io-332-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:58,804 - INFO  - [bookkeeper-io-344-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xbe016fc4, L:/127.0.0.1:52166 - R:localhost/127.0.0.1:43397]
2020-08-10 23:17:58,804 - INFO  - [bookkeeper-io-344-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:43397
2020-08-10 23:17:58,804 - INFO  - [bookie-io-332-3:BookieRequestHandler@50] - Channel connected  [id: 0x1adc919b, L:/127.0.0.1:38861 - R:/127.0.0.1:43258]
2020-08-10 23:17:58,804 - INFO  - [bookkeeper-io-344-3:PerChannelBookieClient$1@471] - connection [id: 0xbe016fc4, L:/127.0.0.1:52166 - R:localhost/127.0.0.1:43397] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:17:58,805 - INFO  - [bookie-io-367-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:17:58,809 - INFO  - [bookie-io-367-3:BookieRequestHandler@50] - Channel connected  [id: 0xca6f30ac, L:/127.0.0.1:43397 - R:/127.0.0.1:52166]
2020-08-10 23:17:58,808 - ERROR - [bookkeeper-io-344-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1741e163, L:/127.0.0.1:49438]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:17:58,867 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:17:58,867 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:17:58,867 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:17:58,867 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:17:58,867 - INFO  - [AuditorElector-localhost:37485:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:17:58,867 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:17:58,871 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:17:58,980 - INFO  - [Time-limited test:BookieAutoRecoveryTest@464] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0000/urL0000000000 to know the status of rereplication process
2020-08-10 23:17:58,982 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie4183256726358880016test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43329/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie4183256726358880016test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "false",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:17:58,984 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:58,988 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:58,991 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:17:58,996 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie4183256726358880016test/current] [/tmp/bookie4183256726358880016test/current]
2020-08-10 23:17:59,004 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:17:59,005 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie4183256726358880016test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:17:59,005 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:17:59,005 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:17:59,005 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:17:59,006 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:17:59,007 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:17:59,007 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:17:59,019 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:42199 to become writable
2020-08-10 23:17:59,019 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:17:59,020 - INFO  - [SyncThread-388-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:17:59,023 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:17:59,027 - INFO  - [BookieJournal-42199:Journal@909] - Starting journal on /tmp/bookie4183256726358880016test/current
2020-08-10 23:17:59,028 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:17:59,028 - INFO  - [BookieJournal-42199:JournalChannel@157] - Opening journal /tmp/bookie4183256726358880016test/current/173da3cb775.txn
2020-08-10 23:17:59,032 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42199
2020-08-10 23:17:59,032 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42199
2020-08-10 23:17:59,033 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42199
2020-08-10 23:17:59,085 - INFO  - [BookieDeathWatcher-37485:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:17:59,085 - INFO  - [BookieDeathWatcher-37485:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37485
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:17:59,085 - INFO  - [BookieDeathWatcher-37485:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:17:59,085 - INFO  - [BookieDeathWatcher-37485:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:17:59,288 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:42199' has been created.
2020-08-10 23:17:59,290 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43329/ledgers : zkServers = localhost:43329, ledgersRootPath = /ledgers.
2020-08-10 23:17:59,303 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:17:59,305 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:17:59,305 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:17:59,305 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:17:59,305 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:17:59,308 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42199
2020-08-10 23:17:59,308 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38861
2020-08-10 23:17:59,308 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:43397
2020-08-10 23:17:59,355 - INFO  - [AutoRecoveryDeathWatcher-37485:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:17:59,355 - INFO  - [AutoRecoveryDeathWatcher-37485:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-37485
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:17:59,355 - INFO  - [AutoRecoveryDeathWatcher-37485:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:01,824 - ERROR - [bookkeeper-io-344-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xed81d0d5, L:/127.0.0.1:49444]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:01,829 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger0 for Recovery.
2020-08-10 23:18:01,837 - INFO  - [BookieHighPriorityThread-38861-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:43258
2020-08-10 23:18:01,840 - INFO  - [BookieHighPriorityThread-43397-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:52166
2020-08-10 23:18:01,841 - ERROR - [bookkeeper-io-344-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x913ac798, L:/127.0.0.1:49446]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:01,856 - ERROR - [bookkeeper-io-344-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x562a4047, L:/127.0.0.1:49448]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:01,856 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E4 from bookie: localhost:37485
2020-08-10 23:18:01,860 - ERROR - [bookkeeper-io-344-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xcaca4b28, L:/127.0.0.1:49450]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:01,860 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingAddOp@376] - Failed to write entry (0, 4): Bookie handle is not available
2020-08-10 23:18:01,861 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:BookieWatcherImpl@298] - replaceBookie for bookie: localhost:37485 in ensemble: [127.0.0.1:38861, localhost:37485, localhost:43397] is not adhering to placement policy and chose 127.0.0.1:42199. excludedBookies [localhost:37485] and quarantinedBookies []
2020-08-10 23:18:01,864 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x23f64385, L:/127.0.0.1:58696 - R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:01,864 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42199
2020-08-10 23:18:01,864 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient$1@471] - connection [id: 0x23f64385, L:/127.0.0.1:58696 - R:127.0.0.1/127.0.0.1:42199] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:01,865 - INFO  - [bookie-io-383-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:01,865 - INFO  - [bookie-io-383-2:BookieRequestHandler@50] - Channel connected  [id: 0xadda47a0, L:/127.0.0.1:42199 - R:/127.0.0.1:58696]
2020-08-10 23:18:02,078 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 0 at entry 4
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe0107a26, L:/127.0.0.1:58700 - R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42199
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8e4d5d9f, L:/127.0.0.1:52184 - R:localhost/127.0.0.1:43397]
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:43397
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-1:PerChannelBookieClient$1@471] - connection [id: 0xe0107a26, L:/127.0.0.1:58700 - R:127.0.0.1/127.0.0.1:42199] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:02,098 - INFO  - [bookie-io-367-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:02,099 - INFO  - [bookie-io-367-4:BookieRequestHandler@50] - Channel connected  [id: 0x6eeb9df8, L:/127.0.0.1:43397 - R:/127.0.0.1:52184]
2020-08-10 23:18:02,098 - INFO  - [bookkeeper-io-379-2:PerChannelBookieClient$1@471] - connection [id: 0x8e4d5d9f, L:/127.0.0.1:52184 - R:localhost/127.0.0.1:43397] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:02,099 - INFO  - [bookie-io-383-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:02,105 - INFO  - [bookie-io-383-3:BookieRequestHandler@50] - Channel connected  [id: 0x35b78c54, L:/127.0.0.1:42199 - R:/127.0.0.1:58700]
2020-08-10 23:18:02,105 - INFO  - [bookie-io-332-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:02,105 - INFO  - [bookie-io-332-4:BookieRequestHandler@50] - Channel connected  [id: 0xa91e81a2, L:/127.0.0.1:38861 - R:/127.0.0.1:43284]
2020-08-10 23:18:02,104 - INFO  - [bookkeeper-io-379-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf5a6f814, L:/127.0.0.1:43284 - R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:18:02,108 - INFO  - [bookkeeper-io-379-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38861
2020-08-10 23:18:02,108 - INFO  - [bookkeeper-io-379-3:PerChannelBookieClient$1@471] - connection [id: 0xf5a6f814, L:/127.0.0.1:43284 - R:127.0.0.1/127.0.0.1:38861] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:02,113 - ERROR - [bookkeeper-io-379-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x3359815e, L:/127.0.0.1:49460]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,115 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 3[3], Host: [localhost:37485], Closed: true) in 1 sub fragments.
2020-08-10 23:18:02,117 - ERROR - [bookkeeper-io-379-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2df17547, L:/127.0.0.1:49462]/localhost:37485, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:37485
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,121 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E1 from bookie: localhost:37485
2020-08-10 23:18:02,133 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({localhost:37485=127.0.0.1:42199}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:18:02,136 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:18:02,138 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:18:02,139 - INFO  - [Time-limited test:BookieAutoRecoveryTest@484] - Waiting to update the urledger metadata in zookeeper
2020-08-10 23:18:02,141 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:18:02,141 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:37485
2020-08-10 23:18:02,141 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38861
2020-08-10 23:18:02,142 - INFO  - [bookkeeper-io-328-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x754a2ca8, L:/127.0.0.1:43254 ! R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:18:02,142 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:43397
2020-08-10 23:18:02,143 - INFO  - [bookie-io-332-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x53e1279b, L:/127.0.0.1:38861 ! R:/127.0.0.1:43254]
2020-08-10 23:18:02,144 - INFO  - [bookie-io-367-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x9257241d, L:/127.0.0.1:43397 ! R:/127.0.0.1:52160]
2020-08-10 23:18:02,144 - INFO  - [bookkeeper-io-328-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x111af784, L:/127.0.0.1:52160 ! R:localhost/127.0.0.1:43397]
2020-08-10 23:18:02,250 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:02,250 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:02,250 - INFO  - [bookie-io-332-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x1adc919b, L:/127.0.0.1:38861 ! R:/127.0.0.1:43258]
2020-08-10 23:18:02,250 - WARN  - [bookkeeper-io-379-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0xf5a6f814, L:/127.0.0.1:43284 - R:127.0.0.1/127.0.0.1:38861] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:02,250 - WARN  - [bookkeeper-io-344-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x61506191, L:/127.0.0.1:43258 - R:127.0.0.1/127.0.0.1:38861] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:02,251 - INFO  - [bookkeeper-io-379-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf5a6f814, L:/127.0.0.1:43284 ! R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:18:02,251 - INFO  - [bookie-io-332-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xa91e81a2, L:/127.0.0.1:38861 ! R:/127.0.0.1:43284]
2020-08-10 23:18:02,251 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x61506191, L:/127.0.0.1:43258 ! R:127.0.0.1/127.0.0.1:38861]
2020-08-10 23:18:02,258 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38861 with exitCode 0
2020-08-10 23:18:02,258 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:02,258 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:02,258 - INFO  - [SyncThread-337-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:02,259 - INFO  - [SyncThread-337-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8255751466935994529test/current/0.log for logId 0.
2020-08-10 23:18:02,261 - INFO  - [pool-187-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8255751466935994529test/current/1.log for logId 1.
2020-08-10 23:18:02,276 - INFO  - [SyncThread-337-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094277266 , logFileOffset - 4608]}.
2020-08-10 23:18:02,279 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:02,280 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:02,280 - INFO  - [BookieJournal-38861:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:02,280 - INFO  - [BookieJournal-38861:Journal@1144] - Journal exited loop!
2020-08-10 23:18:02,280 - INFO  - [Bookie-38861:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:02,280 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:02,282 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:02,282 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:02,282 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:02,282 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:02,282 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:02,285 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:02,285 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:02,285 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:02,391 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:02,391 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:02,392 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:02,392 - INFO  - [AuditorElector-127.0.0.1:38861:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:02,392 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:02,392 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:02,392 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:02,394 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:02,394 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42199
2020-08-10 23:18:02,394 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38861
2020-08-10 23:18:02,395 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38861
2020-08-10 23:18:02,395 - INFO  - [bookkeeper-io-344-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x23f64385, L:/127.0.0.1:58696 ! R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:02,395 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38861
2020-08-10 23:18:02,395 - INFO  - [bookie-io-383-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xadda47a0, L:/127.0.0.1:42199 ! R:/127.0.0.1:58696]
2020-08-10 23:18:02,395 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:37485
2020-08-10 23:18:02,408 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38861
2020-08-10 23:18:02,409 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:43397
2020-08-10 23:18:02,409 - INFO  - [bookkeeper-io-344-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xbe016fc4, L:/127.0.0.1:52166 ! R:localhost/127.0.0.1:43397]
2020-08-10 23:18:02,410 - INFO  - [bookie-io-367-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xca6f30ac, L:/127.0.0.1:43397 ! R:/127.0.0.1:52166]
2020-08-10 23:18:02,514 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:02,514 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:02,515 - WARN  - [bookkeeper-io-379-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x8e4d5d9f, L:/127.0.0.1:52184 - R:localhost/127.0.0.1:43397] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:02,515 - INFO  - [bookkeeper-io-379-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8e4d5d9f, L:/127.0.0.1:52184 ! R:localhost/127.0.0.1:43397]
2020-08-10 23:18:02,515 - INFO  - [bookie-io-367-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x6eeb9df8, L:/127.0.0.1:43397 ! R:/127.0.0.1:52184]
2020-08-10 23:18:02,518 - INFO  - [AuditorElector-localhost:43397:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:02,518 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43397 with exitCode 0
2020-08-10 23:18:02,518 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:02,518 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:02,519 - INFO  - [SyncThread-372-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:02,521 - INFO  - [AuditorElector-localhost:43397:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:02,521 - INFO  - [AuditorElector-localhost:43397:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:02,521 - INFO  - [SyncThread-372-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15953718834620822709test/current/0.log for logId 0.
2020-08-10 23:18:02,523 - INFO  - [pool-207-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15953718834620822709test/current/1.log for logId 1.
2020-08-10 23:18:02,523 - INFO  - [AuditorElector-localhost:43397:Auditor@660] - I'm starting as Auditor Bookie. ID: localhost:43397
2020-08-10 23:18:02,526 - INFO  - [AuditorElector-localhost:43397:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:02,528 - INFO  - [AuditorElector-localhost:43397:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:02,528 - INFO  - [AuditorBookie-localhost:43397:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:02,529 - INFO  - [AuditorElector-localhost:43397:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094275789 durationSinceLastExecutionInSecs: 6 initialDelay: 604794 interval: 604800
2020-08-10 23:18:02,529 - INFO  - [AuditorElector-localhost:43397:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:02,529 - INFO  - [AuditorElector-localhost:43397:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:02,529 - INFO  - [SyncThread-372-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094278389 , logFileOffset - 4096]}.
2020-08-10 23:18:02,535 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:02,537 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:02,537 - INFO  - [BookieJournal-43397:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:02,537 - INFO  - [BookieJournal-43397:Journal@1144] - Journal exited loop!
2020-08-10 23:18:02,537 - INFO  - [Bookie-43397:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:02,538 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:02,540 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:02,542 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:02,542 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:02,545 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:43397
2020-08-10 23:18:02,546 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:43397
2020-08-10 23:18:02,546 - INFO  - [AutoRecoveryDeathWatcher-38861:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:02,547 - INFO  - [AutoRecoveryDeathWatcher-38861:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-38861
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:02,547 - INFO  - [AutoRecoveryDeathWatcher-38861:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:02,548 - INFO  - [AuditorBookie-localhost:43397:Auditor@1114] - Following are the failed bookies: [localhost:43397, 127.0.0.1:38861], and searching its ledgers for re-replication
2020-08-10 23:18:02,548 - INFO  - [AuditorBookie-localhost:43397:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:43397] are identified as underreplicated
2020-08-10 23:18:02,568 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:38861] are identified as underreplicated
2020-08-10 23:18:02,574 - INFO  - [AuditorBookie-localhost:43397:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:02,579 - INFO  - [AuditorBookie-localhost:43397:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:02,588 - INFO  - [AuditorBookie-localhost:43397:Auditor@1114] - Following are the failed bookies: [localhost:43397, 127.0.0.1:38861], and searching its ledgers for re-replication
2020-08-10 23:18:02,598 - INFO  - [AuditorBookie-localhost:43397:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:43397] are identified as underreplicated
2020-08-10 23:18:02,599 - INFO  - [bookie-io-383-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:02,606 - INFO  - [bookkeeper-io-395-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xb87ba789, L:/127.0.0.1:58708 - R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:02,606 - INFO  - [bookkeeper-io-395-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42199
2020-08-10 23:18:02,606 - INFO  - [bookkeeper-io-395-1:PerChannelBookieClient$1@471] - connection [id: 0xb87ba789, L:/127.0.0.1:58708 - R:127.0.0.1/127.0.0.1:42199] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:02,606 - INFO  - [bookie-io-383-4:BookieRequestHandler@50] - Channel connected  [id: 0xa078c50c, L:/127.0.0.1:42199 - R:/127.0.0.1:58708]
2020-08-10 23:18:02,606 - ERROR - [bookkeeper-io-395-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x947f1b4a, L:/127.0.0.1:43292]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,606 - ERROR - [bookkeeper-io-395-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0d586341, L:/127.0.0.1:52198]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,608 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:38861] are identified as underreplicated
2020-08-10 23:18:02,611 - ERROR - [bookkeeper-io-395-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xd25d04d0, L:/127.0.0.1:43296]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,612 - INFO  - [AuditorBookie-localhost:43397:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:02,613 - ERROR - [bookkeeper-io-395-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xeede87e7, L:/127.0.0.1:52202]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,615 - ERROR - [bookkeeper-io-395-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5a9de704, L:/127.0.0.1:43300]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,616 - ERROR - [bookkeeper-io-395-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x63d3e23a, L:/127.0.0.1:52206]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,617 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], allBookies [<Bookie:127.0.0.1:42199>].
2020-08-10 23:18:02,617 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:02,617 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], allBookies [<Bookie:127.0.0.1:42199>].
2020-08-10 23:18:02,617 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:02,618 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], allBookies [<Bookie:127.0.0.1:42199>].
2020-08-10 23:18:02,618 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:02,618 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:43397>, <Bookie:127.0.0.1:38861>, <Bookie:127.0.0.1:42199>], allBookies [<Bookie:127.0.0.1:42199>].
2020-08-10 23:18:02,618 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:02,620 - ERROR - [bookkeeper-io-395-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf1bd2a84, L:/127.0.0.1:43304]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,620 - ERROR - [bookkeeper-io-395-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x5fc9cda1, L:/127.0.0.1:52210]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,620 - ERROR - [bookkeeper-io-395-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x094d07f1, L:/127.0.0.1:43308]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,621 - ERROR - [bookkeeper-io-395-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc319352b, L:/127.0.0.1:52214]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,621 - ERROR - [bookkeeper-io-395-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x641691dc, L:/127.0.0.1:43312]/127.0.0.1:38861, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:38861
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,622 - ERROR - [bookkeeper-io-395-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x461a0d02, L:/127.0.0.1:52218]/localhost:43397, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:43397
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:02,623 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:02,648 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:02,648 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:02,648 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:02,648 - INFO  - [AuditorElector-localhost:43397:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:02,648 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:02,648 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:02,651 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:02,652 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:02,653 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42199
2020-08-10 23:18:02,654 - INFO  - [bookkeeper-io-379-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe0107a26, L:/127.0.0.1:58700 ! R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:02,654 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:37485
2020-08-10 23:18:02,654 - INFO  - [bookie-io-383-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x35b78c54, L:/127.0.0.1:42199 ! R:/127.0.0.1:58700]
2020-08-10 23:18:02,654 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38861
2020-08-10 23:18:02,655 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:43397
2020-08-10 23:18:02,668 - INFO  - [AutoRecoveryDeathWatcher-43397:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:02,668 - INFO  - [AutoRecoveryDeathWatcher-43397:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-43397
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:02,668 - INFO  - [AutoRecoveryDeathWatcher-43397:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:02,669 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:02,671 - INFO  - [AuditorElector-127.0.0.1:42199:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:02,671 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:02,672 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:42199
2020-08-10 23:18:02,675 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:02,675 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:02,676 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094275789 durationSinceLastExecutionInSecs: 6 initialDelay: 604794 interval: 604800
2020-08-10 23:18:02,676 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:02,676 - INFO  - [AuditorElector-127.0.0.1:42199:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:02,676 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:02,684 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1114] - Following are the failed bookies: [localhost:43397, 127.0.0.1:38861], and searching its ledgers for re-replication
2020-08-10 23:18:02,684 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:43397] are identified as underreplicated
2020-08-10 23:18:02,687 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:38861] are identified as underreplicated
2020-08-10 23:18:02,700 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:02,762 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:02,762 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:02,763 - WARN  - [bookkeeper-io-395-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xb87ba789, L:/127.0.0.1:58708 - R:127.0.0.1/127.0.0.1:42199] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:02,763 - INFO  - [bookie-io-383-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xa078c50c, L:/127.0.0.1:42199 ! R:/127.0.0.1:58708]
2020-08-10 23:18:02,763 - INFO  - [bookkeeper-io-395-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xb87ba789, L:/127.0.0.1:58708 ! R:127.0.0.1/127.0.0.1:42199]
2020-08-10 23:18:02,764 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42199 with exitCode 0
2020-08-10 23:18:02,764 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:02,764 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:02,765 - INFO  - [SyncThread-388-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:02,765 - INFO  - [SyncThread-388-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4183256726358880016test/current/0.log for logId 0.
2020-08-10 23:18:02,767 - INFO  - [pool-217-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie4183256726358880016test/current/1.log for logId 1.
2020-08-10 23:18:02,781 - INFO  - [SyncThread-388-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094279029 , logFileOffset - 3072]}.
2020-08-10 23:18:02,784 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:02,784 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:02,785 - INFO  - [BookieJournal-42199:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:02,785 - INFO  - [BookieJournal-42199:Journal@1144] - Journal exited loop!
2020-08-10 23:18:02,785 - INFO  - [Bookie-42199:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:02,785 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:02,787 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:02,787 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:02,788 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:02,788 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:02,788 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:02,791 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:02,791 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:02,791 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:02,799 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:42199
2020-08-10 23:18:02,802 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:02,808 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1114] - Following are the failed bookies: [localhost:43397, 127.0.0.1:38861, 127.0.0.1:42199], and searching its ledgers for re-replication
2020-08-10 23:18:02,808 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:43397] are identified as underreplicated
2020-08-10 23:18:02,811 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:38861] are identified as underreplicated
2020-08-10 23:18:02,814 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:42199] are identified as underreplicated
2020-08-10 23:18:02,819 - INFO  - [AuditorBookie-127.0.0.1:42199:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:02,905 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:02,905 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:02,906 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:02,906 - INFO  - [AuditorElector-127.0.0.1:42199:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:02,906 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:02,906 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:02,908 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:02,908 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:02,912 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42199
2020-08-10 23:18:02,912 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38861
2020-08-10 23:18:02,912 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:43397
2020-08-10 23:18:03,045 - INFO  - [BookieDeathWatcher-42199:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:03,045 - INFO  - [BookieDeathWatcher-42199:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42199
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:03,045 - INFO  - [BookieDeathWatcher-42199:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:03,045 - INFO  - [BookieDeathWatcher-42199:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:03,133 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testLedgerMetadataContainsIpAddressAsBookieID in 992 ms.
2020-08-10 23:18:03,229 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:18:03,275 - INFO  - [BookieDeathWatcher-38861:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:03,276 - INFO  - [BookieDeathWatcher-38861:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38861
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:03,276 - INFO  - [BookieDeathWatcher-38861:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:03,276 - INFO  - [BookieDeathWatcher-38861:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:03,329 - INFO  - [AutoRecoveryDeathWatcher-42199:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:03,329 - INFO  - [AutoRecoveryDeathWatcher-42199:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-42199
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:03,329 - INFO  - [AutoRecoveryDeathWatcher-42199:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:03,332 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:18:03,347 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,353 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:03,356 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,358 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:03,358 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:03,358 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:03,358 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:03,363 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:03,363 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie11749479782719343602test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:34755/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie11749479782719343602test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:03,366 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:03,369 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,371 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:03,375 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie11749479782719343602test/current] [/tmp/bookie11749479782719343602test/current]
2020-08-10 23:18:03,384 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:03,385 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie11749479782719343602test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:03,385 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:03,385 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:03,385 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:03,386 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:03,386 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:03,386 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:03,392 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:40317 to become writable
2020-08-10 23:18:03,392 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:03,393 - INFO  - [SyncThread-416-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:03,395 - INFO  - [BookieDeathWatcher-43397:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:03,395 - INFO  - [BookieDeathWatcher-43397:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43397
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:03,395 - INFO  - [BookieDeathWatcher-43397:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:03,395 - INFO  - [BookieDeathWatcher-43397:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:03,396 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:03,398 - INFO  - [BookieJournal-40317:Journal@909] - Starting journal on /tmp/bookie11749479782719343602test/current
2020-08-10 23:18:03,398 - INFO  - [BookieJournal-40317:JournalChannel@157] - Opening journal /tmp/bookie11749479782719343602test/current/173da3cc887.txn
2020-08-10 23:18:03,398 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:03,403 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:03,657 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:40317' has been created.
2020-08-10 23:18:03,659 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:03,663 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,664 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:03,664 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:03,665 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:03,665 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:03,666 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:03,685 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:03,685 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie8929598720402297200test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:34755/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie8929598720402297200test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:03,687 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:03,694 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,696 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:03,699 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:03,701 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:18:03,702 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8929598720402297200test/current] [/tmp/bookie8929598720402297200test/current]
2020-08-10 23:18:03,702 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:40317
2020-08-10 23:18:03,708 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:03,708 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:03,708 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:03,709 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:03,709 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8929598720402297200test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:03,710 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:03,710 - WARN  - [AuditorElector-127.0.0.1:40317:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:18:03,710 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:18:03,710 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:03,710 - INFO  - [AuditorElector-127.0.0.1:40317:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:03,710 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:03,711 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:03,714 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:03,714 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:03,714 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:03,718 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:03,720 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:18:03,722 - INFO  - [AuditorBookie-127.0.0.1:40317:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:03,723 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41603 to become writable
2020-08-10 23:18:03,724 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:03,726 - INFO  - [SyncThread-435-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:03,726 - INFO  - [AuditorBookie-127.0.0.1:40317-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:03,728 - ERROR - [AuditorBookie-127.0.0.1:40317:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:03,728 - INFO  - [AuditorBookie-127.0.0.1:40317:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:03,728 - INFO  - [AuditorBookie-127.0.0.1:40317:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:03,728 - INFO  - [AuditorBookie-127.0.0.1:40317:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:03,730 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:03,730 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:03,740 - INFO  - [BookieJournal-41603:Journal@909] - Starting journal on /tmp/bookie8929598720402297200test/current
2020-08-10 23:18:03,741 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:03,741 - INFO  - [BookieJournal-41603:JournalChannel@157] - Opening journal /tmp/bookie8929598720402297200test/current/173da3cc9de.txn
2020-08-10 23:18:03,750 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:03,750 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:03,750 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:03,857 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor$11@751] - Completed checkAllLedgers in 136 milliSeconds
2020-08-10 23:18:04,000 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41603' has been created.
2020-08-10 23:18:04,002 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:04,005 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:04,007 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:04,007 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:04,007 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:04,007 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:04,008 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:04,008 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:04,022 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:04,022 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie8200150974307874995test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:34755/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie8200150974307874995test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:04,025 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:04,028 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:04,030 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:04,033 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8200150974307874995test/current] [/tmp/bookie8200150974307874995test/current]
2020-08-10 23:18:04,038 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:04,039 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8200150974307874995test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:04,039 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:04,039 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:04,039 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:04,043 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:04,043 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:04,043 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:04,053 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39817 to become writable
2020-08-10 23:18:04,053 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:04,054 - INFO  - [SyncThread-457-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:04,057 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:04,061 - INFO  - [BookieJournal-39817:Journal@909] - Starting journal on /tmp/bookie8200150974307874995test/current
2020-08-10 23:18:04,061 - INFO  - [BookieJournal-39817:JournalChannel@157] - Opening journal /tmp/bookie8200150974307874995test/current/173da3ccb1e.txn
2020-08-10 23:18:04,061 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:04,064 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,065 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,065 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,315 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39817' has been created.
2020-08-10 23:18:04,320 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:04,325 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:04,330 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:04,330 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:04,330 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:04,330 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:04,336 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,336 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:04,337 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:04,345 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testOpenLedgers @ metadata service zk://localhost:34755/ledgers in 1013 ms.
2020-08-10 23:18:04,346 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:04,350 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:04,355 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:39817, 127.0.0.1:40317, 127.0.0.1:41603] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:18:04,373 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39817, 127.0.0.1:40317, 127.0.0.1:41603] for ledger: 0
2020-08-10 23:18:04,374 - INFO  - [bookkeeper-io-407-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x91d383df, L:/127.0.0.1:47524 - R:127.0.0.1/127.0.0.1:39817]
2020-08-10 23:18:04,374 - INFO  - [bookkeeper-io-407-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39817
2020-08-10 23:18:04,375 - INFO  - [bookkeeper-io-407-1:PerChannelBookieClient$1@471] - connection [id: 0x91d383df, L:/127.0.0.1:47524 - R:127.0.0.1/127.0.0.1:39817] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:04,375 - INFO  - [bookkeeper-io-407-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf0ffa826, L:/127.0.0.1:40446 - R:127.0.0.1/127.0.0.1:40317]
2020-08-10 23:18:04,375 - INFO  - [bookkeeper-io-407-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40317
2020-08-10 23:18:04,375 - INFO  - [bookkeeper-io-407-2:PerChannelBookieClient$1@471] - connection [id: 0xf0ffa826, L:/127.0.0.1:40446 - R:127.0.0.1/127.0.0.1:40317] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:04,376 - INFO  - [bookie-io-411-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:04,376 - INFO  - [bookie-io-411-2:BookieRequestHandler@50] - Channel connected  [id: 0x2528926e, L:/127.0.0.1:40317 - R:/127.0.0.1:40446]
2020-08-10 23:18:04,376 - INFO  - [bookie-io-452-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:04,376 - INFO  - [bookkeeper-io-407-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe152c56c, L:/127.0.0.1:54360 - R:127.0.0.1/127.0.0.1:41603]
2020-08-10 23:18:04,376 - INFO  - [bookkeeper-io-407-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:41603
2020-08-10 23:18:04,377 - INFO  - [bookkeeper-io-407-3:PerChannelBookieClient$1@471] - connection [id: 0xe152c56c, L:/127.0.0.1:54360 - R:127.0.0.1/127.0.0.1:41603] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:04,380 - INFO  - [bookie-io-452-2:BookieRequestHandler@50] - Channel connected  [id: 0xac095a98, L:/127.0.0.1:39817 - R:/127.0.0.1:47524]
2020-08-10 23:18:04,396 - INFO  - [bookie-io-427-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:04,396 - INFO  - [bookie-io-427-2:BookieRequestHandler@50] - Channel connected  [id: 0x9a96a9e1, L:/127.0.0.1:41603 - R:/127.0.0.1:54360]
2020-08-10 23:18:04,433 - INFO  - [Time-limited test:BookieAutoRecoveryTest@161] - Killing Bookie :127.0.0.1:39817
2020-08-10 23:18:04,435 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:04,435 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:04,435 - WARN  - [bookkeeper-io-407-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x91d383df, L:/127.0.0.1:47524 - R:127.0.0.1/127.0.0.1:39817] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:04,435 - INFO  - [bookkeeper-io-407-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x91d383df, L:/127.0.0.1:47524 ! R:127.0.0.1/127.0.0.1:39817]
2020-08-10 23:18:04,436 - INFO  - [bookie-io-452-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xac095a98, L:/127.0.0.1:39817 ! R:/127.0.0.1:47524]
2020-08-10 23:18:04,442 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39817 with exitCode 0
2020-08-10 23:18:04,442 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:04,442 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:04,443 - INFO  - [SyncThread-457-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:04,443 - INFO  - [SyncThread-457-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8200150974307874995test/current/0.log for logId 0.
2020-08-10 23:18:04,446 - INFO  - [pool-255-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8200150974307874995test/current/1.log for logId 1.
2020-08-10 23:18:04,460 - INFO  - [SyncThread-457-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094284062 , logFileOffset - 3072]}.
2020-08-10 23:18:04,463 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:04,463 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:04,463 - INFO  - [BookieJournal-39817:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:04,464 - INFO  - [BookieJournal-39817:Journal@1144] - Journal exited loop!
2020-08-10 23:18:04,464 - INFO  - [Bookie-39817:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:04,464 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:04,464 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:04,464 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:04,464 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:04,465 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:04,465 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:04,466 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:04,467 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:04,467 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:04,470 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,470 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,470 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,470 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39817
2020-08-10 23:18:04,570 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:04,570 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:04,570 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:04,570 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:04,570 - INFO  - [AuditorElector-127.0.0.1:39817:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:04,570 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:04,574 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:04,578 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:04,584 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1114] - Following are the failed bookies: [127.0.0.1:39817], and searching its ledgers for re-replication
2020-08-10 23:18:04,586 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:39817] are identified as underreplicated
2020-08-10 23:18:04,711 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:18:04,711 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:04,711 - INFO  - [Time-limited test:BookieAutoRecoveryTest@167] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0000/urL0000000000 to know the status of rereplication process
2020-08-10 23:18:04,712 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:04,712 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie1553226121020845602test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:34755/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1553226121020845602test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:04,715 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:04,726 - INFO  - [bookkeeper-io-448-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x17333d31, L:/127.0.0.1:40452 - R:127.0.0.1/127.0.0.1:40317]
2020-08-10 23:18:04,728 - INFO  - [bookkeeper-io-448-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40317
2020-08-10 23:18:04,726 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:04,726 - INFO  - [bookkeeper-io-448-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8c2ff020, L:/127.0.0.1:54368 - R:127.0.0.1/127.0.0.1:41603]
2020-08-10 23:18:04,726 - ERROR - [bookkeeper-io-448-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x75d53261, L:/127.0.0.1:47534]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:04,728 - INFO  - [bookkeeper-io-448-2:PerChannelBookieClient$1@471] - connection [id: 0x17333d31, L:/127.0.0.1:40452 - R:127.0.0.1/127.0.0.1:40317] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:04,728 - INFO  - [bookkeeper-io-448-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:41603
2020-08-10 23:18:04,729 - INFO  - [bookie-io-427-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:04,729 - INFO  - [bookie-io-427-3:BookieRequestHandler@50] - Channel connected  [id: 0x35c55e92, L:/127.0.0.1:41603 - R:/127.0.0.1:54368]
2020-08-10 23:18:04,730 - INFO  - [bookie-io-411-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:04,730 - INFO  - [bookie-io-411-3:BookieRequestHandler@50] - Channel connected  [id: 0xa7dd035f, L:/127.0.0.1:40317 - R:/127.0.0.1:40452]
2020-08-10 23:18:04,729 - INFO  - [bookkeeper-io-448-3:PerChannelBookieClient$1@471] - connection [id: 0x8c2ff020, L:/127.0.0.1:54368 - R:127.0.0.1/127.0.0.1:41603] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:04,731 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:04,780 - ERROR - [bookkeeper-io-448-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x30b77d04, L:/127.0.0.1:47538]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:04,799 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1553226121020845602test/current] [/tmp/bookie1553226121020845602test/current]
2020-08-10 23:18:04,809 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:04,810 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1553226121020845602test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:04,810 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:04,810 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:04,810 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:04,811 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:04,812 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:04,812 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:04,822 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:36815 to become writable
2020-08-10 23:18:04,823 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:04,824 - INFO  - [SyncThread-477-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:04,828 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:04,835 - INFO  - [BookieJournal-36815:Journal@909] - Starting journal on /tmp/bookie1553226121020845602test/current
2020-08-10 23:18:04,837 - INFO  - [BookieJournal-36815:JournalChannel@157] - Opening journal /tmp/bookie1553226121020845602test/current/173da3cce26.txn
2020-08-10 23:18:04,837 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:04,845 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:36815
2020-08-10 23:18:04,846 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:36815
2020-08-10 23:18:04,846 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:36815
2020-08-10 23:18:05,065 - INFO  - [BookieDeathWatcher-39817:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:05,065 - INFO  - [BookieDeathWatcher-39817:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39817
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:05,065 - INFO  - [BookieDeathWatcher-39817:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:05,065 - INFO  - [BookieDeathWatcher-39817:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:05,095 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:36815' has been created.
2020-08-10 23:18:05,098 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:34755/ledgers : zkServers = localhost:34755, ledgersRootPath = /ledgers.
2020-08-10 23:18:05,100 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:05,105 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:05,105 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:05,106 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:05,106 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:05,107 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:36815
2020-08-10 23:18:05,108 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:05,108 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:05,346 - INFO  - [AutoRecoveryDeathWatcher-39817:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:05,346 - INFO  - [AutoRecoveryDeathWatcher-39817:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-39817
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:05,347 - INFO  - [AutoRecoveryDeathWatcher-39817:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:07,794 - ERROR - [bookkeeper-io-448-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x29351a63, L:/127.0.0.1:47542]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:07,796 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger0 for Recovery.
2020-08-10 23:18:07,799 - ERROR - [bookkeeper-io-448-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe84df833, L:/127.0.0.1:47544]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:07,799 - INFO  - [BookieHighPriorityThread-40317-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:40452
2020-08-10 23:18:07,799 - INFO  - [BookieHighPriorityThread-41603-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:54368
2020-08-10 23:18:07,808 - ERROR - [bookkeeper-io-448-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc393b484, L:/127.0.0.1:47546]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:07,809 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingAddOp@376] - Failed to write entry (0, 4): Bookie handle is not available
2020-08-10 23:18:07,810 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:BookieWatcherImpl@298] - replaceBookie for bookie: 127.0.0.1:39817 in ensemble: [127.0.0.1:39817, 127.0.0.1:40317, 127.0.0.1:41603] is not adhering to placement policy and chose 127.0.0.1:36815. excludedBookies [127.0.0.1:39817] and quarantinedBookies []
2020-08-10 23:18:07,811 - INFO  - [bookkeeper-io-448-8:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x3595a689, L:/127.0.0.1:60270 - R:127.0.0.1/127.0.0.1:36815]
2020-08-10 23:18:07,811 - INFO  - [bookkeeper-io-448-8:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:36815
2020-08-10 23:18:07,812 - INFO  - [bookie-io-472-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:07,812 - INFO  - [bookie-io-472-2:BookieRequestHandler@50] - Channel connected  [id: 0xc5515ff5, L:/127.0.0.1:36815 - R:/127.0.0.1:60270]
2020-08-10 23:18:07,812 - INFO  - [bookkeeper-io-448-8:PerChannelBookieClient$1@471] - connection [id: 0x3595a689, L:/127.0.0.1:60270 - R:127.0.0.1/127.0.0.1:36815] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:07,818 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 0 at entry 4
2020-08-10 23:18:07,834 - ERROR - [bookkeeper-io-448-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2ce2ff1f, L:/127.0.0.1:47550]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:07,836 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 3[3], Host: [127.0.0.1:39817], Closed: true) in 1 sub fragments.
2020-08-10 23:18:07,837 - ERROR - [bookkeeper-io-448-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe2fee0b3, L:/127.0.0.1:47552]/127.0.0.1:39817, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:39817
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:07,838 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E0 from bookie: 127.0.0.1:39817
2020-08-10 23:18:07,839 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E3 from bookie: 127.0.0.1:39817
2020-08-10 23:18:07,856 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:39817=127.0.0.1:36815}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:18:07,860 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:18:07,862 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:18:07,862 - INFO  - [Time-limited test:BookieAutoRecoveryTest@183] - Waiting to update the urledger metadata in zookeeper
2020-08-10 23:18:07,864 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:18:07,864 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39817
2020-08-10 23:18:07,865 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40317
2020-08-10 23:18:07,866 - INFO  - [bookkeeper-io-407-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf0ffa826, L:/127.0.0.1:40446 ! R:127.0.0.1/127.0.0.1:40317]
2020-08-10 23:18:07,866 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41603
2020-08-10 23:18:07,866 - INFO  - [bookie-io-411-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x2528926e, L:/127.0.0.1:40317 ! R:/127.0.0.1:40446]
2020-08-10 23:18:07,867 - INFO  - [bookkeeper-io-407-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe152c56c, L:/127.0.0.1:54360 ! R:127.0.0.1/127.0.0.1:41603]
2020-08-10 23:18:07,867 - INFO  - [bookie-io-427-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x9a96a9e1, L:/127.0.0.1:41603 ! R:/127.0.0.1:54360]
2020-08-10 23:18:07,977 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:07,977 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:07,979 - INFO  - [bookie-io-411-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xa7dd035f, L:/127.0.0.1:40317 ! R:/127.0.0.1:40452]
2020-08-10 23:18:07,980 - WARN  - [bookkeeper-io-448-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x17333d31, L:/127.0.0.1:40452 - R:127.0.0.1/127.0.0.1:40317] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:07,980 - INFO  - [bookkeeper-io-448-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x17333d31, L:/127.0.0.1:40452 ! R:127.0.0.1/127.0.0.1:40317]
2020-08-10 23:18:07,983 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40317 with exitCode 0
2020-08-10 23:18:07,983 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:07,983 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:07,983 - INFO  - [SyncThread-416-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:07,984 - INFO  - [SyncThread-416-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie11749479782719343602test/current/0.log for logId 0.
2020-08-10 23:18:07,986 - INFO  - [pool-232-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie11749479782719343602test/current/1.log for logId 1.
2020-08-10 23:18:08,001 - INFO  - [SyncThread-416-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094283399 , logFileOffset - 4096]}.
2020-08-10 23:18:08,004 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:08,005 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:08,005 - INFO  - [BookieJournal-40317:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:08,005 - INFO  - [BookieJournal-40317:Journal@1144] - Journal exited loop!
2020-08-10 23:18:08,005 - INFO  - [Bookie-40317:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:08,005 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:08,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:08,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:08,006 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:08,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:08,006 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:08,008 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:08,009 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:08,009 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:08,016 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:08,016 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:08,119 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:08,120 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:08,120 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:08,120 - INFO  - [AuditorElector-127.0.0.1:40317:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:08,122 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40317
2020-08-10 23:18:08,125 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:08,130 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:08,133 - INFO  - [AuditorElector-127.0.0.1:41603:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:08,133 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:08,133 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:41603
2020-08-10 23:18:08,135 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1114] - Following are the failed bookies: [127.0.0.1:40317], and searching its ledgers for re-replication
2020-08-10 23:18:08,136 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:08,136 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:40317] are identified as underreplicated
2020-08-10 23:18:08,136 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:08,138 - INFO  - [AuditorBookie-127.0.0.1:41603:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:08,138 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094283749 durationSinceLastExecutionInSecs: 4 initialDelay: 604796 interval: 604800
2020-08-10 23:18:08,139 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:08,139 - INFO  - [AuditorElector-127.0.0.1:41603:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:08,154 - INFO  - [AuditorBookie-127.0.0.1:40317:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:08,154 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:08,155 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:08,155 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:734)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.waitIfLedgerReplicationDisabled(ZkLedgerUnderreplicationManager.java:620)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:601)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2016)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2301(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:830)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$13.call(ZooKeeperClient.java:824)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:824)
	at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:2049)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2401(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:851)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$14.call(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.exists(ZooKeeperClient.java:845)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.isLedgerReplicationEnabled(ZkLedgerUnderreplicationManager.java:725)
	... 6 more
2020-08-10 23:18:08,159 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:08,167 - ERROR - [bookkeeper-io-448-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x14574e31, L:/127.0.0.1:40474]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,168 - INFO  - [AuditorBookie-127.0.0.1:41603:Auditor@1114] - Following are the failed bookies: [127.0.0.1:40317], and searching its ledgers for re-replication
2020-08-10 23:18:08,169 - INFO  - [AuditorBookie-127.0.0.1:41603:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:40317] are identified as underreplicated
2020-08-10 23:18:08,171 - ERROR - [bookkeeper-io-448-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1953e028, L:/127.0.0.1:40476]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,173 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,173 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:41603>].
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:41603>].
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,174 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:08,175 - ERROR - [bookkeeper-io-448-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xac64056f, L:/127.0.0.1:40478]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,175 - INFO  - [AuditorBookie-127.0.0.1:41603:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:08,176 - ERROR - [bookkeeper-io-448-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x2adf54e7, L:/127.0.0.1:40480]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,178 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:08,267 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:08,268 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:08,268 - WARN  - [bookkeeper-io-448-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0x8c2ff020, L:/127.0.0.1:54368 - R:127.0.0.1/127.0.0.1:41603] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:08,268 - INFO  - [bookkeeper-io-448-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8c2ff020, L:/127.0.0.1:54368 ! R:127.0.0.1/127.0.0.1:41603]
2020-08-10 23:18:08,268 - INFO  - [bookie-io-427-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x35c55e92, L:/127.0.0.1:41603 ! R:/127.0.0.1:54368]
2020-08-10 23:18:08,270 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41603 with exitCode 0
2020-08-10 23:18:08,270 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:08,270 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:08,271 - INFO  - [SyncThread-435-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:08,271 - INFO  - [SyncThread-435-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8929598720402297200test/current/0.log for logId 0.
2020-08-10 23:18:08,272 - INFO  - [pool-242-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8929598720402297200test/current/1.log for logId 1.
2020-08-10 23:18:08,278 - INFO  - [SyncThread-435-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094283742 , logFileOffset - 4608]}.
2020-08-10 23:18:08,280 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:08,281 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:08,281 - INFO  - [BookieJournal-41603:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:08,281 - INFO  - [BookieJournal-41603:Journal@1144] - Journal exited loop!
2020-08-10 23:18:08,281 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:08,281 - INFO  - [Bookie-41603:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:08,281 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:08,282 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:08,282 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:08,282 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:08,282 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:08,283 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:08,284 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:08,284 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:08,288 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:08,388 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:08,388 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:08,389 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:08,389 - INFO  - [AuditorElector-127.0.0.1:41603:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:08,391 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:08,391 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:08,391 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:08,393 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:08,391 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41603
2020-08-10 23:18:08,397 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39817
2020-08-10 23:18:08,398 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:36815
2020-08-10 23:18:08,399 - INFO  - [bookkeeper-io-448-8:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x3595a689, L:/127.0.0.1:60270 ! R:127.0.0.1/127.0.0.1:36815]
2020-08-10 23:18:08,399 - INFO  - [bookie-io-472-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc5515ff5, L:/127.0.0.1:36815 ! R:/127.0.0.1:60270]
2020-08-10 23:18:08,399 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40317
2020-08-10 23:18:08,399 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41603
2020-08-10 23:18:08,404 - INFO  - [BookieDeathWatcher-40317:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:08,404 - INFO  - [BookieDeathWatcher-40317:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40317
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:08,404 - INFO  - [BookieDeathWatcher-40317:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:08,404 - INFO  - [BookieDeathWatcher-40317:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:08,505 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:08,506 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:08,507 - ERROR - [bookkeeper-io-484-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb1db5264, L:/127.0.0.1:40482]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,509 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-36815 with exitCode 0
2020-08-10 23:18:08,509 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:08,509 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:08,509 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:08,509 - INFO  - [SyncThread-477-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:08,511 - ERROR - [bookkeeper-io-484-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x10d0b3a7, L:/127.0.0.1:60286]/127.0.0.1:36815, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:36815
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,516 - INFO  - [SyncThread-477-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1553226121020845602test/current/0.log for logId 0.
2020-08-10 23:18:08,519 - INFO  - [AuditorElector-127.0.0.1:36815:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:08,519 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:08,519 - INFO  - [pool-267-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1553226121020845602test/current/1.log for logId 1.
2020-08-10 23:18:08,521 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:36815
2020-08-10 23:18:08,521 - ERROR - [bookkeeper-io-484-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x91920007, L:/127.0.0.1:54398]/127.0.0.1:41603, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41603
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,524 - ERROR - [bookkeeper-io-484-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x55caaab4, L:/127.0.0.1:40488]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,524 - ERROR - [bookkeeper-io-484-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0d00a697, L:/127.0.0.1:54402]/127.0.0.1:41603, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41603
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,525 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:08,525 - ERROR - [bookkeeper-io-484-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x287a4f5d, L:/127.0.0.1:60296]/127.0.0.1:36815, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:36815
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,525 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:08,526 - ERROR - [bookkeeper-io-484-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6e0394cb, L:/127.0.0.1:40492]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,526 - ERROR - [bookkeeper-io-484-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe231625b, L:/127.0.0.1:54408]/127.0.0.1:41603, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41603
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,526 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094283749 durationSinceLastExecutionInSecs: 4 initialDelay: 604796 interval: 604800
2020-08-10 23:18:08,527 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:08,527 - INFO  - [AuditorElector-127.0.0.1:36815:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:08,527 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,527 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:08,527 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,527 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:08,527 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,528 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:08,528 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41603>, <Bookie:127.0.0.1:36815>, <Bookie:127.0.0.1:40317>], allBookies [<Bookie:127.0.0.1:36815>].
2020-08-10 23:18:08,528 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:08,528 - ERROR - [bookkeeper-io-484-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x12d3f0d4, L:/127.0.0.1:40498]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,528 - ERROR - [bookkeeper-io-484-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x584e389b, L:/127.0.0.1:54414]/127.0.0.1:41603, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41603
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,528 - ERROR - [bookkeeper-io-484-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x25e7b726, L:/127.0.0.1:60302]/127.0.0.1:36815, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:36815
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,529 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:08,530 - ERROR - [bookkeeper-io-484-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf4095ff5, L:/127.0.0.1:40506]/127.0.0.1:40317, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40317
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,530 - ERROR - [bookkeeper-io-484-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x86f14849, L:/127.0.0.1:54416]/127.0.0.1:41603, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41603
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,530 - ERROR - [bookkeeper-io-484-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x7cbdc08d, L:/127.0.0.1:60310]/127.0.0.1:36815, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:36815
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:08,531 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:08,531 - INFO  - [SyncThread-477-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094284838 , logFileOffset - 2560]}.
2020-08-10 23:18:08,534 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:08,535 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:08,535 - INFO  - [BookieJournal-36815:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:08,535 - INFO  - [BookieJournal-36815:Journal@1144] - Journal exited loop!
2020-08-10 23:18:08,536 - INFO  - [Bookie-36815:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:08,536 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:08,539 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:08,539 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:08,539 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:08,542 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:36815
2020-08-10 23:18:08,642 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:08,642 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:08,643 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:08,643 - INFO  - [AuditorElector-127.0.0.1:36815:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:08,646 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41603, 127.0.0.1:36815, 127.0.0.1:40317], and searching its ledgers for re-replication
2020-08-10 23:18:08,648 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41603] are identified as underreplicated
2020-08-10 23:18:08,654 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:36815] are identified as underreplicated
2020-08-10 23:18:08,661 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:40317] are identified as underreplicated
2020-08-10 23:18:08,664 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:08,667 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:08,675 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41603, 127.0.0.1:36815, 127.0.0.1:40317], and searching its ledgers for re-replication
2020-08-10 23:18:08,676 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:41603] are identified as underreplicated
2020-08-10 23:18:08,679 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:36815] are identified as underreplicated
2020-08-10 23:18:08,681 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:40317] are identified as underreplicated
2020-08-10 23:18:08,684 - INFO  - [AuditorBookie-127.0.0.1:36815:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:08,688 - INFO  - [AutoRecoveryDeathWatcher-40317:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:08,689 - INFO  - [AutoRecoveryDeathWatcher-40317:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-40317
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:08,690 - INFO  - [AutoRecoveryDeathWatcher-40317:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:08,692 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:08,692 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:08,692 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:08,693 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:08,695 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:36815
2020-08-10 23:18:08,695 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40317
2020-08-10 23:18:08,695 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41603
2020-08-10 23:18:08,791 - INFO  - [BookieDeathWatcher-41603:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:08,792 - INFO  - [BookieDeathWatcher-41603:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41603
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:08,792 - INFO  - [BookieDeathWatcher-41603:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:08,792 - INFO  - [BookieDeathWatcher-41603:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:08,847 - INFO  - [BookieDeathWatcher-36815:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:08,847 - INFO  - [BookieDeathWatcher-36815:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-36815
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:08,847 - INFO  - [BookieDeathWatcher-36815:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:08,847 - INFO  - [BookieDeathWatcher-36815:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:08,910 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testOpenLedgers in 1045 ms.
2020-08-10 23:18:09,008 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:18:09,034 - INFO  - [AutoRecoveryDeathWatcher-41603:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:09,034 - INFO  - [AutoRecoveryDeathWatcher-41603:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-41603
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:09,034 - INFO  - [AutoRecoveryDeathWatcher-41603:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:09,111 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:18:09,127 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,132 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,135 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,137 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:09,138 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:09,138 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:09,138 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:09,142 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:09,142 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie8587357614607279839test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40371/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie8587357614607279839test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:09,144 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,147 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,147 - INFO  - [AutoRecoveryDeathWatcher-36815:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:09,147 - INFO  - [AutoRecoveryDeathWatcher-36815:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-36815
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:09,147 - INFO  - [AutoRecoveryDeathWatcher-36815:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:09,149 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:09,153 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8587357614607279839test/current] [/tmp/bookie8587357614607279839test/current]
2020-08-10 23:18:09,159 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:09,160 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8587357614607279839test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:09,161 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:09,161 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:09,161 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:09,162 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:09,162 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:09,162 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:09,168 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45637 to become writable
2020-08-10 23:18:09,169 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:09,169 - INFO  - [SyncThread-505-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:09,173 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:09,174 - INFO  - [BookieJournal-45637:Journal@909] - Starting journal on /tmp/bookie8587357614607279839test/current
2020-08-10 23:18:09,174 - INFO  - [BookieJournal-45637:JournalChannel@157] - Opening journal /tmp/bookie8587357614607279839test/current/173da3cdf17.txn
2020-08-10 23:18:09,174 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:09,182 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:09,432 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45637' has been created.
2020-08-10 23:18:09,435 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,438 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,440 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:09,440 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:09,440 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:09,440 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:09,441 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:09,465 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:09,466 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie1471966743317914267test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40371/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie1471966743317914267test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:09,468 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,471 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,473 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:09,475 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:09,477 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:18:09,478 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45637
2020-08-10 23:18:09,480 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1471966743317914267test/current] [/tmp/bookie1471966743317914267test/current]
2020-08-10 23:18:09,483 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:09,483 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:09,484 - WARN  - [AuditorElector-127.0.0.1:45637:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:18:09,485 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:18:09,485 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:09,485 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:09,485 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:09,486 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:09,487 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1471966743317914267test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:09,487 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:09,487 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:09,487 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:09,488 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:09,488 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:09,488 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:09,491 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:09,491 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:18:09,493 - INFO  - [AuditorBookie-127.0.0.1:45637:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,496 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:40757 to become writable
2020-08-10 23:18:09,497 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:09,498 - INFO  - [AuditorBookie-127.0.0.1:45637-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,498 - INFO  - [SyncThread-524-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:09,499 - ERROR - [AuditorBookie-127.0.0.1:45637:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:09,500 - INFO  - [AuditorBookie-127.0.0.1:45637:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:09,500 - INFO  - [AuditorBookie-127.0.0.1:45637:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:09,500 - INFO  - [AuditorBookie-127.0.0.1:45637:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:09,501 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:09,501 - INFO  - [BookieJournal-40757:Journal@909] - Starting journal on /tmp/bookie1471966743317914267test/current
2020-08-10 23:18:09,502 - INFO  - [BookieJournal-40757:JournalChannel@157] - Opening journal /tmp/bookie1471966743317914267test/current/173da3ce05f.txn
2020-08-10 23:18:09,502 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:09,504 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:09,508 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:09,512 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:09,512 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:09,620 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor$11@751] - Completed checkAllLedgers in 128 milliSeconds
2020-08-10 23:18:09,758 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:40757' has been created.
2020-08-10 23:18:09,760 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,764 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,766 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:09,766 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:09,766 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:09,766 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:09,768 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:09,768 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:09,777 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:09,778 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie5828218167770821998test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40371/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie5828218167770821998test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:09,780 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:09,783 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:09,785 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:09,789 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5828218167770821998test/current] [/tmp/bookie5828218167770821998test/current]
2020-08-10 23:18:09,794 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:09,795 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5828218167770821998test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:09,795 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:09,795 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:09,796 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:09,797 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:09,797 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:09,797 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:09,802 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41357 to become writable
2020-08-10 23:18:09,802 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:09,803 - INFO  - [SyncThread-546-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:09,806 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:09,808 - INFO  - [BookieJournal-41357:Journal@909] - Starting journal on /tmp/bookie5828218167770821998test/current
2020-08-10 23:18:09,809 - INFO  - [BookieJournal-41357:JournalChannel@157] - Opening journal /tmp/bookie5828218167770821998test/current/173da3ce192.txn
2020-08-10 23:18:09,809 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:09,814 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:09,814 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:09,814 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,063 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41357' has been created.
2020-08-10 23:18:10,066 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:10,069 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:10,070 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:10,070 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:10,070 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:10,070 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:10,072 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:10,072 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:10,072 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,086 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testStopWhileReplicationInProgress @ metadata service zk://localhost:40371/ledgers in 975 ms.
2020-08-10 23:18:10,087 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:10,093 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:10,096 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:41357, 127.0.0.1:40757, 127.0.0.1:45637] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:18:10,113 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:41357, 127.0.0.1:40757, 127.0.0.1:45637] for ledger: 0
2020-08-10 23:18:10,115 - INFO  - [bookkeeper-io-496-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xda5db73f, L:/127.0.0.1:34528 - R:127.0.0.1/127.0.0.1:41357]
2020-08-10 23:18:10,115 - INFO  - [bookkeeper-io-496-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:41357
2020-08-10 23:18:10,115 - INFO  - [bookie-io-541-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,115 - INFO  - [bookie-io-541-2:BookieRequestHandler@50] - Channel connected  [id: 0x204cb32f, L:/127.0.0.1:41357 - R:/127.0.0.1:34528]
2020-08-10 23:18:10,115 - INFO  - [bookkeeper-io-496-1:PerChannelBookieClient$1@471] - connection [id: 0xda5db73f, L:/127.0.0.1:34528 - R:127.0.0.1/127.0.0.1:41357] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,116 - INFO  - [bookkeeper-io-496-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x13eefbe2, L:/127.0.0.1:55094 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:10,116 - INFO  - [bookkeeper-io-496-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:10,117 - INFO  - [bookie-io-516-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,117 - INFO  - [bookie-io-516-2:BookieRequestHandler@50] - Channel connected  [id: 0x54d1a577, L:/127.0.0.1:40757 - R:/127.0.0.1:55094]
2020-08-10 23:18:10,117 - INFO  - [bookkeeper-io-496-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x359c530b, L:/127.0.0.1:49338 - R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:10,117 - INFO  - [bookkeeper-io-496-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45637
2020-08-10 23:18:10,117 - INFO  - [bookie-io-500-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,117 - INFO  - [bookkeeper-io-496-3:PerChannelBookieClient$1@471] - connection [id: 0x359c530b, L:/127.0.0.1:49338 - R:127.0.0.1/127.0.0.1:45637] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,117 - INFO  - [bookkeeper-io-496-2:PerChannelBookieClient$1@471] - connection [id: 0x13eefbe2, L:/127.0.0.1:55094 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,117 - INFO  - [bookie-io-500-2:BookieRequestHandler@50] - Channel connected  [id: 0x9afa6b3a, L:/127.0.0.1:45637 - R:/127.0.0.1:49338]
2020-08-10 23:18:10,157 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [127.0.0.1:40757, 127.0.0.1:41357, 127.0.0.1:45637] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:18:10,161 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:40757, 127.0.0.1:41357, 127.0.0.1:45637] for ledger: 1
2020-08-10 23:18:10,189 - INFO  - [Time-limited test:BookieAutoRecoveryTest@262] - Killing Bookie:127.0.0.1:41357
2020-08-10 23:18:10,190 - INFO  - [Time-limited test:BookieAutoRecoveryTest@277] - Killing Bookie :127.0.0.1:41357
2020-08-10 23:18:10,191 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:10,191 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:10,192 - WARN  - [bookkeeper-io-496-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xda5db73f, L:/127.0.0.1:34528 - R:127.0.0.1/127.0.0.1:41357] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:10,192 - INFO  - [bookkeeper-io-496-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xda5db73f, L:/127.0.0.1:34528 ! R:127.0.0.1/127.0.0.1:41357]
2020-08-10 23:18:10,192 - INFO  - [bookie-io-541-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x204cb32f, L:/127.0.0.1:41357 ! R:/127.0.0.1:34528]
2020-08-10 23:18:10,194 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41357 with exitCode 0
2020-08-10 23:18:10,194 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:10,194 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:10,195 - INFO  - [SyncThread-546-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:10,195 - INFO  - [SyncThread-546-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5828218167770821998test/current/0.log for logId 0.
2020-08-10 23:18:10,198 - INFO  - [pool-305-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie5828218167770821998test/current/1.log for logId 1.
2020-08-10 23:18:10,208 - INFO  - [SyncThread-546-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094289810 , logFileOffset - 5632]}.
2020-08-10 23:18:10,211 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:10,211 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:10,211 - INFO  - [BookieJournal-41357:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:10,212 - INFO  - [BookieJournal-41357:Journal@1144] - Journal exited loop!
2020-08-10 23:18:10,212 - INFO  - [Bookie-41357:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:10,212 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:10,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:10,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:10,212 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:10,212 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:10,213 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:10,214 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:10,215 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:10,215 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:10,218 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,218 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,218 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,323 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:10,323 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:10,323 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:10,324 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:10,323 - INFO  - [AuditorElector-127.0.0.1:41357:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:10,325 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:10,326 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:10,325 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41357
2020-08-10 23:18:10,330 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:10,338 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1114] - Following are the failed bookies: [127.0.0.1:41357], and searching its ledgers for re-replication
2020-08-10 23:18:10,338 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:41357] are identified as underreplicated
2020-08-10 23:18:10,362 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:18:10,371 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:18:10,371 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:10,377 - ERROR - [bookkeeper-io-537-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xb5ce9e64, L:/127.0.0.1:34534]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:10,377 - INFO  - [bookkeeper-io-537-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7b29ac52, L:/127.0.0.1:55100 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:10,378 - INFO  - [bookkeeper-io-537-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:10,378 - INFO  - [bookkeeper-io-537-2:PerChannelBookieClient$1@471] - connection [id: 0x7b29ac52, L:/127.0.0.1:55100 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,380 - INFO  - [bookie-io-516-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,380 - INFO  - [bookkeeper-io-537-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc23c1017, L:/127.0.0.1:49344 - R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:10,380 - INFO  - [bookkeeper-io-537-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45637
2020-08-10 23:18:10,380 - INFO  - [bookie-io-516-3:BookieRequestHandler@50] - Channel connected  [id: 0xc4043090, L:/127.0.0.1:40757 - R:/127.0.0.1:55100]
2020-08-10 23:18:10,380 - INFO  - [bookkeeper-io-537-3:PerChannelBookieClient$1@471] - connection [id: 0xc23c1017, L:/127.0.0.1:49344 - R:127.0.0.1/127.0.0.1:45637] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,382 - INFO  - [bookie-io-500-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,383 - INFO  - [bookie-io-500-3:BookieRequestHandler@50] - Channel connected  [id: 0x65d9f765, L:/127.0.0.1:45637 - R:/127.0.0.1:49344]
2020-08-10 23:18:10,384 - INFO  - [bookkeeper-io-512-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xea541bfd, L:/127.0.0.1:55104 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:10,384 - INFO  - [bookkeeper-io-512-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:10,384 - INFO  - [bookkeeper-io-512-1:PerChannelBookieClient$1@471] - connection [id: 0xea541bfd, L:/127.0.0.1:55104 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,388 - ERROR - [bookkeeper-io-512-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe26ea422, L:/127.0.0.1:34542]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:10,396 - INFO  - [bookie-io-516-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,396 - INFO  - [bookie-io-516-4:BookieRequestHandler@50] - Channel connected  [id: 0xa31c5a51, L:/127.0.0.1:40757 - R:/127.0.0.1:55104]
2020-08-10 23:18:10,396 - INFO  - [bookkeeper-io-512-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1c43f78d, L:/127.0.0.1:49350 - R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:10,399 - INFO  - [bookkeeper-io-512-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45637
2020-08-10 23:18:10,396 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:40757>, <Bookie:127.0.0.1:45637>].
2020-08-10 23:18:10,400 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:10,400 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>].
2020-08-10 23:18:10,400 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:10,402 - ERROR - [bookkeeper-io-537-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1e107de8, L:/127.0.0.1:34546]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:10,399 - INFO  - [bookie-io-500-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:10,404 - INFO  - [bookie-io-500-4:BookieRequestHandler@50] - Channel connected  [id: 0xd577aa10, L:/127.0.0.1:45637 - R:/127.0.0.1:49350]
2020-08-10 23:18:10,403 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:10,400 - INFO  - [bookkeeper-io-512-3:PerChannelBookieClient$1@471] - connection [id: 0x1c43f78d, L:/127.0.0.1:49350 - R:127.0.0.1/127.0.0.1:45637] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:10,407 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:40757>, <Bookie:127.0.0.1:45637>].
2020-08-10 23:18:10,407 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:10,407 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:41357>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>].
2020-08-10 23:18:10,408 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:10,409 - ERROR - [bookkeeper-io-512-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc5f6acdb, L:/127.0.0.1:34548]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:10,410 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 1 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:10,433 - INFO  - [Time-limited test:BookieAutoRecoveryTest@287] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0000/urL0000000000 to know the status of rereplication process
2020-08-10 23:18:10,434 - INFO  - [Time-limited test:BookieAutoRecoveryTest@287] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0001/urL0000000001 to know the status of rereplication process
2020-08-10 23:18:10,435 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:10,435 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie6292791514475688209test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:40371/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie6292791514475688209test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:10,437 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:10,441 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:10,443 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:10,450 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie6292791514475688209test/current] [/tmp/bookie6292791514475688209test/current]
2020-08-10 23:18:10,454 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:10,455 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie6292791514475688209test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:10,455 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:10,455 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:10,456 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:10,456 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:10,456 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:10,456 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:10,466 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:42141 to become writable
2020-08-10 23:18:10,467 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:10,468 - INFO  - [SyncThread-566-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:10,471 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:10,476 - INFO  - [BookieJournal-42141:Journal@909] - Starting journal on /tmp/bookie6292791514475688209test/current
2020-08-10 23:18:10,477 - INFO  - [BookieJournal-42141:JournalChannel@157] - Opening journal /tmp/bookie6292791514475688209test/current/173da3ce42e.txn
2020-08-10 23:18:10,479 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:10,484 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:10,484 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:10,485 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:10,736 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:42141' has been created.
2020-08-10 23:18:10,738 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:10,742 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:10,743 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:10,743 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:10,743 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:10,743 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:10,745 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:10,745 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:10,745 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:10,818 - INFO  - [BookieDeathWatcher-41357:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:10,819 - INFO  - [BookieDeathWatcher-41357:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41357
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:10,819 - INFO  - [BookieDeathWatcher-41357:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:10,819 - INFO  - [BookieDeathWatcher-41357:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:11,086 - INFO  - [AutoRecoveryDeathWatcher-41357:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:11,086 - INFO  - [AutoRecoveryDeathWatcher-41357:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-41357
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:11,086 - INFO  - [AutoRecoveryDeathWatcher-41357:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:19,796 - INFO  - [bookkeeper-io-573-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7f7d4a0a, L:/127.0.0.1:55122 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:19,796 - INFO  - [bookkeeper-io-573-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:19,797 - INFO  - [bookkeeper-io-573-1:PerChannelBookieClient$1@471] - connection [id: 0x7f7d4a0a, L:/127.0.0.1:55122 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:19,797 - INFO  - [bookkeeper-io-573-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xbb0bc059, L:/127.0.0.1:49368 - R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:19,797 - INFO  - [bookkeeper-io-573-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45637
2020-08-10 23:18:19,797 - INFO  - [bookkeeper-io-573-3:PerChannelBookieClient$1@471] - connection [id: 0xbb0bc059, L:/127.0.0.1:49368 - R:127.0.0.1/127.0.0.1:45637] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:19,797 - ERROR - [bookkeeper-io-573-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xacf67375, L:/127.0.0.1:34560]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:19,797 - INFO  - [bookie-io-500-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:19,797 - INFO  - [bookie-io-500-5:BookieRequestHandler@50] - Channel connected  [id: 0xd41b32b2, L:/127.0.0.1:45637 - R:/127.0.0.1:49368]
2020-08-10 23:18:19,802 - INFO  - [bookie-io-516-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:19,802 - INFO  - [bookie-io-516-5:BookieRequestHandler@50] - Channel connected  [id: 0x12fe12a0, L:/127.0.0.1:40757 - R:/127.0.0.1:55122]
2020-08-10 23:18:19,803 - ERROR - [bookkeeper-io-512-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x376638d9, L:/127.0.0.1:34564]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:19,803 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 4[4], Host: [127.0.0.1:41357], Closed: true) in 1 sub fragments.
2020-08-10 23:18:19,804 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 1, FirstEntryID: 0[0], LastKnownEntryID: 4[4], Host: [127.0.0.1:41357], Closed: true) in 1 sub fragments.
2020-08-10 23:18:19,808 - ERROR - [bookkeeper-io-573-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x75c276fc, L:/127.0.0.1:34566]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:19,809 - ERROR - [bookkeeper-io-512-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x0003e471, L:/127.0.0.1:34570]/127.0.0.1:41357, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:41357
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:19,810 - INFO  - [BookKeeperClientWorker-OrderedExecutor-1-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L1 E1 from bookie: 127.0.0.1:41357
2020-08-10 23:18:19,810 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E0 from bookie: 127.0.0.1:41357
2020-08-10 23:18:19,810 - INFO  - [bookie-io-561-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:19,812 - INFO  - [bookie-io-561-2:BookieRequestHandler@50] - Channel connected  [id: 0xfd06e3ec, L:/127.0.0.1:42141 - R:/127.0.0.1:37440]
2020-08-10 23:18:19,811 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E3 from bookie: 127.0.0.1:41357
2020-08-10 23:18:19,811 - INFO  - [BookKeeperClientWorker-OrderedExecutor-1-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L1 E4 from bookie: 127.0.0.1:41357
2020-08-10 23:18:19,816 - INFO  - [bookkeeper-io-573-5:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe87c5fa5, L:/127.0.0.1:37440 - R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:19,817 - INFO  - [bookkeeper-io-573-5:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42141
2020-08-10 23:18:19,817 - INFO  - [bookkeeper-io-573-5:PerChannelBookieClient$1@471] - connection [id: 0xe87c5fa5, L:/127.0.0.1:37440 - R:127.0.0.1/127.0.0.1:42141] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:19,817 - INFO  - [bookkeeper-io-512-7:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc3cab10f, L:/127.0.0.1:37444 - R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:19,817 - INFO  - [bookkeeper-io-512-7:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42141
2020-08-10 23:18:19,818 - INFO  - [bookkeeper-io-512-7:PerChannelBookieClient$1@471] - connection [id: 0xc3cab10f, L:/127.0.0.1:37444 - R:127.0.0.1/127.0.0.1:42141] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:19,819 - INFO  - [bookie-io-561-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:19,819 - INFO  - [bookie-io-561-3:BookieRequestHandler@50] - Channel connected  [id: 0xbcb5f4b7, L:/127.0.0.1:42141 - R:/127.0.0.1:37444]
2020-08-10 23:18:19,832 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:41357=127.0.0.1:42141}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:18:19,833 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:41357=127.0.0.1:42141}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:18:19,836 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 1
2020-08-10 23:18:19,838 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:18:19,840 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:18:19,841 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:18:20,767 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:20,768 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:20,768 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:20,768 - INFO  - [AuditorElector-127.0.0.1:45637:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:20,768 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:20,768 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:20,769 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:20,769 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:20,769 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:20,769 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:20,770 - INFO  - [bookkeeper-io-512-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1c43f78d, L:/127.0.0.1:49350 ! R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:20,770 - INFO  - [bookie-io-500-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xd577aa10, L:/127.0.0.1:45637 ! R:/127.0.0.1:49350]
2020-08-10 23:18:20,770 - INFO  - [bookie-io-516-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xa31c5a51, L:/127.0.0.1:40757 ! R:/127.0.0.1:55104]
2020-08-10 23:18:20,770 - INFO  - [bookkeeper-io-512-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xea541bfd, L:/127.0.0.1:55104 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:20,770 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42141
2020-08-10 23:18:20,770 - INFO  - [bookkeeper-io-512-7:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc3cab10f, L:/127.0.0.1:37444 ! R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:20,770 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41357
2020-08-10 23:18:20,771 - INFO  - [bookie-io-561-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xbcb5f4b7, L:/127.0.0.1:42141 ! R:/127.0.0.1:37444]
2020-08-10 23:18:20,784 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:20,786 - INFO  - [AuditorElector-127.0.0.1:40757:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:20,786 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:20,787 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:40757
2020-08-10 23:18:20,791 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:20,792 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:20,792 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094289512 durationSinceLastExecutionInSecs: 11 initialDelay: 604789 interval: 604800
2020-08-10 23:18:20,792 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:20,792 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:20,792 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:20,799 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:20,879 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:20,879 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:20,879 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:20,879 - INFO  - [AuditorElector-127.0.0.1:40757:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:20,879 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:20,879 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:20,879 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:20,880 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:20,880 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:20,880 - INFO  - [bookkeeper-io-537-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc23c1017, L:/127.0.0.1:49344 ! R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:20,880 - INFO  - [bookie-io-500-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x65d9f765, L:/127.0.0.1:45637 ! R:/127.0.0.1:49344]
2020-08-10 23:18:20,880 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:20,881 - INFO  - [bookkeeper-io-537-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7b29ac52, L:/127.0.0.1:55100 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:20,881 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41357
2020-08-10 23:18:20,881 - INFO  - [bookie-io-516-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xc4043090, L:/127.0.0.1:40757 ! R:/127.0.0.1:55100]
2020-08-10 23:18:20,988 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:20,988 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:20,988 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:20,988 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:20,988 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:20,989 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:20,989 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:20,990 - INFO  - [bookkeeper-io-573-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xbb0bc059, L:/127.0.0.1:49368 ! R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:20,990 - INFO  - [bookie-io-500-5:BookieRequestHandler@61] - Channels disconnected: [id: 0xd41b32b2, L:/127.0.0.1:45637 ! R:/127.0.0.1:49368]
2020-08-10 23:18:20,990 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:20,990 - INFO  - [bookkeeper-io-573-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7f7d4a0a, L:/127.0.0.1:55122 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:20,990 - INFO  - [bookie-io-516-5:BookieRequestHandler@61] - Channels disconnected: [id: 0x12fe12a0, L:/127.0.0.1:40757 ! R:/127.0.0.1:55122]
2020-08-10 23:18:20,990 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42141
2020-08-10 23:18:20,991 - INFO  - [bookkeeper-io-573-5:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe87c5fa5, L:/127.0.0.1:37440 ! R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:20,991 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41357
2020-08-10 23:18:20,991 - INFO  - [bookie-io-561-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xfd06e3ec, L:/127.0.0.1:42141 ! R:/127.0.0.1:37440]
2020-08-10 23:18:20,992 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:20,993 - ERROR - [AuditorElector-127.0.0.1:42141:ZkLedgerUnderreplicationManager@815] - Error while initializing LostBookieRecoveryDelay
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/lostBookieRecoveryDelay
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:1538)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$1901(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:711)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.create(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.initializeLostBookieRecoveryDelay(ZkLedgerUnderreplicationManager.java:808)
	at org.apache.bookkeeper.replication.Auditor.initialize(Auditor.java:470)
	at org.apache.bookkeeper.replication.Auditor.<init>(Auditor.java:443)
	at org.apache.bookkeeper.replication.Auditor.<init>(Auditor.java:307)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:314)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:20,993 - ERROR - [AuditorElector-127.0.0.1:42141:AuditorElector$3@338] - Ledger underreplication manager unavailable during election
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Error contacting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.initializeLostBookieRecoveryDelay(ZkLedgerUnderreplicationManager.java:816)
	at org.apache.bookkeeper.replication.Auditor.initialize(Auditor.java:470)
	at org.apache.bookkeeper.replication.Auditor.<init>(Auditor.java:443)
	at org.apache.bookkeeper.replication.Auditor.<init>(Auditor.java:307)
	at org.apache.bookkeeper.replication.AuditorElector$3.run(AuditorElector.java:314)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/lostBookieRecoveryDelay
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:1538)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$1901(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:711)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$9.call(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.create(ZooKeeperClient.java:705)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.initializeLostBookieRecoveryDelay(ZkLedgerUnderreplicationManager.java:808)
	... 9 more
2020-08-10 23:18:20,993 - INFO  - [AuditorElector-127.0.0.1:42141:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:20,993 - ERROR - [AuditorElector-127.0.0.1:42141:AuditorElector$2@269] - Exception while deleting myVote:/ledgers/underreplication/auditorelection/V_0000000003
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /ledgers/underreplication/auditorelection/V_0000000003
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:102)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.replication.AuditorElector$2.run(AuditorElector.java:263)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:21,096 - INFO  - [Time-limited test:BookieAutoRecoveryTest@304] - Latch Count is:0
2020-08-10 23:18:21,098 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:21,101 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:21,102 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:21,102 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:21,102 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:21,102 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:21,104 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,104 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:21,104 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:21,113 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:21,116 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:21,117 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:21,117 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:21,117 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:21,117 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:21,119 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,119 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:21,119 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:21,125 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:21,128 - INFO  - [AuditorElector-127.0.0.1:45637:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:21,128 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:21,128 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:45637
2020-08-10 23:18:21,133 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:21,133 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:21,134 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094289512 durationSinceLastExecutionInSecs: 11 initialDelay: 604789 interval: 604800
2020-08-10 23:18:21,134 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:21,134 - INFO  - [AuditorElector-127.0.0.1:45637:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:21,134 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,141 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40371/ledgers : zkServers = localhost:40371, ledgersRootPath = /ledgers.
2020-08-10 23:18:21,144 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:21,146 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:21,146 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:21,146 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:21,146 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:21,152 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,152 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:21,152 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:21,154 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,164 - INFO  - [Time-limited test:BookieAutoRecoveryTest@313] - Waiting to finish rereplication processes
2020-08-10 23:18:21,164 - INFO  - [Time-limited test:BookieAutoRecoveryTest@317] - Waiting to update the urledger metadata in zookeeper
2020-08-10 23:18:21,166 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:18:21,167 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:21,167 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:21,167 - INFO  - [bookie-io-500-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x9afa6b3a, L:/127.0.0.1:45637 ! R:/127.0.0.1:49338]
2020-08-10 23:18:21,167 - INFO  - [bookkeeper-io-496-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x13eefbe2, L:/127.0.0.1:55094 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,167 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:41357
2020-08-10 23:18:21,168 - INFO  - [bookie-io-516-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x54d1a577, L:/127.0.0.1:40757 ! R:/127.0.0.1:55094]
2020-08-10 23:18:21,167 - INFO  - [bookkeeper-io-496-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x359c530b, L:/127.0.0.1:49338 ! R:127.0.0.1/127.0.0.1:45637]
2020-08-10 23:18:21,277 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:21,277 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:21,282 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45637 with exitCode 0
2020-08-10 23:18:21,282 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:21,282 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:21,282 - INFO  - [SyncThread-505-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:21,283 - INFO  - [SyncThread-505-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8587357614607279839test/current/0.log for logId 0.
2020-08-10 23:18:21,285 - INFO  - [pool-282-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8587357614607279839test/current/1.log for logId 1.
2020-08-10 23:18:21,294 - INFO  - [SyncThread-505-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094289175 , logFileOffset - 5632]}.
2020-08-10 23:18:21,298 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:21,298 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:21,298 - INFO  - [BookieJournal-45637:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:21,298 - INFO  - [BookieJournal-45637:Journal@1144] - Journal exited loop!
2020-08-10 23:18:21,298 - INFO  - [Bookie-45637:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:21,299 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:21,301 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:21,302 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:21,302 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:21,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,405 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,406 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:21,406 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:21,406 - INFO  - [AuditorElector-127.0.0.1:45637:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:21,407 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:45637
2020-08-10 23:18:21,413 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,417 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:21,420 - INFO  - [AuditorElector-127.0.0.1:40757:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:21,420 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:21,421 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:40757
2020-08-10 23:18:21,423 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:21,424 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:21,424 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,424 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094289512 durationSinceLastExecutionInSecs: 11 initialDelay: 604789 interval: 604800
2020-08-10 23:18:21,424 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:21,424 - INFO  - [AuditorElector-127.0.0.1:40757:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:21,425 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45637], and searching its ledgers for re-replication
2020-08-10 23:18:21,426 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:45637] are identified as underreplicated
2020-08-10 23:18:21,445 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45637], and searching its ledgers for re-replication
2020-08-10 23:18:21,446 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:45637] are identified as underreplicated
2020-08-10 23:18:21,455 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,456 - INFO  - [bookkeeper-io-585-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x4d346e3f, L:/127.0.0.1:37452 - R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,456 - INFO  - [bookie-io-561-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,456 - INFO  - [bookie-io-561-4:BookieRequestHandler@50] - Channel connected  [id: 0x4fd66177, L:/127.0.0.1:42141 - R:/127.0.0.1:37452]
2020-08-10 23:18:21,456 - INFO  - [bookkeeper-io-585-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42141
2020-08-10 23:18:21,456 - INFO  - [bookkeeper-io-585-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5dd98768, L:/127.0.0.1:55146 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,457 - INFO  - [bookkeeper-io-585-1:PerChannelBookieClient$1@471] - connection [id: 0x4d346e3f, L:/127.0.0.1:37452 - R:127.0.0.1/127.0.0.1:42141] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,457 - INFO  - [bookie-io-516-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,457 - INFO  - [bookkeeper-io-585-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:21,458 - INFO  - [bookkeeper-io-585-2:PerChannelBookieClient$1@471] - connection [id: 0x5dd98768, L:/127.0.0.1:55146 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,458 - INFO  - [bookie-io-516-6:BookieRequestHandler@50] - Channel connected  [id: 0x93ca3d76, L:/127.0.0.1:40757 - R:/127.0.0.1:55146]
2020-08-10 23:18:21,459 - ERROR - [bookkeeper-io-585-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9db28076, L:/127.0.0.1:49390]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,461 - INFO  - [AuditorBookie-127.0.0.1:45637:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,462 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:21,462 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:21,466 - INFO  - [ReplicationWorker:ReplicationWorker@240] - InterruptedException while replicating fragments
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.replication.ReplicationWorker$CheckerCallback.waitAndGetResult(ReplicationWorker.java:676)
	at org.apache.bookkeeper.replication.ReplicationWorker.getUnderreplicatedFragments(ReplicationWorker.java:493)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:366)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:21,467 - INFO  - [ReplicationWorker:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:21,469 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:21,469 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:21,469 - INFO  - [bookkeeper-io-585-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5dd98768, L:/127.0.0.1:55146 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,469 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42141
2020-08-10 23:18:21,470 - INFO  - [bookkeeper-io-594-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xf843b91c, L:/127.0.0.1:37460 - R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,470 - INFO  - [bookkeeper-io-594-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42141
2020-08-10 23:18:21,471 - INFO  - [bookkeeper-io-594-2:PerChannelBookieClient$1@471] - connection [id: 0xf843b91c, L:/127.0.0.1:37460 - R:127.0.0.1/127.0.0.1:42141] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,470 - ERROR - [bookkeeper-io-594-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x02a03cb1, L:/127.0.0.1:49396]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,470 - INFO  - [bookkeeper-io-594-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8d716ea1, L:/127.0.0.1:55150 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,470 - INFO  - [bookie-io-561-4:BookieRequestHandler@61] - Channels disconnected: [id: 0x4fd66177, L:/127.0.0.1:42141 ! R:/127.0.0.1:37452]
2020-08-10 23:18:21,474 - INFO  - [bookie-io-516-7:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,475 - INFO  - [bookie-io-516-7:BookieRequestHandler@50] - Channel connected  [id: 0x83302d06, L:/127.0.0.1:40757 - R:/127.0.0.1:55150]
2020-08-10 23:18:21,470 - INFO  - [bookkeeper-io-585-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x4d346e3f, L:/127.0.0.1:37452 ! R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,470 - INFO  - [bookie-io-516-6:BookieRequestHandler@61] - Channels disconnected: [id: 0x93ca3d76, L:/127.0.0.1:40757 ! R:/127.0.0.1:55146]
2020-08-10 23:18:21,475 - INFO  - [bookkeeper-io-594-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:21,476 - INFO  - [bookkeeper-io-594-1:PerChannelBookieClient$1@471] - connection [id: 0x8d716ea1, L:/127.0.0.1:55150 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,476 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:21,476 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45637
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:21,476 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,477 - INFO  - [bookie-io-561-5:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,477 - INFO  - [bookie-io-561-5:BookieRequestHandler@50] - Channel connected  [id: 0xddcbe477, L:/127.0.0.1:42141 - R:/127.0.0.1:37460]
2020-08-10 23:18:21,481 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:40757>].
2020-08-10 23:18:21,481 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:21,481 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:40757>, <Bookie:127.0.0.1:42141>].
2020-08-10 23:18:21,481 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:21,490 - ERROR - [bookkeeper-io-594-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xa7e20dc2, L:/127.0.0.1:49398]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,490 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 1 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:21,501 - INFO  - [bookkeeper-io-600-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5ec3ec55, L:/127.0.0.1:37466 - R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,501 - INFO  - [bookkeeper-io-600-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:42141
2020-08-10 23:18:21,501 - INFO  - [bookkeeper-io-600-1:PerChannelBookieClient$1@471] - connection [id: 0x5ec3ec55, L:/127.0.0.1:37466 - R:127.0.0.1/127.0.0.1:42141] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,502 - INFO  - [bookie-io-561-6:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,502 - INFO  - [bookie-io-561-6:BookieRequestHandler@50] - Channel connected  [id: 0xfed5b56c, L:/127.0.0.1:42141 - R:/127.0.0.1:37466]
2020-08-10 23:18:21,502 - INFO  - [bookie-io-516-8:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:21,502 - INFO  - [bookie-io-516-8:BookieRequestHandler@50] - Channel connected  [id: 0x6a89d15d, L:/127.0.0.1:40757 - R:/127.0.0.1:55160]
2020-08-10 23:18:21,501 - INFO  - [bookkeeper-io-600-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x3c119071, L:/127.0.0.1:55160 - R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,503 - INFO  - [bookkeeper-io-600-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:40757
2020-08-10 23:18:21,503 - INFO  - [bookkeeper-io-600-2:PerChannelBookieClient$1@471] - connection [id: 0x3c119071, L:/127.0.0.1:55160 - R:127.0.0.1/127.0.0.1:40757] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:21,503 - ERROR - [bookkeeper-io-600-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf849d8b9, L:/127.0.0.1:49404]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,505 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:40757>].
2020-08-10 23:18:21,505 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:21,505 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:40757>].
2020-08-10 23:18:21,505 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:21,507 - ERROR - [bookkeeper-io-600-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x906cfe83, L:/127.0.0.1:49406]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,507 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:21,611 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:21,611 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:21,611 - INFO  - [bookie-io-516-8:BookieRequestHandler@61] - Channels disconnected: [id: 0x6a89d15d, L:/127.0.0.1:40757 ! R:/127.0.0.1:55160]
2020-08-10 23:18:21,612 - WARN  - [bookkeeper-io-600-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x3c119071, L:/127.0.0.1:55160 - R:127.0.0.1/127.0.0.1:40757] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:21,612 - WARN  - [bookkeeper-io-594-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x8d716ea1, L:/127.0.0.1:55150 - R:127.0.0.1/127.0.0.1:40757] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:21,611 - INFO  - [bookie-io-516-7:BookieRequestHandler@61] - Channels disconnected: [id: 0x83302d06, L:/127.0.0.1:40757 ! R:/127.0.0.1:55150]
2020-08-10 23:18:21,612 - INFO  - [bookkeeper-io-594-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8d716ea1, L:/127.0.0.1:55150 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,612 - INFO  - [bookkeeper-io-600-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x3c119071, L:/127.0.0.1:55160 ! R:127.0.0.1/127.0.0.1:40757]
2020-08-10 23:18:21,613 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40757 with exitCode 0
2020-08-10 23:18:21,613 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:21,613 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:21,613 - INFO  - [SyncThread-524-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:21,614 - INFO  - [SyncThread-524-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1471966743317914267test/current/0.log for logId 0.
2020-08-10 23:18:21,616 - INFO  - [pool-292-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1471966743317914267test/current/1.log for logId 1.
2020-08-10 23:18:21,633 - INFO  - [SyncThread-524-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094289503 , logFileOffset - 5632]}.
2020-08-10 23:18:21,637 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:21,637 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:21,637 - INFO  - [BookieJournal-40757:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:21,637 - INFO  - [BookieJournal-40757:Journal@1144] - Journal exited loop!
2020-08-10 23:18:21,637 - INFO  - [Bookie-40757:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:21,637 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:21,638 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:21,638 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:21,638 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:21,638 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:21,638 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:21,640 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:21,640 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:21,640 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:21,643 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:21,643 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:40757
2020-08-10 23:18:21,645 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,650 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45637, 127.0.0.1:40757], and searching its ledgers for re-replication
2020-08-10 23:18:21,650 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:45637] are identified as underreplicated
2020-08-10 23:18:21,655 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:40757] are identified as underreplicated
2020-08-10 23:18:21,662 - INFO  - [AuditorBookie-127.0.0.1:40757:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,743 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,744 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:21,744 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:21,744 - INFO  - [AuditorElector-127.0.0.1:40757:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:21,744 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:21,744 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:21,747 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:21,748 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:21,750 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:21,750 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:21,750 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42141
2020-08-10 23:18:21,751 - INFO  - [bookkeeper-io-594-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xf843b91c, L:/127.0.0.1:37460 ! R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,751 - INFO  - [bookie-io-561-5:BookieRequestHandler@61] - Channels disconnected: [id: 0xddcbe477, L:/127.0.0.1:42141 ! R:/127.0.0.1:37460]
2020-08-10 23:18:21,758 - ERROR - [bookkeeper-io-600-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x8893eb4b, L:/127.0.0.1:55166]/127.0.0.1:40757, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40757
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,759 - ERROR - [bookkeeper-io-600-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xf7c4c8da, L:/127.0.0.1:49410]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,759 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:42141>].
2020-08-10 23:18:21,759 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:21,759 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:127.0.0.1:42141>, <Bookie:127.0.0.1:45637>, <Bookie:127.0.0.1:40757>], allBookies [<Bookie:127.0.0.1:42141>].
2020-08-10 23:18:21,760 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:21,760 - ERROR - [bookkeeper-io-600-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xdf1dd3a7, L:/127.0.0.1:55170]/127.0.0.1:40757, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:40757
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,761 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:21,761 - ERROR - [bookkeeper-io-600-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x528e7ec0, L:/127.0.0.1:49414]/127.0.0.1:45637, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:45637
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:21,765 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 1 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:21,767 - INFO  - [AuditorElector-127.0.0.1:42141:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:21,767 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:21,767 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:21,767 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:42141
2020-08-10 23:18:21,768 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-42141
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:21,768 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,770 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:21,771 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:21,771 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094289512 durationSinceLastExecutionInSecs: 12 initialDelay: 604788 interval: 604800
2020-08-10 23:18:21,771 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:21,771 - INFO  - [AuditorElector-127.0.0.1:42141:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:21,771 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,778 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1114] - Following are the failed bookies: [127.0.0.1:45637, 127.0.0.1:40757], and searching its ledgers for re-replication
2020-08-10 23:18:21,779 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:45637] are identified as underreplicated
2020-08-10 23:18:21,784 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:40757] are identified as underreplicated
2020-08-10 23:18:21,789 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,794 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:21,794 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-40757
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:21,794 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,859 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:21,860 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:21,860 - WARN  - [bookkeeper-io-600-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x5ec3ec55, L:/127.0.0.1:37466 - R:127.0.0.1/127.0.0.1:42141] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:21,860 - INFO  - [bookie-io-561-6:BookieRequestHandler@61] - Channels disconnected: [id: 0xfed5b56c, L:/127.0.0.1:42141 ! R:/127.0.0.1:37466]
2020-08-10 23:18:21,860 - INFO  - [bookkeeper-io-600-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5ec3ec55, L:/127.0.0.1:37466 ! R:127.0.0.1/127.0.0.1:42141]
2020-08-10 23:18:21,862 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42141 with exitCode 0
2020-08-10 23:18:21,862 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:21,862 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:21,863 - INFO  - [SyncThread-566-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:21,863 - INFO  - [SyncThread-566-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie6292791514475688209test/current/0.log for logId 0.
2020-08-10 23:18:21,864 - INFO  - [pool-317-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie6292791514475688209test/current/1.log for logId 1.
2020-08-10 23:18:21,883 - INFO  - [SyncThread-566-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094290478 , logFileOffset - 2048]}.
2020-08-10 23:18:21,886 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:21,886 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:21,886 - INFO  - [BookieJournal-42141:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:21,886 - INFO  - [BookieJournal-42141:Journal@1144] - Journal exited loop!
2020-08-10 23:18:21,887 - INFO  - [Bookie-42141:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:21,887 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:21,889 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:21,889 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:21,889 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:21,894 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:42141
2020-08-10 23:18:21,897 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:21,909 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1114] - Following are the failed bookies: [127.0.0.1:42141, 127.0.0.1:45637, 127.0.0.1:40757], and searching its ledgers for re-replication
2020-08-10 23:18:21,910 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:42141] are identified as underreplicated
2020-08-10 23:18:21,921 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:45637] are identified as underreplicated
2020-08-10 23:18:21,926 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0, 1] of bookie: [127.0.0.1:40757] are identified as underreplicated
2020-08-10 23:18:21,932 - INFO  - [AuditorBookie-127.0.0.1:42141:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:21,993 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:21,993 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:21,993 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:21,993 - INFO  - [AuditorElector-127.0.0.1:42141:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:21,993 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:21,993 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:21,994 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:21,997 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:22,003 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45637
2020-08-10 23:18:22,003 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:40757
2020-08-10 23:18:22,004 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:42141
2020-08-10 23:18:22,110 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:22,110 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-45637
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:22,111 - INFO  - [AutoRecoveryDeathWatcher-45637:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:22,137 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:22,137 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-40757
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:22,137 - INFO  - [AutoRecoveryDeathWatcher-40757:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:22,170 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:22,170 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-42141
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:22,170 - INFO  - [AutoRecoveryDeathWatcher-42141:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:22,197 - INFO  - [BookieDeathWatcher-45637:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:22,197 - INFO  - [BookieDeathWatcher-45637:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45637
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:22,197 - INFO  - [BookieDeathWatcher-45637:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:22,197 - INFO  - [BookieDeathWatcher-45637:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:22,223 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testStopWhileReplicationInProgress in 1056 ms.
2020-08-10 23:18:22,320 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@134] - ZooKeeper client is disconnected from zookeeper now, but it is OK unless we received EXPIRED event.
2020-08-10 23:18:22,427 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.replication.BookieAutoRecoveryTest
2020-08-10 23:18:22,442 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,446 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:22,450 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,452 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:22,452 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:22,452 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:22,452 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:22,456 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:22,457 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie2204600953339235936test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie2204600953339235936test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:22,459 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:22,462 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,464 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:22,469 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie2204600953339235936test/current] [/tmp/bookie2204600953339235936test/current]
2020-08-10 23:18:22,475 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:22,476 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2204600953339235936test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:22,476 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:22,476 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:22,477 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:22,478 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:22,478 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:22,478 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:22,499 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:41589 to become writable
2020-08-10 23:18:22,503 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:22,504 - INFO  - [BookieDeathWatcher-42141:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:22,504 - INFO  - [SyncThread-621-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:22,504 - INFO  - [BookieDeathWatcher-42141:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-42141
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:22,504 - INFO  - [BookieDeathWatcher-42141:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:22,504 - INFO  - [BookieDeathWatcher-42141:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:22,508 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:22,514 - INFO  - [BookieJournal-41589:Journal@909] - Starting journal on /tmp/bookie2204600953339235936test/current
2020-08-10 23:18:22,515 - INFO  - [BookieJournal-41589:JournalChannel@157] - Opening journal /tmp/bookie2204600953339235936test/current/173da3d1334.txn
2020-08-10 23:18:22,515 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:22,517 - INFO  - [BookieDeathWatcher-40757:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:22,517 - INFO  - [BookieDeathWatcher-40757:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40757
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:22,517 - INFO  - [BookieDeathWatcher-40757:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:22,517 - INFO  - [BookieDeathWatcher-40757:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:22,521 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:22,771 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:41589' has been created.
2020-08-10 23:18:22,773 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:22,776 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,777 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:22,777 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:22,777 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:22,777 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:22,780 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:22,797 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:22,797 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie6061887637692556485test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie6061887637692556485test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:22,799 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:22,803 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,806 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:22,807 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:22,810 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@471] - Initializing lostBookieRecoveryDelay zNode to the conif value: 0
2020-08-10 23:18:22,810 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:41589
2020-08-10 23:18:22,814 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie6061887637692556485test/current] [/tmp/bookie6061887637692556485test/current]
2020-08-10 23:18:22,814 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:22,814 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:22,815 - WARN  - [AuditorElector-127.0.0.1:41589:ZkLedgerUnderreplicationManager@945] - checkAllLedgersCtimeZnode is not yet available
2020-08-10 23:18:22,815 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: -1 durationSinceLastExecutionInSecs: -1 initialDelay: 0 interval: 604800
2020-08-10 23:18:22,815 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:22,815 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:22,815 - INFO  - [AuditorElector-127.0.0.1:41589:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:22,822 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:22,824 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie6061887637692556485test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:22,824 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:22,824 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:22,824 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:22,825 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:22,825 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:22,825 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:22,826 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:22,827 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor$11@748] - Starting checkAllLedgers
2020-08-10 23:18:22,830 - INFO  - [AuditorBookie-127.0.0.1:41589:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:22,837 - INFO  - [AuditorBookie-127.0.0.1:41589-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:22,838 - ERROR - [AuditorBookie-127.0.0.1:41589:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:22,839 - INFO  - [AuditorBookie-127.0.0.1:41589:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:22,839 - INFO  - [AuditorBookie-127.0.0.1:41589:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:22,839 - INFO  - [AuditorBookie-127.0.0.1:41589:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:22,840 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:43415 to become writable
2020-08-10 23:18:22,840 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:22,844 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:22,845 - INFO  - [SyncThread-640-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:22,849 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:22,853 - INFO  - [BookieJournal-43415:Journal@909] - Starting journal on /tmp/bookie6061887637692556485test/current
2020-08-10 23:18:22,854 - INFO  - [BookieJournal-43415:JournalChannel@157] - Opening journal /tmp/bookie6061887637692556485test/current/173da3d1487.txn
2020-08-10 23:18:22,856 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:22,857 - WARN  - [AuditorBookie-127.0.0.1:41589-EventThread:ZKRegistrationClient$WatchTask@115] - Failed to schedule watch bookies task
java.util.concurrent.RejectedExecutionException: Task java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask@77b1fd0b[Not completed, task = java.util.concurrent.Executors$RunnableAdapter@384b0e49[Wrapped task = com.google.common.util.concurrent.TrustedListenableFutureTask@368cf730 (delegate = java.util.concurrent.Executors$RunnableAdapter@32b36539[Wrapped task = org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask@7a2f8619])]] rejected from java.util.concurrent.ScheduledThreadPoolExecutor@17e89cf2[Terminated, pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 5]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2055)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:825)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.delayedExecute(ScheduledThreadPoolExecutor.java:340)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor.schedule(ScheduledThreadPoolExecutor.java:562)
	at com.google.common.util.concurrent.MoreExecutors$ScheduledListeningDecorator.schedule(MoreExecutors.java:512)
	at org.apache.bookkeeper.common.util.BoundedScheduledExecutorService.schedule(BoundedScheduledExecutorService.java:63)
	at org.apache.bookkeeper.common.util.OrderedScheduler$OrderedSchedulerDecoratedThread.schedule(OrderedScheduler.java:317)
	at org.apache.bookkeeper.common.util.OrderedScheduler.schedule(OrderedScheduler.java:273)
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.scheduleWatchTask(ZKRegistrationClient.java:113)
	at org.apache.bookkeeper.discover.ZKRegistrationClient$WatchTask.process(ZKRegistrationClient.java:161)
	at org.apache.zookeeper.ClientCnxn$EventThread.processEvent(ClientCnxn.java:535)
	at org.apache.zookeeper.ClientCnxn$EventThread.run(ClientCnxn.java:510)
2020-08-10 23:18:22,861 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:22,861 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:22,962 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor$11@751] - Completed checkAllLedgers in 134 milliSeconds
2020-08-10 23:18:23,108 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:43415' has been created.
2020-08-10 23:18:23,110 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:23,114 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:23,115 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:23,115 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:23,115 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:23,115 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:23,117 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:23,117 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:23,126 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:18:23,126 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie17966710765291517137test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie17966710765291517137test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:23,129 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:23,132 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:23,134 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:23,138 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17966710765291517137test/current] [/tmp/bookie17966710765291517137test/current]
2020-08-10 23:18:23,143 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:23,144 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17966710765291517137test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:23,144 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:23,144 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:23,144 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:23,145 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:23,145 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:23,145 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:23,153 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37087 to become writable
2020-08-10 23:18:23,154 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:23,155 - INFO  - [SyncThread-662-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:23,159 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:23,160 - INFO  - [BookieJournal-37087:Journal@909] - Starting journal on /tmp/bookie17966710765291517137test/current
2020-08-10 23:18:23,161 - INFO  - [BookieJournal-37087:JournalChannel@157] - Opening journal /tmp/bookie17966710765291517137test/current/173da3d15ba.txn
2020-08-10 23:18:23,161 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:23,165 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37087
2020-08-10 23:18:23,165 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37087
2020-08-10 23:18:23,166 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37087
2020-08-10 23:18:23,416 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37087' has been created.
2020-08-10 23:18:23,418 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:23,421 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:23,423 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:23,423 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:23,423 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:23,423 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:23,425 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:23,425 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:23,425 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37087
2020-08-10 23:18:23,444 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testLedgerMetadataContainsHostNameAsBookieID @ metadata service zk://localhost:43525/ledgers in 1016 ms.
2020-08-10 23:18:23,445 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:23,448 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:23,555 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:23,555 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:23,558 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-41589 with exitCode 0
2020-08-10 23:18:23,558 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:23,558 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:23,558 - INFO  - [SyncThread-621-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:23,561 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:23,562 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:23,562 - INFO  - [BookieJournal-41589:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:23,562 - INFO  - [BookieJournal-41589:Journal@1144] - Journal exited loop!
2020-08-10 23:18:23,562 - INFO  - [Bookie-41589:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:23,562 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:23,562 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:23,563 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:23,567 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:23,567 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:23,567 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:41589
2020-08-10 23:18:23,570 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:23,574 - INFO  - [AuditorBookie-127.0.0.1:41589:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:23,671 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:23,672 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:23,672 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:23,672 - INFO  - [AuditorElector-127.0.0.1:41589:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:23,672 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:23,672 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:23,672 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:23,674 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:23,683 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:23,685 - INFO  - [AuditorElector-127.0.0.1:43415:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:23,685 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:23,686 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:43415
2020-08-10 23:18:23,688 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:23,689 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:23,689 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094302848 durationSinceLastExecutionInSecs: 0 initialDelay: 604800 interval: 604800
2020-08-10 23:18:23,689 - INFO  - [AuditorBookie-127.0.0.1:43415:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:23,689 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:23,689 - INFO  - [AuditorElector-127.0.0.1:43415:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:23,694 - INFO  - [AuditorBookie-127.0.0.1:43415:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:23,782 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:23,782 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:23,784 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43415 with exitCode 0
2020-08-10 23:18:23,784 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:23,784 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:23,784 - INFO  - [SyncThread-640-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:23,788 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:23,788 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:23,788 - INFO  - [BookieJournal-43415:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:23,788 - INFO  - [BookieJournal-43415:Journal@1144] - Journal exited loop!
2020-08-10 23:18:23,789 - INFO  - [Bookie-43415:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:23,789 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:23,794 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:23,794 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43415
2020-08-10 23:18:23,797 - INFO  - [AuditorBookie-127.0.0.1:43415:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:23,797 - INFO  - [AutoRecoveryDeathWatcher-41589:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:23,797 - INFO  - [AutoRecoveryDeathWatcher-41589:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-41589
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:23,797 - INFO  - [AutoRecoveryDeathWatcher-41589:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:23,800 - INFO  - [AuditorBookie-127.0.0.1:43415:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:23,898 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:23,898 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:23,898 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:23,898 - INFO  - [AuditorElector-127.0.0.1:43415:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:23,898 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:23,898 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:23,898 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:23,901 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:23,919 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:23,922 - INFO  - [AuditorElector-127.0.0.1:37087:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:23,922 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:23,923 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:37087
2020-08-10 23:18:23,926 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:23,926 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:23,927 - INFO  - [AuditorBookie-127.0.0.1:37087:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:23,928 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094302848 durationSinceLastExecutionInSecs: 1 initialDelay: 604799 interval: 604800
2020-08-10 23:18:23,928 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:23,928 - INFO  - [AuditorElector-127.0.0.1:37087:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:23,937 - INFO  - [AuditorBookie-127.0.0.1:37087:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:24,019 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:24,019 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:24,022 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37087 with exitCode 0
2020-08-10 23:18:24,022 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:24,022 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:24,022 - INFO  - [SyncThread-662-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:24,025 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:24,025 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:24,026 - INFO  - [BookieJournal-37087:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:24,026 - INFO  - [BookieJournal-37087:Journal@1144] - Journal exited loop!
2020-08-10 23:18:24,026 - INFO  - [Bookie-37087:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:24,026 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:24,026 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:24,027 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:24,030 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37087
2020-08-10 23:18:24,034 - INFO  - [AuditorBookie-127.0.0.1:37087:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:24,037 - INFO  - [AuditorBookie-127.0.0.1:37087:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:24,125 - INFO  - [AutoRecoveryDeathWatcher-43415:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:24,125 - INFO  - [AutoRecoveryDeathWatcher-43415:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-43415
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:24,125 - INFO  - [AutoRecoveryDeathWatcher-43415:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:24,131 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:24,132 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:24,132 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:24,132 - INFO  - [AuditorElector-127.0.0.1:37087:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:24,132 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:24,132 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:24,134 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:24,134 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:24,169 - INFO  - [BookieDeathWatcher-37087:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:24,169 - INFO  - [BookieDeathWatcher-37087:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37087
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:24,169 - INFO  - [BookieDeathWatcher-37087:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:24,170 - INFO  - [BookieDeathWatcher-37087:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:24,243 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,247 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,248 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:24,248 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:24,248 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:24,248 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:24,251 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie13001399327272243261test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie13001399327272243261test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:24,256 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,259 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,261 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:24,269 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie13001399327272243261test/current] [/tmp/bookie13001399327272243261test/current]
2020-08-10 23:18:24,275 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:24,276 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie13001399327272243261test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:24,276 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:24,276 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:24,276 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:24,277 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:24,277 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:24,277 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:24,284 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:43869 to become writable
2020-08-10 23:18:24,285 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:24,288 - INFO  - [SyncThread-694-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:24,292 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:24,293 - INFO  - [BookieJournal-43869:Journal@909] - Starting journal on /tmp/bookie13001399327272243261test/current
2020-08-10 23:18:24,293 - INFO  - [BookieJournal-43869:JournalChannel@157] - Opening journal /tmp/bookie13001399327272243261test/current/173da3d1a26.txn
2020-08-10 23:18:24,295 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:24,299 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:24,447 - INFO  - [AutoRecoveryDeathWatcher-37087:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:24,447 - INFO  - [AutoRecoveryDeathWatcher-37087:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-37087
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:24,447 - INFO  - [AutoRecoveryDeathWatcher-37087:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:24,526 - INFO  - [BookieDeathWatcher-41589:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:24,526 - INFO  - [BookieDeathWatcher-41589:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-41589
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:24,526 - INFO  - [BookieDeathWatcher-41589:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:24,526 - INFO  - [BookieDeathWatcher-41589:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:24,551 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:43869' has been created.
2020-08-10 23:18:24,553 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,557 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,558 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:24,558 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:24,558 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:24,558 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:24,560 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:24,572 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie10351763955510431802test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie10351763955510431802test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "true",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:24,577 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,580 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,581 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:24,584 - INFO  - [AuditorElector-127.0.0.1:43869:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:24,584 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:24,585 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:24,586 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@660] - I'm starting as Auditor Bookie. ID: 127.0.0.1:43869
2020-08-10 23:18:24,590 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:24,590 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie10351763955510431802test/current] [/tmp/bookie10351763955510431802test/current]
2020-08-10 23:18:24,591 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:24,592 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094302848 durationSinceLastExecutionInSecs: 1 initialDelay: 604799 interval: 604800
2020-08-10 23:18:24,592 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:24,592 - INFO  - [AuditorElector-127.0.0.1:43869:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:24,593 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:24,596 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:24,597 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie10351763955510431802test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:24,597 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:24,598 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:24,598 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:24,598 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:24,598 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:24,598 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:24,600 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:24,609 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for localhost:46113 to become writable
2020-08-10 23:18:24,609 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:24,610 - INFO  - [SyncThread-713-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:24,613 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:24,615 - INFO  - [BookieJournal-46113:Journal@909] - Starting journal on /tmp/bookie10351763955510431802test/current
2020-08-10 23:18:24,616 - INFO  - [BookieJournal-46113:JournalChannel@157] - Opening journal /tmp/bookie10351763955510431802test/current/173da3d1b69.txn
2020-08-10 23:18:24,616 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:24,621 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:24,622 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:24,872 - INFO  - [BookieDeathWatcher-43415:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:24,872 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie 'localhost:46113' has been created.
2020-08-10 23:18:24,872 - INFO  - [BookieDeathWatcher-43415:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43415
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:24,873 - INFO  - [BookieDeathWatcher-43415:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:24,873 - INFO  - [BookieDeathWatcher-43415:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:24,876 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,879 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,881 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:24,881 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:24,881 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:24,881 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:24,883 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:24,884 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:24,901 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie8726772827487777203test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie8726772827487777203test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "true",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:24,905 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:24,908 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:24,914 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:24,919 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8726772827487777203test/current] [/tmp/bookie8726772827487777203test/current]
2020-08-10 23:18:24,928 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:24,929 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8726772827487777203test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:24,929 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:24,929 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:24,930 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:24,930 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:24,930 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:24,930 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:24,941 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for localhost:42331 to become writable
2020-08-10 23:18:24,942 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:24,942 - INFO  - [SyncThread-729-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:24,946 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:24,947 - INFO  - [BookieJournal-42331:Journal@909] - Starting journal on /tmp/bookie8726772827487777203test/current
2020-08-10 23:18:24,947 - INFO  - [BookieJournal-42331:JournalChannel@157] - Opening journal /tmp/bookie8726772827487777203test/current/173da3d1cb4.txn
2020-08-10 23:18:24,948 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:24,954 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:24,954 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:24,954 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:25,206 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie 'localhost:42331' has been created.
2020-08-10 23:18:25,208 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:25,212 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:25,213 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:25,213 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:25,213 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:25,213 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:25,215 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:25,215 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:25,215 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:25,223 - WARN  - [Time-limited test:BookieWatcherImpl@251] - New ensemble: [localhost:42331, localhost:46113, 127.0.0.1:43869] is not adhering to Placement Policy. quarantinedBookies: []
2020-08-10 23:18:25,241 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [localhost:42331, localhost:46113, 127.0.0.1:43869] for ledger: 0
2020-08-10 23:18:25,242 - INFO  - [bookkeeper-io-685-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x4b02c6ba, L:/127.0.0.1:45084 - R:localhost/127.0.0.1:42331]
2020-08-10 23:18:25,243 - INFO  - [bookkeeper-io-685-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:42331
2020-08-10 23:18:25,243 - INFO  - [bookkeeper-io-685-1:PerChannelBookieClient$1@471] - connection [id: 0x4b02c6ba, L:/127.0.0.1:45084 - R:localhost/127.0.0.1:42331] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:25,243 - INFO  - [bookkeeper-io-685-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x78fe5c1c, L:/127.0.0.1:48020 - R:localhost/127.0.0.1:46113]
2020-08-10 23:18:25,243 - INFO  - [bookkeeper-io-685-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:46113
2020-08-10 23:18:25,243 - INFO  - [bookkeeper-io-685-2:PerChannelBookieClient$1@471] - connection [id: 0x78fe5c1c, L:/127.0.0.1:48020 - R:localhost/127.0.0.1:46113] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:25,244 - INFO  - [bookkeeper-io-685-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xb0edf047, L:/127.0.0.1:37686 - R:127.0.0.1/127.0.0.1:43869]
2020-08-10 23:18:25,244 - INFO  - [bookkeeper-io-685-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:43869
2020-08-10 23:18:25,244 - INFO  - [bookkeeper-io-685-3:PerChannelBookieClient$1@471] - connection [id: 0xb0edf047, L:/127.0.0.1:37686 - R:127.0.0.1/127.0.0.1:43869] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:25,244 - INFO  - [bookie-io-724-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:25,244 - INFO  - [bookie-io-724-2:BookieRequestHandler@50] - Channel connected  [id: 0x3b2cd67b, L:/127.0.0.1:42331 - R:/127.0.0.1:45084]
2020-08-10 23:18:25,244 - INFO  - [bookie-io-705-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:25,244 - INFO  - [bookie-io-705-2:BookieRequestHandler@50] - Channel connected  [id: 0xc1c04252, L:/127.0.0.1:46113 - R:/127.0.0.1:48020]
2020-08-10 23:18:25,244 - INFO  - [bookie-io-689-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:25,245 - INFO  - [bookie-io-689-2:BookieRequestHandler@50] - Channel connected  [id: 0x02d98a2a, L:/127.0.0.1:43869 - R:/127.0.0.1:37686]
2020-08-10 23:18:25,272 - INFO  - [Time-limited test:BookieAutoRecoveryTest@524] - Kill bookie which has registered using ipaddress
2020-08-10 23:18:25,273 - INFO  - [Time-limited test:BookieAutoRecoveryTest@536] - Killing Bookie :127.0.0.1:43869
2020-08-10 23:18:25,274 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:25,274 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:25,275 - WARN  - [bookkeeper-io-685-3:PerChannelBookieClient@1270] - Exception caught on:[id: 0xb0edf047, L:/127.0.0.1:37686 - R:127.0.0.1/127.0.0.1:43869] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:25,275 - INFO  - [bookie-io-689-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x02d98a2a, L:/127.0.0.1:43869 ! R:/127.0.0.1:37686]
2020-08-10 23:18:25,275 - INFO  - [bookkeeper-io-685-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xb0edf047, L:/127.0.0.1:37686 ! R:127.0.0.1/127.0.0.1:43869]
2020-08-10 23:18:25,279 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-43869 with exitCode 0
2020-08-10 23:18:25,279 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:25,279 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:25,280 - INFO  - [SyncThread-694-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:25,280 - INFO  - [SyncThread-694-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13001399327272243261test/current/0.log for logId 0.
2020-08-10 23:18:25,285 - INFO  - [pool-379-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13001399327272243261test/current/1.log for logId 1.
2020-08-10 23:18:25,289 - INFO  - [SyncThread-694-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094304294 , logFileOffset - 3072]}.
2020-08-10 23:18:25,292 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:25,292 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:25,292 - INFO  - [BookieJournal-43869:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:25,293 - INFO  - [BookieJournal-43869:Journal@1144] - Journal exited loop!
2020-08-10 23:18:25,293 - INFO  - [Bookie-43869:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:25,293 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:25,294 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:25,294 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:25,294 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:25,294 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:25,294 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:25,297 - WARN  - [GarbageCollectorThread-695-1:ScanAndCompareGarbageCollector@217] - Exception when iterating over the metadata
java.io.IOException: Interrupted while preloading
	at org.apache.bookkeeper.meta.LegacyHierarchicalLedgerManager$LegacyHierarchicalLedgerRangeIterator.preload(LegacyHierarchicalLedgerManager.java:222)
	at org.apache.bookkeeper.meta.LegacyHierarchicalLedgerManager$LegacyHierarchicalLedgerRangeIterator.hasNext(LegacyHierarchicalLedgerManager.java:237)
	at org.apache.bookkeeper.meta.HierarchicalLedgerManager$HierarchicalLedgerRangeIterator.hasNext(HierarchicalLedgerManager.java:109)
	at org.apache.bookkeeper.bookie.ScanAndCompareGarbageCollector.gc(ScanAndCompareGarbageCollector.java:159)
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.doGcLedgers(GarbageCollectorThread.java:380)
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.runWithFlags(GarbageCollectorThread.java:331)
	at org.apache.bookkeeper.bookie.GarbageCollectorThread.safeRun(GarbageCollectorThread.java:309)
	at org.apache.bookkeeper.common.util.SafeRunnable.run(SafeRunnable.java:36)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2587)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1248)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.meta.LegacyHierarchicalLedgerManager$LegacyHierarchicalLedgerRangeIterator.preload(LegacyHierarchicalLedgerManager.java:209)
	... 14 more
2020-08-10 23:18:25,301 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:25,301 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:25,301 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:25,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:25,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:25,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:25,305 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:43869
2020-08-10 23:18:25,308 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:25,313 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1114] - Following are the failed bookies: [127.0.0.1:43869], and searching its ledgers for re-replication
2020-08-10 23:18:25,314 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:43869] are identified as underreplicated
2020-08-10 23:18:25,337 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@635] - Recieved urLedger publishing event :NodeCreated
2020-08-10 23:18:25,337 - INFO  - [AuditorBookie-127.0.0.1:43869:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:25,346 - INFO  - [bookkeeper-io-736-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xeb354be4, L:/127.0.0.1:48026 - R:localhost/127.0.0.1:46113]
2020-08-10 23:18:25,346 - INFO  - [bookkeeper-io-736-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:46113
2020-08-10 23:18:25,347 - INFO  - [bookkeeper-io-736-2:PerChannelBookieClient$1@471] - connection [id: 0xeb354be4, L:/127.0.0.1:48026 - R:localhost/127.0.0.1:46113] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:25,346 - ERROR - [bookkeeper-io-736-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xcd6a8e16, L:/127.0.0.1:37690]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:25,347 - INFO  - [bookie-io-705-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:25,347 - INFO  - [bookie-io-705-3:BookieRequestHandler@50] - Channel connected  [id: 0x85f71d13, L:/127.0.0.1:46113 - R:/127.0.0.1:48026]
2020-08-10 23:18:25,351 - INFO  - [bookie-io-724-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:25,352 - INFO  - [bookie-io-724-3:BookieRequestHandler@50] - Channel connected  [id: 0xa44d1cea, L:/127.0.0.1:42331 - R:/127.0.0.1:45092]
2020-08-10 23:18:25,354 - INFO  - [bookkeeper-io-736-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8155b197, L:/127.0.0.1:45092 - R:localhost/127.0.0.1:42331]
2020-08-10 23:18:25,354 - INFO  - [bookkeeper-io-736-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:42331
2020-08-10 23:18:25,354 - INFO  - [bookkeeper-io-736-1:PerChannelBookieClient$1@471] - connection [id: 0x8155b197, L:/127.0.0.1:45092 - R:localhost/127.0.0.1:42331] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:25,358 - ERROR - [bookkeeper-io-736-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x67ce2268, L:/127.0.0.1:37694]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:25,404 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:25,404 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:25,404 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:25,405 - INFO  - [AuditorElector-127.0.0.1:43869:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:25,406 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:25,407 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:25,407 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:25,408 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:25,422 - INFO  - [AuditorElector-localhost:46113:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:25,425 - INFO  - [AuditorElector-localhost:46113:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:25,425 - INFO  - [AuditorElector-localhost:46113:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:25,426 - INFO  - [AuditorElector-localhost:46113:Auditor@660] - I'm starting as Auditor Bookie. ID: localhost:46113
2020-08-10 23:18:25,430 - INFO  - [AuditorElector-localhost:46113:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:25,430 - INFO  - [AuditorElector-localhost:46113:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:25,430 - INFO  - [AuditorElector-localhost:46113:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094302848 durationSinceLastExecutionInSecs: 2 initialDelay: 604798 interval: 604800
2020-08-10 23:18:25,431 - INFO  - [AuditorElector-localhost:46113:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:25,431 - INFO  - [AuditorElector-localhost:46113:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:25,431 - INFO  - [AuditorBookie-localhost:46113:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:25,439 - INFO  - [AuditorBookie-localhost:46113:Auditor@1114] - Following are the failed bookies: [127.0.0.1:43869], and searching its ledgers for re-replication
2020-08-10 23:18:25,439 - INFO  - [AuditorBookie-localhost:46113:Auditor@1132] - Following ledgers: [0] of bookie: [127.0.0.1:43869] are identified as underreplicated
2020-08-10 23:18:25,442 - INFO  - [AuditorBookie-localhost:46113:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:25,524 - INFO  - [Time-limited test:BookieAutoRecoveryTest@542] - Watching on urLedgerPath:/ledgers/underreplication/ledgers/0000/0000/0000/0000/urL0000000000 to know the status of rereplication process
2020-08-10 23:18:25,526 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:25,531 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:25,533 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:25,533 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:25,533 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:25,533 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:25,534 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:25,534 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:25,536 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageWarnThreshold" : "0.99",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "diskUsageThreshold" : "0.999",
  "gcWaitTime" : "1000",
  "journalFormatVersionToWrite" : "5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "openLedgerRereplicationGracePeriod" : "3000",
  "ledgerDirectories" : "/tmp/bookie16459763772029888315test",
  "listeningInterface" : "lo",
  "metadataServiceUri" : "zk://localhost:43525/ledgers",
  "journalFlushWhenQueueEmpty" : "true",
  "enableTaskExecutionStats" : "true",
  "journalDirectories" : "/tmp/bookie16459763772029888315test",
  "ledgerManagerFactoryClass" : "org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory",
  "useHostNameAsBookieID" : "true",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "rwRereplicateBackoffMs" : "500"
}
2020-08-10 23:18:25,538 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:25,541 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:25,543 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:18:25,547 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie16459763772029888315test/current] [/tmp/bookie16459763772029888315test/current]
2020-08-10 23:18:25,552 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:18:25,553 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie16459763772029888315test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:18:25,553 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.SortedLedgerStorage
2020-08-10 23:18:25,553 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:18:25,554 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:18:25,554 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:18:25,554 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:18:25,554 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:18:25,560 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for localhost:39361 to become writable
2020-08-10 23:18:25,560 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:18:25,561 - INFO  - [SyncThread-754-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:18:25,564 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:18:25,569 - INFO  - [BookieJournal-39361:Journal@909] - Starting journal on /tmp/bookie16459763772029888315test/current
2020-08-10 23:18:25,569 - INFO  - [BookieJournal-39361:JournalChannel@157] - Opening journal /tmp/bookie16459763772029888315test/current/173da3d1f22.txn
2020-08-10 23:18:25,570 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:18:25,572 - INFO  - [AutoRecoveryDeathWatcher-43869:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:25,573 - INFO  - [AutoRecoveryDeathWatcher-43869:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-43869
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:25,573 - INFO  - [AutoRecoveryDeathWatcher-43869:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:25,575 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:39361
2020-08-10 23:18:25,575 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:39361
2020-08-10 23:18:25,585 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:39361
2020-08-10 23:18:25,585 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:39361
2020-08-10 23:18:25,826 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie 'localhost:39361' has been created.
2020-08-10 23:18:25,829 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:43525/ledgers : zkServers = localhost:43525, ledgersRootPath = /ledgers.
2020-08-10 23:18:25,835 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:18:25,836 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:18:25,836 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:18:25,836 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:18:25,836 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:18:25,838 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:42331
2020-08-10 23:18:25,838 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:39361
2020-08-10 23:18:25,838 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/localhost:46113
2020-08-10 23:18:26,304 - INFO  - [BookieDeathWatcher-43869:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:18:26,304 - INFO  - [BookieDeathWatcher-43869:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-43869
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:18:26,304 - INFO  - [BookieDeathWatcher-43869:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:26,304 - INFO  - [BookieDeathWatcher-43869:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:28,363 - ERROR - [bookkeeper-io-736-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xc46a78c9, L:/127.0.0.1:37702]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,363 - WARN  - [PendingReplicationTimer:ReplicationWorker$3@519] - Missing bookie(s) from last segment. Opening Ledger0 for Recovery.
2020-08-10 23:18:28,371 - INFO  - [BookieHighPriorityThread-42331-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:45092
2020-08-10 23:18:28,371 - INFO  - [BookieHighPriorityThread-46113-OrderedExecutor-0-0:ReadEntryProcessorV3@208] - Ledger fence request received for ledger: 0 from address: /127.0.0.1:48026
2020-08-10 23:18:28,384 - ERROR - [bookkeeper-io-736-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x4e338599, L:/127.0.0.1:37704]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,389 - ERROR - [bookkeeper-io-736-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x52652c20, L:/127.0.0.1:37706]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,390 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E5 from bookie: 127.0.0.1:43869
2020-08-10 23:18:28,390 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingAddOp@376] - Failed to write entry (0, 4): Bookie handle is not available
2020-08-10 23:18:28,390 - WARN  - [BookKeeperClientWorker-OrderedExecutor-0-0:BookieWatcherImpl@298] - replaceBookie for bookie: 127.0.0.1:43869 in ensemble: [localhost:42331, localhost:46113, 127.0.0.1:43869] is not adhering to placement policy and chose localhost:39361. excludedBookies [127.0.0.1:43869] and quarantinedBookies []
2020-08-10 23:18:28,393 - INFO  - [bookkeeper-io-736-8:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x259009e1, L:/127.0.0.1:48256 - R:localhost/127.0.0.1:39361]
2020-08-10 23:18:28,393 - INFO  - [bookkeeper-io-736-8:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:39361
2020-08-10 23:18:28,393 - INFO  - [bookkeeper-io-736-8:PerChannelBookieClient$1@471] - connection [id: 0x259009e1, L:/127.0.0.1:48256 - R:localhost/127.0.0.1:39361] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:28,398 - INFO  - [bookie-io-749-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:28,398 - INFO  - [bookie-io-749-2:BookieRequestHandler@50] - Channel connected  [id: 0x3de08f7c, L:/127.0.0.1:39361 - R:/127.0.0.1:48256]
2020-08-10 23:18:28,404 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:ReadOnlyLedgerHandle@309] - Closing recovered ledger 0 at entry 4
2020-08-10 23:18:28,418 - INFO  - [bookkeeper-io-720-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1bf7363d, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:46113]
2020-08-10 23:18:28,418 - INFO  - [bookkeeper-io-720-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:46113
2020-08-10 23:18:28,418 - INFO  - [bookkeeper-io-720-1:PerChannelBookieClient$1@471] - connection [id: 0x1bf7363d, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:46113] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:28,419 - INFO  - [bookkeeper-io-720-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x55e3ffc7, L:/127.0.0.1:45112 - R:localhost/127.0.0.1:42331]
2020-08-10 23:18:28,419 - INFO  - [bookkeeper-io-720-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:42331
2020-08-10 23:18:28,419 - INFO  - [bookkeeper-io-720-3:PerChannelBookieClient$1@471] - connection [id: 0x55e3ffc7, L:/127.0.0.1:45112 - R:localhost/127.0.0.1:42331] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:28,419 - INFO  - [bookkeeper-io-720-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8bb865df, L:/127.0.0.1:48262 - R:localhost/127.0.0.1:39361]
2020-08-10 23:18:28,420 - INFO  - [bookkeeper-io-720-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:39361
2020-08-10 23:18:28,420 - INFO  - [bookkeeper-io-720-2:PerChannelBookieClient$1@471] - connection [id: 0x8bb865df, L:/127.0.0.1:48262 - R:localhost/127.0.0.1:39361] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:28,420 - INFO  - [bookie-io-705-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:28,420 - INFO  - [bookie-io-705-4:BookieRequestHandler@50] - Channel connected  [id: 0xc669e2cf, L:/127.0.0.1:46113 - R:/127.0.0.1:48048]
2020-08-10 23:18:28,420 - INFO  - [bookie-io-724-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:28,421 - INFO  - [bookie-io-724-4:BookieRequestHandler@50] - Channel connected  [id: 0xf5a4c3e0, L:/127.0.0.1:42331 - R:/127.0.0.1:45112]
2020-08-10 23:18:28,424 - INFO  - [bookie-io-749-3:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:28,424 - INFO  - [bookie-io-749-3:BookieRequestHandler@50] - Channel connected  [id: 0x1a28588f, L:/127.0.0.1:39361 - R:/127.0.0.1:48262]
2020-08-10 23:18:28,429 - ERROR - [bookkeeper-io-720-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9be3bf2c, L:/127.0.0.1:37716]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,432 - INFO  - [ReplicationWorker:LedgerFragmentReplicator@192] - Replicating fragment Fragment(LedgerID: 0, FirstEntryID: 0[0], LastKnownEntryID: 3[3], Host: [127.0.0.1:43869], Closed: true) in 1 sub fragments.
2020-08-10 23:18:28,439 - ERROR - [bookkeeper-io-720-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x94e5145c, L:/127.0.0.1:37718]/127.0.0.1:43869, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: /127.0.0.1:43869
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,442 - INFO  - [BookKeeperClientWorker-OrderedExecutor-0-0:PendingReadOp$LedgerEntryRequest@213] - Error: Bookie handle is not available while reading L0 E2 from bookie: 127.0.0.1:43869
2020-08-10 23:18:28,452 - INFO  - [Time-limited test-EventThread:LedgerFragmentReplicator@440] - Updated ZK for ledgerId: ({127.0.0.1:43869=localhost:39361}:{}) to point ledger fragments from old bookies to new bookies: {}
2020-08-10 23:18:28,457 - INFO  - [ReplicationWorker:ReplicationWorker@401] - Ledger replicated successfully. ledger id is: 0
2020-08-10 23:18:28,459 - INFO  - [Time-limited test-EventThread:BookieAutoRecoveryTest$1@630] - Recieved Ledger rereplication completion event :NodeDeleted
2020-08-10 23:18:28,459 - INFO  - [Time-limited test:BookieAutoRecoveryTest@564] - Waiting to update the urledger metadata in zookeeper
2020-08-10 23:18:28,461 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:18:28,575 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:28,575 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:28,575 - INFO  - [bookie-io-705-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x85f71d13, L:/127.0.0.1:46113 ! R:/127.0.0.1:48026]
2020-08-10 23:18:28,575 - WARN  - [bookkeeper-io-685-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x78fe5c1c, L:/127.0.0.1:48020 - R:localhost/127.0.0.1:46113] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:28,575 - INFO  - [bookkeeper-io-685-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x78fe5c1c, L:/127.0.0.1:48020 ! R:localhost/127.0.0.1:46113]
2020-08-10 23:18:28,576 - WARN  - [bookkeeper-io-736-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xeb354be4, L:/127.0.0.1:48026 - R:localhost/127.0.0.1:46113] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:28,576 - INFO  - [bookkeeper-io-736-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xeb354be4, L:/127.0.0.1:48026 ! R:localhost/127.0.0.1:46113]
2020-08-10 23:18:28,575 - INFO  - [bookie-io-705-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc1c04252, L:/127.0.0.1:46113 ! R:/127.0.0.1:48020]
2020-08-10 23:18:28,575 - INFO  - [bookie-io-705-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xc669e2cf, L:/127.0.0.1:46113 ! R:/127.0.0.1:48048]
2020-08-10 23:18:28,575 - WARN  - [bookkeeper-io-720-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1bf7363d, L:/127.0.0.1:48048 - R:localhost/127.0.0.1:46113] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:28,576 - INFO  - [bookkeeper-io-720-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1bf7363d, L:/127.0.0.1:48048 ! R:localhost/127.0.0.1:46113]
2020-08-10 23:18:28,578 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-46113 with exitCode 0
2020-08-10 23:18:28,578 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:28,578 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:28,578 - INFO  - [SyncThread-713-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:28,579 - INFO  - [SyncThread-713-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10351763955510431802test/current/0.log for logId 0.
2020-08-10 23:18:28,581 - INFO  - [pool-389-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10351763955510431802test/current/1.log for logId 1.
2020-08-10 23:18:28,598 - INFO  - [SyncThread-713-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094304617 , logFileOffset - 4096]}.
2020-08-10 23:18:28,601 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:28,601 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:28,602 - INFO  - [BookieJournal-46113:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:28,602 - INFO  - [BookieJournal-46113:Journal@1144] - Journal exited loop!
2020-08-10 23:18:28,602 - INFO  - [Bookie-46113:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:28,603 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:28,603 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:28,603 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:28,603 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:28,604 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:28,604 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:28,606 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:28,606 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:28,606 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:28,609 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:46113
2020-08-10 23:18:28,609 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:46113
2020-08-10 23:18:28,609 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:46113
2020-08-10 23:18:28,609 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:46113
2020-08-10 23:18:28,713 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:28,714 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:28,714 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:28,714 - INFO  - [AuditorElector-localhost:46113:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:28,721 - INFO  - [AuditorBookie-localhost:46113:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:28,727 - INFO  - [AuditorElector-localhost:42331:Auditor@467] - AuthProvider used by the Auditor is null
2020-08-10 23:18:28,729 - INFO  - [AuditorElector-localhost:42331:ZkLedgerUnderreplicationManager@811] - lostBookieRecoveryDelay Znode is already present, so using existing lostBookieRecoveryDelay Znode value
2020-08-10 23:18:28,729 - INFO  - [AuditorElector-localhost:42331:Auditor@474] - Valid lostBookieRecoveryDelay zNode is available, so not creating lostBookieRecoveryDelay zNode as part of Auditor initialization 
2020-08-10 23:18:28,730 - INFO  - [AuditorElector-localhost:42331:Auditor@660] - I'm starting as Auditor Bookie. ID: localhost:42331
2020-08-10 23:18:28,733 - INFO  - [AuditorElector-localhost:42331:Auditor@698] - Auditor periodic bookie checking enabled 'auditorPeriodicBookieCheckInterval' 86400 seconds
2020-08-10 23:18:28,734 - INFO  - [AuditorElector-localhost:42331:Auditor@708] - Auditor periodic ledger checking enabled 'auditorPeriodicCheckInterval' 604800 seconds
2020-08-10 23:18:28,735 - INFO  - [AuditorElector-localhost:42331:Auditor@733] - checkAllLedgers scheduling info.  checkAllLedgersLastExecutedCTime: 1597094302848 durationSinceLastExecutionInSecs: 5 initialDelay: 604795 interval: 604800
2020-08-10 23:18:28,735 - INFO  - [AuditorElector-localhost:42331:Auditor@889] - Periodic placementPolicy check disabled
2020-08-10 23:18:28,735 - INFO  - [AuditorElector-localhost:42331:Auditor@897] - Periodic replicas check disabled
2020-08-10 23:18:28,735 - INFO  - [AuditorBookie-localhost:42331:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:28,735 - INFO  - [AuditorBookie-localhost:46113:Auditor@1114] - Following are the failed bookies: [localhost:46113], and searching its ledgers for re-replication
2020-08-10 23:18:28,736 - INFO  - [AuditorBookie-localhost:46113:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:46113] are identified as underreplicated
2020-08-10 23:18:28,765 - INFO  - [AuditorBookie-localhost:46113:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:28,765 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:28,766 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:28,768 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.lang.Object.wait(Native Method)
	at java.base/java.lang.Object.wait(Object.java:328)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1529)
	at org.apache.zookeeper.ClientCnxn.submitRequest(ClientCnxn.java:1512)
	at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:2587)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$3701(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1248)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$27.call(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.getChildren(ZooKeeperClient.java:1242)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager$1.getChildren(ZkLedgerUnderreplicationManager.java:144)
	at org.apache.bookkeeper.util.SubTreeCache.getChildren(SubTreeCache.java:118)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:501)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicateFromHierarchy(ZkLedgerUnderreplicationManager.java:556)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:602)
	... 4 more
2020-08-10 23:18:28,768 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:28,768 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:42331
2020-08-10 23:18:28,768 - INFO  - [AuditorBookie-localhost:42331:Auditor@1114] - Following are the failed bookies: [localhost:46113], and searching its ledgers for re-replication
2020-08-10 23:18:28,768 - INFO  - [bookkeeper-io-720-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x55e3ffc7, L:/127.0.0.1:45112 ! R:localhost/127.0.0.1:42331]
2020-08-10 23:18:28,769 - INFO  - [AuditorBookie-localhost:42331:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:46113] are identified as underreplicated
2020-08-10 23:18:28,769 - INFO  - [bookie-io-724-4:BookieRequestHandler@61] - Channels disconnected: [id: 0xf5a4c3e0, L:/127.0.0.1:42331 ! R:/127.0.0.1:45112]
2020-08-10 23:18:28,769 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:39361
2020-08-10 23:18:28,770 - INFO  - [bookkeeper-io-720-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8bb865df, L:/127.0.0.1:48262 ! R:localhost/127.0.0.1:39361]
2020-08-10 23:18:28,770 - INFO  - [bookie-io-749-3:BookieRequestHandler@61] - Channels disconnected: [id: 0x1a28588f, L:/127.0.0.1:39361 ! R:/127.0.0.1:48262]
2020-08-10 23:18:28,770 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43869
2020-08-10 23:18:28,770 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:46113
2020-08-10 23:18:28,776 - INFO  - [AuditorBookie-localhost:42331:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:28,884 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:18:28,884 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:18:28,884 - INFO  - [bookie-io-724-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x3b2cd67b, L:/127.0.0.1:42331 ! R:/127.0.0.1:45084]
2020-08-10 23:18:28,884 - WARN  - [bookkeeper-io-685-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x4b02c6ba, L:/127.0.0.1:45084 - R:localhost/127.0.0.1:42331] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:28,884 - INFO  - [bookkeeper-io-685-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x4b02c6ba, L:/127.0.0.1:45084 ! R:localhost/127.0.0.1:42331]
2020-08-10 23:18:28,884 - WARN  - [bookkeeper-io-736-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x8155b197, L:/127.0.0.1:45092 - R:localhost/127.0.0.1:42331] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:18:28,885 - INFO  - [bookkeeper-io-736-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8155b197, L:/127.0.0.1:45092 ! R:localhost/127.0.0.1:42331]
2020-08-10 23:18:28,885 - ERROR - [bookkeeper-io-761-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xab9b68bc, L:/127.0.0.1:48058]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,886 - INFO  - [bookie-io-724-3:BookieRequestHandler@61] - Channels disconnected: [id: 0xa44d1cea, L:/127.0.0.1:42331 ! R:/127.0.0.1:45092]
2020-08-10 23:18:28,888 - INFO  - [bookkeeper-io-761-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x94c4574a, L:/127.0.0.1:48270 - R:localhost/127.0.0.1:39361]
2020-08-10 23:18:28,888 - INFO  - [bookkeeper-io-761-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: localhost:39361
2020-08-10 23:18:28,888 - INFO  - [bookkeeper-io-761-2:PerChannelBookieClient$1@471] - connection [id: 0x94c4574a, L:/127.0.0.1:48270 - R:localhost/127.0.0.1:39361] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:18:28,889 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-42331 with exitCode 0
2020-08-10 23:18:28,889 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:18:28,889 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:18:28,889 - ERROR - [bookkeeper-io-761-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x4702fe09, L:/127.0.0.1:45124]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,889 - INFO  - [SyncThread-729-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:18:28,891 - INFO  - [SyncThread-729-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8726772827487777203test/current/0.log for logId 0.
2020-08-10 23:18:28,891 - INFO  - [bookie-io-749-4:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:18:28,892 - INFO  - [bookie-io-749-4:BookieRequestHandler@50] - Channel connected  [id: 0xc254a360, L:/127.0.0.1:39361 - R:/127.0.0.1:48270]
2020-08-10 23:18:28,893 - INFO  - [pool-399-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8726772827487777203test/current/1.log for logId 1.
2020-08-10 23:18:28,895 - ERROR - [bookkeeper-io-761-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x04debfd2, L:/127.0.0.1:45126]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,896 - ERROR - [bookkeeper-io-761-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xcfef1d10, L:/127.0.0.1:48066]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,897 - ERROR - [bookkeeper-io-761-7:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe8f59952, L:/127.0.0.1:48068]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,897 - ERROR - [bookkeeper-io-761-6:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x1cd29788, L:/127.0.0.1:45132]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], allBookies [<Bookie:localhost:42331>, <Bookie:localhost:39361>].
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], allBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>].
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], allBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>].
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@576] - Failed to choose a bookie: excluded [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], fallback to choose bookie randomly from the cluster.
2020-08-10 23:18:28,898 - WARN  - [ReplicationWorker:RackawareEnsemblePlacementPolicyImpl@769] - Failed to find 1 bookies : excludeBookies [<Bookie:localhost:39361>, <Bookie:localhost:42331>, <Bookie:localhost:46113>], allBookies [<Bookie:localhost:42331>, <Bookie:localhost:39361>].
2020-08-10 23:18:28,899 - WARN  - [ReplicationWorker:ReplicationWorker@390] - BKNotEnoughBookiesException while replicating the fragment
org.apache.bookkeeper.client.BKException$BKNotEnoughBookiesException: Not enough non-faulty bookies available
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandomInternal(RackawareEnsemblePlacementPolicyImpl.java:772)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectRandom(RackawareEnsemblePlacementPolicyImpl.java:690)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:579)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:203)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.selectFromNetworkLocation(RackawareEnsemblePlacementPolicyImpl.java:539)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.selectFromNetworkLocation(RackawareEnsemblePlacementPolicy.java:224)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicyImpl.replaceBookie(RackawareEnsemblePlacementPolicyImpl.java:467)
	at org.apache.bookkeeper.client.RackawareEnsemblePlacementPolicy.replaceBookie(RackawareEnsemblePlacementPolicy.java:117)
	at org.apache.bookkeeper.client.BookKeeperAdmin.getReplacementBookiesByIndexes(BookKeeperAdmin.java:1022)
	at org.apache.bookkeeper.client.BookKeeperAdmin.replicateLedgerFragment(BookKeeperAdmin.java:1071)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:384)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:277)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:18:28,901 - ERROR - [bookkeeper-io-761-1:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xae803845, L:/127.0.0.1:45134]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,902 - ERROR - [bookkeeper-io-761-8:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xd60f8fb2, L:/127.0.0.1:48074]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,903 - ERROR - [bookkeeper-io-761-2:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x45b35540, L:/127.0.0.1:45138]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,903 - ERROR - [bookkeeper-io-761-3:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x6eff150c, L:/127.0.0.1:48078]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,903 - ERROR - [bookkeeper-io-761-4:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0xe3d7a00d, L:/127.0.0.1:45142]/localhost:42331, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:42331
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,904 - ERROR - [bookkeeper-io-761-5:PerChannelBookieClient$ConnectionFutureListener@2464] - Could not connect to bookie: [id: 0x9e86af9b, L:/127.0.0.1:48082]/localhost:46113, current state CONNECTING : 
io.netty.channel.AbstractChannel$AnnotatedConnectException: syscall:getsockopt(..) failed: Connection refused: localhost/127.0.0.1:46113
	at io.netty.channel.unix.Socket.finishConnect(..)(Unknown Source)
Caused by: io.netty.channel.unix.Errors$NativeConnectException: syscall:getsockopt(..) failed: Connection refused
	... 1 more
2020-08-10 23:18:28,906 - ERROR - [ReplicationWorker:ReplicationWorker@592] - ReplicationWorker failed to replicate Ledger : 0 for 0 number of times, so deferring the ledger lock release by 9375 msecs
2020-08-10 23:18:28,907 - INFO  - [SyncThread-729-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597094304948 , logFileOffset - 4096]}.
2020-08-10 23:18:28,911 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:18:28,911 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:18:28,911 - INFO  - [BookieJournal-42331:Journal@1135] - Journal exits when shutting down
2020-08-10 23:18:28,911 - INFO  - [BookieJournal-42331:Journal@1144] - Journal exited loop!
2020-08-10 23:18:28,912 - INFO  - [AutoRecoveryDeathWatcher-46113:AutoRecoveryMain$AutoRecoveryDeathWatcher@227] - AutoRecoveryDeathWatcher noticed the AutoRecovery is not running any more,exiting the watch loop!
2020-08-10 23:18:28,912 - INFO  - [Bookie-42331:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:18:28,913 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:18:28,913 - INFO  - [AutoRecoveryDeathWatcher-46113:AutoRecoveryMain$AutoRecoveryDeathWatcher@211] - AutoRecoveryDeathWatcher exited loop due to uncaught exception from thread AutoRecoveryDeathWatcher-46113
java.lang.RuntimeException: AutoRecovery is not running any more
	at org.apache.bookkeeper.replication.AutoRecoveryMain$AutoRecoveryDeathWatcher.run(AutoRecoveryMain.java:237)
2020-08-10 23:18:28,913 - INFO  - [AutoRecoveryDeathWatcher-46113:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:28,913 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:18:28,914 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:18:28,914 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:18:28,914 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:18:28,914 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:18:28,917 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:18:28,917 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:18:28,917 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:18:28,920 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:42331
2020-08-10 23:18:28,920 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:42331
2020-08-10 23:18:28,920 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/localhost:42331
2020-08-10 23:18:28,927 - INFO  - [AuditorBookie-localhost:42331:Auditor@1067] - Starting auditBookies
2020-08-10 23:18:28,936 - INFO  - [AuditorBookie-localhost:42331:Auditor@1114] - Following are the failed bookies: [localhost:42331, localhost:46113], and searching its ledgers for re-replication
2020-08-10 23:18:28,937 - INFO  - [AuditorBookie-localhost:42331:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:42331] are identified as underreplicated
2020-08-10 23:18:28,942 - INFO  - [Time-limited test-EventThread:Auditor@1132] - Following ledgers: [0] of bookie: [localhost:46113] are identified as underreplicated
2020-08-10 23:18:28,949 - INFO  - [AuditorBookie-localhost:42331:Auditor@1102] - Completed auditBookies
2020-08-10 23:18:29,020 - INFO  - [Time-limited test:AutoRecoveryMain@144] - Shutting down auto recovery: 0
2020-08-10 23:18:29,020 - INFO  - [Time-limited test:AutoRecoveryMain@148] - Shutting down AutoRecovery
2020-08-10 23:18:29,020 - INFO  - [Time-limited test:Auditor@1947] - Shutting down auditor
2020-08-10 23:18:29,020 - INFO  - [AuditorElector-localhost:42331:AuditorElector$2@260] - Shutting down AuditorElector
2020-08-10 23:18:29,021 - INFO  - [Time-limited test:ReplicationWorker@614] - Shutting down replication worker
2020-08-10 23:18:29,021 - INFO  - [Time-limited test:ReplicationWorker@622] - Shutting down ReplicationWorker
2020-08-10 23:18:29,021 - ERROR - [ReplicationWorker:ReplicationWorker@249] - UnavailableException while replicating fragments
org.apache.bookkeeper.replication.ReplicationException$UnavailableException: Interrupted while connecting zookeeper
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:612)
	at org.apache.bookkeeper.replication.ReplicationWorker.rereplicate(ReplicationWorker.java:272)
	at org.apache.bookkeeper.replication.ReplicationWorker.run(ReplicationWorker.java:238)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1040)
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:232)
	at org.apache.bookkeeper.meta.ZkLedgerUnderreplicationManager.getLedgerToRereplicate(ZkLedgerUnderreplicationManager.java:607)
	... 4 more
2020-08-10 23:18:29,023 - INFO  - [ReplicationWorker:ReplicationWorker@254] - ReplicationWorker exited loop!
2020-08-10 23:18:29,023 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:42331
2020-08-10 23:18:29,024 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:43869
2020-08-10 23:18:29,024 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for localhost:39361
