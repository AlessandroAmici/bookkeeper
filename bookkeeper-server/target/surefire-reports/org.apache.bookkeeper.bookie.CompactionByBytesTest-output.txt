2020-08-10 23:30:42,886 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:30:43,283 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:43,451 - INFO  - [Time-limited test:MetadataDrivers@105] - BookKeeper metadata driver manager initialized
2020-08-10 23:30:43,459 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42787/ledgers : zkServers = localhost:42787, ledgersRootPath = /ledgers.
2020-08-10 23:30:43,483 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:43,595 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:43,635 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:43,636 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:43,640 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:43,707 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:30:43,913 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie13942557235588987507test",
  "metadataServiceUri" : "zk://localhost:42787/ledgers",
  "journalDirectories" : "/tmp/bookie13942557235588987507test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:30:44,118 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42787/ledgers : zkServers = localhost:42787, ledgersRootPath = /ledgers.
2020-08-10 23:30:44,130 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:44,144 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:44,169 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie13942557235588987507test/current] [/tmp/bookie13942557235588987507test/current]
2020-08-10 23:30:44,315 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:44,335 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie13942557235588987507test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:44,336 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:44,360 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:44,370 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:44,375 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:44,386 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:30:44,386 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:30:44,424 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33803 to become writable
2020-08-10 23:30:44,432 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 3 ms.
2020-08-10 23:30:44,437 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:44,443 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:44,444 - INFO  - [BookieJournal-33803:Journal@909] - Starting journal on /tmp/bookie13942557235588987507test/current
2020-08-10 23:30:44,449 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:44,450 - INFO  - [BookieJournal-33803:JournalChannel@157] - Opening journal /tmp/bookie13942557235588987507test/current/173da486560.txn
2020-08-10 23:30:44,493 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33803
2020-08-10 23:30:44,742 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33803' has been created.
2020-08-10 23:30:44,744 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testRecoverIndexWhenIndexIsPartiallyFlush @ metadata service zk://localhost:42787/ledgers in 1828 ms.
2020-08-10 23:30:44,826 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33803] for ledger: 0
2020-08-10 23:30:44,838 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33803] for ledger: 1
2020-08-10 23:30:44,849 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33803] for ledger: 2
2020-08-10 23:30:44,931 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1f073da2, L:/127.0.0.1:37138 - R:127.0.0.1/127.0.0.1:33803]
2020-08-10 23:30:44,932 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33803
2020-08-10 23:30:44,957 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient$1@471] - connection [id: 0x1f073da2, L:/127.0.0.1:37138 - R:127.0.0.1/127.0.0.1:33803] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:30:45,417 - INFO  - [bookie-io-8-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:30:45,418 - INFO  - [bookie-io-8-2:BookieRequestHandler@50] - Channel connected  [id: 0xc210bfb0, L:/127.0.0.1:33803 - R:/127.0.0.1:37138]
2020-08-10 23:30:45,436 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:45,440 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/0.log for logId 0.
2020-08-10 23:30:46,038 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:46,056 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/1.log for logId 1.
2020-08-10 23:30:46,057 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie13942557235588987507test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:46,078 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:30:46,444 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:30:46,472 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:30:46,473 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:30:46,476 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
2020-08-10 23:30:46,518 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:46,520 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/2.log for logId 2.
2020-08-10 23:30:46,520 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie13942557235588987507test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:46,546 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:30:47,444 - INFO  - [GarbageCollectorThread-14-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:30:47,462 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:47,465 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/3.log for logId 3.
2020-08-10 23:30:47,465 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie13942557235588987507test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:47,487 - INFO  - [SyncThread-13-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:30:47,568 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:47,568 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:47,573 - WARN  - [bookkeeper-io-3-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1f073da2, L:/127.0.0.1:37138 - R:127.0.0.1/127.0.0.1:33803] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:30:47,575 - INFO  - [bookie-io-8-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc210bfb0, L:/127.0.0.1:33803 ! R:/127.0.0.1:37138]
2020-08-10 23:30:47,576 - INFO  - [bookkeeper-io-3-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1f073da2, L:/127.0.0.1:37138 ! R:127.0.0.1/127.0.0.1:33803]
2020-08-10 23:30:47,603 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33803 with exitCode 0
2020-08-10 23:30:47,603 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:47,603 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:47,612 - INFO  - [SyncThread-13-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095044448 , logFileOffset - 462336]}.
2020-08-10 23:30:47,616 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:47,617 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:47,618 - INFO  - [BookieJournal-33803:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:47,618 - INFO  - [BookieJournal-33803:Journal@1144] - Journal exited loop!
2020-08-10 23:30:47,619 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:47,619 - INFO  - [Bookie-33803:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:47,620 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:47,621 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:47,621 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:47,621 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:47,622 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:47,625 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:47,642 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:47,643 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:47,650 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33803
2020-08-10 23:30:48,492 - INFO  - [BookieDeathWatcher-33803:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:48,494 - INFO  - [BookieDeathWatcher-33803:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33803
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:48,497 - INFO  - [BookieDeathWatcher-33803:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:48,497 - INFO  - [BookieDeathWatcher-33803:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:48,757 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie13942557235588987507test",
  "metadataServiceUri" : "zk://localhost:42787/ledgers",
  "journalDirectories" : "/tmp/bookie13942557235588987507test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "600000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "33803",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:30:48,763 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:42787/ledgers : zkServers = localhost:42787, ledgersRootPath = /ledgers.
2020-08-10 23:30:48,776 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:48,781 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:48,806 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:48,809 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:48,810 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:48,811 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:48,814 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:48,815 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:30:48,815 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:30:48,835 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33803 to become writable
2020-08-10 23:30:48,836 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095044448 from position 462336
2020-08-10 23:30:48,837 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie13942557235588987507test/current/173da486560.txn
2020-08-10 23:30:48,838 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 2 ms.
2020-08-10 23:30:48,839 - INFO  - [SyncThread-23-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095044448 , logFileOffset - 462340]}.
2020-08-10 23:30:48,843 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:48,844 - INFO  - [BookieJournal-33803:Journal@909] - Starting journal on /tmp/bookie13942557235588987507test/current
2020-08-10 23:30:48,845 - INFO  - [BookieJournal-33803:JournalChannel@157] - Opening journal /tmp/bookie13942557235588987507test/current/173da486561.txn
2020-08-10 23:30:48,845 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:48,852 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33803
2020-08-10 23:30:49,117 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33803' has been created.
2020-08-10 23:30:49,140 - INFO  - [Time-limited test:CompactionTest@1255] - Finished deleting the ledgers contains most entries.
2020-08-10 23:30:49,144 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 0.
2020-08-10 23:30:49,145 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/4.log.compacting for logId 4.
2020-08-10 23:30:49,251 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie13942557235588987507test/current/4.log.compacting with logId 4.
2020-08-10 23:30:49,275 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:49,276 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 0 end in PartialFlushIndexPhase.
2020-08-10 23:30:49,276 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 1.
2020-08-10 23:30:49,277 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/5.log.compacting for logId 5.
2020-08-10 23:30:49,348 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie13942557235588987507test/current/5.log.compacting with logId 5.
2020-08-10 23:30:49,364 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:49,366 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 1 end in PartialFlushIndexPhase.
2020-08-10 23:30:49,366 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1401] - Compacting entry log 2.
2020-08-10 23:30:49,367 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie13942557235588987507test/current/6.log.compacting for logId 6.
2020-08-10 23:30:49,448 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie13942557235588987507test/current/6.log.compacting with logId 6.
2020-08-10 23:30:49,472 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase UpdateIndexPhase. Abort current compaction.
java.io.IOException: Flush ledger index encounter exception
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$PartialFlushIndexPhase.start(CompactionTest.java:1469)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithIndexFlushFailure(CompactionTest.java:1415)
	at org.apache.bookkeeper.bookie.CompactionTest.testRecoverIndexWhenIndexIsPartiallyFlush(CompactionTest.java:1262)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:49,473 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1416] - Compaction for 2 end in PartialFlushIndexPhase.
2020-08-10 23:30:49,495 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x8cc9d0db, L:/127.0.0.1:37142 - R:127.0.0.1/127.0.0.1:33803]
2020-08-10 23:30:49,496 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33803
2020-08-10 23:30:49,498 - INFO  - [bookie-io-18-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:30:49,499 - INFO  - [bookie-io-18-2:BookieRequestHandler@50] - Channel connected  [id: 0xd302f1fd, L:/127.0.0.1:33803 - R:/127.0.0.1:37142]
2020-08-10 23:30:49,500 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient$1@471] - connection [id: 0x8cc9d0db, L:/127.0.0.1:37142 - R:127.0.0.1/127.0.0.1:33803] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:30:49,533 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie13942557235588987507test/current/6.log.2.compacted has partially flushed index, recovering index.
2020-08-10 23:30:49,537 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 6
2020-08-10 23:30:49,549 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:30:49,549 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie13942557235588987507test/current/5.log.1.compacted has partially flushed index, recovering index.
2020-08-10 23:30:49,552 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 5
2020-08-10 23:30:49,563 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:30:49,564 - INFO  - [Time-limited test:TransactionalEntryLogCompactor@86] - Found compacted log file /tmp/bookie13942557235588987507test/current/4.log.0.compacted has partially flushed index, recovering index.
2020-08-10 23:30:49,566 - INFO  - [Time-limited test:TransactionalEntryLogCompactor$UpdateIndexPhase@377] - Recovered 94 entry locations from compacted log 4
2020-08-10 23:30:49,577 - INFO  - [Time-limited test:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:30:49,588 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:49,589 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33803
2020-08-10 23:30:49,590 - INFO  - [bookkeeper-io-3-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x8cc9d0db, L:/127.0.0.1:37142 ! R:127.0.0.1/127.0.0.1:33803]
2020-08-10 23:30:49,591 - INFO  - [bookie-io-18-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xd302f1fd, L:/127.0.0.1:33803 ! R:/127.0.0.1:37142]
2020-08-10 23:30:51,703 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:51,704 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:51,711 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33803 with exitCode 0
2020-08-10 23:30:51,711 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:51,712 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:51,712 - INFO  - [SyncThread-23-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095044448 , logFileOffset - 462340]}.
2020-08-10 23:30:51,717 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:51,717 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:51,718 - INFO  - [BookieJournal-33803:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:51,718 - INFO  - [BookieJournal-33803:Journal@1144] - Journal exited loop!
2020-08-10 23:30:51,718 - INFO  - [Bookie-33803:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:51,718 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:51,719 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:51,719 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:51,719 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:51,719 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:51,719 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:51,722 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:51,725 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:51,725 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:51,864 - INFO  - [BookieDeathWatcher-33803:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:51,864 - INFO  - [BookieDeathWatcher-33803:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33803
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:51,864 - INFO  - [BookieDeathWatcher-33803:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:51,864 - INFO  - [BookieDeathWatcher-33803:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:51,963 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testRecoverIndexWhenIndexIsPartiallyFlush in 2374 ms.
2020-08-10 23:30:51,968 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:30:51,985 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:52,000 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44113/ledgers : zkServers = localhost:44113, ledgersRootPath = /ledgers.
2020-08-10 23:30:52,008 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:52,013 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:52,014 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:52,015 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:52,015 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:52,030 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:30:52,031 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie2544482674852728487test",
  "metadataServiceUri" : "zk://localhost:44113/ledgers",
  "journalDirectories" : "/tmp/bookie2544482674852728487test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:30:52,036 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44113/ledgers : zkServers = localhost:44113, ledgersRootPath = /ledgers.
2020-08-10 23:30:52,044 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:52,047 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:52,057 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie2544482674852728487test/current] [/tmp/bookie2544482674852728487test/current]
2020-08-10 23:30:52,070 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:52,073 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie2544482674852728487test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:52,073 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:52,074 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:52,074 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:52,076 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:52,085 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:30:52,085 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:30:52,103 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37761 to become writable
2020-08-10 23:30:52,105 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:52,106 - INFO  - [SyncThread-39-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:52,110 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:52,111 - INFO  - [BookieJournal-37761:Journal@909] - Starting journal on /tmp/bookie2544482674852728487test/current
2020-08-10 23:30:52,112 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:52,112 - INFO  - [BookieJournal-37761:JournalChannel@157] - Opening journal /tmp/bookie2544482674852728487test/current/173da488351.txn
2020-08-10 23:30:52,123 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37761
2020-08-10 23:30:52,373 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37761' has been created.
2020-08-10 23:30:52,375 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompactionWithNoWritableLedgerDirsButIsForceGCAllowWhenNoSpaceIsSet @ metadata service zk://localhost:44113/ledgers in 406 ms.
2020-08-10 23:30:52,375 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:52,375 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:52,386 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37761 with exitCode 0
2020-08-10 23:30:52,387 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:52,387 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:52,388 - INFO  - [SyncThread-39-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:52,392 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:52,392 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:52,393 - INFO  - [BookieJournal-37761:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:52,393 - INFO  - [BookieJournal-37761:Journal@1144] - Journal exited loop!
2020-08-10 23:30:52,393 - INFO  - [Bookie-37761:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:52,393 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:52,395 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:52,396 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:52,396 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:52,397 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:52,397 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:52,397 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:52,398 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:52,398 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:52,405 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37761
2020-08-10 23:30:52,626 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "[/tmp/ledger4184486784274436393test1, /tmp/ledger7799796219791269163test2]",
  "metadataServiceUri" : "zk://localhost:44113/ledgers",
  "journalDirectories" : "/tmp/journal4039890153200764691test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "600000",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:30:52,631 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44113/ledgers : zkServers = localhost:44113, ledgersRootPath = /ledgers.
2020-08-10 23:30:52,643 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:52,648 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:52,660 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/journal4039890153200764691test/current] [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:52,670 - WARN  - [Time-limited test:Bookie@293] - Dirs: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current] are in same DiskPartition/FileSystem: / (/dev/sda1)
2020-08-10 23:30:52,673 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:52,676 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/ledger4184486784274436393test1/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:52,676 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/ledger7799796219791269163test2/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:52,676 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:52,677 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:52,678 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:52,680 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:52,680 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:30:52,681 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:30:52,708 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44113/ledgers : zkServers = localhost:44113, ledgersRootPath = /ledgers.
2020-08-10 23:30:52,717 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:52,720 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:52,721 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:52,722 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:52,722 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:52,726 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39363 to become writable
2020-08-10 23:30:52,727 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:52,729 - INFO  - [SyncThread-49-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:52,738 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:52,739 - INFO  - [BookieJournal-39363:Journal@909] - Starting journal on /tmp/journal4039890153200764691test/current
2020-08-10 23:30:52,740 - INFO  - [BookieJournal-39363:JournalChannel@157] - Opening journal /tmp/journal4039890153200764691test/current/173da4885c5.txn
2020-08-10 23:30:52,741 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:52,749 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39363
2020-08-10 23:30:52,997 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39363' has been created.
2020-08-10 23:30:53,036 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39363] for ledger: 0
2020-08-10 23:30:53,046 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39363] for ledger: 1
2020-08-10 23:30:53,055 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39363] for ledger: 2
2020-08-10 23:30:53,072 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x62e57c89, L:/127.0.0.1:42612 - R:127.0.0.1/127.0.0.1:39363]
2020-08-10 23:30:53,072 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39363
2020-08-10 23:30:53,072 - INFO  - [bookie-io-44-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:30:53,073 - INFO  - [bookie-io-44-2:BookieRequestHandler@50] - Channel connected  [id: 0xc5d126f6, L:/127.0.0.1:39363 - R:/127.0.0.1:42612]
2020-08-10 23:30:53,073 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient$1@471] - connection [id: 0x62e57c89, L:/127.0.0.1:42612 - R:127.0.0.1/127.0.0.1:39363] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:30:53,075 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:53,076 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger7799796219791269163test2/current/0.log for logId 0.
2020-08-10 23:30:53,122 - INFO  - [BookieDeathWatcher-37761:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:53,123 - INFO  - [BookieDeathWatcher-37761:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37761
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:53,124 - INFO  - [BookieDeathWatcher-37761:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:53,124 - INFO  - [BookieDeathWatcher-37761:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:53,534 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:53,553 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4184486784274436393test1/current/1.log for logId 1.
2020-08-10 23:30:53,554 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/ledger7799796219791269163test2/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:53,579 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:30:53,936 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:53,938 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4184486784274436393test1/current/2.log for logId 2.
2020-08-10 23:30:53,938 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/ledger4184486784274436393test1/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:53,968 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:30:54,314 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:54,316 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger4184486784274436393test1/current/3.log for logId 3.
2020-08-10 23:30:54,316 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/ledger4184486784274436393test1/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:54,342 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:30:54,442 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:54,442 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/ledger4184486784274436393test1/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:54,442 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:30:54,444 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/ledger7799796219791269163test2/current is out of space. Adding it to filled dirs list
2020-08-10 23:30:54,444 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:30:54,444 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:30:54,445 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:30:54,446 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:30:54,459 - INFO  - [Time-limited test:CompactionTest@468] - Finished deleting the ledgers contains most entries.
2020-08-10 23:30:54,462 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:30:54,463 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:30:54,465 - INFO  - [GarbageCollectorThread-50-1:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = true, reachEntryLogLimit = false
2020-08-10 23:30:54,467 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,468 - INFO  - [GarbageCollectorThread-50-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/ledger7799796219791269163test2/current/4.log for logId 4.
2020-08-10 23:30:54,469 - INFO  - [GarbageCollectorThread-50-1:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/ledger4184486784274436393test1/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:54,469 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,476 - INFO  - [SyncThread-49-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:30:54,476 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,476 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,477 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:30:54,478 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,479 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:30:54,479 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:30:54,484 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,484 - INFO  - [SyncThread-49-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:30:54,485 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,485 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,488 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,488 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:30:54,488 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,488 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:30:54,489 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:30:54,496 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,496 - INFO  - [GarbageCollectorThread-50-1:IndexPersistenceMgr@528] - No ledger 0 found when flushing header.
2020-08-10 23:30:54,496 - INFO  - [GarbageCollectorThread-50-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 104857600 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:54,496 - INFO  - [GarbageCollectorThread-50-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:30:54,496 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:30:54,497 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:30:54,497 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@368] - GarbageCollectorThread-50-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:30:54,497 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:30:54,497 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:30:54,511 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:30:54,512 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:30:54,512 - INFO  - [GarbageCollectorThread-50-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:30:54,523 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:54,523 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39363
2020-08-10 23:30:54,525 - INFO  - [bookkeeper-io-56-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x62e57c89, L:/127.0.0.1:42612 ! R:127.0.0.1/127.0.0.1:39363]
2020-08-10 23:30:54,525 - INFO  - [bookie-io-44-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xc5d126f6, L:/127.0.0.1:39363 ! R:/127.0.0.1:42612]
2020-08-10 23:30:56,628 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:56,629 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:56,635 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39363 with exitCode 0
2020-08-10 23:30:56,635 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:56,636 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:56,636 - INFO  - [SyncThread-49-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095052741 , logFileOffset - 461312]}.
2020-08-10 23:30:56,636 - INFO  - [SyncThread-49-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/ledger4184486784274436393test1/current, /tmp/ledger7799796219791269163test2/current]
2020-08-10 23:30:56,643 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:56,644 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:56,644 - INFO  - [BookieJournal-39363:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:56,644 - INFO  - [BookieJournal-39363:Journal@1144] - Journal exited loop!
2020-08-10 23:30:56,644 - INFO  - [Bookie-39363:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:56,644 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:56,645 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:56,645 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:56,645 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:56,645 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:56,645 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:56,647 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:56,647 - ERROR - [Time-limited test:InterleavedLedgerStorage@294] - Error while closing the ledger cache
org.apache.bookkeeper.bookie.FileInfo$FileInfoDeletedException: FileInfo already deleted
	at org.apache.bookkeeper.bookie.FileInfo.checkOpen(FileInfo.java:284)
	at org.apache.bookkeeper.bookie.FileInfo.close(FileInfo.java:461)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.lambda$closeAllWithoutFlushing$0(FileInfoBackingCache.java:117)
	at org.apache.bookkeeper.util.collections.ConcurrentLongHashMap$Section.forEach(ConcurrentLongHashMap.java:485)
	at org.apache.bookkeeper.util.collections.ConcurrentLongHashMap.forEach(ConcurrentLongHashMap.java:186)
	at org.apache.bookkeeper.bookie.FileInfoBackingCache.closeAllWithoutFlushing(FileInfoBackingCache.java:115)
	at org.apache.bookkeeper.bookie.IndexPersistenceMgr.close(IndexPersistenceMgr.java:346)
	at org.apache.bookkeeper.bookie.LedgerCacheImpl.close(LedgerCacheImpl.java:184)
	at org.apache.bookkeeper.bookie.InterleavedLedgerStorage.shutdown(InterleavedLedgerStorage.java:292)
	at org.apache.bookkeeper.bookie.Bookie.shutdown(Bookie.java:1198)
	at org.apache.bookkeeper.bookie.Bookie.shutdown(Bookie.java:1167)
	at org.apache.bookkeeper.proto.BookieServer.shutdown(BookieServer.java:208)
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.stopBKCluster(BookKeeperClusterTestCase.java:271)
	at org.apache.bookkeeper.test.BookKeeperClusterTestCase.tearDown(BookKeeperClusterTestCase.java:189)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:30:56,648 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:56,649 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:56,873 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompactionWithNoWritableLedgerDirsButIsForceGCAllowWhenNoSpaceIsSet in 2350 ms.
2020-08-10 23:30:56,876 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:30:56,897 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:56,907 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39631/ledgers : zkServers = localhost:39631, ledgersRootPath = /ledgers.
2020-08-10 23:30:56,917 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:56,921 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:56,921 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:56,921 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:56,921 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:56,928 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:30:56,929 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie5808926360793044499test",
  "metadataServiceUri" : "zk://localhost:39631/ledgers",
  "journalDirectories" : "/tmp/bookie5808926360793044499test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:30:56,934 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:39631/ledgers : zkServers = localhost:39631, ledgersRootPath = /ledgers.
2020-08-10 23:30:56,939 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:56,943 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:56,952 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie5808926360793044499test/current] [/tmp/bookie5808926360793044499test/current]
2020-08-10 23:30:56,965 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:56,967 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie5808926360793044499test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:56,968 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:56,968 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:56,969 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:56,971 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:56,971 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:30:56,971 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:30:56,986 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39155 to become writable
2020-08-10 23:30:56,987 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:30:56,990 - INFO  - [SyncThread-71-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:56,994 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:56,996 - INFO  - [BookieJournal-39155:Journal@909] - Starting journal on /tmp/bookie5808926360793044499test/current
2020-08-10 23:30:56,997 - INFO  - [BookieJournal-39155:JournalChannel@157] - Opening journal /tmp/bookie5808926360793044499test/current/173da489666.txn
2020-08-10 23:30:56,998 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:57,005 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39155
2020-08-10 23:30:57,258 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39155' has been created.
2020-08-10 23:30:57,259 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionSafety @ metadata service zk://localhost:39631/ledgers in 383 ms.
2020-08-10 23:30:57,260 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:57,367 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:57,367 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:57,373 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39155 with exitCode 0
2020-08-10 23:30:57,374 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:30:57,374 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:30:57,374 - INFO  - [SyncThread-71-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:57,378 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:30:57,380 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:30:57,380 - INFO  - [BookieJournal-39155:Journal@1135] - Journal exits when shutting down
2020-08-10 23:30:57,380 - INFO  - [BookieJournal-39155:Journal@1144] - Journal exited loop!
2020-08-10 23:30:57,380 - INFO  - [Bookie-39155:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:30:57,381 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:30:57,381 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:57,381 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:57,382 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:57,382 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:57,382 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:57,382 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:57,382 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:57,383 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:30:57,606 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSafety in 346 ms.
2020-08-10 23:30:57,609 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:57,609 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:30:57,612 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:57,612 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:30:57,612 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:30:57,615 - INFO  - [Time-limited test:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:57,616 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest12830457959953615539.dir/current/0.log for logId 0.
2020-08-10 23:30:57,620 - INFO  - [pool-49-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest12830457959953615539.dir/current/1.log for logId 1.
2020-08-10 23:30:57,621 - INFO  - [Time-limited test:IndexInMemPageMgr@507] - Could not grab a clean page for ledger 2, entry 0, force flushing dirty ledgers.
2020-08-10 23:30:57,627 - INFO  - [Time-limited test:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:30:57,628 - INFO  - [Time-limited test:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bkTest12830457959953615539.dir/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:30:57,629 - INFO  - [pool-49-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest12830457959953615539.dir/current/2.log for logId 2.
2020-08-10 23:30:57,629 - INFO  - [Time-limited test:IndexInMemPageMgr@507] - Could not grab a clean page for ledger 3, entry 0, force flushing dirty ledgers.
2020-08-10 23:30:57,652 - INFO  - [Time-limited test:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:30:57,653 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:57,653 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:57,653 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:57,657 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:57,658 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:57,660 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:57,665 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:57,672 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:57,673 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:30:57,675 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:57,675 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:30:57,675 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:30:57,755 - INFO  - [BookieDeathWatcher-39363:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:57,756 - INFO  - [BookieDeathWatcher-39363:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39363
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:57,756 - INFO  - [BookieDeathWatcher-39363:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:57,756 - INFO  - [BookieDeathWatcher-39363:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:57,776 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:30:57,777 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:30:57,778 - INFO  - [GarbageCollectorThread-77-1:EntryLogger@1043] - Failed to get ledgers map index from: 1.log : No ledgers map index found on entryLogId1
2020-08-10 23:30:57,779 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:30:57,780 - INFO  - [GarbageCollectorThread-77-1:EntryLogger@1043] - Failed to get ledgers map index from: 2.log : readerIndex(0) + length(4) exceeds writerIndex(0): UnpooledByteBufAllocator$InstrumentedUnpooledUnsafeDirectByteBuf(ridx: 0, widx: 0, cap: 1024)
2020-08-10 23:30:57,783 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@396] - Deleting entryLogId 1 as it has no active ledgers!
2020-08-10 23:30:57,784 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:30:58,011 - INFO  - [BookieDeathWatcher-39155:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:30:58,011 - INFO  - [BookieDeathWatcher-39155:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39155
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:30:58,011 - INFO  - [BookieDeathWatcher-39155:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:30:58,011 - INFO  - [BookieDeathWatcher-39155:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:30:58,677 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:30:58,677 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.699999988079071
2020-08-10 23:30:58,678 - INFO  - [GarbageCollectorThread-77-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:30:58,679 - INFO  - [GarbageCollectorThread-77-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest12830457959953615539.dir/current/3.log for logId 3.
2020-08-10 23:30:58,680 - INFO  - [pool-50-thread-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bkTest12830457959953615539.dir/current/4.log for logId 4.
2020-08-10 23:30:58,701 - INFO  - [GarbageCollectorThread-77-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:30:58,702 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:30:58,702 - INFO  - [GarbageCollectorThread-77-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 1, 0, 0, 0, 0, 0]
2020-08-10 23:30:59,684 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:30:59,684 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:30:59,684 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:30:59,684 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:30:59,684 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:30:59,689 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:30:59,692 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:30:59,693 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:59,694 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 1
2020-08-10 23:30:59,696 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:59,696 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.699999988079071, interval=1000
2020-08-10 23:30:59,696 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=10000
2020-08-10 23:30:59,697 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:30:59,699 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSafety in 1 ms.
2020-08-10 23:30:59,701 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:30:59,724 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:59,735 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45097/ledgers : zkServers = localhost:45097, ledgersRootPath = /ledgers.
2020-08-10 23:30:59,746 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:59,750 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:30:59,752 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:30:59,752 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:30:59,752 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:30:59,761 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:30:59,761 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie512247334507565197test",
  "metadataServiceUri" : "zk://localhost:45097/ledgers",
  "journalDirectories" : "/tmp/bookie512247334507565197test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:30:59,766 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45097/ledgers : zkServers = localhost:45097, ledgersRootPath = /ledgers.
2020-08-10 23:30:59,773 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:30:59,776 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:30:59,786 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie512247334507565197test/current] [/tmp/bookie512247334507565197test/current]
2020-08-10 23:30:59,801 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:30:59,803 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie512247334507565197test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:30:59,804 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:30:59,804 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:30:59,805 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:30:59,807 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:30:59,808 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:30:59,808 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:30:59,819 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:44845 to become writable
2020-08-10 23:30:59,822 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:30:59,823 - INFO  - [SyncThread-90-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:30:59,826 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:30:59,828 - INFO  - [BookieJournal-44845:Journal@909] - Starting journal on /tmp/bookie512247334507565197test/current
2020-08-10 23:30:59,830 - INFO  - [BookieJournal-44845:JournalChannel@157] - Opening journal /tmp/bookie512247334507565197test/current/173da48a176.txn
2020-08-10 23:30:59,830 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:30:59,838 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:44845
2020-08-10 23:31:00,087 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:44845' has been created.
2020-08-10 23:31:00,089 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionPersistence @ metadata service zk://localhost:45097/ledgers in 388 ms.
2020-08-10 23:31:00,117 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44845] for ledger: 0
2020-08-10 23:31:00,126 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44845] for ledger: 1
2020-08-10 23:31:00,133 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:44845] for ledger: 2
2020-08-10 23:31:00,138 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x151411ef, L:/127.0.0.1:41148 - R:127.0.0.1/127.0.0.1:44845]
2020-08-10 23:31:00,138 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:44845
2020-08-10 23:31:00,138 - INFO  - [bookie-io-85-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:00,139 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient$1@471] - connection [id: 0x151411ef, L:/127.0.0.1:41148 - R:127.0.0.1/127.0.0.1:44845] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:00,139 - INFO  - [bookie-io-85-2:BookieRequestHandler@50] - Channel connected  [id: 0xcc3622e7, L:/127.0.0.1:44845 - R:/127.0.0.1:41148]
2020-08-10 23:31:00,141 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:00,141 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie512247334507565197test/current/0.log for logId 0.
2020-08-10 23:31:00,499 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:00,501 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie512247334507565197test/current/1.log for logId 1.
2020-08-10 23:31:00,502 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie512247334507565197test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:00,538 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:31:00,827 - INFO  - [GarbageCollectorThread-91-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:00,861 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:00,862 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie512247334507565197test/current/2.log for logId 2.
2020-08-10 23:31:00,864 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie512247334507565197test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:00,889 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:01,215 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:01,216 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie512247334507565197test/current/3.log for logId 3.
2020-08-10 23:31:01,217 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie512247334507565197test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:01,241 - INFO  - [SyncThread-90-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:01,315 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:01,315 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:01,316 - WARN  - [bookkeeper-io-81-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x151411ef, L:/127.0.0.1:41148 - R:127.0.0.1/127.0.0.1:44845] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:01,316 - INFO  - [bookkeeper-io-81-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x151411ef, L:/127.0.0.1:41148 ! R:127.0.0.1/127.0.0.1:44845]
2020-08-10 23:31:01,320 - INFO  - [bookie-io-85-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xcc3622e7, L:/127.0.0.1:44845 ! R:/127.0.0.1:41148]
2020-08-10 23:31:01,322 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-44845 with exitCode 0
2020-08-10 23:31:01,322 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:01,322 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:01,329 - INFO  - [SyncThread-90-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095059830 , logFileOffset - 461824]}.
2020-08-10 23:31:01,333 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:01,333 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:01,334 - INFO  - [BookieJournal-44845:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:01,334 - INFO  - [BookieJournal-44845:Journal@1144] - Journal exited loop!
2020-08-10 23:31:01,334 - INFO  - [Bookie-44845:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:01,334 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:01,335 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:01,335 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:01,335 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:01,336 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:01,336 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:01,337 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:01,343 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:01,344 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:01,454 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:44845
2020-08-10 23:31:01,838 - INFO  - [BookieDeathWatcher-44845:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:01,838 - INFO  - [BookieDeathWatcher-44845:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44845
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:01,838 - INFO  - [BookieDeathWatcher-44845:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:01,838 - INFO  - [BookieDeathWatcher-44845:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:02,458 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie512247334507565197test",
  "metadataServiceUri" : "zk://localhost:45097/ledgers",
  "journalDirectories" : "/tmp/bookie512247334507565197test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "44845",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.0",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:02,466 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:45097/ledgers : zkServers = localhost:45097, ledgersRootPath = /ledgers.
2020-08-10 23:31:02,482 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:02,487 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:02,500 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:02,504 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:02,504 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:02,505 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:02,506 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:02,506 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:31:02,507 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:31:02,527 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:44845 to become writable
2020-08-10 23:31:02,527 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095059830 from position 461824
2020-08-10 23:31:02,527 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie512247334507565197test/current/173da48a176.txn
2020-08-10 23:31:02,528 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:02,528 - INFO  - [SyncThread-100-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095059830 , logFileOffset - 461828]}.
2020-08-10 23:31:02,531 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:02,535 - INFO  - [BookieJournal-44845:Journal@909] - Starting journal on /tmp/bookie512247334507565197test/current
2020-08-10 23:31:02,536 - INFO  - [BookieJournal-44845:JournalChannel@157] - Opening journal /tmp/bookie512247334507565197test/current/173da48a177.txn
2020-08-10 23:31:02,536 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:02,543 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:44845
2020-08-10 23:31:02,794 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:44845' has been created.
2020-08-10 23:31:02,803 - INFO  - [Time-limited test:CompactionTest@584] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:02,804 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:31:02,805 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:02,805 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:02,805 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:02,806 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:02,806 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:02,806 - INFO  - [GarbageCollectorThread-101-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:31:02,816 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:31:02,817 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:02,817 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:02,817 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:02,817 - INFO  - [GarbageCollectorThread-101-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:02,818 - INFO  - [GarbageCollectorThread-101-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie512247334507565197test/current/4.log for logId 4.
2020-08-10 23:31:02,826 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:31:02,826 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:31:02,835 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:31:02,836 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:31:02,845 - INFO  - [GarbageCollectorThread-101-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:31:02,845 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:31:02,845 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 3, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:02,845 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@368] - GarbageCollectorThread-101-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:31:02,845 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:02,856 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:02,857 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:02,857 - INFO  - [GarbageCollectorThread-101-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:02,862 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc3c52ba5, L:/127.0.0.1:41152 - R:127.0.0.1/127.0.0.1:44845]
2020-08-10 23:31:02,862 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:44845
2020-08-10 23:31:02,862 - INFO  - [bookie-io-95-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:02,863 - INFO  - [bookie-io-95-2:BookieRequestHandler@50] - Channel connected  [id: 0xfb442a78, L:/127.0.0.1:44845 - R:/127.0.0.1:41152]
2020-08-10 23:31:02,863 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient$1@471] - connection [id: 0xc3c52ba5, L:/127.0.0.1:41152 - R:127.0.0.1/127.0.0.1:44845] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:02,891 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:02,892 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:02,892 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:02,894 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:02,894 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:31:02,894 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:31:02,905 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:02,905 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:44845
2020-08-10 23:31:02,905 - INFO  - [bookkeeper-io-81-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc3c52ba5, L:/127.0.0.1:41152 ! R:127.0.0.1/127.0.0.1:44845]
2020-08-10 23:31:02,906 - INFO  - [bookie-io-95-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xfb442a78, L:/127.0.0.1:44845 ! R:/127.0.0.1:41152]
2020-08-10 23:31:04,993 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:04,993 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:04,998 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-44845 with exitCode 0
2020-08-10 23:31:04,998 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:04,998 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:04,999 - INFO  - [SyncThread-100-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095059830 , logFileOffset - 461828]}.
2020-08-10 23:31:05,004 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:05,005 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:05,005 - INFO  - [BookieJournal-44845:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:05,005 - INFO  - [BookieJournal-44845:Journal@1144] - Journal exited loop!
2020-08-10 23:31:05,005 - INFO  - [Bookie-44845:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:05,006 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:05,008 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:05,009 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:05,009 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:05,230 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionPersistence in 2325 ms.
2020-08-10 23:31:05,232 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:05,248 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:05,258 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44571/ledgers : zkServers = localhost:44571, ledgersRootPath = /ledgers.
2020-08-10 23:31:05,265 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:05,268 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:05,269 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:05,270 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:05,270 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:05,287 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:05,288 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7940126679214851642test",
  "metadataServiceUri" : "zk://localhost:44571/ledgers",
  "journalDirectories" : "/tmp/bookie7940126679214851642test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:05,293 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44571/ledgers : zkServers = localhost:44571, ledgersRootPath = /ledgers.
2020-08-10 23:31:05,298 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:05,302 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:05,310 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7940126679214851642test/current] [/tmp/bookie7940126679214851642test/current]
2020-08-10 23:31:05,322 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:05,324 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7940126679214851642test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:05,324 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:05,324 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:05,325 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:05,326 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:05,327 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:05,328 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:05,339 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37917 to become writable
2020-08-10 23:31:05,341 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:05,342 - INFO  - [SyncThread-119-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:05,348 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:05,349 - INFO  - [BookieJournal-37917:Journal@909] - Starting journal on /tmp/bookie7940126679214851642test/current
2020-08-10 23:31:05,350 - INFO  - [BookieJournal-37917:JournalChannel@157] - Opening journal /tmp/bookie7940126679214851642test/current/173da48b707.txn
2020-08-10 23:31:05,350 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:05,356 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37917
2020-08-10 23:31:05,544 - INFO  - [BookieDeathWatcher-44845:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:05,545 - INFO  - [BookieDeathWatcher-44845:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-44845
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:05,545 - INFO  - [BookieDeathWatcher-44845:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:05,546 - INFO  - [BookieDeathWatcher-44845:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:05,607 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37917' has been created.
2020-08-10 23:31:05,609 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testForceGarbageCollection @ metadata service zk://localhost:44571/ledgers in 377 ms.
2020-08-10 23:31:05,613 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:44571/ledgers : zkServers = localhost:44571, ledgersRootPath = /ledgers.
2020-08-10 23:31:05,623 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:05,628 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:05,628 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:05,630 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:05,630 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:31:05,630 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:31:05,631 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:31:05,631 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:05,639 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:05,640 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:05,640 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:05,640 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@368] - GarbageCollectorThread-127-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:31:05,640 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:05,643 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:05,644 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:05,644 - INFO  - [GarbageCollectorThread-127-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:05,647 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:05,647 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:05,647 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:05,647 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:05,648 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:05,648 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:05,648 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:05,756 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:05,865 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:05,865 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:05,872 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37917 with exitCode 0
2020-08-10 23:31:05,872 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:05,873 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:05,873 - INFO  - [SyncThread-119-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:05,876 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:05,877 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:05,878 - INFO  - [BookieJournal-37917:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:05,878 - INFO  - [BookieJournal-37917:Journal@1144] - Journal exited loop!
2020-08-10 23:31:05,878 - INFO  - [Bookie-37917:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:05,878 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:05,879 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:05,879 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:05,879 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:05,879 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:05,880 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:05,880 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:05,880 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:05,880 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:06,101 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testForceGarbageCollection in 345 ms.
2020-08-10 23:31:06,103 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:06,118 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:06,144 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41289/ledgers : zkServers = localhost:41289, ledgersRootPath = /ledgers.
2020-08-10 23:31:06,156 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:06,160 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:06,161 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:06,161 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:06,161 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:06,170 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:06,170 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie717737948548237562test",
  "metadataServiceUri" : "zk://localhost:41289/ledgers",
  "journalDirectories" : "/tmp/bookie717737948548237562test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:06,174 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41289/ledgers : zkServers = localhost:41289, ledgersRootPath = /ledgers.
2020-08-10 23:31:06,180 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:06,187 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:06,194 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie717737948548237562test/current] [/tmp/bookie717737948548237562test/current]
2020-08-10 23:31:06,206 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:06,208 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie717737948548237562test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:06,208 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:06,209 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:06,209 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:06,210 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:06,210 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:06,210 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:06,223 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38177 to become writable
2020-08-10 23:31:06,224 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:06,224 - INFO  - [SyncThread-139-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:06,228 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:06,229 - INFO  - [BookieJournal-38177:Journal@909] - Starting journal on /tmp/bookie717737948548237562test/current
2020-08-10 23:31:06,230 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:06,230 - INFO  - [BookieJournal-38177:JournalChannel@157] - Opening journal /tmp/bookie717737948548237562test/current/173da48ba77.txn
2020-08-10 23:31:06,237 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38177
2020-08-10 23:31:06,358 - INFO  - [BookieDeathWatcher-37917:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:06,358 - INFO  - [BookieDeathWatcher-37917:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37917
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:06,358 - INFO  - [BookieDeathWatcher-37917:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:06,358 - INFO  - [BookieDeathWatcher-37917:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:06,487 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38177' has been created.
2020-08-10 23:31:06,489 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompactionWithNoWritableLedgerDirs @ metadata service zk://localhost:41289/ledgers in 386 ms.
2020-08-10 23:31:06,514 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38177] for ledger: 0
2020-08-10 23:31:06,522 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38177] for ledger: 1
2020-08-10 23:31:06,529 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:38177] for ledger: 2
2020-08-10 23:31:06,533 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x5fae47c3, L:/127.0.0.1:50300 - R:127.0.0.1/127.0.0.1:38177]
2020-08-10 23:31:06,533 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:38177
2020-08-10 23:31:06,533 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient$1@471] - connection [id: 0x5fae47c3, L:/127.0.0.1:50300 - R:127.0.0.1/127.0.0.1:38177] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:06,535 - INFO  - [bookie-io-134-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:06,535 - INFO  - [bookie-io-134-2:BookieRequestHandler@50] - Channel connected  [id: 0x9ca75d04, L:/127.0.0.1:38177 - R:/127.0.0.1:50300]
2020-08-10 23:31:06,536 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:06,536 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie717737948548237562test/current/0.log for logId 0.
2020-08-10 23:31:06,919 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:06,929 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie717737948548237562test/current/1.log for logId 1.
2020-08-10 23:31:06,930 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie717737948548237562test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:06,957 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:31:07,229 - INFO  - [GarbageCollectorThread-140-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:07,337 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:07,338 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie717737948548237562test/current/2.log for logId 2.
2020-08-10 23:31:07,338 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie717737948548237562test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:07,368 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:07,761 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:07,763 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie717737948548237562test/current/3.log for logId 3.
2020-08-10 23:31:07,763 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie717737948548237562test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:07,791 - INFO  - [SyncThread-139-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:07,856 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:07,856 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:07,857 - WARN  - [bookkeeper-io-130-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x5fae47c3, L:/127.0.0.1:50300 - R:127.0.0.1/127.0.0.1:38177] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:07,858 - ERROR - [bookie-io-134-2:DefaultPromise@770] - Failed to submit a listener notification task. Event loop shut down?
java.util.concurrent.RejectedExecutionException: event executor terminated
	at io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:867)
	at io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:328)
	at io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:321)
	at io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:778)
	at io.netty.util.concurrent.DefaultPromise.safeExecute(DefaultPromise.java:768)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:432)
	at io.netty.util.concurrent.DefaultPromise.setSuccess(DefaultPromise.java:94)
	at io.netty.channel.group.DefaultChannelGroupFuture.setSuccess0(DefaultChannelGroupFuture.java:205)
	at io.netty.channel.group.DefaultChannelGroupFuture.access$400(DefaultChannelGroupFuture.java:40)
	at io.netty.channel.group.DefaultChannelGroupFuture$1.operationComplete(DefaultChannelGroupFuture.java:74)
	at io.netty.channel.group.DefaultChannelGroupFuture$1.operationComplete(DefaultChannelGroupFuture.java:47)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:485)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)
	at io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)
	at io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetSuccess(AbstractChannel.java:982)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.doClose0(AbstractChannel.java:769)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:744)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:615)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.close(DefaultChannelPipeline.java:1376)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)
	at io.netty.channel.ChannelOutboundHandlerAdapter.close(ChannelOutboundHandlerAdapter.java:71)
	at io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)
	at io.netty.channel.AbstractChannelHandlerContext.access$1100(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$13.run(AbstractChannelHandlerContext.java:613)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:335)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:07,858 - INFO  - [bookie-io-134-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x9ca75d04, L:/127.0.0.1:38177 ! R:/127.0.0.1:50300]
2020-08-10 23:31:07,858 - INFO  - [bookkeeper-io-130-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x5fae47c3, L:/127.0.0.1:50300 ! R:127.0.0.1/127.0.0.1:38177]
2020-08-10 23:31:07,865 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38177 with exitCode 0
2020-08-10 23:31:07,866 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:07,866 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:07,874 - INFO  - [SyncThread-139-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095066231 , logFileOffset - 461312]}.
2020-08-10 23:31:07,877 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:07,878 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:07,879 - INFO  - [BookieJournal-38177:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:07,879 - INFO  - [BookieJournal-38177:Journal@1144] - Journal exited loop!
2020-08-10 23:31:07,880 - INFO  - [Bookie-38177:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:07,880 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:07,880 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:07,881 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:07,881 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:07,881 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:07,881 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:07,882 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:07,884 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:07,884 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:07,893 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:38177
2020-08-10 23:31:08,244 - INFO  - [BookieDeathWatcher-38177:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:08,244 - INFO  - [BookieDeathWatcher-38177:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38177
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:08,244 - INFO  - [BookieDeathWatcher-38177:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:08,244 - INFO  - [BookieDeathWatcher-38177:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:08,992 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie717737948548237562test",
  "metadataServiceUri" : "zk://localhost:41289/ledgers",
  "journalDirectories" : "/tmp/bookie717737948548237562test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "38177",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:08,996 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41289/ledgers : zkServers = localhost:41289, ledgersRootPath = /ledgers.
2020-08-10 23:31:09,002 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:09,009 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:09,022 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:09,025 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:09,026 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:09,026 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:09,028 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:09,028 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:31:09,028 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:31:09,047 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38177 to become writable
2020-08-10 23:31:09,052 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095066231 from position 461312
2020-08-10 23:31:09,052 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie717737948548237562test/current/173da48ba77.txn
2020-08-10 23:31:09,052 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:09,053 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095066231 , logFileOffset - 461316]}.
2020-08-10 23:31:09,057 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:09,059 - INFO  - [BookieJournal-38177:Journal@909] - Starting journal on /tmp/bookie717737948548237562test/current
2020-08-10 23:31:09,059 - INFO  - [BookieJournal-38177:JournalChannel@157] - Opening journal /tmp/bookie717737948548237562test/current/173da48ba78.txn
2020-08-10 23:31:09,060 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:09,066 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38177
2020-08-10 23:31:09,319 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38177' has been created.
2020-08-10 23:31:09,319 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/bookie717737948548237562test/current is out of space. Adding it to filled dirs list
2020-08-10 23:31:09,319 - INFO  - [Time-limited test:GarbageCollectorThread@272] - Suspend Major Compaction triggered by thread: Time-limited test
2020-08-10 23:31:09,319 - INFO  - [Time-limited test:GarbageCollectorThread@285] - Suspend Minor Compaction triggered by thread: Time-limited test
2020-08-10 23:31:09,328 - INFO  - [Time-limited test:CompactionTest@397] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:09,329 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:09,330 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:09,330 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:09,330 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:09,331 - INFO  - [GarbageCollectorThread-150-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:31:09,340 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:31:09,340 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:09,341 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:09,341 - INFO  - [GarbageCollectorThread-150-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:09,341 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:09,341 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:38177
2020-08-10 23:31:09,452 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:09,452 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:09,459 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38177 with exitCode 0
2020-08-10 23:31:09,459 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:09,459 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:09,460 - INFO  - [SyncThread-149-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095066231 , logFileOffset - 461316]}.
2020-08-10 23:31:09,460 - INFO  - [SyncThread-149-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 102400 are: [/tmp/bookie717737948548237562test/current]
2020-08-10 23:31:09,467 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:09,468 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:09,468 - INFO  - [BookieJournal-38177:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:09,468 - INFO  - [BookieJournal-38177:Journal@1144] - Journal exited loop!
2020-08-10 23:31:09,468 - INFO  - [Bookie-38177:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:09,468 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:09,469 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:09,469 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:09,469 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:09,470 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:09,470 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:09,470 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:09,470 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:09,470 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:09,694 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompactionWithNoWritableLedgerDirs in 353 ms.
2020-08-10 23:31:09,696 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:09,717 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:09,727 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36079/ledgers : zkServers = localhost:36079, ledgersRootPath = /ledgers.
2020-08-10 23:31:09,736 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:09,739 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:09,740 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:09,740 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:09,740 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:09,749 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:09,750 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie15074185666437235517test",
  "metadataServiceUri" : "zk://localhost:36079/ledgers",
  "journalDirectories" : "/tmp/bookie15074185666437235517test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:09,757 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36079/ledgers : zkServers = localhost:36079, ledgersRootPath = /ledgers.
2020-08-10 23:31:09,763 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:09,766 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:09,773 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie15074185666437235517test/current] [/tmp/bookie15074185666437235517test/current]
2020-08-10 23:31:09,784 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:09,786 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie15074185666437235517test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:09,786 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:09,787 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:09,787 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:09,789 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:09,789 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:09,789 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:09,801 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34189 to become writable
2020-08-10 23:31:09,802 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:09,803 - INFO  - [SyncThread-165-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:09,807 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:09,808 - INFO  - [BookieJournal-34189:Journal@909] - Starting journal on /tmp/bookie15074185666437235517test/current
2020-08-10 23:31:09,809 - INFO  - [BookieJournal-34189:JournalChannel@157] - Opening journal /tmp/bookie15074185666437235517test/current/173da48c872.txn
2020-08-10 23:31:09,809 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:09,816 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34189
2020-08-10 23:31:10,065 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34189' has been created.
2020-08-10 23:31:10,067 - INFO  - [BookieDeathWatcher-38177:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:10,067 - INFO  - [BookieDeathWatcher-38177:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38177
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:10,067 - INFO  - [BookieDeathWatcher-38177:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:10,067 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testDisableCompaction @ metadata service zk://localhost:36079/ledgers in 370 ms.
2020-08-10 23:31:10,067 - INFO  - [BookieDeathWatcher-38177:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:10,097 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34189] for ledger: 0
2020-08-10 23:31:10,105 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34189] for ledger: 1
2020-08-10 23:31:10,112 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34189] for ledger: 2
2020-08-10 23:31:10,116 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xe029ade1, L:/127.0.0.1:51128 - R:127.0.0.1/127.0.0.1:34189]
2020-08-10 23:31:10,116 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34189
2020-08-10 23:31:10,117 - INFO  - [bookie-io-160-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:10,117 - INFO  - [bookie-io-160-2:BookieRequestHandler@50] - Channel connected  [id: 0xf91b6beb, L:/127.0.0.1:34189 - R:/127.0.0.1:51128]
2020-08-10 23:31:10,117 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient$1@471] - connection [id: 0xe029ade1, L:/127.0.0.1:51128 - R:127.0.0.1/127.0.0.1:34189] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:10,118 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:10,119 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15074185666437235517test/current/0.log for logId 0.
2020-08-10 23:31:10,450 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:10,451 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15074185666437235517test/current/1.log for logId 1.
2020-08-10 23:31:10,451 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie15074185666437235517test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:10,484 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:31:10,789 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:10,790 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15074185666437235517test/current/2.log for logId 2.
2020-08-10 23:31:10,790 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie15074185666437235517test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:10,808 - INFO  - [GarbageCollectorThread-166-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:10,820 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:11,125 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:11,127 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie15074185666437235517test/current/3.log for logId 3.
2020-08-10 23:31:11,127 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie15074185666437235517test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:11,152 - INFO  - [SyncThread-165-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:11,204 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:11,204 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:11,205 - INFO  - [bookie-io-160-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xf91b6beb, L:/127.0.0.1:34189 ! R:/127.0.0.1:51128]
2020-08-10 23:31:11,205 - WARN  - [bookkeeper-io-156-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xe029ade1, L:/127.0.0.1:51128 - R:127.0.0.1/127.0.0.1:34189] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:11,207 - INFO  - [bookkeeper-io-156-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xe029ade1, L:/127.0.0.1:51128 ! R:127.0.0.1/127.0.0.1:34189]
2020-08-10 23:31:11,216 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34189 with exitCode 0
2020-08-10 23:31:11,216 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:11,216 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:11,224 - INFO  - [SyncThread-165-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095069810 , logFileOffset - 461312]}.
2020-08-10 23:31:11,227 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:11,228 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:11,228 - INFO  - [BookieJournal-34189:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:11,228 - INFO  - [BookieJournal-34189:Journal@1144] - Journal exited loop!
2020-08-10 23:31:11,229 - INFO  - [Bookie-34189:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:11,229 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:11,230 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:11,230 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:11,230 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:11,230 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:11,230 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:11,232 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:11,233 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:11,233 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:11,243 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34189
2020-08-10 23:31:12,052 - INFO  - [BookieDeathWatcher-34189:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:12,052 - INFO  - [BookieDeathWatcher-34189:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34189
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:12,053 - INFO  - [BookieDeathWatcher-34189:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:12,053 - INFO  - [BookieDeathWatcher-34189:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:12,348 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie15074185666437235517test",
  "metadataServiceUri" : "zk://localhost:36079/ledgers",
  "journalDirectories" : "/tmp/bookie15074185666437235517test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "34189",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:12,352 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36079/ledgers : zkServers = localhost:36079, ledgersRootPath = /ledgers.
2020-08-10 23:31:12,362 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:12,366 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:12,380 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:12,382 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:12,382 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:12,383 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:12,384 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:12,385 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:31:12,385 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:31:12,398 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34189 to become writable
2020-08-10 23:31:12,398 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095069810 from position 461312
2020-08-10 23:31:12,399 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie15074185666437235517test/current/173da48c872.txn
2020-08-10 23:31:12,399 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:12,399 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095069810 , logFileOffset - 461316]}.
2020-08-10 23:31:12,403 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:12,406 - INFO  - [BookieJournal-34189:Journal@909] - Starting journal on /tmp/bookie15074185666437235517test/current
2020-08-10 23:31:12,406 - INFO  - [BookieJournal-34189:JournalChannel@157] - Opening journal /tmp/bookie15074185666437235517test/current/173da48c873.txn
2020-08-10 23:31:12,407 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:12,413 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34189
2020-08-10 23:31:12,663 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34189' has been created.
2020-08-10 23:31:12,670 - INFO  - [Time-limited test:CompactionTest@214] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:12,671 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:12,672 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:12,672 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:12,673 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:12,673 - INFO  - [GarbageCollectorThread-176-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:31:12,682 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:31:12,683 - INFO  - [GarbageCollectorThread-176-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:12,683 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:12,683 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:34189
2020-08-10 23:31:12,791 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:12,792 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:12,800 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34189 with exitCode 0
2020-08-10 23:31:12,800 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:12,800 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:12,800 - INFO  - [SyncThread-175-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095069810 , logFileOffset - 461316]}.
2020-08-10 23:31:12,804 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:12,807 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:12,808 - INFO  - [BookieJournal-34189:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:12,808 - INFO  - [BookieJournal-34189:Journal@1144] - Journal exited loop!
2020-08-10 23:31:12,808 - INFO  - [Bookie-34189:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:12,808 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:12,809 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:12,809 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:12,809 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:12,809 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:12,810 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:12,810 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:12,810 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:12,810 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:13,046 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testDisableCompaction in 362 ms.
2020-08-10 23:31:13,048 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:13,063 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:13,071 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40601/ledgers : zkServers = localhost:40601, ledgersRootPath = /ledgers.
2020-08-10 23:31:13,078 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:13,085 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:13,086 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:13,086 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:13,086 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:13,093 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:13,094 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie7635295942495883112test",
  "metadataServiceUri" : "zk://localhost:40601/ledgers",
  "journalDirectories" : "/tmp/bookie7635295942495883112test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:13,099 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40601/ledgers : zkServers = localhost:40601, ledgersRootPath = /ledgers.
2020-08-10 23:31:13,108 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:13,113 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:13,125 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie7635295942495883112test/current] [/tmp/bookie7635295942495883112test/current]
2020-08-10 23:31:13,139 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:13,141 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie7635295942495883112test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:13,141 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:13,142 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:13,142 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:13,143 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:13,143 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:13,144 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:13,154 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:40091 to become writable
2020-08-10 23:31:13,155 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:13,155 - INFO  - [SyncThread-191-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:13,160 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:13,161 - INFO  - [BookieJournal-40091:Journal@909] - Starting journal on /tmp/bookie7635295942495883112test/current
2020-08-10 23:31:13,162 - INFO  - [BookieJournal-40091:JournalChannel@157] - Opening journal /tmp/bookie7635295942495883112test/current/173da48d58b.txn
2020-08-10 23:31:13,162 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:13,169 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:40091
2020-08-10 23:31:13,417 - INFO  - [BookieDeathWatcher-34189:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:13,417 - INFO  - [BookieDeathWatcher-34189:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34189
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:13,418 - INFO  - [BookieDeathWatcher-34189:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:13,418 - INFO  - [BookieDeathWatcher-34189:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:13,418 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:40091' has been created.
2020-08-10 23:31:13,420 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testSuspendGarbageCollection @ metadata service zk://localhost:40601/ledgers in 372 ms.
2020-08-10 23:31:13,422 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40601/ledgers : zkServers = localhost:40601, ledgersRootPath = /ledgers.
2020-08-10 23:31:13,427 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:13,430 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:13,431 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:13,432 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:13,432 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=1000
2020-08-10 23:31:13,433 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=2000
2020-08-10 23:31:14,438 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:14,439 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:14,439 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:15,171 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:15,172 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:15,172 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:15,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:15,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:15,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:15,934 - INFO  - [Time-limited test:GarbageCollectorThread@272] - Suspend Major Compaction triggered by thread: Time-limited test
2020-08-10 23:31:16,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:16,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:16,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:16,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:16,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:17,167 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:17,167 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:17,168 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:17,435 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:17,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:18,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:18,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:18,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:18,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:18,938 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:19,441 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:19,442 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:19,442 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:19,442 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:19,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:20,169 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:20,169 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:20,169 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:20,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:20,936 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:20,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:20,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:20,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:20,939 - INFO  - [Time-limited test:GarbageCollectorThread@285] - Suspend Minor Compaction triggered by thread: Time-limited test
2020-08-10 23:31:21,439 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:21,440 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:21,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:21,938 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:22,171 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:22,171 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:22,171 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:22,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:22,437 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:22,939 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:22,939 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:23,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:23,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:23,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:23,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:24,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@337] - Disk almost full, suspend major compaction to slow down filling disk.
2020-08-10 23:31:24,436 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@340] - Disk full, suspend minor compaction to slow down filling disk.
2020-08-10 23:31:24,441 - INFO  - [Time-limited test:GarbageCollectorThread@291] - Time-limited test Minor Compaction back to normal since bookie has enough space now.
2020-08-10 23:31:24,441 - INFO  - [Time-limited test:GarbageCollectorThread@278] - Time-limited test Major Compaction back to normal since bookie has enough space now.
2020-08-10 23:31:24,937 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:24,938 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:24,938 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:25,168 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:25,169 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:25,169 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:25,940 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:25,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:25,941 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:27,438 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:27,438 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:27,439 - INFO  - [GarbageCollectorThread-199-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:27,440 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:27,440 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:27,440 - INFO  - [GarbageCollectorThread-192-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:28,562 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:28,690 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:28,691 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:28,694 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-40091 with exitCode 0
2020-08-10 23:31:28,695 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:28,695 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:28,695 - INFO  - [SyncThread-191-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:28,705 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:28,705 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:28,706 - INFO  - [BookieJournal-40091:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:28,706 - INFO  - [BookieJournal-40091:Journal@1144] - Journal exited loop!
2020-08-10 23:31:28,706 - INFO  - [Bookie-40091:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:28,706 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:28,707 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:28,707 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:28,707 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:28,707 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:28,707 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:28,708 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:28,708 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:28,708 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:28,931 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testSuspendGarbageCollection in 369 ms.
2020-08-10 23:31:28,933 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:28,959 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:28,971 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40647/ledgers : zkServers = localhost:40647, ledgersRootPath = /ledgers.
2020-08-10 23:31:28,984 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:28,987 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:28,988 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:28,988 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:28,988 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:29,004 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:29,005 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie1365800519097453574test",
  "metadataServiceUri" : "zk://localhost:40647/ledgers",
  "journalDirectories" : "/tmp/bookie1365800519097453574test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:29,009 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40647/ledgers : zkServers = localhost:40647, ledgersRootPath = /ledgers.
2020-08-10 23:31:29,018 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:29,022 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:29,031 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie1365800519097453574test/current] [/tmp/bookie1365800519097453574test/current]
2020-08-10 23:31:29,050 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:29,052 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie1365800519097453574test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:29,053 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:29,053 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:29,053 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:29,055 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:29,055 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:29,055 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:29,065 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34087 to become writable
2020-08-10 23:31:29,066 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:29,067 - INFO  - [SyncThread-211-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:29,081 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:29,082 - INFO  - [BookieJournal-34087:Journal@909] - Starting journal on /tmp/bookie1365800519097453574test/current
2020-08-10 23:31:29,083 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:29,083 - INFO  - [BookieJournal-34087:JournalChannel@157] - Opening journal /tmp/bookie1365800519097453574test/current/173da4913bc.txn
2020-08-10 23:31:29,101 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34087
2020-08-10 23:31:29,204 - INFO  - [BookieDeathWatcher-40091:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:29,204 - INFO  - [BookieDeathWatcher-40091:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-40091
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:29,204 - INFO  - [BookieDeathWatcher-40091:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:29,204 - INFO  - [BookieDeathWatcher-40091:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:29,355 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34087' has been created.
2020-08-10 23:31:29,357 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionSmallEntryLogs @ metadata service zk://localhost:40647/ledgers in 423 ms.
2020-08-10 23:31:29,422 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34087] for ledger: 0
2020-08-10 23:31:29,427 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1f3ed9ab, L:/127.0.0.1:34580 - R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:29,427 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34087
2020-08-10 23:31:29,427 - INFO  - [bookie-io-206-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:29,427 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient$1@471] - connection [id: 0x1f3ed9ab, L:/127.0.0.1:34580 - R:127.0.0.1/127.0.0.1:34087] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:29,427 - INFO  - [bookie-io-206-2:BookieRequestHandler@50] - Channel connected  [id: 0x449e7101, L:/127.0.0.1:34087 - R:/127.0.0.1:34580]
2020-08-10 23:31:29,428 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:29,429 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/0.log for logId 0.
2020-08-10 23:31:29,476 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:29,476 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:29,477 - WARN  - [bookkeeper-io-202-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x1f3ed9ab, L:/127.0.0.1:34580 - R:127.0.0.1/127.0.0.1:34087] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:29,477 - INFO  - [bookie-io-206-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x449e7101, L:/127.0.0.1:34087 ! R:/127.0.0.1:34580]
2020-08-10 23:31:29,478 - INFO  - [bookkeeper-io-202-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1f3ed9ab, L:/127.0.0.1:34580 ! R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:29,480 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34087 with exitCode 0
2020-08-10 23:31:29,481 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:29,481 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:29,507 - INFO  - [SyncThread-211-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095089084 , logFileOffset - 5120]}.
2020-08-10 23:31:29,518 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:29,519 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:29,519 - INFO  - [BookieJournal-34087:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:29,519 - INFO  - [BookieJournal-34087:Journal@1144] - Journal exited loop!
2020-08-10 23:31:29,519 - INFO  - [Bookie-34087:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:29,519 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:29,520 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:29,521 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:29,521 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:29,521 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:29,521 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:29,526 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:29,526 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:29,527 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:29,537 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34087
2020-08-10 23:31:30,102 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:30,102 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34087
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:30,102 - INFO  - [BookieDeathWatcher-34087:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:30,102 - INFO  - [BookieDeathWatcher-34087:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:30,638 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie1365800519097453574test",
  "metadataServiceUri" : "zk://localhost:40647/ledgers",
  "journalDirectories" : "/tmp/bookie1365800519097453574test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "34087",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:30,643 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40647/ledgers : zkServers = localhost:40647, ledgersRootPath = /ledgers.
2020-08-10 23:31:30,684 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:30,687 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:30,709 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:30,711 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:30,712 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:30,712 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:30,715 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:30,715 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:30,715 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:30,724 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34087 to become writable
2020-08-10 23:31:30,725 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095089084 from position 5120
2020-08-10 23:31:30,725 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie1365800519097453574test/current/173da4913bc.txn
2020-08-10 23:31:30,725 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:30,726 - INFO  - [SyncThread-221-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095089084 , logFileOffset - 5124]}.
2020-08-10 23:31:30,744 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:30,753 - INFO  - [BookieJournal-34087:Journal@909] - Starting journal on /tmp/bookie1365800519097453574test/current
2020-08-10 23:31:30,755 - INFO  - [BookieJournal-34087:JournalChannel@157] - Opening journal /tmp/bookie1365800519097453574test/current/173da4913bd.txn
2020-08-10 23:31:30,755 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:30,769 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34087
2020-08-10 23:31:31,015 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34087' has been created.
2020-08-10 23:31:31,036 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34087] for ledger: 1
2020-08-10 23:31:31,057 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34087] for ledger: 2
2020-08-10 23:31:31,079 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:34087] for ledger: 3
2020-08-10 23:31:31,082 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xee0fa848, L:/127.0.0.1:34584 - R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:31,083 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34087
2020-08-10 23:31:31,082 - INFO  - [bookie-io-216-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:31,083 - INFO  - [bookie-io-216-2:BookieRequestHandler@50] - Channel connected  [id: 0x5b5ba4e3, L:/127.0.0.1:34087 - R:/127.0.0.1:34584]
2020-08-10 23:31:31,085 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient$1@471] - connection [id: 0xee0fa848, L:/127.0.0.1:34584 - R:127.0.0.1/127.0.0.1:34087] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:31,087 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:31,087 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/1.log for logId 1.
2020-08-10 23:31:31,571 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:31,572 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/2.log for logId 2.
2020-08-10 23:31:31,573 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie1365800519097453574test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:31,605 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:31,745 - INFO  - [GarbageCollectorThread-222-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:31,745 - INFO  - [GarbageCollectorThread-222-1:EntryLogger@1043] - Failed to get ledgers map index from: 0.log : No ledgers map index found on entryLogId0
2020-08-10 23:31:31,746 - INFO  - [GarbageCollectorThread-222-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:31,928 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:31,929 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/3.log for logId 3.
2020-08-10 23:31:31,929 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie1365800519097453574test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:31,962 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:32,263 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:32,265 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/4.log for logId 4.
2020-08-10 23:31:32,265 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/bookie1365800519097453574test/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:32,290 - INFO  - [SyncThread-221-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:31:32,360 - INFO  - [Time-limited test:CompactionTest@781] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:32,360 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:32,360 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:32,360 - WARN  - [bookkeeper-io-202-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0xee0fa848, L:/127.0.0.1:34584 - R:127.0.0.1/127.0.0.1:34087] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:32,361 - INFO  - [bookie-io-216-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x5b5ba4e3, L:/127.0.0.1:34087 ! R:/127.0.0.1:34584]
2020-08-10 23:31:32,361 - INFO  - [bookkeeper-io-202-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xee0fa848, L:/127.0.0.1:34584 ! R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:32,368 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34087 with exitCode 0
2020-08-10 23:31:32,368 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:32,368 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:32,375 - INFO  - [SyncThread-221-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095089085 , logFileOffset - 461312]}.
2020-08-10 23:31:32,379 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:32,379 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:32,379 - INFO  - [BookieJournal-34087:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:32,379 - INFO  - [BookieJournal-34087:Journal@1144] - Journal exited loop!
2020-08-10 23:31:32,380 - INFO  - [Bookie-34087:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:32,380 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:32,381 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:32,381 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:32,381 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:32,381 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:32,381 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:32,383 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:32,385 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:32,385 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:32,390 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:34087
2020-08-10 23:31:32,771 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:32,771 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34087
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:32,772 - INFO  - [BookieDeathWatcher-34087:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:32,772 - INFO  - [BookieDeathWatcher-34087:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:33,492 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie1365800519097453574test",
  "metadataServiceUri" : "zk://localhost:40647/ledgers",
  "journalDirectories" : "/tmp/bookie1365800519097453574test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "34087",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:33,497 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:40647/ledgers : zkServers = localhost:40647, ledgersRootPath = /ledgers.
2020-08-10 23:31:33,504 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:33,507 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:33,520 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:33,522 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:33,522 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:33,524 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:33,526 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:33,526 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:33,526 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:33,547 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:34087 to become writable
2020-08-10 23:31:33,549 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095089085 from position 461312
2020-08-10 23:31:33,549 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie1365800519097453574test/current/173da4913bd.txn
2020-08-10 23:31:33,549 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:33,550 - INFO  - [SyncThread-231-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095089085 , logFileOffset - 461316]}.
2020-08-10 23:31:33,553 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:33,554 - INFO  - [BookieJournal-34087:Journal@909] - Starting journal on /tmp/bookie1365800519097453574test/current
2020-08-10 23:31:33,556 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:33,556 - INFO  - [BookieJournal-34087:JournalChannel@157] - Opening journal /tmp/bookie1365800519097453574test/current/173da4913be.txn
2020-08-10 23:31:33,565 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:34087
2020-08-10 23:31:33,815 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:34087' has been created.
2020-08-10 23:31:33,815 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:31:33,815 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:33,815 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:33,816 - INFO  - [GarbageCollectorThread-232-1:EntryLogger@1043] - Failed to get ledgers map index from: 0.log : No ledgers map index found on entryLogId0
2020-08-10 23:31:33,817 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:33,818 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:33,818 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:33,818 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:31:33,818 - INFO  - [GarbageCollectorThread-232-1:EntryLogger@1043] - Failed to get ledgers map index from: 4.log : No ledgers map index found on entryLogId4
2020-08-10 23:31:33,826 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@396] - Deleting entryLogId 4 as it has no active ledgers!
2020-08-10 23:31:33,826 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 4
2020-08-10 23:31:33,827 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:33,827 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:33,827 - INFO  - [GarbageCollectorThread-232-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:33,828 - INFO  - [GarbageCollectorThread-232-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie1365800519097453574test/current/5.log for logId 5.
2020-08-10 23:31:33,836 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:31:33,836 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:31:33,844 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:31:33,845 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:31:33,852 - INFO  - [GarbageCollectorThread-232-1:EntryLogCompactor@64] - Removing entry log 3 after compaction
2020-08-10 23:31:33,852 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:33,852 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 1]
2020-08-10 23:31:33,852 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@368] - GarbageCollectorThread-232-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:31:33,852 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:33,858 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:33,858 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:33,859 - INFO  - [GarbageCollectorThread-232-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
2020-08-10 23:31:33,866 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xc5e98eaf, L:/127.0.0.1:34590 - R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:33,866 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:34087
2020-08-10 23:31:33,867 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient$1@471] - connection [id: 0xc5e98eaf, L:/127.0.0.1:34590 - R:127.0.0.1/127.0.0.1:34087] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:33,867 - INFO  - [bookie-io-226-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:33,868 - INFO  - [bookie-io-226-2:BookieRequestHandler@50] - Channel connected  [id: 0x87d679f9, L:/127.0.0.1:34087 - R:/127.0.0.1:34590]
2020-08-10 23:31:33,875 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:33,876 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:34087
2020-08-10 23:31:33,876 - INFO  - [bookkeeper-io-202-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xc5e98eaf, L:/127.0.0.1:34590 ! R:127.0.0.1/127.0.0.1:34087]
2020-08-10 23:31:33,877 - INFO  - [bookie-io-226-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x87d679f9, L:/127.0.0.1:34087 ! R:/127.0.0.1:34590]
2020-08-10 23:31:35,975 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:35,975 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:35,978 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-34087 with exitCode 0
2020-08-10 23:31:35,978 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:35,978 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:35,979 - INFO  - [SyncThread-231-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095089085 , logFileOffset - 461316]}.
2020-08-10 23:31:35,983 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:35,983 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:35,983 - INFO  - [BookieJournal-34087:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:35,983 - INFO  - [BookieJournal-34087:Journal@1144] - Journal exited loop!
2020-08-10 23:31:35,983 - INFO  - [Bookie-34087:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:35,984 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:35,985 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:35,985 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:35,985 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:35,986 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:35,986 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:35,988 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:35,988 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:35,988 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:36,208 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionSmallEntryLogs in 2332 ms.
2020-08-10 23:31:36,210 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:36,226 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,235 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37151/ledgers : zkServers = localhost:37151, ledgersRootPath = /ledgers.
2020-08-10 23:31:36,242 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,244 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:36,245 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:36,245 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:36,245 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:36,252 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:36,253 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie17684608027131064255test",
  "metadataServiceUri" : "zk://localhost:37151/ledgers",
  "journalDirectories" : "/tmp/bookie17684608027131064255test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:36,257 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37151/ledgers : zkServers = localhost:37151, ledgersRootPath = /ledgers.
2020-08-10 23:31:36,263 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,268 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:36,275 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17684608027131064255test/current] [/tmp/bookie17684608027131064255test/current]
2020-08-10 23:31:36,287 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:36,289 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17684608027131064255test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:36,289 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:36,290 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:36,290 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:36,291 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:36,292 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:36,292 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:36,303 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:38823 to become writable
2020-08-10 23:31:36,308 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:36,309 - INFO  - [SyncThread-247-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:36,312 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:36,314 - INFO  - [BookieJournal-38823:Journal@909] - Starting journal on /tmp/bookie17684608027131064255test/current
2020-08-10 23:31:36,316 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:36,316 - INFO  - [BookieJournal-38823:JournalChannel@157] - Opening journal /tmp/bookie17684608027131064255test/current/173da492ffd.txn
2020-08-10 23:31:36,322 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:38823
2020-08-10 23:31:36,565 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:36,566 - INFO  - [BookieDeathWatcher-34087:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-34087
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:36,566 - INFO  - [BookieDeathWatcher-34087:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:36,566 - INFO  - [BookieDeathWatcher-34087:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:36,571 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:38823' has been created.
2020-08-10 23:31:36,572 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testWhenNoLogsToCompact @ metadata service zk://localhost:37151/ledgers in 362 ms.
2020-08-10 23:31:36,573 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:36,684 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:36,684 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:36,694 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-38823 with exitCode 0
2020-08-10 23:31:36,695 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:36,695 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:36,695 - INFO  - [SyncThread-247-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:36,699 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:36,699 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:36,699 - INFO  - [BookieJournal-38823:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:36,699 - INFO  - [BookieJournal-38823:Journal@1144] - Journal exited loop!
2020-08-10 23:31:36,700 - INFO  - [Bookie-38823:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:36,700 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:36,701 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:36,702 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:36,923 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testWhenNoLogsToCompact in 348 ms.
2020-08-10 23:31:36,925 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:36,926 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:36,928 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:36,929 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.20000000298023224, interval=3600000
2020-08-10 23:31:36,929 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.800000011920929, interval=86400000
2020-08-10 23:31:36,929 - INFO  - [Time-limited test:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.1
2020-08-10 23:31:36,929 - INFO  - [Time-limited test:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:36,929 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:36,930 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testWhenNoLogsToCompact in 0 ms.
2020-08-10 23:31:36,932 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:36,947 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,955 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41821/ledgers : zkServers = localhost:41821, ledgersRootPath = /ledgers.
2020-08-10 23:31:36,964 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,969 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:36,969 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:36,969 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:36,970 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:36,976 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:36,976 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8320679642959938115test",
  "metadataServiceUri" : "zk://localhost:41821/ledgers",
  "journalDirectories" : "/tmp/bookie8320679642959938115test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:36,981 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41821/ledgers : zkServers = localhost:41821, ledgersRootPath = /ledgers.
2020-08-10 23:31:36,988 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:36,994 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:37,001 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie8320679642959938115test/current] [/tmp/bookie8320679642959938115test/current]
2020-08-10 23:31:37,011 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:37,012 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie8320679642959938115test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:37,013 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:37,013 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:37,014 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:37,015 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:37,015 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:37,016 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:37,032 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37489 to become writable
2020-08-10 23:31:37,032 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:37,033 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:37,037 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:37,038 - INFO  - [BookieJournal-37489:Journal@909] - Starting journal on /tmp/bookie8320679642959938115test/current
2020-08-10 23:31:37,039 - INFO  - [BookieJournal-37489:JournalChannel@157] - Opening journal /tmp/bookie8320679642959938115test/current/173da4932d0.txn
2020-08-10 23:31:37,040 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:37,045 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37489
2020-08-10 23:31:37,295 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37489' has been created.
2020-08-10 23:31:37,297 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMinorCompaction @ metadata service zk://localhost:41821/ledgers in 364 ms.
2020-08-10 23:31:37,320 - INFO  - [BookieDeathWatcher-38823:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:37,320 - INFO  - [BookieDeathWatcher-38823:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-38823
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:37,320 - INFO  - [BookieDeathWatcher-38823:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:37,320 - INFO  - [BookieDeathWatcher-38823:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:37,321 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37489] for ledger: 0
2020-08-10 23:31:37,329 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37489] for ledger: 1
2020-08-10 23:31:37,334 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:37489] for ledger: 2
2020-08-10 23:31:37,339 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x0daed3c1, L:/127.0.0.1:55422 - R:127.0.0.1/127.0.0.1:37489]
2020-08-10 23:31:37,339 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37489
2020-08-10 23:31:37,339 - INFO  - [bookie-io-259-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:37,339 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient$1@471] - connection [id: 0x0daed3c1, L:/127.0.0.1:55422 - R:127.0.0.1/127.0.0.1:37489] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:37,339 - INFO  - [bookie-io-259-2:BookieRequestHandler@50] - Channel connected  [id: 0xb7408fd4, L:/127.0.0.1:37489 - R:/127.0.0.1:55422]
2020-08-10 23:31:37,340 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:37,340 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8320679642959938115test/current/0.log for logId 0.
2020-08-10 23:31:37,672 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:37,673 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8320679642959938115test/current/1.log for logId 1.
2020-08-10 23:31:37,673 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie8320679642959938115test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:37,708 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:31:38,002 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:38,003 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8320679642959938115test/current/2.log for logId 2.
2020-08-10 23:31:38,004 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie8320679642959938115test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:38,033 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:38,038 - INFO  - [GarbageCollectorThread-265-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:38,038 - INFO  - [GarbageCollectorThread-265-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:38,330 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:38,331 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8320679642959938115test/current/3.log for logId 3.
2020-08-10 23:31:38,331 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie8320679642959938115test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:38,360 - INFO  - [SyncThread-264-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:38,422 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:38,422 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:38,423 - WARN  - [bookkeeper-io-255-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x0daed3c1, L:/127.0.0.1:55422 - R:127.0.0.1/127.0.0.1:37489] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:38,423 - INFO  - [bookie-io-259-2:BookieRequestHandler@61] - Channels disconnected: [id: 0xb7408fd4, L:/127.0.0.1:37489 ! R:/127.0.0.1:55422]
2020-08-10 23:31:38,423 - INFO  - [bookkeeper-io-255-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x0daed3c1, L:/127.0.0.1:55422 ! R:127.0.0.1/127.0.0.1:37489]
2020-08-10 23:31:38,427 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37489 with exitCode 0
2020-08-10 23:31:38,427 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:38,427 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:38,435 - INFO  - [SyncThread-264-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095097040 , logFileOffset - 461312]}.
2020-08-10 23:31:38,438 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:38,439 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:38,441 - INFO  - [BookieJournal-37489:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:38,441 - INFO  - [BookieJournal-37489:Journal@1144] - Journal exited loop!
2020-08-10 23:31:38,441 - INFO  - [Bookie-37489:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:38,441 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:38,442 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:38,442 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:38,442 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:38,442 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:38,442 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:38,444 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:38,444 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:38,444 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:38,449 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:37489
2020-08-10 23:31:39,049 - INFO  - [BookieDeathWatcher-37489:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:39,049 - INFO  - [BookieDeathWatcher-37489:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37489
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:39,049 - INFO  - [BookieDeathWatcher-37489:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:39,049 - INFO  - [BookieDeathWatcher-37489:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:39,551 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie8320679642959938115test",
  "metadataServiceUri" : "zk://localhost:41821/ledgers",
  "journalDirectories" : "/tmp/bookie8320679642959938115test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "37489",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:39,554 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:41821/ledgers : zkServers = localhost:41821, ledgersRootPath = /ledgers.
2020-08-10 23:31:39,563 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:39,573 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:39,582 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:39,583 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:39,584 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:39,584 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:39,585 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:39,586 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=120000000
2020-08-10 23:31:39,586 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=240000000
2020-08-10 23:31:39,596 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:37489 to become writable
2020-08-10 23:31:39,597 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095097040 from position 461312
2020-08-10 23:31:39,597 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie8320679642959938115test/current/173da4932d0.txn
2020-08-10 23:31:39,597 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:31:39,600 - INFO  - [SyncThread-274-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095097040 , logFileOffset - 461316]}.
2020-08-10 23:31:39,605 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:39,607 - INFO  - [BookieJournal-37489:Journal@909] - Starting journal on /tmp/bookie8320679642959938115test/current
2020-08-10 23:31:39,608 - INFO  - [BookieJournal-37489:JournalChannel@157] - Opening journal /tmp/bookie8320679642959938115test/current/173da4932d1.txn
2020-08-10 23:31:39,609 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:39,616 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:37489
2020-08-10 23:31:39,867 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:37489' has been created.
2020-08-10 23:31:39,867 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:31:39,867 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:39,867 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:39,868 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:39,869 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:39,869 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:39,870 - INFO  - [GarbageCollectorThread-275-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:31:39,876 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:39,876 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:39,876 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 4]
2020-08-10 23:31:39,876 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@368] - GarbageCollectorThread-275-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:31:39,877 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:39,883 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:39,883 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:39,884 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 4]
2020-08-10 23:31:39,895 - INFO  - [Time-limited test:CompactionTest@329] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:39,896 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:31:39,896 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:39,901 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:31:39,901 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:39,902 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:39,902 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:39,902 - INFO  - [GarbageCollectorThread-275-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:39,903 - INFO  - [GarbageCollectorThread-275-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie8320679642959938115test/current/4.log for logId 4.
2020-08-10 23:31:39,911 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:31:39,912 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:31:39,919 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:31:39,920 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:31:39,927 - INFO  - [GarbageCollectorThread-275-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:31:39,928 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:31:39,928 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 3, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:39,928 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@368] - GarbageCollectorThread-275-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:31:39,928 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:31:39,932 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:39,932 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:39,932 - INFO  - [GarbageCollectorThread-275-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:39,936 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa3f262ef, L:/127.0.0.1:55426 - R:127.0.0.1/127.0.0.1:37489]
2020-08-10 23:31:39,936 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:37489
2020-08-10 23:31:39,937 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient$1@471] - connection [id: 0xa3f262ef, L:/127.0.0.1:55426 - R:127.0.0.1/127.0.0.1:37489] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:39,937 - INFO  - [bookie-io-269-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:39,938 - INFO  - [bookie-io-269-2:BookieRequestHandler@50] - Channel connected  [id: 0x1d3c26b8, L:/127.0.0.1:37489 - R:/127.0.0.1:55426]
2020-08-10 23:31:39,944 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:39,945 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:37489
2020-08-10 23:31:39,946 - INFO  - [bookkeeper-io-255-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa3f262ef, L:/127.0.0.1:55426 ! R:127.0.0.1/127.0.0.1:37489]
2020-08-10 23:31:39,946 - INFO  - [bookie-io-269-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x1d3c26b8, L:/127.0.0.1:37489 ! R:/127.0.0.1:55426]
2020-08-10 23:31:42,070 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:42,071 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:42,080 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-37489 with exitCode 0
2020-08-10 23:31:42,080 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:42,080 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:42,080 - INFO  - [SyncThread-274-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095097040 , logFileOffset - 461316]}.
2020-08-10 23:31:42,085 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:42,085 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:42,085 - INFO  - [BookieJournal-37489:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:42,085 - INFO  - [BookieJournal-37489:Journal@1144] - Journal exited loop!
2020-08-10 23:31:42,085 - INFO  - [Bookie-37489:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:42,085 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:42,087 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:42,087 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:42,087 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:42,087 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:42,087 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:42,089 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:42,089 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:42,089 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:42,308 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMinorCompaction in 2363 ms.
2020-08-10 23:31:42,310 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:31:42,324 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:42,332 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
2020-08-10 23:31:42,338 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:42,341 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:31:42,342 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:31:42,342 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:31:42,342 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:31:42,356 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:31:42,357 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie16743659906445559468test",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "journalDirectories" : "/tmp/bookie16743659906445559468test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:31:42,360 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
2020-08-10 23:31:42,365 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:42,368 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:42,376 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie16743659906445559468test/current] [/tmp/bookie16743659906445559468test/current]
2020-08-10 23:31:42,390 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:42,393 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie16743659906445559468test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:31:42,393 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:42,394 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:42,394 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:42,395 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:42,395 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:31:42,396 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:42,409 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39439 to become writable
2020-08-10 23:31:42,410 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:42,410 - INFO  - [SyncThread-290-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:31:42,414 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:42,416 - INFO  - [BookieJournal-39439:Journal@909] - Starting journal on /tmp/bookie16743659906445559468test/current
2020-08-10 23:31:42,418 - INFO  - [BookieJournal-39439:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d3.txn
2020-08-10 23:31:42,418 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:42,424 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39439
2020-08-10 23:31:42,619 - INFO  - [BookieDeathWatcher-37489:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:42,619 - INFO  - [BookieDeathWatcher-37489:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-37489
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:42,620 - INFO  - [BookieDeathWatcher-37489:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:42,620 - INFO  - [BookieDeathWatcher-37489:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:42,675 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39439' has been created.
2020-08-10 23:31:42,676 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionFailureShouldNotResultInDuplicatedData @ metadata service zk://localhost:36951/ledgers in 365 ms.
2020-08-10 23:31:42,703 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39439] for ledger: 0
2020-08-10 23:31:42,712 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39439] for ledger: 1
2020-08-10 23:31:42,720 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:39439] for ledger: 2
2020-08-10 23:31:42,725 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa699197b, L:/127.0.0.1:50338 - R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:42,725 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39439
2020-08-10 23:31:42,725 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient$1@471] - connection [id: 0xa699197b, L:/127.0.0.1:50338 - R:127.0.0.1/127.0.0.1:39439] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:42,727 - INFO  - [bookie-io-285-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:42,727 - INFO  - [bookie-io-285-2:BookieRequestHandler@50] - Channel connected  [id: 0x98d11231, L:/127.0.0.1:39439 - R:/127.0.0.1:50338]
2020-08-10 23:31:42,728 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:31:42,728 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/0.log for logId 0.
2020-08-10 23:31:43,032 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:43,033 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/1.log for logId 1.
2020-08-10 23:31:43,033 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie16743659906445559468test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:43,069 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:31:43,367 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:43,368 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/2.log for logId 2.
2020-08-10 23:31:43,368 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie16743659906445559468test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:43,397 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:31:43,416 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:43,417 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:43,681 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:43,682 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/3.log for logId 3.
2020-08-10 23:31:43,682 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie16743659906445559468test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:43,706 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:31:43,996 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:43,997 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/4.log for logId 4.
2020-08-10 23:31:43,997 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 3 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=3, logFile=/tmp/bookie16743659906445559468test/current/3.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:44,031 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 3 to disk.
2020-08-10 23:31:44,352 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:31:44,353 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/5.log for logId 5.
2020-08-10 23:31:44,353 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 4 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=4, logFile=/tmp/bookie16743659906445559468test/current/4.log, ledgerIdAssigned=-1}].
2020-08-10 23:31:44,384 - INFO  - [SyncThread-290-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 4 to disk.
2020-08-10 23:31:44,415 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:44,417 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:44,417 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:31:44,423 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@358] - Enter minor compaction, suspendMinor false
2020-08-10 23:31:44,423 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.10000000149011612
2020-08-10 23:31:44,423 - INFO  - [GarbageCollectorThread-291-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 5]
2020-08-10 23:31:44,496 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:44,496 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:44,498 - INFO  - [bookie-io-285-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x98d11231, L:/127.0.0.1:39439 ! R:/127.0.0.1:50338]
2020-08-10 23:31:44,498 - WARN  - [bookkeeper-io-281-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xa699197b, L:/127.0.0.1:50338 - R:127.0.0.1/127.0.0.1:39439] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:44,499 - INFO  - [bookkeeper-io-281-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa699197b, L:/127.0.0.1:50338 ! R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:44,516 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39439 with exitCode 0
2020-08-10 23:31:44,517 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:44,517 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:44,524 - INFO  - [SyncThread-290-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095102419 , logFileOffset - 768512]}.
2020-08-10 23:31:44,527 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:44,528 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:44,528 - INFO  - [BookieJournal-39439:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:44,528 - INFO  - [BookieJournal-39439:Journal@1144] - Journal exited loop!
2020-08-10 23:31:44,529 - INFO  - [Bookie-39439:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:44,529 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:44,530 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:44,530 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:44,530 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:44,530 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:44,530 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:44,532 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:44,532 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:44,532 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:45,041 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39439
2020-08-10 23:31:45,425 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:45,425 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39439
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:45,426 - INFO  - [BookieDeathWatcher-39439:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:45,426 - INFO  - [BookieDeathWatcher-39439:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:46,150 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.0",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie16743659906445559468test",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "useTransactionalCompaction" : "true",
  "journalDirectories" : "/tmp/bookie16743659906445559468test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "39439",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:46,154 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
2020-08-10 23:31:46,165 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:46,168 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:46,182 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:46,184 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:46,184 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:46,185 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:46,187 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:46,188 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:31:46,188 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=false, threshold=0.0, interval=4000
2020-08-10 23:31:46,199 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39439 to become writable
2020-08-10 23:31:46,199 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095102419 from position 768512
2020-08-10 23:31:46,200 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d3.txn
2020-08-10 23:31:46,200 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:46,200 - INFO  - [SyncThread-300-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095102419 , logFileOffset - 768516]}.
2020-08-10 23:31:46,205 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:46,207 - INFO  - [BookieJournal-39439:Journal@909] - Starting journal on /tmp/bookie16743659906445559468test/current
2020-08-10 23:31:46,208 - INFO  - [BookieJournal-39439:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d4.txn
2020-08-10 23:31:46,209 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:46,215 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39439
2020-08-10 23:31:46,465 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39439' has been created.
2020-08-10 23:31:46,474 - INFO  - [Time-limited test:CompactionTest@1315] - Finished deleting the ledgers contains most entries.
2020-08-10 23:31:47,208 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:47,208 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:47,209 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:47,209 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:47,210 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:31:47,210 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 5
2020-08-10 23:31:47,210 - INFO  - [GarbageCollectorThread-301-1:EntryLogger@1043] - Failed to get ledgers map index from: 5.log : No ledgers map index found on entryLogId5
2020-08-10 23:31:47,218 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@396] - Deleting entryLogId 5 as it has no active ledgers!
2020-08-10 23:31:47,219 - INFO  - [GarbageCollectorThread-301-1:GarbageCollectorThread@494] - Removing entry log metadata for 5
2020-08-10 23:31:51,487 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 0
2020-08-10 23:31:51,488 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/6.log.compacting for logId 6.
2020-08-10 23:31:51,592 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/6.log.compacting with logId 6.
2020-08-10 23:31:51,593 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:51,594 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 0 end in FlushCompactionLogPhase.
2020-08-10 23:31:51,594 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 1
2020-08-10 23:31:51,595 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/7.log.compacting for logId 7.
2020-08-10 23:31:51,691 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/7.log.compacting with logId 7.
2020-08-10 23:31:51,692 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:51,692 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 1 end in FlushCompactionLogPhase.
2020-08-10 23:31:51,693 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 2
2020-08-10 23:31:51,694 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/8.log.compacting for logId 8.
2020-08-10 23:31:51,792 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/8.log.compacting with logId 8.
2020-08-10 23:31:51,793 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:51,794 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 2 end in FlushCompactionLogPhase.
2020-08-10 23:31:51,794 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 3
2020-08-10 23:31:51,794 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/9.log.compacting for logId 9.
2020-08-10 23:31:51,890 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/9.log.compacting with logId 9.
2020-08-10 23:31:51,891 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:51,892 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 3 end in FlushCompactionLogPhase.
2020-08-10 23:31:51,892 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1424] - Compacting entry log 4
2020-08-10 23:31:51,893 - INFO  - [Time-limited test:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/a.log.compacting for logId 10.
2020-08-10 23:31:51,991 - INFO  - [Time-limited test:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/a.log.compacting with logId 10.
2020-08-10 23:31:51,992 - ERROR - [Time-limited test:TransactionalEntryLogCompactor$CompactionPhase@138] - Encounter exception in compaction phase FlushCompactionLogPhase. Abort current compaction.
java.io.IOException: Encounter IOException when trying to flush compaction log
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor$LogFlushFailurePhase.start(CompactionTest.java:1484)
	at org.apache.bookkeeper.bookie.TransactionalEntryLogCompactor$CompactionPhase.run(TransactionalEntryLogCompactor.java:135)
	at org.apache.bookkeeper.bookie.CompactionTest$MockTransactionalEntryLogCompactor.compactWithLogFlushFailure(CompactionTest.java:1432)
	at org.apache.bookkeeper.bookie.CompactionTest.testCompactionFailureShouldNotResultInDuplicatedData(CompactionTest.java:1330)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:298)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:292)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:31:51,993 - INFO  - [Time-limited test:CompactionTest$MockTransactionalEntryLogCompactor@1433] - Compaction for 4 end in FlushCompactionLogPhase.
2020-08-10 23:31:52,001 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7ddc66ea, L:/127.0.0.1:50344 - R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:52,001 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39439
2020-08-10 23:31:52,001 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient$1@471] - connection [id: 0x7ddc66ea, L:/127.0.0.1:50344 - R:127.0.0.1/127.0.0.1:39439] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:52,002 - INFO  - [bookie-io-295-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:52,002 - INFO  - [bookie-io-295-2:BookieRequestHandler@50] - Channel connected  [id: 0x88cd929b, L:/127.0.0.1:39439 - R:/127.0.0.1:50344]
2020-08-10 23:31:52,017 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:52,017 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:52,018 - INFO  - [bookie-io-295-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x88cd929b, L:/127.0.0.1:39439 ! R:/127.0.0.1:50344]
2020-08-10 23:31:52,018 - WARN  - [bookkeeper-io-281-2:PerChannelBookieClient@1270] - Exception caught on:[id: 0x7ddc66ea, L:/127.0.0.1:50344 - R:127.0.0.1/127.0.0.1:39439] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:31:52,019 - INFO  - [bookkeeper-io-281-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7ddc66ea, L:/127.0.0.1:50344 ! R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:52,023 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39439 with exitCode 0
2020-08-10 23:31:52,024 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:31:52,024 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:31:52,024 - INFO  - [SyncThread-300-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095102419 , logFileOffset - 768516]}.
2020-08-10 23:31:52,028 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:31:52,028 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:31:52,029 - INFO  - [BookieJournal-39439:Journal@1135] - Journal exits when shutting down
2020-08-10 23:31:52,029 - INFO  - [BookieJournal-39439:Journal@1144] - Journal exited loop!
2020-08-10 23:31:52,029 - INFO  - [Bookie-39439:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:31:52,029 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:31:52,030 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:31:52,030 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:31:52,030 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:31:52,030 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:31:52,030 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:31:52,031 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:31:52,031 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:31:52,031 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:31:52,035 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:39439
2020-08-10 23:31:52,218 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:31:52,218 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39439
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:31:52,218 - INFO  - [BookieDeathWatcher-39439:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:31:52,218 - INFO  - [BookieDeathWatcher-39439:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:31:53,149 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie16743659906445559468test",
  "metadataServiceUri" : "zk://localhost:36951/ledgers",
  "useTransactionalCompaction" : "true",
  "journalDirectories" : "/tmp/bookie16743659906445559468test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "39439",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionInterval" : "2",
  "minorCompactionThreshold" : "0.0",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:31:53,154 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:36951/ledgers : zkServers = localhost:36951, ledgersRootPath = /ledgers.
2020-08-10 23:31:53,163 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:31:53,167 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:31:53,177 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:31:53,180 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:31:53,180 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:31:53,180 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:31:53,181 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:31:53,182 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=2000
2020-08-10 23:31:53,182 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:31:53,189 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:39439 to become writable
2020-08-10 23:31:53,190 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095102419 from position 768516
2020-08-10 23:31:53,190 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d3.txn
2020-08-10 23:31:53,190 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095102420 from position 0
2020-08-10 23:31:53,190 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d4.txn
2020-08-10 23:31:53,191 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:31:53,191 - INFO  - [SyncThread-310-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095102420 , logFileOffset - 516]}.
2020-08-10 23:31:53,195 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:31:53,196 - INFO  - [BookieJournal-39439:Journal@909] - Starting journal on /tmp/bookie16743659906445559468test/current
2020-08-10 23:31:53,197 - INFO  - [BookieJournal-39439:JournalChannel@157] - Opening journal /tmp/bookie16743659906445559468test/current/173da4947d5.txn
2020-08-10 23:31:53,197 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:31:53,204 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:39439
2020-08-10 23:31:53,459 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:39439' has been created.
2020-08-10 23:31:54,197 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:31:54,197 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:31:54,198 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:31:54,198 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:31:54,198 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 4
2020-08-10 23:31:57,204 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:31:57,204 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:31:57,204 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 0 with usage 0.02127659574468085.
2020-08-10 23:31:57,205 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/b.log.compacting for logId 11.
2020-08-10 23:31:57,213 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/b.log.compacting with logId 11.
2020-08-10 23:31:57,223 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:31:57,223 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 0.
2020-08-10 23:31:57,223 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 1 with usage 0.02127659574468085.
2020-08-10 23:31:57,224 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/c.log.compacting for logId 12.
2020-08-10 23:31:57,239 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/c.log.compacting with logId 12.
2020-08-10 23:31:57,247 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:31:57,247 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 1.
2020-08-10 23:31:57,247 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 2 with usage 0.02127659574468085.
2020-08-10 23:31:57,248 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/d.log.compacting for logId 13.
2020-08-10 23:31:57,263 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/d.log.compacting with logId 13.
2020-08-10 23:31:57,273 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:31:57,274 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 2.
2020-08-10 23:31:57,274 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 3 with usage 0.02127659574468085.
2020-08-10 23:31:57,274 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/e.log.compacting for logId 14.
2020-08-10 23:31:57,289 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/e.log.compacting with logId 14.
2020-08-10 23:31:57,299 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:31:57,299 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 3.
2020-08-10 23:31:57,299 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@98] - Compacting entry log 4 with usage 0.02127659574468085.
2020-08-10 23:31:57,299 - INFO  - [GarbageCollectorThread-311-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16743659906445559468test/current/f.log.compacting for logId 15.
2020-08-10 23:31:57,313 - INFO  - [GarbageCollectorThread-311-1:EntryLogger@640] - Flushed compaction log file /tmp/bookie16743659906445559468test/current/f.log.compacting with logId 15.
2020-08-10 23:31:57,322 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@494] - Removing entry log metadata for 4
2020-08-10 23:31:57,323 - INFO  - [GarbageCollectorThread-311-1:TransactionalEntryLogCompactor@117] - Compacted entry log : 4.
2020-08-10 23:31:57,323 - INFO  - [GarbageCollectorThread-311-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 5, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:31:58,468 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x1690bfd4, L:/127.0.0.1:50348 - R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:58,468 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:39439
2020-08-10 23:31:58,468 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient$1@471] - connection [id: 0x1690bfd4, L:/127.0.0.1:50348 - R:127.0.0.1/127.0.0.1:39439] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:31:58,471 - INFO  - [bookie-io-305-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:31:58,471 - INFO  - [bookie-io-305-2:BookieRequestHandler@50] - Channel connected  [id: 0x7f4aa3d4, L:/127.0.0.1:39439 - R:/127.0.0.1:50348]
2020-08-10 23:31:58,480 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:31:58,480 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:39439
2020-08-10 23:31:58,480 - INFO  - [bookkeeper-io-281-3:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x1690bfd4, L:/127.0.0.1:50348 ! R:127.0.0.1/127.0.0.1:39439]
2020-08-10 23:31:58,481 - INFO  - [bookie-io-305-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x7f4aa3d4, L:/127.0.0.1:39439 ! R:/127.0.0.1:50348]
2020-08-10 23:32:00,580 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:00,581 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:00,600 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-39439 with exitCode 0
2020-08-10 23:32:00,600 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:32:00,600 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:32:00,600 - INFO  - [SyncThread-310-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095102420 , logFileOffset - 516]}.
2020-08-10 23:32:00,605 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:32:00,605 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:32:00,605 - INFO  - [BookieJournal-39439:Journal@1135] - Journal exits when shutting down
2020-08-10 23:32:00,606 - INFO  - [BookieJournal-39439:Journal@1144] - Journal exited loop!
2020-08-10 23:32:00,606 - INFO  - [Bookie-39439:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:32:00,606 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:32:00,607 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:32:00,830 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionFailureShouldNotResultInDuplicatedData in 2350 ms.
2020-08-10 23:32:00,832 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:32:00,854 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:00,864 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35635/ledgers : zkServers = localhost:35635, ledgersRootPath = /ledgers.
2020-08-10 23:32:00,872 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:00,875 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:32:00,875 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:32:00,876 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:32:00,876 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:32:00,882 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:32:00,882 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie16575790640346934788test",
  "metadataServiceUri" : "zk://localhost:35635/ledgers",
  "journalDirectories" : "/tmp/bookie16575790640346934788test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:32:00,886 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35635/ledgers : zkServers = localhost:35635, ledgersRootPath = /ledgers.
2020-08-10 23:32:00,891 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:00,896 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:32:00,902 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie16575790640346934788test/current] [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:00,912 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:32:00,914 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie16575790640346934788test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:32:00,914 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:32:00,914 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:32:00,915 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:32:00,917 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:32:00,917 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:32:00,917 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:32:00,931 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33475 to become writable
2020-08-10 23:32:00,931 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:32:00,932 - INFO  - [SyncThread-326-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:32:00,937 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:32:00,939 - INFO  - [BookieJournal-33475:Journal@909] - Starting journal on /tmp/bookie16575790640346934788test/current
2020-08-10 23:32:00,940 - INFO  - [BookieJournal-33475:JournalChannel@157] - Opening journal /tmp/bookie16575790640346934788test/current/173da49902d.txn
2020-08-10 23:32:00,940 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:32:00,945 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33475
2020-08-10 23:32:01,198 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33475' has been created.
2020-08-10 23:32:01,200 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testCompactionWhenLedgerDirsAreFull @ metadata service zk://localhost:35635/ledgers in 367 ms.
2020-08-10 23:32:01,220 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33475] for ledger: 0
2020-08-10 23:32:01,222 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:32:01,222 - INFO  - [BookieDeathWatcher-39439:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-39439
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:32:01,223 - INFO  - [BookieDeathWatcher-39439:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:01,223 - INFO  - [BookieDeathWatcher-39439:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:01,227 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33475] for ledger: 1
2020-08-10 23:32:01,234 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33475] for ledger: 2
2020-08-10 23:32:01,238 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0xa29b3843, L:/127.0.0.1:35928 - R:127.0.0.1/127.0.0.1:33475]
2020-08-10 23:32:01,238 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33475
2020-08-10 23:32:01,238 - INFO  - [bookie-io-321-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:32:01,238 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient$1@471] - connection [id: 0xa29b3843, L:/127.0.0.1:35928 - R:127.0.0.1/127.0.0.1:33475] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:32:01,238 - INFO  - [bookie-io-321-2:BookieRequestHandler@50] - Channel connected  [id: 0x27cf8956, L:/127.0.0.1:33475 - R:/127.0.0.1:35928]
2020-08-10 23:32:01,241 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:32:01,242 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16575790640346934788test/current/0.log for logId 0.
2020-08-10 23:32:01,553 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:01,554 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16575790640346934788test/current/1.log for logId 1.
2020-08-10 23:32:01,554 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie16575790640346934788test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:01,585 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:32:01,857 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:01,858 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16575790640346934788test/current/2.log for logId 2.
2020-08-10 23:32:01,858 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie16575790640346934788test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:01,886 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:32:01,938 - INFO  - [GarbageCollectorThread-327-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:32:01,939 - INFO  - [GarbageCollectorThread-327-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:32:02,148 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:02,149 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16575790640346934788test/current/3.log for logId 3.
2020-08-10 23:32:02,149 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie16575790640346934788test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:02,176 - INFO  - [SyncThread-326-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:32:02,243 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:02,243 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:02,244 - INFO  - [bookie-io-321-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x27cf8956, L:/127.0.0.1:33475 ! R:/127.0.0.1:35928]
2020-08-10 23:32:02,244 - WARN  - [bookkeeper-io-317-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0xa29b3843, L:/127.0.0.1:35928 - R:127.0.0.1/127.0.0.1:33475] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:32:02,244 - INFO  - [bookkeeper-io-317-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0xa29b3843, L:/127.0.0.1:35928 ! R:127.0.0.1/127.0.0.1:33475]
2020-08-10 23:32:02,252 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33475 with exitCode 0
2020-08-10 23:32:02,253 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:32:02,253 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:32:02,253 - INFO  - [SyncThread-326-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095120941 , logFileOffset - 461312]}.
2020-08-10 23:32:02,256 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:32:02,257 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:32:02,257 - INFO  - [BookieJournal-33475:Journal@1135] - Journal exits when shutting down
2020-08-10 23:32:02,257 - INFO  - [BookieJournal-33475:Journal@1144] - Journal exited loop!
2020-08-10 23:32:02,257 - INFO  - [Bookie-33475:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:32:02,257 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:32:02,258 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:32:02,258 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:32:02,258 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:32:02,258 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:32:02,258 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:32:02,259 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:32:02,260 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:32:02,260 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:32:02,264 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@498] - Removing a node: /default-rack/127.0.0.1:33475
2020-08-10 23:32:02,958 - INFO  - [BookieDeathWatcher-33475:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:32:02,958 - INFO  - [BookieDeathWatcher-33475:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33475
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:32:02,958 - INFO  - [BookieDeathWatcher-33475:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:02,958 - INFO  - [BookieDeathWatcher-33475:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:03,368 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.76262057",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie16575790640346934788test",
  "metadataServiceUri" : "zk://localhost:35635/ledgers",
  "minUsableSizeForIndexFileCreation" : "1",
  "journalDirectories" : "/tmp/bookie16575790640346934788test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "diskUsageWarnThreshold" : "0.0",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "60000",
  "forceReadOnlyBookie" : "true",
  "isForceGCAllowWhenNoSpace" : "true",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "33475",
  "allowEphemeralPorts" : "true",
  "minUsableSizeForEntryLogCreation" : "1",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "240000",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.0",
  "minorCompactionInterval" : "120000",
  "enableTaskExecutionStats" : "true",
  "isThrottleByBytes" : "true"
}
2020-08-10 23:32:03,373 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:35635/ledgers : zkServers = localhost:35635, ledgersRootPath = /ledgers.
2020-08-10 23:32:03,381 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:03,385 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:32:03,401 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:32:03,403 - ERROR - [Time-limited test:DiskChecker@156] - Space left on device /tmp/bookie16575790640346934788test/current : 2510168064, Used space fraction: 0.8473572 > threshold 0.76262057.
2020-08-10 23:32:03,404 - WARN  - [Time-limited test:LedgerDirsManager@231] - /tmp/bookie16575790640346934788test/current is out of space. Adding it to filled dirs list
2020-08-10 23:32:03,405 - INFO  - [BookieStateManagerService-0:ReadOnlyBookie$1@73] - Skip transition to readonly mode for readonly bookie
2020-08-10 23:32:03,406 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:32:03,407 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:32:03,408 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:32:03,410 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:32:03,410 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=false, threshold=0.0, interval=120000000
2020-08-10 23:32:03,410 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=240000000
2020-08-10 23:32:03,410 - INFO  - [Time-limited test:ReadOnlyBookie@56] - Running bookie in force readonly mode.
2020-08-10 23:32:03,440 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33475 to become readonly
2020-08-10 23:32:03,441 - INFO  - [Time-limited test:Bookie@931] - Replaying journal 1597095120941 from position 461312
2020-08-10 23:32:03,441 - INFO  - [Time-limited test:JournalChannel@157] - Opening journal /tmp/bookie16575790640346934788test/current/173da49902d.txn
2020-08-10 23:32:03,442 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 1 ms.
2020-08-10 23:32:03,442 - INFO  - [SyncThread-336-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095120941 , logFileOffset - 461316]}.
2020-08-10 23:32:03,442 - INFO  - [SyncThread-336-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,446 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:32:03,447 - INFO  - [BookieJournal-33475:Journal@909] - Starting journal on /tmp/bookie16575790640346934788test/current
2020-08-10 23:32:03,448 - INFO  - [BookieJournal-33475:JournalChannel@157] - Opening journal /tmp/bookie16575790640346934788test/current/173da49902e.txn
2020-08-10 23:32:03,448 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:32:03,458 - WARN  - [BookieStateManagerService-0:ZKRegistrationManager@306] - No writable bookie registered node /ledgers/available/127.0.0.1:33475 when transitioning to readonly
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /ledgers/available/127.0.0.1:33475
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:118)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at org.apache.zookeeper.ZooKeeper.delete(ZooKeeper.java:1793)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.access$2101(ZooKeeperClient.java:70)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:770)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient$11.call(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.zookeeper.ZooWorker.syncCallWithRetries(ZooWorker.java:140)
	at org.apache.bookkeeper.zookeeper.ZooKeeperClient.delete(ZooKeeperClient.java:764)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.doRegisterReadOnlyBookie(ZKRegistrationManager.java:304)
	at org.apache.bookkeeper.discover.ZKRegistrationManager.registerBookie(ZKRegistrationManager.java:226)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:272)
	at org.apache.bookkeeper.bookie.BookieStateManager.doRegisterBookie(BookieStateManager.java:260)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:223)
	at org.apache.bookkeeper.bookie.BookieStateManager$2.call(BookieStateManager.java:219)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2020-08-10 23:32:03,711 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33475' has been created.
2020-08-10 23:32:03,718 - INFO  - [Time-limited test:CompactionTest@699] - Finished deleting the ledgers contains most entries.
2020-08-10 23:32:03,718 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:32:03,719 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:32:03,719 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:32:03,719 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:32:03,719 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:32:03,720 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 3
2020-08-10 23:32:03,720 - INFO  - [GarbageCollectorThread-337-1:EntryLogger@1043] - Failed to get ledgers map index from: 3.log : No ledgers map index found on entryLogId3
2020-08-10 23:32:03,726 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@396] - Deleting entryLogId 3 as it has no active ledgers!
2020-08-10 23:32:03,727 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 3
2020-08-10 23:32:03,727 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:32:03,727 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:32:03,727 - INFO  - [GarbageCollectorThread-337-1:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:32:03,727 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,728 - INFO  - [GarbageCollectorThread-337-1:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie16575790640346934788test/current/4.log for logId 4.
2020-08-10 23:32:03,733 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,734 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,737 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 2 after compaction
2020-08-10 23:32:03,737 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 2
2020-08-10 23:32:03,743 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,743 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,746 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 1 after compaction
2020-08-10 23:32:03,747 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 1
2020-08-10 23:32:03,756 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,756 - INFO  - [GarbageCollectorThread-337-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:03,759 - INFO  - [GarbageCollectorThread-337-1:EntryLogCompactor@64] - Removing entry log 0 after compaction
2020-08-10 23:32:03,760 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@494] - Removing entry log metadata for 0
2020-08-10 23:32:03,760 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 3, 0, 0, 0, 0, 0, 0]
2020-08-10 23:32:03,760 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@368] - GarbageCollectorThread-337-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:32:03,760 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:32:03,765 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:32:03,765 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:32:03,765 - INFO  - [GarbageCollectorThread-337-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2020-08-10 23:32:03,771 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x810ad366, L:/127.0.0.1:35932 - R:127.0.0.1/127.0.0.1:33475]
2020-08-10 23:32:03,771 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33475
2020-08-10 23:32:03,772 - INFO  - [bookie-io-331-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:32:03,772 - INFO  - [bookie-io-331-2:BookieRequestHandler@50] - Channel connected  [id: 0x15a5a520, L:/127.0.0.1:33475 - R:/127.0.0.1:35932]
2020-08-10 23:32:03,772 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient$1@471] - connection [id: 0x810ad366, L:/127.0.0.1:35932 - R:127.0.0.1/127.0.0.1:33475] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:32:03,796 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:32:03,796 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:33475
2020-08-10 23:32:03,797 - INFO  - [bookkeeper-io-317-2:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x810ad366, L:/127.0.0.1:35932 ! R:127.0.0.1/127.0.0.1:33475]
2020-08-10 23:32:03,797 - INFO  - [bookie-io-331-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x15a5a520, L:/127.0.0.1:33475 ! R:/127.0.0.1:35932]
2020-08-10 23:32:05,895 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:05,895 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:05,903 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33475 with exitCode 0
2020-08-10 23:32:05,904 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:32:05,904 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:32:05,905 - INFO  - [SyncThread-336-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095120941 , logFileOffset - 461316]}.
2020-08-10 23:32:05,905 - INFO  - [SyncThread-336-1:LedgerDirsManager@195] - No writable ledger dirs below diskUsageThreshold. But Dirs that can accommodate 1 are: [/tmp/bookie16575790640346934788test/current]
2020-08-10 23:32:05,908 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:32:05,909 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:32:05,909 - INFO  - [BookieJournal-33475:Journal@1135] - Journal exits when shutting down
2020-08-10 23:32:05,909 - INFO  - [BookieJournal-33475:Journal@1144] - Journal exited loop!
2020-08-10 23:32:05,909 - INFO  - [Bookie-33475:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:32:05,909 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:32:05,910 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:32:05,910 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:32:05,910 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:32:05,911 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:32:05,911 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:32:05,913 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:32:05,913 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:32:05,913 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:32:06,136 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testCompactionWhenLedgerDirsAreFull in 2340 ms.
2020-08-10 23:32:06,138 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:32:06,162 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:06,173 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33181/ledgers : zkServers = localhost:33181, ledgersRootPath = /ledgers.
2020-08-10 23:32:06,182 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:06,186 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:32:06,186 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:32:06,186 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:32:06,187 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:32:06,194 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:32:06,194 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie17971999890171721535test",
  "metadataServiceUri" : "zk://localhost:33181/ledgers",
  "journalDirectories" : "/tmp/bookie17971999890171721535test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:32:06,198 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:33181/ledgers : zkServers = localhost:33181, ledgersRootPath = /ledgers.
2020-08-10 23:32:06,204 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:06,208 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:32:06,217 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie17971999890171721535test/current] [/tmp/bookie17971999890171721535test/current]
2020-08-10 23:32:06,228 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:32:06,230 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie17971999890171721535test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:32:06,231 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:32:06,231 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:32:06,232 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:32:06,233 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:32:06,233 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:32:06,233 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:32:06,240 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:45947 to become writable
2020-08-10 23:32:06,241 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:32:06,241 - INFO  - [SyncThread-352-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:32:06,246 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:32:06,246 - INFO  - [BookieJournal-45947:Journal@909] - Starting journal on /tmp/bookie17971999890171721535test/current
2020-08-10 23:32:06,247 - INFO  - [BookieJournal-45947:JournalChannel@157] - Opening journal /tmp/bookie17971999890171721535test/current/173da49a4e8.txn
2020-08-10 23:32:06,248 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:32:06,254 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:45947
2020-08-10 23:32:06,467 - INFO  - [BookieDeathWatcher-33475:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:32:06,467 - INFO  - [BookieDeathWatcher-33475:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-33475
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:32:06,467 - INFO  - [BookieDeathWatcher-33475:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:06,467 - INFO  - [BookieDeathWatcher-33475:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:06,507 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:45947' has been created.
2020-08-10 23:32:06,509 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMajorCompactionAboveThreshold @ metadata service zk://localhost:33181/ledgers in 370 ms.
2020-08-10 23:32:06,536 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45947] for ledger: 0
2020-08-10 23:32:06,544 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45947] for ledger: 1
2020-08-10 23:32:06,551 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:45947] for ledger: 2
2020-08-10 23:32:06,557 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x7b8affbe, L:/127.0.0.1:58144 - R:127.0.0.1/127.0.0.1:45947]
2020-08-10 23:32:06,557 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:45947
2020-08-10 23:32:06,557 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient$1@471] - connection [id: 0x7b8affbe, L:/127.0.0.1:58144 - R:127.0.0.1/127.0.0.1:45947] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:32:06,557 - INFO  - [bookie-io-347-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:32:06,558 - INFO  - [bookie-io-347-2:BookieRequestHandler@50] - Channel connected  [id: 0x37217e8f, L:/127.0.0.1:45947 - R:/127.0.0.1:58144]
2020-08-10 23:32:06,558 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:32:06,559 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17971999890171721535test/current/0.log for logId 0.
2020-08-10 23:32:06,880 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:06,881 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17971999890171721535test/current/1.log for logId 1.
2020-08-10 23:32:06,882 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie17971999890171721535test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:06,916 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:32:07,214 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:07,215 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17971999890171721535test/current/2.log for logId 2.
2020-08-10 23:32:07,216 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie17971999890171721535test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:07,241 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:32:07,247 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:32:07,247 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:32:07,545 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:07,546 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie17971999890171721535test/current/3.log for logId 3.
2020-08-10 23:32:07,546 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie17971999890171721535test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:07,571 - INFO  - [SyncThread-352-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:32:07,640 - INFO  - [Time-limited test:CompactionTest@743] - Finished deleting the ledgers contains less entries.
2020-08-10 23:32:07,641 - INFO  - [Time-limited test:GarbageCollectorThread@235] - Forced garbage collection triggered by thread: Time-limited test
2020-08-10 23:32:07,641 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:32:07,641 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 2
2020-08-10 23:32:07,651 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:32:07,651 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:32:07,652 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 3, 0, 0]
2020-08-10 23:32:07,652 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@368] - GarbageCollectorThread-353-1 Set forceGarbageCollection to false after force GC to make it forceGC-able again.
2020-08-10 23:32:07,652 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@321] - Garbage collector thread forced to perform GC before expiry of wait time.
2020-08-10 23:32:07,656 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@347] - Enter major compaction, suspendMajor false
2020-08-10 23:32:07,656 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@431] - Do compaction to compact those files lower than 0.5
2020-08-10 23:32:07,657 - INFO  - [GarbageCollectorThread-353-1:GarbageCollectorThread@462] - Compaction: entry log usage buckets[10% 20% 30% 40% 50% 60% 70% 80% 90% 100%] = [0, 0, 0, 0, 0, 0, 0, 3, 0, 0]
2020-08-10 23:32:07,657 - INFO  - [Time-limited test:BookKeeperClusterTestCase@185] - TearDown
2020-08-10 23:32:07,657 - INFO  - [Time-limited test:PerChannelBookieClient@1029] - Closing the per channel bookie client for 127.0.0.1:45947
2020-08-10 23:32:07,658 - INFO  - [bookie-io-347-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x37217e8f, L:/127.0.0.1:45947 ! R:/127.0.0.1:58144]
2020-08-10 23:32:07,658 - INFO  - [bookkeeper-io-343-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x7b8affbe, L:/127.0.0.1:58144 ! R:127.0.0.1/127.0.0.1:45947]
2020-08-10 23:32:07,764 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:07,764 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:07,770 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-45947 with exitCode 0
2020-08-10 23:32:07,770 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:32:07,770 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:32:07,778 - INFO  - [SyncThread-352-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095126248 , logFileOffset - 461824]}.
2020-08-10 23:32:07,781 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:32:07,782 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:32:07,782 - INFO  - [BookieJournal-45947:Journal@1135] - Journal exits when shutting down
2020-08-10 23:32:07,782 - INFO  - [BookieJournal-45947:Journal@1144] - Journal exited loop!
2020-08-10 23:32:07,783 - INFO  - [Bookie-45947:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:32:07,783 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:32:07,783 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:32:07,783 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:32:07,783 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:32:07,784 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
2020-08-10 23:32:07,784 - INFO  - [Time-limited test:EntryLogger@1161] - Stopping EntryLogger
2020-08-10 23:32:07,785 - INFO  - [Time-limited test:EntryLoggerAllocator@222] - Stopped entry logger preallocator.
2020-08-10 23:32:07,785 - INFO  - [Time-limited test:InterleavedLedgerStorage@296] - Complete shutting down Ledger Storage
2020-08-10 23:32:07,785 - INFO  - [Time-limited test:LedgerDirsMonitor@202] - Shutting down LedgerDirsMonitor
2020-08-10 23:32:08,006 - INFO  - [Time-limited test:BookKeeperClusterTestCase@208] - Tearing down test testMajorCompactionAboveThreshold in 348 ms.
2020-08-10 23:32:08,008 - INFO  - [Time-limited test:BookKeeperClusterTestCase@152] - Setting up test class org.apache.bookkeeper.bookie.CompactionByBytesTest
2020-08-10 23:32:08,025 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:08,032 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37423/ledgers : zkServers = localhost:37423, ledgersRootPath = /ledgers.
2020-08-10 23:32:08,038 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:08,041 - ERROR - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@267] - Failed to initialize DNS Resolver org.apache.bookkeeper.net.ScriptBasedMapping, used default subnet resolver : java.lang.RuntimeException: No network topology script is found when using script based DNS resolver.
2020-08-10 23:32:08,041 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@214] - Initialize rackaware ensemble placement policy @ <Bookie:127.0.1.1:0> @ /default-rack : org.apache.bookkeeper.client.TopologyAwareEnsemblePlacementPolicy$DefaultResolver.
2020-08-10 23:32:08,041 - INFO  - [Time-limited test:RackawareEnsemblePlacementPolicyImpl@224] - Not weighted
2020-08-10 23:32:08,041 - INFO  - [Time-limited test:BookKeeper@509] - Weighted ledger placement is not enabled
2020-08-10 23:32:08,049 - INFO  - [Time-limited test:BookKeeperClusterTestCase@636] - Starting new bookie on port: 0
2020-08-10 23:32:08,049 - INFO  - [Time-limited test:BookieServer@99] - {
  "diskUsageThreshold" : "0.999",
  "majorCompactionThreshold" : "0.5",
  "allocatorPoolingPolicy" : "UnpooledHeap",
  "ledgerDirectories" : "/tmp/bookie10291221393627157808test",
  "metadataServiceUri" : "zk://localhost:37423/ledgers",
  "journalDirectories" : "/tmp/bookie10291221393627157808test",
  "allowLoopback" : "true",
  "metastoreImplClass" : "org.apache.bookkeeper.metastore.InMemoryMetaStore",
  "diskUsageWarnThreshold" : "0.99",
  "ledgerStorageClass" : "org.apache.bookkeeper.bookie.InterleavedLedgerStorage",
  "dbStorage_readAheadCacheMaxSizeMb" : "4",
  "gcWaitTime" : "1000",
  "isForceGCAllowWhenNoSpace" : "false",
  "journalFormatVersionToWrite" : "5",
  "entryLogFilePreallocationEnabled" : "false",
  "dbStorage_writeCacheMaxSizeMb" : "4",
  "bookiePort" : "0",
  "allowEphemeralPorts" : "true",
  "listeningInterface" : "lo",
  "logSizeLimit" : "102400",
  "majorCompactionInterval" : "4",
  "journalFlushWhenQueueEmpty" : "true",
  "flushInterval" : "100",
  "minorCompactionThreshold" : "0.10000000149011612",
  "minorCompactionInterval" : "2",
  "isThrottleByBytes" : "true",
  "enableTaskExecutionStats" : "true"
}
2020-08-10 23:32:08,053 - INFO  - [Time-limited test:ZKMetadataDriverBase@187] - Initialize zookeeper metadata driver at metadata service uri zk://localhost:37423/ledgers : zkServers = localhost:37423, ledgersRootPath = /ledgers.
2020-08-10 23:32:08,059 - INFO  - [Time-limited test-EventThread:ZooKeeperWatcherBase@130] - ZooKeeper client is connected now.
2020-08-10 23:32:08,062 - INFO  - [Time-limited test:ZKRegistrationManager@425] - INSTANCEID not exists in zookeeper. Not considering it for data verification
2020-08-10 23:32:08,067 - INFO  - [Time-limited test:Bookie@390] - Stamping new cookies on all dirs [/tmp/bookie10291221393627157808test/current] [/tmp/bookie10291221393627157808test/current]
2020-08-10 23:32:08,077 - INFO  - [Time-limited test:Bookie@704] - instantiate ledger manager org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
2020-08-10 23:32:08,079 - ERROR - [Time-limited test:Journal$LastLogMark@251] - Problems reading from /tmp/bookie10291221393627157808test/current/lastMark (this is okay if it is the first time starting this bookie
2020-08-10 23:32:08,079 - INFO  - [Time-limited test:Bookie@623] - Using ledger storage: org.apache.bookkeeper.bookie.InterleavedLedgerStorage
2020-08-10 23:32:08,080 - INFO  - [Time-limited test:IndexPersistenceMgr@99] - openFileLimit = 20000
2020-08-10 23:32:08,080 - INFO  - [Time-limited test:IndexInMemPageMgr@361] - maxDirectMemory = 2147483648, pageSize = 8192, pageLimit = 87381
2020-08-10 23:32:08,081 - INFO  - [Time-limited test:ScanAndCompareGarbageCollector@105] - Over Replicated Ledger Deletion : enabled=true, interval=86400000
2020-08-10 23:32:08,081 - INFO  - [Time-limited test:GarbageCollectorThread@225] - Minor Compaction : enabled=true, threshold=0.10000000149011612, interval=2000
2020-08-10 23:32:08,081 - INFO  - [Time-limited test:GarbageCollectorThread@227] - Major Compaction : enabled=true, threshold=0.5, interval=4000
2020-08-10 23:32:08,097 - INFO  - [Time-limited test:BookKeeperTestClient@90] - Wait for 127.0.0.1:33427 to become writable
2020-08-10 23:32:08,098 - INFO  - [Time-limited test:Bookie@901] - Finished replaying journal in 0 ms.
2020-08-10 23:32:08,098 - INFO  - [SyncThread-368-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 0 , logFileOffset - 0]}.
2020-08-10 23:32:08,102 - INFO  - [Time-limited test:Bookie@991] - Finished reading journal, starting bookie
2020-08-10 23:32:08,103 - INFO  - [BookieJournal-33427:Journal@909] - Starting journal on /tmp/bookie10291221393627157808test/current
2020-08-10 23:32:08,103 - INFO  - [BookieJournal-33427:JournalChannel@157] - Opening journal /tmp/bookie10291221393627157808test/current/173da49ac28.txn
2020-08-10 23:32:08,104 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@478] - ForceWrite Thread started
2020-08-10 23:32:08,111 - INFO  - [BookKeeperClientScheduler-OrderedScheduler-0-0:NetworkTopologyImpl@426] - Adding a new node: /default-rack/127.0.0.1:33427
2020-08-10 23:32:08,254 - INFO  - [BookieDeathWatcher-45947:BookieServer$DeathWatcher@285] - BookieDeathWatcher noticed the bookie is not running any more, exiting the watch loop!
2020-08-10 23:32:08,255 - INFO  - [BookieDeathWatcher-45947:BookieServer$DeathWatcher@269] - BookieDeathWatcher exited loop due to uncaught exception from thread BookieDeathWatcher-45947
java.lang.RuntimeException: Bookie is not running any more
	at org.apache.bookkeeper.proto.BookieServer$DeathWatcher.run(BookieServer.java:289)
2020-08-10 23:32:08,255 - INFO  - [BookieDeathWatcher-45947:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:08,255 - INFO  - [BookieDeathWatcher-45947:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:08,361 - INFO  - [Time-limited test:BookKeeperClusterTestCase@670] - New bookie '127.0.0.1:33427' has been created.
2020-08-10 23:32:08,363 - INFO  - [Time-limited test:BookKeeperClusterTestCase@164] - Setup testcase testMajorCompaction @ metadata service zk://localhost:37423/ledgers in 354 ms.
2020-08-10 23:32:08,385 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33427] for ledger: 0
2020-08-10 23:32:08,391 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33427] for ledger: 1
2020-08-10 23:32:08,396 - INFO  - [Time-limited test-EventThread:LedgerCreateOp@221] - Ensemble: [127.0.0.1:33427] for ledger: 2
2020-08-10 23:32:08,400 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$ConnectionFutureListener@2417] - Successfully connected to bookie: [id: 0x33d77166, L:/127.0.0.1:49144 - R:127.0.0.1/127.0.0.1:33427]
2020-08-10 23:32:08,400 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$ConnectionFutureListener@2425] - Successfully connected to bookie: 127.0.0.1:33427
2020-08-10 23:32:08,400 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient$1@471] - connection [id: 0x33d77166, L:/127.0.0.1:49144 - R:127.0.0.1/127.0.0.1:33427] authenticated as BookKeeperPrincipal{ANONYMOUS}
2020-08-10 23:32:08,401 - INFO  - [bookie-io-363-2:AuthHandler$ServerSideHandler$AuthHandshakeCompleteCallback@219] - Authentication success on server side
2020-08-10 23:32:08,401 - INFO  - [bookie-io-363-2:BookieRequestHandler@50] - Channel connected  [id: 0x02f4bda7, L:/127.0.0.1:33427 - R:/127.0.0.1:49144]
2020-08-10 23:32:08,402 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file because current active log channel has not initialized yet
2020-08-10 23:32:08,402 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10291221393627157808test/current/0.log for logId 0.
2020-08-10 23:32:08,684 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:08,686 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10291221393627157808test/current/1.log for logId 1.
2020-08-10 23:32:08,686 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 0 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=0, logFile=/tmp/bookie10291221393627157808test/current/0.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:08,719 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 0 to disk.
2020-08-10 23:32:08,991 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:08,991 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10291221393627157808test/current/2.log for logId 2.
2020-08-10 23:32:08,992 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 1 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=1, logFile=/tmp/bookie10291221393627157808test/current/1.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:09,021 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 1 to disk.
2020-08-10 23:32:09,103 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 0
2020-08-10 23:32:09,104 - INFO  - [GarbageCollectorThread-369-1:GarbageCollectorThread@553] - Extracting entry log meta from entryLogId: 1
2020-08-10 23:32:09,702 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@146] - Creating a new entry log file : createNewLog = false, reachEntryLogLimit = true
2020-08-10 23:32:09,704 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLoggerAllocator@181] - Created new entry log file /tmp/bookie10291221393627157808test/current/3.log for logId 3.
2020-08-10 23:32:09,704 - INFO  - [BookieWriteThreadPool-OrderedExecutor-0-0:EntryLogManagerBase@163] - Flushing entry logger 2 back to filesystem, pending for syncing entry loggers : [BufferedChannel{logId=2, logFile=/tmp/bookie10291221393627157808test/current/2.log, ledgerIdAssigned=-1}].
2020-08-10 23:32:09,729 - INFO  - [SyncThread-368-1:EntryLogManagerForSingleEntryLog@209] - Synced entry logger 2 to disk.
2020-08-10 23:32:09,789 - INFO  - [Time-limited test:BookieServer@203] - Shutting down BookieServer
2020-08-10 23:32:09,790 - INFO  - [Time-limited test:BookieNettyServer@424] - Shutting down BookieNettyServer
2020-08-10 23:32:09,791 - WARN  - [bookkeeper-io-359-1:PerChannelBookieClient@1270] - Exception caught on:[id: 0x33d77166, L:/127.0.0.1:49144 - R:127.0.0.1/127.0.0.1:33427] cause: syscall:read(..) failed: Connection reset by peer
2020-08-10 23:32:09,791 - INFO  - [bookkeeper-io-359-1:PerChannelBookieClient@1210] - Disconnected from bookie channel [id: 0x33d77166, L:/127.0.0.1:49144 ! R:127.0.0.1/127.0.0.1:33427]
2020-08-10 23:32:09,791 - INFO  - [bookie-io-363-2:BookieRequestHandler@61] - Channels disconnected: [id: 0x02f4bda7, L:/127.0.0.1:33427 ! R:/127.0.0.1:49144]
2020-08-10 23:32:09,795 - INFO  - [Time-limited test:Bookie@1176] - Shutting down Bookie-33427 with exitCode 0
2020-08-10 23:32:09,795 - INFO  - [Time-limited test:Bookie@1185] - Turning bookie to read only during shut down
2020-08-10 23:32:09,795 - INFO  - [Time-limited test:SyncThread@203] - Shutting down SyncThread
2020-08-10 23:32:09,802 - INFO  - [SyncThread-368-1:SyncThread@135] - Flush ledger storage at checkpoint CheckpointList{checkpoints=[LogMark: logFileId - 1597095128104 , logFileOffset - 461312]}.
2020-08-10 23:32:09,806 - INFO  - [Time-limited test:Journal@1159] - Shutting down Journal
2020-08-10 23:32:09,807 - INFO  - [ForceWriteThread:Journal$ForceWriteThread@533] - ForceWrite thread interrupted
2020-08-10 23:32:09,807 - INFO  - [BookieJournal-33427:Journal@1135] - Journal exits when shutting down
2020-08-10 23:32:09,807 - INFO  - [BookieJournal-33427:Journal@1144] - Journal exited loop!
2020-08-10 23:32:09,808 - INFO  - [Bookie-33427:Bookie@1130] - Journal thread(s) quit.
2020-08-10 23:32:09,808 - INFO  - [Time-limited test:Journal@1170] - Finished Shutting down Journal thread
2020-08-10 23:32:09,808 - INFO  - [Time-limited test:InterleavedLedgerStorage@286] - Shutting down InterleavedLedgerStorage
2020-08-10 23:32:09,808 - INFO  - [Time-limited test:InterleavedLedgerStorage@287] - Shutting down GC thread
2020-08-10 23:32:09,808 - INFO  - [Time-limited test:GarbageCollectorThread@474] - Shutting down GarbageCollectorThread
2020-08-10 23:32:09,808 - INFO  - [Time-limited test:InterleavedLedgerStorage@289] - Shutting down entry logger
